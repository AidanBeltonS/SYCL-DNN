/*
 * Copyright 2018 Codeplay Software Ltd.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use these files except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

// DO NOT MODIFY BY HAND
// This file was automatically generated by generate_pooling_tests.py.
// Results calculated using Tensorflow v1.8.0.

#include <gtest/gtest.h>

#include "sycldnn/pooling/launch.h"
#include "sycldnn/pooling/operators.h"
#include "sycldnn/pooling/params.h"

#include "test/pooling/pooling_fixture.h"
#include "test/types/kernel_data_types.h"

#include <CL/sycl.hpp>

#include <vector>

using namespace sycldnn;
template <typename DataType>
using AvgWindow7Stride1Grad =
    PoolingFixture<DataType, pooling::Average, pooling::Backpropagate>;
TYPED_TEST_CASE(AvgWindow7Stride1Grad, types::GTestKernelDataTypes);
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x8x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      7.1521825397,  8.7940192744,  10.8360827664, 13.4384637188, 14.7676303855,
      12.9247732426, 11.2624716553, 9.729138322,   10.8702097506, 13.2671485261,
      16.2139739229, 19.9306405896, 21.5098072562, 18.695521542,  16.1998866213,
      13.9318594104, 16.220606576,  19.6889739229, 23.9135770975, 29.1969104308,
      31.0677437642, 26.8534580499, 23.1633786848, 19.8477324263, 23.8563208617,
      28.8389739229, 34.8635770975, 42.3469104308, 44.5677437642, 38.3534580499,
      32.9633786848, 28.1620181406, 34.489654195,  41.4723072562, 49.8302437642,
      60.1135770975, 62.3344104308, 53.3201247166, 45.5967120181, 38.7953514739,
      32.9301303855, 39.5413548753, 47.4326247166, 57.1159580499, 58.9867913832,
      50.3725056689, 43.0157596372, 36.5572562358, 30.6178287982, 36.729053288,
      44.0092120181, 52.9258786848, 54.5050453515, 46.4907596372, 39.6617913832,
      33.679478458,  27.7678287982, 33.2872165533, 39.8530895692, 47.8840419501,
      49.2132086168, 41.9417800454, 35.7556689342, 30.3447845805};
  const std::array<int, 4> in_shape = {{1, 8, 8, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x8x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.0204081633, 0.0612244898, 0.0612244898, 0.0612244898, 0.0612244898,
      0.0612244898, 0.0612244898, 0.0408163265, 0.0816326531, 0.2040816327,
      0.2040816327, 0.2040816327, 0.2040816327, 0.2040816327, 0.2040816327,
      0.1224489796, 0.0816326531, 0.2040816327, 0.2040816327, 0.2040816327,
      0.2040816327, 0.2040816327, 0.2040816327, 0.1224489796, 0.0816326531,
      0.2040816327, 0.2040816327, 0.2040816327, 0.2040816327, 0.2040816327,
      0.2040816327, 0.1224489796, 0.0816326531, 0.2040816327, 0.2040816327,
      0.2040816327, 0.2040816327, 0.2040816327, 0.2040816327, 0.1224489796,
      0.0816326531, 0.2040816327, 0.2040816327, 0.2040816327, 0.2040816327,
      0.2040816327, 0.2040816327, 0.1224489796, 0.0816326531, 0.2040816327,
      0.2040816327, 0.2040816327, 0.2040816327, 0.2040816327, 0.2040816327,
      0.1224489796, 0.0612244898, 0.1428571429, 0.1428571429, 0.1428571429,
      0.1428571429, 0.1428571429, 0.1428571429, 0.0816326531};
  const std::array<int, 4> in_shape = {{1, 8, 8, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x8x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      13.7274886621,  14.3043650794,  16.9026587302,  17.5880385488,
      20.8601984127,  21.6721655329,  25.9130555556,  26.8769274376,
      28.5713888889,  29.535260771,   25.0375793651,  25.8495464853,
      21.8395634921,  22.5249433107,  18.8814002268,  19.458276644,
      21.0550396825,  21.7404195011,  25.7200056689,  26.5342970522,
      31.4632596372,  32.4279478458,  38.71611678,    39.8612811791,
      41.8744501134,  43.0196145125,  36.4263548753,  37.3910430839,
      31.5854818594,  32.3997732426,  27.1783390023,  27.8637188209,
      31.6292460317,  32.4412131519,  38.4132596372,  39.3779478458,
      46.6842913832,  47.827154195,   57.0371485261,  58.3938208617,
      60.7788151927,  62.1354875283,  52.564053288,   53.7069160998,
      45.362069161,   46.3267573696,  38.8834977324,  39.6954648526,
      46.7487698413,  47.7126417234,  56.5327834467,  57.6779478458,
      68.3704818594,  69.727154195,   83.0833390023,  84.6938208617,
      87.5250056689,  89.1354875283,  75.3502437642,  76.7069160998,
      64.7815929705,  65.9267573696,  55.3601643991,  56.3240362812,
      68.0154365079,  68.97930839,    81.7994501134,  82.9446145125,
      98.3038151927,  99.6604875283,  118.6166723356, 120.227154195,
      123.0583390023, 124.6688208617, 105.2835770975, 106.6402494331,
      90.0482596372,  91.1934240363,  76.6268310658,  77.5907029478,
      65.0482936508,  65.860260771,   78.118021542,   79.0827097506,
      93.7223866213,  94.8652494331,  112.8752437642, 114.2319160998,
      116.6169104308, 117.9735827664, 99.6021485261,  100.7450113379,
      85.0668310658,  86.0315192744,  72.3025453515,  73.1145124717,
      60.5502777778,  61.2356575964,  72.6438151927,  73.458106576,
      87.0537358277,  88.0184240363,  104.7065929705, 105.8517573696,
      107.8649263039, 109.0100907029, 92.0168310658,  92.9815192744,
      78.5092913832,  79.3235827664,  66.6735770975,  67.3589569161,
      54.9587811791,  55.5356575964,  65.889053288,   66.5744331066,
      78.8942120181,  79.7061791383,  94.8042120181,  95.7680839002,
      97.4625453515,  98.4264172336,  83.0715929705,  83.8835600907,
      70.8259580499,  71.5113378685,  60.1126927438,  60.689569161,
  };
  const std::array<int, 4> in_shape = {{1, 8, 8, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x8x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.0204081633, 0.0408163265, 0.0816326531, 0.1224489796, 0.0816326531,
      0.1224489796, 0.0816326531, 0.1224489796, 0.0816326531, 0.1224489796,
      0.0816326531, 0.1224489796, 0.0816326531, 0.1224489796, 0.0612244898,
      0.0816326531, 0.1224489796, 0.1632653061, 0.3265306122, 0.4081632653,
      0.3265306122, 0.4081632653, 0.3265306122, 0.4081632653, 0.3265306122,
      0.4081632653, 0.3265306122, 0.4081632653, 0.3265306122, 0.4081632653,
      0.2040816327, 0.2448979592, 0.1224489796, 0.1632653061, 0.3265306122,
      0.4081632653, 0.3265306122, 0.4081632653, 0.3265306122, 0.4081632653,
      0.3265306122, 0.4081632653, 0.3265306122, 0.4081632653, 0.3265306122,
      0.4081632653, 0.2040816327, 0.2448979592, 0.1224489796, 0.1632653061,
      0.3265306122, 0.4081632653, 0.3265306122, 0.4081632653, 0.3265306122,
      0.4081632653, 0.3265306122, 0.4081632653, 0.3265306122, 0.4081632653,
      0.3265306122, 0.4081632653, 0.2040816327, 0.2448979592, 0.1224489796,
      0.1632653061, 0.3265306122, 0.4081632653, 0.3265306122, 0.4081632653,
      0.3265306122, 0.4081632653, 0.3265306122, 0.4081632653, 0.3265306122,
      0.4081632653, 0.3265306122, 0.4081632653, 0.2040816327, 0.2448979592,
      0.1224489796, 0.1632653061, 0.3265306122, 0.4081632653, 0.3265306122,
      0.4081632653, 0.3265306122, 0.4081632653, 0.3265306122, 0.4081632653,
      0.3265306122, 0.4081632653, 0.3265306122, 0.4081632653, 0.2040816327,
      0.2448979592, 0.1224489796, 0.1632653061, 0.3265306122, 0.4081632653,
      0.3265306122, 0.4081632653, 0.3265306122, 0.4081632653, 0.3265306122,
      0.4081632653, 0.3265306122, 0.4081632653, 0.3265306122, 0.4081632653,
      0.2040816327, 0.2448979592, 0.1020408163, 0.1224489796, 0.2448979592,
      0.2857142857, 0.2448979592, 0.2857142857, 0.2448979592, 0.2857142857,
      0.2448979592, 0.2857142857, 0.2448979592, 0.2857142857, 0.2448979592,
      0.2857142857, 0.1428571429, 0.1632653061};
  const std::array<int, 4> in_shape = {{1, 8, 8, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x8x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      26.878100907,   27.4549773243,  28.0318537415,  28.6087301587,
      33.1199376417,  33.8053174603,  34.4906972789,  35.1760770975,
      40.9084297052,  41.7203968254,  42.5323639456,  43.3443310658,
      50.862239229,   51.8261111111,  52.7899829932,  53.7538548753,
      56.1789058957,  57.1427777778,  58.1066496599,  59.070521542,
      49.26319161,    50.0751587302,  50.8871258503,  51.6990929705,
      42.9937471655,  43.6791269841,  44.3645068027,  45.0498866213,
      37.1859240363,  37.7628004535,  38.3396768707,  38.916553288,
      41.4246995465,  42.1100793651,  42.7954591837,  43.4808390023,
      50.6257199546,  51.4400113379,  52.2543027211,  53.0685941043,
      61.9618310658,  62.9265192744,  63.891207483,   64.8558956916,
      76.287069161,   77.4322335601,  78.5773979592,  79.7225623583,
      82.6037358277,  83.7489002268,  84.8940646259,  86.0392290249,
      71.888021542,   72.8527097506,  73.8173979592,  74.7820861678,
      62.3566723356,  63.1709637188,  63.985255102,   64.7995464853,
      53.6712981859,  54.3566780045,  55.0420578231,  55.7274376417,
      62.4465249433,  63.2584920635,  64.0704591837,  64.8824263039,
      75.8618310658,  76.8265192744,  77.791207483,   78.7558956916,
      92.2257199546,  93.3685827664,  94.5114455782,  95.65430839,
      112.7176247166, 114.0742970522, 115.4309693878, 116.7876417234,
      120.2009580499, 121.5576303855, 122.9143027211, 124.2709750567,
      103.9852437642, 105.128106576,  106.2709693878, 107.4138321995,
      89.7594501134,  90.724138322,   91.6888265306,  92.6535147392,
      76.9550283447,  77.7669954649,  78.578962585,   79.3909297052,
      92.5336678005,  93.4975396825,  94.4614115646,  95.4252834467,
      111.9204024943, 113.0655668934, 114.2107312925, 115.3558956916,
      135.3842913832, 136.7409637188, 138.0976360544, 139.45430839,
      164.5561961451, 166.1666780045, 167.7771598639, 169.3876417234,
      173.4395294785, 175.0500113379, 176.6604931973, 178.2709750567,
      149.3438151927, 150.7004875283, 152.0571598639, 153.4138321995,
      128.418021542,  129.563185941,  130.7083503401, 131.8535147392,
      109.7564569161, 110.7203287982, 111.6842006803, 112.6480725624,
      135.0670011338, 136.0308730159, 136.994744898,  137.95861678,
      162.4537358277, 163.5989002268, 164.7440646259, 165.8892290249,
      195.2509580499, 196.6076303855, 197.9643027211, 199.3209750567,
      235.6228628118, 237.2333446712, 238.8438265306, 240.45430839,
      244.5061961451, 246.1166780045, 247.7271598639, 249.3376417234,
      209.2104818594, 210.567154195,  211.9238265306, 213.2804988662,
      178.9513548753, 180.0965192744, 181.2416836735, 182.3868480726,
      152.2897902494, 153.2536621315, 154.2175340136, 155.1814058957,
      129.2846201814, 130.0965873016, 130.9085544218, 131.720521542,
      155.2713548753, 156.2360430839, 157.2007312925, 158.1654195011,
      186.3019104308, 187.4447732426, 188.5876360544, 189.7304988662,
      224.3938151927, 225.7504875283, 227.1071598639, 228.4638321995,
      231.8771485261, 233.2338208617, 234.5904931973, 235.9471655329,
      198.0614342404, 199.2042970522, 200.3471598639, 201.4900226757,
      169.1689739229, 170.1336621315, 171.0983503401, 172.0630385488,
      143.7931235828, 144.6050907029, 145.4170578231, 146.2290249433,
      120.415175737,  121.1005555556, 121.7859353741, 122.4713151927,
      144.4733390023, 145.2876303855, 146.1019217687, 146.9162131519,
      173.1427834467, 174.1074716553, 175.0721598639, 176.0368480726,
      208.268021542,  209.413185941,  210.5583503401, 211.7035147392,
      214.5846882086, 215.7298526077, 216.8750170068, 218.0201814059,
      183.0689739229, 184.0336621315, 184.9983503401, 185.9630385488,
      156.2042913832, 157.0185827664, 157.8328741497, 158.6471655329,
      132.6617743764, 133.347154195,  134.0325340136, 134.7179138322,
      109.340685941,  109.9175623583, 110.4944387755, 111.0713151927,
      131.0927267574, 131.778106576,  132.4634863946, 133.1488662132,
      156.9764569161, 157.7884240363, 158.6003911565, 159.4123582766,
      188.6445521542, 189.6084240363, 190.5722959184, 191.5361678005,
      193.9612188209, 194.9250907029, 195.888962585,  196.8528344671,
      165.3312188209, 166.143185941,  166.9551530612, 167.7671201814,
      140.9665362812, 141.6519160998, 142.3372959184, 143.022675737,
      119.6485090703, 120.2253854875, 120.8022619048, 121.379138322,
  };
  const std::array<int, 4> in_shape = {{1, 8, 8, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x8x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.0204081633, 0.0408163265, 0.0612244898, 0.0816326531, 0.1224489796,
      0.1632653061, 0.2040816327, 0.2448979592, 0.1224489796, 0.1632653061,
      0.2040816327, 0.2448979592, 0.1224489796, 0.1632653061, 0.2040816327,
      0.2448979592, 0.1224489796, 0.1632653061, 0.2040816327, 0.2448979592,
      0.1224489796, 0.1632653061, 0.2040816327, 0.2448979592, 0.1224489796,
      0.1632653061, 0.2040816327, 0.2448979592, 0.1020408163, 0.1224489796,
      0.1428571429, 0.1632653061, 0.2040816327, 0.2448979592, 0.2857142857,
      0.3265306122, 0.5714285714, 0.6530612245, 0.7346938776, 0.8163265306,
      0.5714285714, 0.6530612245, 0.7346938776, 0.8163265306, 0.5714285714,
      0.6530612245, 0.7346938776, 0.8163265306, 0.5714285714, 0.6530612245,
      0.7346938776, 0.8163265306, 0.5714285714, 0.6530612245, 0.7346938776,
      0.8163265306, 0.5714285714, 0.6530612245, 0.7346938776, 0.8163265306,
      0.3673469388, 0.4081632653, 0.4489795918, 0.4897959184, 0.2040816327,
      0.2448979592, 0.2857142857, 0.3265306122, 0.5714285714, 0.6530612245,
      0.7346938776, 0.8163265306, 0.5714285714, 0.6530612245, 0.7346938776,
      0.8163265306, 0.5714285714, 0.6530612245, 0.7346938776, 0.8163265306,
      0.5714285714, 0.6530612245, 0.7346938776, 0.8163265306, 0.5714285714,
      0.6530612245, 0.7346938776, 0.8163265306, 0.5714285714, 0.6530612245,
      0.7346938776, 0.8163265306, 0.3673469388, 0.4081632653, 0.4489795918,
      0.4897959184, 0.2040816327, 0.2448979592, 0.2857142857, 0.3265306122,
      0.5714285714, 0.6530612245, 0.7346938776, 0.8163265306, 0.5714285714,
      0.6530612245, 0.7346938776, 0.8163265306, 0.5714285714, 0.6530612245,
      0.7346938776, 0.8163265306, 0.5714285714, 0.6530612245, 0.7346938776,
      0.8163265306, 0.5714285714, 0.6530612245, 0.7346938776, 0.8163265306,
      0.5714285714, 0.6530612245, 0.7346938776, 0.8163265306, 0.3673469388,
      0.4081632653, 0.4489795918, 0.4897959184, 0.2040816327, 0.2448979592,
      0.2857142857, 0.3265306122, 0.5714285714, 0.6530612245, 0.7346938776,
      0.8163265306, 0.5714285714, 0.6530612245, 0.7346938776, 0.8163265306,
      0.5714285714, 0.6530612245, 0.7346938776, 0.8163265306, 0.5714285714,
      0.6530612245, 0.7346938776, 0.8163265306, 0.5714285714, 0.6530612245,
      0.7346938776, 0.8163265306, 0.5714285714, 0.6530612245, 0.7346938776,
      0.8163265306, 0.3673469388, 0.4081632653, 0.4489795918, 0.4897959184,
      0.2040816327, 0.2448979592, 0.2857142857, 0.3265306122, 0.5714285714,
      0.6530612245, 0.7346938776, 0.8163265306, 0.5714285714, 0.6530612245,
      0.7346938776, 0.8163265306, 0.5714285714, 0.6530612245, 0.7346938776,
      0.8163265306, 0.5714285714, 0.6530612245, 0.7346938776, 0.8163265306,
      0.5714285714, 0.6530612245, 0.7346938776, 0.8163265306, 0.5714285714,
      0.6530612245, 0.7346938776, 0.8163265306, 0.3673469388, 0.4081632653,
      0.4489795918, 0.4897959184, 0.2040816327, 0.2448979592, 0.2857142857,
      0.3265306122, 0.5714285714, 0.6530612245, 0.7346938776, 0.8163265306,
      0.5714285714, 0.6530612245, 0.7346938776, 0.8163265306, 0.5714285714,
      0.6530612245, 0.7346938776, 0.8163265306, 0.5714285714, 0.6530612245,
      0.7346938776, 0.8163265306, 0.5714285714, 0.6530612245, 0.7346938776,
      0.8163265306, 0.5714285714, 0.6530612245, 0.7346938776, 0.8163265306,
      0.3673469388, 0.4081632653, 0.4489795918, 0.4897959184, 0.1836734694,
      0.2040816327, 0.2244897959, 0.2448979592, 0.4489795918, 0.4897959184,
      0.5306122449, 0.5714285714, 0.4489795918, 0.4897959184, 0.5306122449,
      0.5714285714, 0.4489795918, 0.4897959184, 0.5306122449, 0.5714285714,
      0.4489795918, 0.4897959184, 0.5306122449, 0.5714285714, 0.4489795918,
      0.4897959184, 0.5306122449, 0.5714285714, 0.4489795918, 0.4897959184,
      0.5306122449, 0.5714285714, 0.2653061224, 0.2857142857, 0.306122449,
      0.3265306122};
  const std::array<int, 4> in_shape = {{1, 8, 8, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x8x9x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      7.8827721088,  9.6620238095,  11.5497789116, 13.8787471655, 14.4712471655,
      16.309223356,  14.4866043084, 12.8158560091, 11.0366043084, 12.0348129252,
      14.6507993197, 17.3956972789, 20.7484750567, 21.2766893424, 23.6360941043,
      20.8849036281, 18.3978287982, 15.7818424036, 18.0181462585, 21.8246088435,
      25.783792517,  30.5810147392, 30.9592290249, 34.0019671202, 29.9174433107,
      26.2637018141, 22.457239229,  26.5652891156, 32.0574659864, 37.7309353741,
      44.5614909297, 44.6697052154, 48.6224433107, 42.6379195011, 37.3270351474,
      31.8348582766, 38.5277891156, 46.2699659864, 54.1934353741, 63.6489909297,
      62.9697052154, 67.7099433107, 59.1004195011, 51.5395351474, 43.7973582766,
      36.8163605442, 44.158537415,  51.6534353741, 60.5756575964, 59.7163718821,
      63.9966099773, 55.7870861678, 48.5976303855, 41.2554535147, 34.2508843537,
      41.0454421769, 47.9689115646, 56.1966893424, 55.2624036281, 59.08430839,
      51.4581179138, 44.7924716553, 37.9979138322, 31.0753741497, 37.2168707483,
      43.4668707483, 50.8851247166, 49.9508390023, 53.315600907,  46.4036961451,
      40.3707029478, 34.2292063492};
  const std::array<int, 4> in_shape = {{1, 8, 9, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x8x9x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.0204081633, 0.0612244898, 0.1224489796, 0.1224489796, 0.1224489796,
      0.1224489796, 0.1224489796, 0.1020408163, 0.0612244898, 0.1020408163,
      0.2448979592, 0.4285714286, 0.4285714286, 0.4285714286, 0.4285714286,
      0.4285714286, 0.3265306122, 0.1836734694, 0.1020408163, 0.2448979592,
      0.4285714286, 0.4285714286, 0.4285714286, 0.4285714286, 0.4285714286,
      0.3265306122, 0.1836734694, 0.1020408163, 0.2448979592, 0.4285714286,
      0.4285714286, 0.4285714286, 0.4285714286, 0.4285714286, 0.3265306122,
      0.1836734694, 0.1020408163, 0.2448979592, 0.4285714286, 0.4285714286,
      0.4285714286, 0.4285714286, 0.4285714286, 0.3265306122, 0.1836734694,
      0.1020408163, 0.2448979592, 0.4285714286, 0.4285714286, 0.4285714286,
      0.4285714286, 0.4285714286, 0.3265306122, 0.1836734694, 0.1020408163,
      0.2448979592, 0.4285714286, 0.4285714286, 0.4285714286, 0.4285714286,
      0.4285714286, 0.3265306122, 0.1836734694, 0.0816326531, 0.1836734694,
      0.306122449,  0.306122449,  0.306122449,  0.306122449,  0.306122449,
      0.2244897959, 0.1224489796};
  const std::array<int, 4> in_shape = {{1, 8, 9, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x8x9x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      15.1886678005,  15.7655442177,  18.6386678005,  19.324047619,
      22.3056746032,  23.0995578231,  26.8370238095,  27.7574943311,
      28.06,          28.9424943311,  31.6979761905,  32.618446712,
      28.1793253968,  28.9732086168,  24.9463321995,  25.6317120181,
      21.4963321995,  22.0732086168,  23.3842460317,  24.0696258503,
      28.4873072562,  29.3015986395,  33.84819161,    34.7913945578,
      40.4033503401,  41.4969501134,  41.5048979592,  42.5533786848,
      46.1785884354,  47.2721882086,  40.8266043084,  41.7698072562,
      35.9813662132,  36.7956575964,  30.8783049887,  31.5636848073,
      35.2243253968,  36.036292517,   42.6845294785,  43.6492176871,
      50.450175737,   51.567585034,   59.8664455782,  61.1620294785,
      60.6763265306,  61.9184580499,  66.7083503401,  68.0039342404,
      58.7174773243,  59.8348866213,  51.5627154195,  52.5274036281,
      44.1025113379,  44.914478458,   52.1667063492,  53.1305782313,
      62.9697675737,  64.1149319728,  74.1354138322,  75.4618707483,
      87.5850170068,  89.1229818594,  87.8648979592,  89.3394104308,
      95.7069217687,  97.2448866213,  83.9493820862,  85.2758390023,
      73.5089058957,  74.6540702948,  62.7058446712,  63.6697165533,
      76.0917063492,  77.0555782313,  91.3947675737,  92.5399319728,
      107.0604138322, 108.3868707483, 125.7600170068, 127.2979818594,
      124.4648979592, 125.9394104308, 133.8819217687, 135.4198866213,
      116.8743820862, 118.2008390023, 101.9339058957, 103.0790702948,
      86.6308446712,  87.5947165533,  72.8207539683,  73.6327210884,
      87.3523866213,  88.3170748299,  102.1894614512, 103.3068707483,
      119.8557312925, 121.1513151927, 118.1906122449, 119.4327437642,
      126.6976360544, 127.9932199546, 110.4567630385, 111.5741723356,
      96.2305725624,  97.195260771,   81.6989399093,  82.5109070295,
      67.8163888889,  68.5017687075,  81.2765929705,  82.0908843537,
      94.9946201814,  95.9378231293,  111.2997789116, 112.3933786848,
      109.4763265306, 110.5248072562, 117.0750170068, 118.16861678,
      101.9730328798, 102.9162358277, 88.7706519274,  89.5849433107,
      75.3104478458,  75.9958276644,  61.5738718821,  62.1507482993,
      73.748361678,   74.4337414966,  86.1398582766,  86.9337414966,
      100.8497789116, 101.7702494331, 99.0191836735,  99.9016780045,
      105.7107312925, 106.6312018141, 92.0135090703,  92.8073922902,
      80.0560260771,  80.7414058957,  67.8815362812,  68.4584126984};
  const std::array<int, 4> in_shape = {{1, 8, 9, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x8x9x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.0204081633, 0.0408163265, 0.0816326531, 0.1224489796, 0.1836734694,
      0.2448979592, 0.1836734694, 0.2448979592, 0.1836734694, 0.2448979592,
      0.1836734694, 0.2448979592, 0.1836734694, 0.2448979592, 0.1632653061,
      0.2040816327, 0.1020408163, 0.1224489796, 0.1632653061, 0.2040816327,
      0.4081632653, 0.4897959184, 0.7346938776, 0.8571428571, 0.7346938776,
      0.8571428571, 0.7346938776, 0.8571428571, 0.7346938776, 0.8571428571,
      0.7346938776, 0.8571428571, 0.5714285714, 0.6530612245, 0.3265306122,
      0.3673469388, 0.1632653061, 0.2040816327, 0.4081632653, 0.4897959184,
      0.7346938776, 0.8571428571, 0.7346938776, 0.8571428571, 0.7346938776,
      0.8571428571, 0.7346938776, 0.8571428571, 0.7346938776, 0.8571428571,
      0.5714285714, 0.6530612245, 0.3265306122, 0.3673469388, 0.1632653061,
      0.2040816327, 0.4081632653, 0.4897959184, 0.7346938776, 0.8571428571,
      0.7346938776, 0.8571428571, 0.7346938776, 0.8571428571, 0.7346938776,
      0.8571428571, 0.7346938776, 0.8571428571, 0.5714285714, 0.6530612245,
      0.3265306122, 0.3673469388, 0.1632653061, 0.2040816327, 0.4081632653,
      0.4897959184, 0.7346938776, 0.8571428571, 0.7346938776, 0.8571428571,
      0.7346938776, 0.8571428571, 0.7346938776, 0.8571428571, 0.7346938776,
      0.8571428571, 0.5714285714, 0.6530612245, 0.3265306122, 0.3673469388,
      0.1632653061, 0.2040816327, 0.4081632653, 0.4897959184, 0.7346938776,
      0.8571428571, 0.7346938776, 0.8571428571, 0.7346938776, 0.8571428571,
      0.7346938776, 0.8571428571, 0.7346938776, 0.8571428571, 0.5714285714,
      0.6530612245, 0.3265306122, 0.3673469388, 0.1632653061, 0.2040816327,
      0.4081632653, 0.4897959184, 0.7346938776, 0.8571428571, 0.7346938776,
      0.8571428571, 0.7346938776, 0.8571428571, 0.7346938776, 0.8571428571,
      0.7346938776, 0.8571428571, 0.5714285714, 0.6530612245, 0.3265306122,
      0.3673469388, 0.1428571429, 0.1632653061, 0.3265306122, 0.3673469388,
      0.5510204082, 0.612244898,  0.5510204082, 0.612244898,  0.5510204082,
      0.612244898,  0.5510204082, 0.612244898,  0.5510204082, 0.612244898,
      0.4081632653, 0.4489795918, 0.2244897959, 0.2448979592};
  const std::array<int, 4> in_shape = {{1, 8, 9, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x8x9x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      29.8004591837,  30.3773356009,  30.9542120181,  31.5310884354,
      36.5919557823,  37.2773356009,  37.9627154195,  38.6480952381,
      43.8174659864,  44.6113492063,  45.4052324263,  46.1991156463,
      52.7535770975,  53.674047619,   54.5945181406,  55.5149886621,
      55.2375056689,  56.12,          57.0024943311,  57.8849886621,
      62.4754818594,  63.395952381,   64.3164229025,  65.236893424,
      55.5647675737,  56.3586507937,  57.1525340136,  57.9464172336,
      49.2072845805,  49.8926643991,  50.5780442177,  51.2634240363,
      42.4157879819,  42.9926643991,  43.5695408163,  44.1464172336,
      46.0831122449,  46.7684920635,  47.4538718821,  48.1392517007,
      56.1603231293,  56.9746145125,  57.7889058957,  58.6031972789,
      66.7531802721,  67.69638322,    68.6395861678,  69.5827891156,
      79.713100907,   80.8067006803,  81.9003004535,  82.9939002268,
      81.9613151927,  83.0097959184,  84.058276644,   85.1067573696,
      91.2635770975,  92.3571768707,  93.450776644,   94.5443764172,
      80.7100056689,  81.6532086168,  82.5964115646,  83.5396145125,
      71.1484410431,  71.9627324263,  72.7770238095,  73.5913151927,
      61.0712301587,  61.7566099773,  62.4419897959,  63.1273696145,
      69.6366836735,  70.4486507937,  71.2606179138,  72.072585034,
      84.4043707483,  85.3690589569,  86.3337471655,  87.2984353741,
      99.7829421769,  100.9003514739, 102.017760771,  103.135170068,
      118.4373072562, 119.7328911565, 121.0284750567, 122.3240589569,
      120.110521542,  121.3526530612, 122.5947845805, 123.8369160998,
      132.12111678,   133.4167006803, 134.7122845805, 136.0078684807,
      116.3175453515, 117.4349546485, 118.5523639456, 119.6697732426,
      102.1607426304, 103.125430839,  104.0901190476, 105.0548072562,
      87.3930555556,  88.2050226757,  89.0169897959,  89.8289569161,
      103.3695408163, 104.3334126984, 105.2972845805, 106.2611564626,
      124.7943707483, 125.9395351474, 127.0846995465, 128.2298639456,
      146.9443707483, 148.2708276644, 149.5972845805, 150.9237414966,
      173.632069161,  175.1700340136, 176.7079988662, 178.2459637188,
      174.2552834467, 175.7297959184, 177.20430839,   178.6788208617,
      189.8758786848, 191.4138435374, 192.95180839,   194.4897732426,
      166.5723072562, 167.8987641723, 169.2252210884, 170.5516780045,
      145.8726473923, 147.0178117914, 148.1629761905, 149.3081405896,
      124.4478174603, 125.4116893424, 126.3755612245, 127.3394331066,
      151.2195408163, 152.1834126984, 153.1472845805, 154.1111564626,
      181.6443707483, 182.7895351474, 183.9346995465, 185.0798639456,
      212.7943707483, 214.1208276644, 215.4472845805, 216.7737414966,
      249.982069161,  251.5200340136, 253.0579988662, 254.5959637188,
      247.4552834467, 248.9297959184, 250.40430839,   251.8788208617,
      266.2258786848, 267.7638435374, 269.30180839,   270.8397732426,
      232.4223072562, 233.7487641723, 235.0752210884, 236.4016780045,
      202.7226473923, 203.8678117914, 205.0129761905, 206.1581405896,
      172.2978174603, 173.2616893424, 174.2255612245, 175.1894331066,
      144.8295408163, 145.6415079365, 146.4534750567, 147.2654421769,
      173.740085034,  174.7047732426, 175.6694614512, 176.6341496599,
      203.2615136054, 204.3789229025, 205.4963321995, 206.6137414966,
      238.4158786848, 239.711462585,  241.0070464853, 242.3026303855,
      235.1390929705, 236.3812244898, 237.6233560091, 238.8654875283,
      252.0996882086, 253.3952721088, 254.6908560091, 255.9864399093,
      219.79611678,   220.9135260771, 222.0309353741, 223.1483446712,
      191.4964569161, 192.4611451247, 193.4258333333, 194.390521542,
      162.5859126984, 163.3978798186, 164.2098469388, 165.021814059,
      134.9473979592, 135.6327777778, 136.3181575964, 137.003537415,
      161.7388945578, 162.553185941,  163.3674773243, 164.1817687075,
      189.046037415,  189.9892403628, 190.9324433107, 191.8756462585,
      221.5059580499, 222.5995578231, 223.6931575964, 224.7867573696,
      217.9041723356, 218.9526530612, 220.0011337868, 221.0496145125,
      233.0564342404, 234.1500340136, 235.2436337868, 236.3372335601,
      203.0028628118, 203.9460657596, 204.8892687075, 205.8324716553,
      176.7270124717, 177.5413038549, 178.3555952381, 179.1698866213,
      149.935515873,  150.6208956916, 151.3062755102, 151.9916553288,
      122.5708673469, 123.1477437642, 123.7246201814, 124.3014965986,
      146.8113435374, 147.496723356,  148.1821031746, 148.8674829932,
      171.4858333333, 172.2797165533, 173.0735997732, 173.8674829932,
      200.7790873016, 201.6995578231, 202.6200283447, 203.5404988662,
      197.1558730159, 198.0383673469, 198.920861678,  199.8033560091,
      210.5009920635, 211.421462585,  212.3419331066, 213.2624036281,
      183.2331349206, 184.0270181406, 184.8209013605, 185.6147845805,
      159.4266723356, 160.1120521542, 160.7974319728, 161.4828117914,
      135.1861961451, 135.7630725624, 136.3399489796, 136.9168253968};
  const std::array<int, 4> in_shape = {{1, 8, 9, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x8x9x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.0204081633, 0.0408163265, 0.0612244898, 0.0816326531, 0.1224489796,
      0.1632653061, 0.2040816327, 0.2448979592, 0.306122449,  0.3673469388,
      0.4285714286, 0.4897959184, 0.306122449,  0.3673469388, 0.4285714286,
      0.4897959184, 0.306122449,  0.3673469388, 0.4285714286, 0.4897959184,
      0.306122449,  0.3673469388, 0.4285714286, 0.4897959184, 0.306122449,
      0.3673469388, 0.4285714286, 0.4897959184, 0.2857142857, 0.3265306122,
      0.3673469388, 0.4081632653, 0.1836734694, 0.2040816327, 0.2244897959,
      0.2448979592, 0.2857142857, 0.3265306122, 0.3673469388, 0.4081632653,
      0.7346938776, 0.8163265306, 0.8979591837, 0.9795918367, 1.3469387755,
      1.4693877551, 1.5918367347, 1.7142857143, 1.3469387755, 1.4693877551,
      1.5918367347, 1.7142857143, 1.3469387755, 1.4693877551, 1.5918367347,
      1.7142857143, 1.3469387755, 1.4693877551, 1.5918367347, 1.7142857143,
      1.3469387755, 1.4693877551, 1.5918367347, 1.7142857143, 1.0612244898,
      1.1428571429, 1.2244897959, 1.306122449,  0.612244898,  0.6530612245,
      0.693877551,  0.7346938776, 0.2857142857, 0.3265306122, 0.3673469388,
      0.4081632653, 0.7346938776, 0.8163265306, 0.8979591837, 0.9795918367,
      1.3469387755, 1.4693877551, 1.5918367347, 1.7142857143, 1.3469387755,
      1.4693877551, 1.5918367347, 1.7142857143, 1.3469387755, 1.4693877551,
      1.5918367347, 1.7142857143, 1.3469387755, 1.4693877551, 1.5918367347,
      1.7142857143, 1.3469387755, 1.4693877551, 1.5918367347, 1.7142857143,
      1.0612244898, 1.1428571429, 1.2244897959, 1.306122449,  0.612244898,
      0.6530612245, 0.693877551,  0.7346938776, 0.2857142857, 0.3265306122,
      0.3673469388, 0.4081632653, 0.7346938776, 0.8163265306, 0.8979591837,
      0.9795918367, 1.3469387755, 1.4693877551, 1.5918367347, 1.7142857143,
      1.3469387755, 1.4693877551, 1.5918367347, 1.7142857143, 1.3469387755,
      1.4693877551, 1.5918367347, 1.7142857143, 1.3469387755, 1.4693877551,
      1.5918367347, 1.7142857143, 1.3469387755, 1.4693877551, 1.5918367347,
      1.7142857143, 1.0612244898, 1.1428571429, 1.2244897959, 1.306122449,
      0.612244898,  0.6530612245, 0.693877551,  0.7346938776, 0.2857142857,
      0.3265306122, 0.3673469388, 0.4081632653, 0.7346938776, 0.8163265306,
      0.8979591837, 0.9795918367, 1.3469387755, 1.4693877551, 1.5918367347,
      1.7142857143, 1.3469387755, 1.4693877551, 1.5918367347, 1.7142857143,
      1.3469387755, 1.4693877551, 1.5918367347, 1.7142857143, 1.3469387755,
      1.4693877551, 1.5918367347, 1.7142857143, 1.3469387755, 1.4693877551,
      1.5918367347, 1.7142857143, 1.0612244898, 1.1428571429, 1.2244897959,
      1.306122449,  0.612244898,  0.6530612245, 0.693877551,  0.7346938776,
      0.2857142857, 0.3265306122, 0.3673469388, 0.4081632653, 0.7346938776,
      0.8163265306, 0.8979591837, 0.9795918367, 1.3469387755, 1.4693877551,
      1.5918367347, 1.7142857143, 1.3469387755, 1.4693877551, 1.5918367347,
      1.7142857143, 1.3469387755, 1.4693877551, 1.5918367347, 1.7142857143,
      1.3469387755, 1.4693877551, 1.5918367347, 1.7142857143, 1.3469387755,
      1.4693877551, 1.5918367347, 1.7142857143, 1.0612244898, 1.1428571429,
      1.2244897959, 1.306122449,  0.612244898,  0.6530612245, 0.693877551,
      0.7346938776, 0.2857142857, 0.3265306122, 0.3673469388, 0.4081632653,
      0.7346938776, 0.8163265306, 0.8979591837, 0.9795918367, 1.3469387755,
      1.4693877551, 1.5918367347, 1.7142857143, 1.3469387755, 1.4693877551,
      1.5918367347, 1.7142857143, 1.3469387755, 1.4693877551, 1.5918367347,
      1.7142857143, 1.3469387755, 1.4693877551, 1.5918367347, 1.7142857143,
      1.3469387755, 1.4693877551, 1.5918367347, 1.7142857143, 1.0612244898,
      1.1428571429, 1.2244897959, 1.306122449,  0.612244898,  0.6530612245,
      0.693877551,  0.7346938776, 0.2653061224, 0.2857142857, 0.306122449,
      0.3265306122, 0.612244898,  0.6530612245, 0.693877551,  0.7346938776,
      1.0408163265, 1.1020408163, 1.1632653061, 1.2244897959, 1.0408163265,
      1.1020408163, 1.1632653061, 1.2244897959, 1.0408163265, 1.1020408163,
      1.1632653061, 1.2244897959, 1.0408163265, 1.1020408163, 1.1632653061,
      1.2244897959, 1.0408163265, 1.1020408163, 1.1632653061, 1.2244897959,
      0.7755102041, 0.8163265306, 0.8571428571, 0.8979591837, 0.4285714286,
      0.4489795918, 0.4693877551, 0.4897959184};
  const std::array<int, 4> in_shape = {{1, 8, 9, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x8x10x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      8.613361678,   10.5300283447, 12.5551984127, 14.6888718821,
      14.7101020408, 15.7734353741, 18.0940702948, 16.2859070295,
      14.3692403628, 12.3440702948, 13.1994160998, 16.0344501134,
      18.9983956916, 22.0912528345, 21.7910544218, 23.0543877551,
      26.1369274376, 23.4308049887, 20.5957709751, 17.6318253968,
      19.815685941,  23.9602437642, 28.2575226757, 32.7075226757,
      31.8934353741, 33.3901020408, 37.5004195011, 33.5085827664,
      29.3640249433, 25.0667460317, 29.2742573696, 35.2759580499,
      41.4589512472, 47.8232369615, 46.2258163265, 48.0024829932,
      53.5128004535, 47.6923922902, 41.69069161,   35.5076984127,
      42.5659240363, 51.0676247166, 59.7506179138, 68.6149036281,
      65.5591496599, 67.3358163265, 74.3044671202, 65.9840589569,
      57.4823582766, 48.7993650794, 40.7025907029, 48.7757199546,
      57.0015702948, 65.3801417234, 62.2743877551, 63.7710544218,
      70.1730385488, 62.2526303855, 54.1795011338, 45.9536507937,
      37.8839399093, 45.3618310658, 52.9686337868, 60.7043480726,
      57.6958163265, 58.9591496599, 64.7500226757, 57.4010430839,
      49.9231519274, 42.3163492063, 34.3829195011, 41.1465249433,
      48.0186337868, 54.9992460317, 52.1930952381, 53.2564285714,
      58.4044444444, 51.7493424036, 44.9857369615, 38.1136281179};
  const std::array<int, 4> in_shape = {{1, 8, 10, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x8x10x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.0204081633, 0.0612244898, 0.1224489796, 0.2040816327, 0.2040816327,
      0.2040816327, 0.2040816327, 0.1836734694, 0.1428571429, 0.0816326531,
      0.1224489796, 0.2857142857, 0.4897959184, 0.7346938776, 0.7346938776,
      0.7346938776, 0.7346938776, 0.612244898,  0.4489795918, 0.2448979592,
      0.1224489796, 0.2857142857, 0.4897959184, 0.7346938776, 0.7346938776,
      0.7346938776, 0.7346938776, 0.612244898,  0.4489795918, 0.2448979592,
      0.1224489796, 0.2857142857, 0.4897959184, 0.7346938776, 0.7346938776,
      0.7346938776, 0.7346938776, 0.612244898,  0.4489795918, 0.2448979592,
      0.1224489796, 0.2857142857, 0.4897959184, 0.7346938776, 0.7346938776,
      0.7346938776, 0.7346938776, 0.612244898,  0.4489795918, 0.2448979592,
      0.1224489796, 0.2857142857, 0.4897959184, 0.7346938776, 0.7346938776,
      0.7346938776, 0.7346938776, 0.612244898,  0.4489795918, 0.2448979592,
      0.1224489796, 0.2857142857, 0.4897959184, 0.7346938776, 0.7346938776,
      0.7346938776, 0.7346938776, 0.612244898,  0.4489795918, 0.2448979592,
      0.1020408163, 0.2244897959, 0.3673469388, 0.5306122449, 0.5306122449,
      0.5306122449, 0.5306122449, 0.4285714286, 0.306122449,  0.1632653061};
  const std::array<int, 4> in_shape = {{1, 8, 10, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x8x10x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      16.6498469388,  17.226723356,   20.3746768707,  21.0600566893,
      24.3165136054,  25.1103968254,  28.4753571429,  29.3777437642,
      28.5811111111,  29.4202040816,  30.7077777778,  31.5468707483,
      35.2857539683,  36.1881405896,  31.777930839,   32.571814059,
      28.053100907,   28.7384807256,  24.1112641723,  24.6881405896,
      25.713452381,   26.3988321995,  31.2546088435,  32.0689002268,
      37.0535884354,  37.9967913832,  43.1103911565,  44.1825056689,
      42.5851927438,  43.5821088435,  45.1118594104,  46.1087755102,
      51.2017403628,  52.2738548753,  45.9184070295,  46.8616099773,
      40.3772505669,  41.1915419501,  34.5782709751,  35.2636507937,
      38.8194047619,  39.6313718821,  46.9557993197,  47.9204875283,
      55.3976360544,  56.5150453515,  64.144914966,   65.4150453515,
      62.6058276644,  63.7868707483,  65.5991609977,  66.7802040816,
      73.7307086168,  75.0008390023,  65.8997562358,  67.0171655329,
      57.763361678,   58.7280498866,  49.3215249433,  50.1334920635,
      57.5846428571,  58.5485147392,  69.4067517007,  70.5519160998,
      81.5914455782,  82.9179024943,  94.1387244898,  95.6464739229,
      91.0496371882,  92.4516326531,  94.6029705215,  96.0049659864,
      105.5178514739, 107.025600907,  94.0583276644,  95.3847845805,
      82.2362188209,  83.38138322,    70.0515249433,  71.0153968254,
      84.1679761905,  85.1318480726,  100.990085034,  102.1352494331,
      118.1747789116, 119.5012358277, 135.7220578231, 137.2298072562,
      129.7163038549, 131.1182993197, 133.2696371882, 134.6716326531,
      147.1011848073, 148.6089342404, 130.6416609977, 131.9681179138,
      113.8195521542, 114.9647165533, 96.6348582766,  97.5987301587,
      80.5932142857,  81.4051814059,  96.5867517007,  97.5514399093,
      112.8857312925, 114.0031405896, 129.4901530612, 130.7602834467,
      123.3677324263, 124.5487755102, 126.3610657596, 127.5421088435,
      139.075946712,  140.3460770975, 123.3878514739, 124.505260771,
      107.394314059,  108.3590022676, 91.0953344671,  91.9073015873,
      75.0825,        75.7678798186,  89.9093707483,  90.7236621315,
      104.9940646259, 105.9372675737, 120.3365816327, 121.4086961451,
      114.3947165533, 115.3916326531, 116.92138322,   117.9182993197,
      128.427930839,  129.5000453515, 113.85888322,   114.8020861678,
      99.0320124717,  99.8463038549,  83.9473185941,  84.6326984127,
      68.188962585,   68.7658390023,  81.607670068,   82.2930498866,
      95.2433843537,  96.0372675737,  109.0961054422, 109.9984920635,
      103.5470975057, 104.3861904762, 105.6737641723, 106.5128571429,
      115.9065022676, 116.8088888889, 102.7048015873, 103.4986848073,
      89.2860941043,  89.9714739229,  75.6503798186,  76.2272562358};
  const std::array<int, 4> in_shape = {{1, 8, 10, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x8x10x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.0204081633, 0.0408163265, 0.0816326531, 0.1224489796, 0.1836734694,
      0.2448979592, 0.3265306122, 0.4081632653, 0.3265306122, 0.4081632653,
      0.3265306122, 0.4081632653, 0.3265306122, 0.4081632653, 0.306122449,
      0.3673469388, 0.2448979592, 0.2857142857, 0.1428571429, 0.1632653061,
      0.2040816327, 0.2448979592, 0.4897959184, 0.5714285714, 0.8571428571,
      0.9795918367, 1.306122449,  1.4693877551, 1.306122449,  1.4693877551,
      1.306122449,  1.4693877551, 1.306122449,  1.4693877551, 1.1020408163,
      1.2244897959, 0.8163265306, 0.8979591837, 0.4489795918, 0.4897959184,
      0.2040816327, 0.2448979592, 0.4897959184, 0.5714285714, 0.8571428571,
      0.9795918367, 1.306122449,  1.4693877551, 1.306122449,  1.4693877551,
      1.306122449,  1.4693877551, 1.306122449,  1.4693877551, 1.1020408163,
      1.2244897959, 0.8163265306, 0.8979591837, 0.4489795918, 0.4897959184,
      0.2040816327, 0.2448979592, 0.4897959184, 0.5714285714, 0.8571428571,
      0.9795918367, 1.306122449,  1.4693877551, 1.306122449,  1.4693877551,
      1.306122449,  1.4693877551, 1.306122449,  1.4693877551, 1.1020408163,
      1.2244897959, 0.8163265306, 0.8979591837, 0.4489795918, 0.4897959184,
      0.2040816327, 0.2448979592, 0.4897959184, 0.5714285714, 0.8571428571,
      0.9795918367, 1.306122449,  1.4693877551, 1.306122449,  1.4693877551,
      1.306122449,  1.4693877551, 1.306122449,  1.4693877551, 1.1020408163,
      1.2244897959, 0.8163265306, 0.8979591837, 0.4489795918, 0.4897959184,
      0.2040816327, 0.2448979592, 0.4897959184, 0.5714285714, 0.8571428571,
      0.9795918367, 1.306122449,  1.4693877551, 1.306122449,  1.4693877551,
      1.306122449,  1.4693877551, 1.306122449,  1.4693877551, 1.1020408163,
      1.2244897959, 0.8163265306, 0.8979591837, 0.4489795918, 0.4897959184,
      0.2040816327, 0.2448979592, 0.4897959184, 0.5714285714, 0.8571428571,
      0.9795918367, 1.306122449,  1.4693877551, 1.306122449,  1.4693877551,
      1.306122449,  1.4693877551, 1.306122449,  1.4693877551, 1.1020408163,
      1.2244897959, 0.8163265306, 0.8979591837, 0.4489795918, 0.4897959184,
      0.1836734694, 0.2040816327, 0.4081632653, 0.4489795918, 0.6734693878,
      0.7346938776, 0.9795918367, 1.0612244898, 0.9795918367, 1.0612244898,
      0.9795918367, 1.0612244898, 0.9795918367, 1.0612244898, 0.7959183673,
      0.8571428571, 0.5714285714, 0.612244898,  0.306122449,  0.3265306122};
  const std::array<int, 4> in_shape = {{1, 8, 10, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x8x10x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      32.7228174603,  33.2996938776,  33.8765702948,  34.453446712,
      40.0639739229,  40.7493537415,  41.4347335601,  42.1201133787,
      47.8391439909,  48.6330272109,  49.4269104308,  50.2207936508,
      56.0483276644,  56.9507142857,  57.853100907,   58.7554875283,
      56.3231292517,  57.1622222222,  58.0013151927,  58.8404081633,
      60.576462585,   61.4155555556,  62.2546485261,  63.0937414966,
      69.6691213152,  70.5715079365,  71.4738945578,  72.3762811791,
      62.761978458,   63.555861678,   64.349744898,   65.1436281179,
      55.4208219955,  56.1062018141,  56.7915816327,  57.4769614512,
      47.6456519274,  48.2225283447,  48.7994047619,  49.3762811791,
      50.7415249433,  51.4269047619,  52.1122845805,  52.7976643991,
      61.6949263039,  62.5092176871,  63.3235090703,  64.1378004535,
      73.1639739229,  74.1071768707,  75.0503798186,  75.9935827664,
      85.1486678005,  86.2207823129,  87.2928968254,  88.3650113379,
      84.1734693878,  85.1703854875,  86.1673015873,  87.1642176871,
      89.2268027211,  90.2237188209,  91.2206349206,  92.2175510204,
      101.3313662132, 102.4034807256, 103.4755952381, 104.5477097506,
      90.8936111111,  91.836814059,   92.7800170068,  93.7232199546,
      79.9402097506,  80.7545011338,  81.568792517,   82.3830839002,
      68.4711621315,  69.1565419501,  69.8419217687,  70.5273015873,
      76.8268424036,  77.6388095238,  78.450776644,   79.2627437642,
      92.9469104308,  93.9115986395,  94.8762868481,  95.8409750567,
      109.6778628118, 110.7952721088, 111.9126814059, 113.0300907029,
      127.0196995465, 128.289829932,  129.5599603175, 130.8300907029,
      124.0306122449, 125.2116553288, 126.3926984127, 127.5737414966,
      130.0172789116, 131.1983219955, 132.3793650794, 133.5604081633,
      146.1912868481, 147.4614172336, 148.731547619,  150.0016780045,
      130.6821031746, 131.7995124717, 132.9169217687, 134.0343310658,
      114.5620351474, 115.526723356,  116.4914115646, 117.4560997732,
      97.8310827664,  98.6430498866,  99.4550170068,  100.266984127,
      114.2054138322, 115.1692857143, 116.1331575964, 117.0970294785,
      137.6683390023, 138.8135034014, 139.9586678005, 141.1038321995,
      161.8564342404, 163.1828911565, 164.5093480726, 165.8358049887,
      186.7696995465, 188.2774489796, 189.7851984127, 191.2929478458,
      180.6972789116, 182.0992743764, 183.5012698413, 184.9032653061,
      187.8039455782, 189.2059410431, 190.6079365079, 192.0099319728,
      209.5279535147, 211.0357029478, 212.543452381,  214.0512018141,
      186.7901984127, 188.1166553288, 189.4431122449, 190.769569161,
      163.3272732426, 164.4724376417, 165.6176020408, 166.7627664399,
      139.1391780045, 140.1030498866, 141.0669217687, 142.0307936508,
      167.3720804989, 168.335952381,  169.299824263,  170.2636961451,
      200.8350056689, 201.980170068,  203.1253344671, 204.2704988662,
      235.023100907,  236.3495578231, 237.6760147392, 239.0024716553,
      269.9363662132, 271.4441156463, 272.9518650794, 274.4596145125,
      258.0306122449, 259.4326077098, 260.8346031746, 262.2365986395,
      265.1372789116, 266.5392743764, 267.9412698413, 269.3432653061,
      292.6946201814, 294.2023696145, 295.7101190476, 297.2178684807,
      259.9568650794, 261.2833219955, 262.6097789116, 263.9362358277,
      226.4939399093, 227.6391043084, 228.7842687075, 229.9294331066,
      192.3058446712, 193.2697165533, 194.2335884354, 195.1974603175,
      160.3744614512, 161.1864285714, 161.9983956916, 162.8103628118,
      192.2088151927, 193.1735034014, 194.13819161,   195.1028798186,
      224.654053288,  225.771462585,  226.8888718821, 228.0062811791,
      257.710175737,  258.9803061224, 260.2504365079, 261.5205668934,
      245.5544217687, 246.7354648526, 247.9165079365, 249.0975510204,
      251.5410884354, 252.7221315193, 253.9031746032, 255.0842176871,
      276.8817630385, 278.151893424,  279.4220238095, 280.692154195,
      245.6582936508, 246.7757029478, 247.8931122449, 249.010521542,
      213.8239399093, 214.7886281179, 215.7533163265, 216.7180045351,
      181.3787018141, 182.1906689342, 183.0026360544, 183.8146031746,
      149.4796201814, 150.165,        150.8503798186, 151.5357596372,
      179.0044501134, 179.8187414966, 180.6330328798, 181.447324263,
      209.0449263039, 209.9881292517, 210.9313321995, 211.8745351474,
      239.6010487528, 240.6731632653, 241.7452777778, 242.8173922902,
      227.7925170068, 228.7894331066, 229.7863492063, 230.7832653061,
      232.8458503401, 233.8427664399, 234.8396825397, 235.8365986395,
      255.7837471655, 256.855861678,  257.9279761905, 259.0000907029,
      226.7745634921, 227.7177664399, 228.6609693878, 229.6041723356,
      197.2497335601, 198.0640249433, 198.8783163265, 199.6926077098,
      167.2092573696, 167.8946371882, 168.5800170068, 169.2653968254,
      135.8010487528, 136.3779251701, 136.9548015873, 137.5316780045,
      162.5299603175, 163.2153401361, 163.9007199546, 164.5860997732,
      189.6928854875, 190.4867687075, 191.2806519274, 192.0745351474,
      217.289824263,  218.1922108844, 219.0945975057, 219.996984127,
      206.2551020408, 207.0941950113, 207.9332879819, 208.7723809524,
      210.5084353741, 211.3475283447, 212.1866213152, 213.0257142857,
      230.9106179138, 231.8130045351, 232.7153911565, 233.6177777778,
      204.6157199546, 205.4096031746, 206.2034863946, 206.9973696145,
      177.88680839,   178.5721882086, 179.2575680272, 179.9429478458,
      150.72388322,   151.3007596372, 151.8776360544, 152.4545124717};
  const std::array<int, 4> in_shape = {{1, 8, 10, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x8x10x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.0204081633, 0.0408163265, 0.0612244898, 0.0816326531, 0.1224489796,
      0.1632653061, 0.2040816327, 0.2448979592, 0.306122449,  0.3673469388,
      0.4285714286, 0.4897959184, 0.5714285714, 0.6530612245, 0.7346938776,
      0.8163265306, 0.5714285714, 0.6530612245, 0.7346938776, 0.8163265306,
      0.5714285714, 0.6530612245, 0.7346938776, 0.8163265306, 0.5714285714,
      0.6530612245, 0.7346938776, 0.8163265306, 0.5510204082, 0.612244898,
      0.6734693878, 0.7346938776, 0.4489795918, 0.4897959184, 0.5306122449,
      0.5714285714, 0.2653061224, 0.2857142857, 0.306122449,  0.3265306122,
      0.3673469388, 0.4081632653, 0.4489795918, 0.4897959184, 0.8979591837,
      0.9795918367, 1.0612244898, 1.1428571429, 1.5918367347, 1.7142857143,
      1.8367346939, 1.9591836735, 2.4489795918, 2.612244898,  2.7755102041,
      2.9387755102, 2.4489795918, 2.612244898,  2.7755102041, 2.9387755102,
      2.4489795918, 2.612244898,  2.7755102041, 2.9387755102, 2.4489795918,
      2.612244898,  2.7755102041, 2.9387755102, 2.0816326531, 2.2040816327,
      2.3265306122, 2.4489795918, 1.5510204082, 1.6326530612, 1.7142857143,
      1.7959183673, 0.8571428571, 0.8979591837, 0.9387755102, 0.9795918367,
      0.3673469388, 0.4081632653, 0.4489795918, 0.4897959184, 0.8979591837,
      0.9795918367, 1.0612244898, 1.1428571429, 1.5918367347, 1.7142857143,
      1.8367346939, 1.9591836735, 2.4489795918, 2.612244898,  2.7755102041,
      2.9387755102, 2.4489795918, 2.612244898,  2.7755102041, 2.9387755102,
      2.4489795918, 2.612244898,  2.7755102041, 2.9387755102, 2.4489795918,
      2.612244898,  2.7755102041, 2.9387755102, 2.0816326531, 2.2040816327,
      2.3265306122, 2.4489795918, 1.5510204082, 1.6326530612, 1.7142857143,
      1.7959183673, 0.8571428571, 0.8979591837, 0.9387755102, 0.9795918367,
      0.3673469388, 0.4081632653, 0.4489795918, 0.4897959184, 0.8979591837,
      0.9795918367, 1.0612244898, 1.1428571429, 1.5918367347, 1.7142857143,
      1.8367346939, 1.9591836735, 2.4489795918, 2.612244898,  2.7755102041,
      2.9387755102, 2.4489795918, 2.612244898,  2.7755102041, 2.9387755102,
      2.4489795918, 2.612244898,  2.7755102041, 2.9387755102, 2.4489795918,
      2.612244898,  2.7755102041, 2.9387755102, 2.0816326531, 2.2040816327,
      2.3265306122, 2.4489795918, 1.5510204082, 1.6326530612, 1.7142857143,
      1.7959183673, 0.8571428571, 0.8979591837, 0.9387755102, 0.9795918367,
      0.3673469388, 0.4081632653, 0.4489795918, 0.4897959184, 0.8979591837,
      0.9795918367, 1.0612244898, 1.1428571429, 1.5918367347, 1.7142857143,
      1.8367346939, 1.9591836735, 2.4489795918, 2.612244898,  2.7755102041,
      2.9387755102, 2.4489795918, 2.612244898,  2.7755102041, 2.9387755102,
      2.4489795918, 2.612244898,  2.7755102041, 2.9387755102, 2.4489795918,
      2.612244898,  2.7755102041, 2.9387755102, 2.0816326531, 2.2040816327,
      2.3265306122, 2.4489795918, 1.5510204082, 1.6326530612, 1.7142857143,
      1.7959183673, 0.8571428571, 0.8979591837, 0.9387755102, 0.9795918367,
      0.3673469388, 0.4081632653, 0.4489795918, 0.4897959184, 0.8979591837,
      0.9795918367, 1.0612244898, 1.1428571429, 1.5918367347, 1.7142857143,
      1.8367346939, 1.9591836735, 2.4489795918, 2.612244898,  2.7755102041,
      2.9387755102, 2.4489795918, 2.612244898,  2.7755102041, 2.9387755102,
      2.4489795918, 2.612244898,  2.7755102041, 2.9387755102, 2.4489795918,
      2.612244898,  2.7755102041, 2.9387755102, 2.0816326531, 2.2040816327,
      2.3265306122, 2.4489795918, 1.5510204082, 1.6326530612, 1.7142857143,
      1.7959183673, 0.8571428571, 0.8979591837, 0.9387755102, 0.9795918367,
      0.3673469388, 0.4081632653, 0.4489795918, 0.4897959184, 0.8979591837,
      0.9795918367, 1.0612244898, 1.1428571429, 1.5918367347, 1.7142857143,
      1.8367346939, 1.9591836735, 2.4489795918, 2.612244898,  2.7755102041,
      2.9387755102, 2.4489795918, 2.612244898,  2.7755102041, 2.9387755102,
      2.4489795918, 2.612244898,  2.7755102041, 2.9387755102, 2.4489795918,
      2.612244898,  2.7755102041, 2.9387755102, 2.0816326531, 2.2040816327,
      2.3265306122, 2.4489795918, 1.5510204082, 1.6326530612, 1.7142857143,
      1.7959183673, 0.8571428571, 0.8979591837, 0.9387755102, 0.9795918367,
      0.3469387755, 0.3673469388, 0.387755102,  0.4081632653, 0.7755102041,
      0.8163265306, 0.8571428571, 0.8979591837, 1.2857142857, 1.3469387755,
      1.4081632653, 1.4693877551, 1.8775510204, 1.9591836735, 2.0408163265,
      2.1224489796, 1.8775510204, 1.9591836735, 2.0408163265, 2.1224489796,
      1.8775510204, 1.9591836735, 2.0408163265, 2.1224489796, 1.8775510204,
      1.9591836735, 2.0408163265, 2.1224489796, 1.5306122449, 1.5918367347,
      1.6530612245, 1.7142857143, 1.1020408163, 1.1428571429, 1.1836734694,
      1.2244897959, 0.5918367347, 0.612244898,  0.6326530612, 0.6530612245};
  const std::array<int, 4> in_shape = {{1, 8, 10, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x9x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      7.1521825397,  8.7940192744,  10.8360827664, 13.4384637188, 14.7676303855,
      12.9247732426, 11.2624716553, 9.729138322,   10.8702097506, 13.2671485261,
      16.2139739229, 19.9306405896, 21.5098072562, 18.695521542,  16.1998866213,
      13.9318594104, 15.4562641723, 18.7715702948, 22.8136337868, 27.8731575964,
      29.702324263,  25.6880385488, 22.1685941043, 19.0026077098, 21.8193594104,
      26.3965702948, 31.9386337868, 38.8314909297, 40.952324263,  35.2713718821,
      30.335260771,  25.9311791383, 30.2399546485, 36.3814512472, 43.7401814059,
      52.8030385488, 54.8363718821, 46.9354195011, 40.1576417234, 34.1821315193,
      41.2631689342, 49.4975226757, 59.3062528345, 71.3191099773, 73.4399433107,
      62.6389909297, 53.4362131519, 45.3749886621, 38.9508673469, 46.6852210884,
      55.8828401361, 67.1290306122, 68.9581972789, 58.757244898,  50.082244898,
      42.4972108844, 36.1008673469, 43.2433843537, 51.7267176871, 62.0871938776,
      63.6663605442, 54.2082653061, 46.176122449,  39.1625170068, 32.3828401361,
      38.770255102,  46.3488265306, 55.5950170068, 56.9241836735, 48.4375170068,
      41.238707483,  34.9597959184};
  const std::array<int, 4> in_shape = {{1, 9, 8, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x9x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.0204081633, 0.0612244898, 0.0612244898, 0.0612244898, 0.0612244898,
      0.0612244898, 0.0612244898, 0.0408163265, 0.0816326531, 0.2040816327,
      0.2040816327, 0.2040816327, 0.2040816327, 0.2040816327, 0.2040816327,
      0.1224489796, 0.1836734694, 0.4285714286, 0.4285714286, 0.4285714286,
      0.4285714286, 0.4285714286, 0.4285714286, 0.2448979592, 0.1836734694,
      0.4285714286, 0.4285714286, 0.4285714286, 0.4285714286, 0.4285714286,
      0.4285714286, 0.2448979592, 0.1836734694, 0.4285714286, 0.4285714286,
      0.4285714286, 0.4285714286, 0.4285714286, 0.4285714286, 0.2448979592,
      0.1836734694, 0.4285714286, 0.4285714286, 0.4285714286, 0.4285714286,
      0.4285714286, 0.4285714286, 0.2448979592, 0.1836734694, 0.4285714286,
      0.4285714286, 0.4285714286, 0.4285714286, 0.4285714286, 0.4285714286,
      0.2448979592, 0.1632653061, 0.3673469388, 0.3673469388, 0.3673469388,
      0.3673469388, 0.3673469388, 0.3673469388, 0.2040816327, 0.1020408163,
      0.2244897959, 0.2244897959, 0.2244897959, 0.2244897959, 0.2244897959,
      0.2244897959, 0.1224489796};
  const std::array<int, 4> in_shape = {{1, 9, 8, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x9x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      13.7274886621,  14.3043650794,  16.9026587302,  17.5880385488,
      20.8601984127,  21.6721655329,  25.9130555556,  26.8769274376,
      28.5713888889,  29.535260771,   25.0375793651,  25.8495464853,
      21.8395634921,  22.5249433107,  18.8814002268,  19.458276644,
      21.0550396825,  21.7404195011,  25.7200056689,  26.5342970522,
      31.4632596372,  32.4279478458,  38.71611678,    39.8612811791,
      41.8744501134,  43.0196145125,  36.4263548753,  37.3910430839,
      31.5854818594,  32.3997732426,  27.1783390023,  27.8637188209,
      30.1186451247,  30.9125283447,  36.5999376417,  37.5431405896,
      44.5098582766,  45.6272675737,  54.4198582766,  55.7463151927,
      58.07819161,    59.4046485261,  50.2586678005,  51.3760770975,
      43.3939852608,  44.3371882086,  37.2113321995,  38.0052154195,
      42.7182482993,  43.6387188209,  51.6995408163,  52.7931405896,
      62.5816836735,  63.8772675737,  76.1250170068,  77.6629818594,
      80.3666836735,  81.9046485261,  69.2471598639,  70.5427437642,
      59.5769217687,  60.670521542,   50.9418877551,  51.8623582766,
      59.597414966,   60.4799092971,  71.7144217687,  72.7629024943,
      86.2382312925,  87.4803628118,  104.1315646259, 105.6060770975,
      108.1982312925, 109.6727437642, 92.628707483,   93.8708390023,
      79.2668027211,  80.3152834467,  67.4817687075,  68.3642630385,
      81.6058673469,  82.5263378685,  97.9014455782,  98.9950453515,
      117.3169217687, 118.6125056689, 141.100255102,  142.6382199546,
      145.3419217687, 146.8798866213, 123.9823979592, 125.2779818594,
      105.7788265306, 106.8724263039, 89.8295068027,  90.7499773243,
      77.1078514739,  77.9017346939,  92.427239229,   93.3704421769,
      110.6482709751, 111.7656802721, 132.9316043084, 134.2580612245,
      136.5899376417, 137.9163945578, 116.3970804989, 117.5144897959,
      99.2212868481,  100.1644897959, 84.2005385488,  84.9944217687,
      71.5163548753,  72.2017346939,  85.6724773243,  86.4867687075,
      102.4887471655, 103.4534353741, 123.029223356,  124.1743877551,
      126.1875566893, 127.3327210884, 107.4518424036, 108.4165306122,
      91.5379535147,  92.352244898,   77.639654195,   78.3250340136,
      64.1888038549,  64.7656802721,  76.8551303855,  77.5405102041,
      91.885685941,   92.6976530612,  110.2261621315, 111.1900340136,
      112.8844954649, 113.8483673469, 96.0630668934,  96.8750340136,
      81.7920351474,  82.477414966,   69.3427154195,  69.9195918367};
  const std::array<int, 4> in_shape = {{1, 9, 8, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x9x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.0204081633, 0.0408163265, 0.0816326531, 0.1224489796, 0.0816326531,
      0.1224489796, 0.0816326531, 0.1224489796, 0.0816326531, 0.1224489796,
      0.0816326531, 0.1224489796, 0.0816326531, 0.1224489796, 0.0612244898,
      0.0816326531, 0.1224489796, 0.1632653061, 0.3265306122, 0.4081632653,
      0.3265306122, 0.4081632653, 0.3265306122, 0.4081632653, 0.3265306122,
      0.4081632653, 0.3265306122, 0.4081632653, 0.3265306122, 0.4081632653,
      0.2040816327, 0.2448979592, 0.306122449,  0.3673469388, 0.7346938776,
      0.8571428571, 0.7346938776, 0.8571428571, 0.7346938776, 0.8571428571,
      0.7346938776, 0.8571428571, 0.7346938776, 0.8571428571, 0.7346938776,
      0.8571428571, 0.4285714286, 0.4897959184, 0.306122449,  0.3673469388,
      0.7346938776, 0.8571428571, 0.7346938776, 0.8571428571, 0.7346938776,
      0.8571428571, 0.7346938776, 0.8571428571, 0.7346938776, 0.8571428571,
      0.7346938776, 0.8571428571, 0.4285714286, 0.4897959184, 0.306122449,
      0.3673469388, 0.7346938776, 0.8571428571, 0.7346938776, 0.8571428571,
      0.7346938776, 0.8571428571, 0.7346938776, 0.8571428571, 0.7346938776,
      0.8571428571, 0.7346938776, 0.8571428571, 0.4285714286, 0.4897959184,
      0.306122449,  0.3673469388, 0.7346938776, 0.8571428571, 0.7346938776,
      0.8571428571, 0.7346938776, 0.8571428571, 0.7346938776, 0.8571428571,
      0.7346938776, 0.8571428571, 0.7346938776, 0.8571428571, 0.4285714286,
      0.4897959184, 0.306122449,  0.3673469388, 0.7346938776, 0.8571428571,
      0.7346938776, 0.8571428571, 0.7346938776, 0.8571428571, 0.7346938776,
      0.8571428571, 0.7346938776, 0.8571428571, 0.7346938776, 0.8571428571,
      0.4285714286, 0.4897959184, 0.2857142857, 0.3265306122, 0.6530612245,
      0.7346938776, 0.6530612245, 0.7346938776, 0.6530612245, 0.7346938776,
      0.6530612245, 0.7346938776, 0.6530612245, 0.7346938776, 0.6530612245,
      0.7346938776, 0.3673469388, 0.4081632653, 0.1836734694, 0.2040816327,
      0.4081632653, 0.4489795918, 0.4081632653, 0.4489795918, 0.4081632653,
      0.4489795918, 0.4081632653, 0.4489795918, 0.4081632653, 0.4489795918,
      0.4081632653, 0.4489795918, 0.2244897959, 0.2448979592};
  const std::array<int, 4> in_shape = {{1, 9, 8, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x9x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      26.878100907,   27.4549773243,  28.0318537415,  28.6087301587,
      33.1199376417,  33.8053174603,  34.4906972789,  35.1760770975,
      40.9084297052,  41.7203968254,  42.5323639456,  43.3443310658,
      50.862239229,   51.8261111111,  52.7899829932,  53.7538548753,
      56.1789058957,  57.1427777778,  58.1066496599,  59.070521542,
      49.26319161,    50.0751587302,  50.8871258503,  51.6990929705,
      42.9937471655,  43.6791269841,  44.3645068027,  45.0498866213,
      37.1859240363,  37.7628004535,  38.3396768707,  38.916553288,
      41.4246995465,  42.1100793651,  42.7954591837,  43.4808390023,
      50.6257199546,  51.4400113379,  52.2543027211,  53.0685941043,
      61.9618310658,  62.9265192744,  63.891207483,   64.8558956916,
      76.287069161,   77.4322335601,  78.5773979592,  79.7225623583,
      82.6037358277,  83.7489002268,  84.8940646259,  86.0392290249,
      71.888021542,   72.8527097506,  73.8173979592,  74.7820861678,
      62.3566723356,  63.1709637188,  63.985255102,   64.7995464853,
      53.6712981859,  54.3566780045,  55.0420578231,  55.7274376417,
      59.4434070295,  60.2372902494,  61.0311734694,  61.8250566893,
      72.2566723356,  73.1998752834,  74.1430782313,  75.0862811791,
      87.9023072562,  89.0197165533,  90.1371258503,  91.2545351474,
      107.5132596372, 108.8397165533, 110.1661734694, 111.4926303855,
      114.8299263039, 116.15638322,   117.4828401361, 118.8092970522,
      99.3999263039,  100.5173356009, 101.634744898,  102.752154195,
      85.8447675737,  86.7879705215,  87.7311734694,  88.6743764172,
      73.6287811791,  74.4226643991,  75.216547619,   76.010430839,
      84.5160260771,  85.4364965986,  86.3569671202,  87.2774376417,
      102.3054818594, 103.3990816327, 104.4926814059, 105.5862811791,
      123.8677834467, 125.1633673469, 126.4589512472, 127.7545351474,
      150.712069161,  152.2500340136, 153.7879988662, 155.3259637188,
      159.1954024943, 160.7333673469, 162.2713321995, 163.8092970522,
      137.1987358277, 138.4943197279, 139.7899036281, 141.0854875283,
      118.0602437642, 119.1538435374, 120.2474433107, 121.3410430839,
      100.9633049887, 101.8837755102, 102.8042460317, 103.7247165533,
      118.3123356009, 119.194829932,  120.077324263,  120.9598185941,
      142.3803628118, 143.4288435374, 144.477324263,  145.5258049887,
      171.2343310658, 172.476462585,  173.7185941043, 174.9607256236,
      206.78861678,   208.2631292517, 209.7376417234, 211.212154195,
      214.9219501134, 216.396462585,  217.8709750567, 219.3454875283,
      184.0152834467, 185.257414966,  186.4995464853, 187.7416780045,
      157.4851247166, 158.5336054422, 159.5820861678, 160.6305668934,
      134.0810430839, 134.963537415,  135.846031746,  136.7285260771,
      162.2912641723, 163.2117346939, 164.1322052154, 165.052675737,
      194.7092913832, 195.8028911565, 196.8964909297, 197.9900907029,
      233.3382596372, 234.6338435374, 235.9294274376, 237.2250113379,
      280.6625453515, 282.2005102041, 283.7384750567, 285.2764399093,
      289.1458786848, 290.6838435374, 292.22180839,   293.7597732426,
      246.6692120181, 247.9647959184, 249.2603798186, 250.5559637188,
      210.464053288,  211.5576530612, 212.6512528345, 213.7448526077,
      178.7385430839, 179.6590136054, 180.579484127,  181.4999546485,
      153.4218197279, 154.2157029478, 155.0095861678, 155.8034693878,
      183.9112755102, 184.854478458,  185.7976814059, 186.7408843537,
      220.1791326531, 221.2965419501, 222.4139512472, 223.5313605442,
      264.5367517007, 265.8632086168, 267.1896655329, 268.516122449,
      271.8534183673, 273.1798752834, 274.5063321995, 275.8327891156,
      231.6767517007, 232.7941609977, 233.9115702948, 235.0289795918,
      197.4993707483, 198.4425736961, 199.385776644,  200.3289795918,
      167.6071938776, 168.4010770975, 169.1949603175, 169.9888435374,
      142.347329932,  143.0327097506, 143.7180895692, 144.4034693878,
      170.5306632653, 171.3449546485, 172.1592460317, 172.973537415,
      204.0128061224, 204.9774943311, 205.9421825397, 206.9068707483,
      244.9132823129, 246.058446712,  247.2036111111, 248.3487755102,
      251.2299489796, 252.3751133787, 253.5202777778, 254.6654421769,
      213.9389965986, 214.9036848073, 215.8683730159, 216.8330612245,
      182.2616156463, 183.0759070295, 183.8901984127, 184.7044897959,
      154.5939285714, 155.27930839,   155.9646882086, 156.6500680272,
      127.8007312925, 128.3776077098, 128.954484127,  129.5313605442,
      153.0248809524, 153.710260771,  154.3956405896, 155.0810204082,
      182.9594047619, 183.7713718821, 184.5833390023, 185.3953061224,
      219.488452381,  220.452324263,  221.4161961451, 222.3800680272,
      224.8051190476, 225.7689909297, 226.7328628118, 227.6967346939,
      191.3141666667, 192.1261337868, 192.938100907,  193.7500680272,
      162.8986904762, 163.5840702948, 164.2694501134, 164.954829932,
      138.1085544218, 138.685430839,  139.2623072562, 139.8391836735};
  const std::array<int, 4> in_shape = {{1, 9, 8, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x9x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.0204081633, 0.0408163265, 0.0612244898, 0.0816326531, 0.1224489796,
      0.1632653061, 0.2040816327, 0.2448979592, 0.1224489796, 0.1632653061,
      0.2040816327, 0.2448979592, 0.1224489796, 0.1632653061, 0.2040816327,
      0.2448979592, 0.1224489796, 0.1632653061, 0.2040816327, 0.2448979592,
      0.1224489796, 0.1632653061, 0.2040816327, 0.2448979592, 0.1224489796,
      0.1632653061, 0.2040816327, 0.2448979592, 0.1020408163, 0.1224489796,
      0.1428571429, 0.1632653061, 0.2040816327, 0.2448979592, 0.2857142857,
      0.3265306122, 0.5714285714, 0.6530612245, 0.7346938776, 0.8163265306,
      0.5714285714, 0.6530612245, 0.7346938776, 0.8163265306, 0.5714285714,
      0.6530612245, 0.7346938776, 0.8163265306, 0.5714285714, 0.6530612245,
      0.7346938776, 0.8163265306, 0.5714285714, 0.6530612245, 0.7346938776,
      0.8163265306, 0.5714285714, 0.6530612245, 0.7346938776, 0.8163265306,
      0.3673469388, 0.4081632653, 0.4489795918, 0.4897959184, 0.5510204082,
      0.612244898,  0.6734693878, 0.7346938776, 1.3469387755, 1.4693877551,
      1.5918367347, 1.7142857143, 1.3469387755, 1.4693877551, 1.5918367347,
      1.7142857143, 1.3469387755, 1.4693877551, 1.5918367347, 1.7142857143,
      1.3469387755, 1.4693877551, 1.5918367347, 1.7142857143, 1.3469387755,
      1.4693877551, 1.5918367347, 1.7142857143, 1.3469387755, 1.4693877551,
      1.5918367347, 1.7142857143, 0.7959183673, 0.8571428571, 0.9183673469,
      0.9795918367, 0.5510204082, 0.612244898,  0.6734693878, 0.7346938776,
      1.3469387755, 1.4693877551, 1.5918367347, 1.7142857143, 1.3469387755,
      1.4693877551, 1.5918367347, 1.7142857143, 1.3469387755, 1.4693877551,
      1.5918367347, 1.7142857143, 1.3469387755, 1.4693877551, 1.5918367347,
      1.7142857143, 1.3469387755, 1.4693877551, 1.5918367347, 1.7142857143,
      1.3469387755, 1.4693877551, 1.5918367347, 1.7142857143, 0.7959183673,
      0.8571428571, 0.9183673469, 0.9795918367, 0.5510204082, 0.612244898,
      0.6734693878, 0.7346938776, 1.3469387755, 1.4693877551, 1.5918367347,
      1.7142857143, 1.3469387755, 1.4693877551, 1.5918367347, 1.7142857143,
      1.3469387755, 1.4693877551, 1.5918367347, 1.7142857143, 1.3469387755,
      1.4693877551, 1.5918367347, 1.7142857143, 1.3469387755, 1.4693877551,
      1.5918367347, 1.7142857143, 1.3469387755, 1.4693877551, 1.5918367347,
      1.7142857143, 0.7959183673, 0.8571428571, 0.9183673469, 0.9795918367,
      0.5510204082, 0.612244898,  0.6734693878, 0.7346938776, 1.3469387755,
      1.4693877551, 1.5918367347, 1.7142857143, 1.3469387755, 1.4693877551,
      1.5918367347, 1.7142857143, 1.3469387755, 1.4693877551, 1.5918367347,
      1.7142857143, 1.3469387755, 1.4693877551, 1.5918367347, 1.7142857143,
      1.3469387755, 1.4693877551, 1.5918367347, 1.7142857143, 1.3469387755,
      1.4693877551, 1.5918367347, 1.7142857143, 0.7959183673, 0.8571428571,
      0.9183673469, 0.9795918367, 0.5510204082, 0.612244898,  0.6734693878,
      0.7346938776, 1.3469387755, 1.4693877551, 1.5918367347, 1.7142857143,
      1.3469387755, 1.4693877551, 1.5918367347, 1.7142857143, 1.3469387755,
      1.4693877551, 1.5918367347, 1.7142857143, 1.3469387755, 1.4693877551,
      1.5918367347, 1.7142857143, 1.3469387755, 1.4693877551, 1.5918367347,
      1.7142857143, 1.3469387755, 1.4693877551, 1.5918367347, 1.7142857143,
      0.7959183673, 0.8571428571, 0.9183673469, 0.9795918367, 0.5306122449,
      0.5714285714, 0.612244898,  0.6530612245, 1.2244897959, 1.306122449,
      1.387755102,  1.4693877551, 1.2244897959, 1.306122449,  1.387755102,
      1.4693877551, 1.2244897959, 1.306122449,  1.387755102,  1.4693877551,
      1.2244897959, 1.306122449,  1.387755102,  1.4693877551, 1.2244897959,
      1.306122449,  1.387755102,  1.4693877551, 1.2244897959, 1.306122449,
      1.387755102,  1.4693877551, 0.693877551,  0.7346938776, 0.7755102041,
      0.8163265306, 0.3469387755, 0.3673469388, 0.387755102,  0.4081632653,
      0.7755102041, 0.8163265306, 0.8571428571, 0.8979591837, 0.7755102041,
      0.8163265306, 0.8571428571, 0.8979591837, 0.7755102041, 0.8163265306,
      0.8571428571, 0.8979591837, 0.7755102041, 0.8163265306, 0.8571428571,
      0.8979591837, 0.7755102041, 0.8163265306, 0.8571428571, 0.8979591837,
      0.7755102041, 0.8163265306, 0.8571428571, 0.8979591837, 0.4285714286,
      0.4489795918, 0.4693877551, 0.4897959184};
  const std::array<int, 4> in_shape = {{1, 9, 8, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x9x9x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      7.8827721088,  9.6620238095,  11.5497789116, 13.8787471655, 14.4712471655,
      16.309223356,  14.4866043084, 12.8158560091, 11.0366043084, 12.0348129252,
      14.6507993197, 17.3956972789, 20.7484750567, 21.2766893424, 23.6360941043,
      20.8849036281, 18.3978287982, 15.7818424036, 17.1633843537, 20.7997789116,
      24.5854931973, 29.1763662132, 29.5760090703, 32.5211281179, 28.6270804989,
      25.1400056689, 21.5036111111, 24.2860034014, 29.3271598639, 34.5414455782,
      40.8267630385, 41.0014058957, 44.7048582766, 39.2274773243, 34.3594501134,
      29.3182936508, 33.7699319728, 40.5753741497, 47.5468027211, 55.8737868481,
      55.3509297052, 59.5918820862, 52.0395011338, 45.4000453515, 38.5946031746,
      46.1602891156, 55.3157312925, 64.6443027211, 75.7296201814, 74.4642630385,
      79.6077154195, 69.3303344671, 60.348021542,  51.1925793651, 43.5948129252,
      52.2026360544, 60.9597789116, 71.3506519274, 70.0102947846, 74.6954138322,
      65.0013662132, 56.5428628118, 47.9350396825, 40.4193027211, 48.3740646259,
      56.4577380952, 66.0390873016, 64.6987301587, 68.9267063492, 59.9469444444,
      52.1210941043, 44.1663321995, 36.2672619048, 43.3852891156, 50.6118197279,
      59.1693594104, 57.8932879819, 61.5998356009, 53.5486451247, 46.5391213152,
      39.4210941043};
  const std::array<int, 4> in_shape = {{1, 9, 9, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x9x9x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.0204081633, 0.0612244898, 0.1224489796, 0.1224489796, 0.1224489796,
      0.1224489796, 0.1224489796, 0.1020408163, 0.0612244898, 0.1020408163,
      0.2448979592, 0.4285714286, 0.4285714286, 0.4285714286, 0.4285714286,
      0.4285714286, 0.3265306122, 0.1836734694, 0.2448979592, 0.5510204082,
      0.9183673469, 0.9183673469, 0.9183673469, 0.9183673469, 0.9183673469,
      0.6734693878, 0.3673469388, 0.2448979592, 0.5510204082, 0.9183673469,
      0.9183673469, 0.9183673469, 0.9183673469, 0.9183673469, 0.6734693878,
      0.3673469388, 0.2448979592, 0.5510204082, 0.9183673469, 0.9183673469,
      0.9183673469, 0.9183673469, 0.9183673469, 0.6734693878, 0.3673469388,
      0.2448979592, 0.5510204082, 0.9183673469, 0.9183673469, 0.9183673469,
      0.9183673469, 0.9183673469, 0.6734693878, 0.3673469388, 0.2448979592,
      0.5510204082, 0.9183673469, 0.9183673469, 0.9183673469, 0.9183673469,
      0.9183673469, 0.6734693878, 0.3673469388, 0.2244897959, 0.4897959184,
      0.7959183673, 0.7959183673, 0.7959183673, 0.7959183673, 0.7959183673,
      0.5714285714, 0.306122449,  0.1428571429, 0.306122449,  0.4897959184,
      0.4897959184, 0.4897959184, 0.4897959184, 0.4897959184, 0.3469387755,
      0.1836734694};
  const std::array<int, 4> in_shape = {{1, 9, 9, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x9x9x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      15.1886678005,  15.7655442177,  18.6386678005,  19.324047619,
      22.3056746032,  23.0995578231,  26.8370238095,  27.7574943311,
      28.06,          28.9424943311,  31.6979761905,  32.618446712,
      28.1793253968,  28.9732086168,  24.9463321995,  25.6317120181,
      21.4963321995,  22.0732086168,  23.3842460317,  24.0696258503,
      28.4873072562,  29.3015986395,  33.84819161,    34.7913945578,
      40.4033503401,  41.4969501134,  41.5048979592,  42.5533786848,
      46.1785884354,  47.2721882086,  40.8266043084,  41.7698072562,
      35.9813662132,  36.7956575964,  30.8783049887,  31.5636848073,
      33.5328854875,  34.3267687075,  40.6563548753,  41.5995578231,
      48.0784637188,  49.1709863946,  57.0860034014,  58.3527324263,
      57.9375510204,  59.1520181406,  63.7755272109,  65.0422562358,
      56.161638322,   57.2541609977,  49.33680839,    50.2800113379,
      42.2133390023,  43.0072222222,  47.6515362812,  48.5720068027,
      57.5607199546,  58.6543197279,  67.8161621315,  69.0828911565,
      80.1848129252,  81.6535260771,  80.5946938776,  82.0028117914,
      87.9410034014,  89.4097165533,  77.1882256236,  78.4549546485,
      67.6253004535,  68.7189002268,  57.71611678,    58.6365873016,
      66.6573696145,  67.5398639456,  80.1022675737,  81.1507482993,
      93.879138322,   95.0936054422,  110.3394557823, 111.7475736961,
      109.3518367347, 110.7018594104, 117.7756462585, 119.1837641723,
      102.8645351474, 104.0790022676, 89.7516099773,  90.8000907029,
      76.3067120181,  77.1892063492,  91.4001077098,  92.3205782313,
      109.5378628118, 110.631462585,  128.0218764172, 129.2886054422,
      149.9905272109, 151.4592403628, 147.5204081633, 148.9285260771,
      157.7467176871, 159.215430839,  137.3939399093, 138.6606689342,
      119.6024433107, 120.6960430839, 101.4646882086, 102.3851587302,
      86.3957426304,  87.1896258503,  103.462069161,  104.4052721088,
      120.8270351474, 121.9195578231, 141.4345748299, 142.7013038549,
      138.806122449,  140.0205895692, 148.1240986395, 149.3908276644,
      128.9102097506, 130.0027324263, 112.1425226757, 113.0857256236,
      95.0761961451,  95.8700793651,  80.1532256236,  80.8386054422,
      95.9338378685,  96.7481292517,  111.9722732426, 112.9154761905,
      130.9845748299, 132.0781746032, 128.3489795918, 129.3974603175,
      136.7598129252, 137.8534126984, 118.950685941,  119.8938888889,
      103.4278968254, 104.2421882086, 87.6472845805,  88.3326643991,
      71.9576473923,  72.5345238095,  86.0851984127,  86.7705782313,
      100.4297562358, 101.2236394558, 117.4182482993, 118.3387188209,
      114.9040816327, 115.7865759637, 122.2792006803, 123.1996712018,
      106.3034070295, 107.0972902494, 92.3928628118,  93.0782426304,
      78.2653117914,  78.8421882086};
  const std::array<int, 4> in_shape = {{1, 9, 9, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x9x9x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.0204081633, 0.0408163265, 0.0816326531, 0.1224489796, 0.1836734694,
      0.2448979592, 0.1836734694, 0.2448979592, 0.1836734694, 0.2448979592,
      0.1836734694, 0.2448979592, 0.1836734694, 0.2448979592, 0.1632653061,
      0.2040816327, 0.1020408163, 0.1224489796, 0.1632653061, 0.2040816327,
      0.4081632653, 0.4897959184, 0.7346938776, 0.8571428571, 0.7346938776,
      0.8571428571, 0.7346938776, 0.8571428571, 0.7346938776, 0.8571428571,
      0.7346938776, 0.8571428571, 0.5714285714, 0.6530612245, 0.3265306122,
      0.3673469388, 0.4285714286, 0.4897959184, 0.9795918367, 1.1020408163,
      1.6530612245, 1.8367346939, 1.6530612245, 1.8367346939, 1.6530612245,
      1.8367346939, 1.6530612245, 1.8367346939, 1.6530612245, 1.8367346939,
      1.2244897959, 1.3469387755, 0.6734693878, 0.7346938776, 0.4285714286,
      0.4897959184, 0.9795918367, 1.1020408163, 1.6530612245, 1.8367346939,
      1.6530612245, 1.8367346939, 1.6530612245, 1.8367346939, 1.6530612245,
      1.8367346939, 1.6530612245, 1.8367346939, 1.2244897959, 1.3469387755,
      0.6734693878, 0.7346938776, 0.4285714286, 0.4897959184, 0.9795918367,
      1.1020408163, 1.6530612245, 1.8367346939, 1.6530612245, 1.8367346939,
      1.6530612245, 1.8367346939, 1.6530612245, 1.8367346939, 1.6530612245,
      1.8367346939, 1.2244897959, 1.3469387755, 0.6734693878, 0.7346938776,
      0.4285714286, 0.4897959184, 0.9795918367, 1.1020408163, 1.6530612245,
      1.8367346939, 1.6530612245, 1.8367346939, 1.6530612245, 1.8367346939,
      1.6530612245, 1.8367346939, 1.6530612245, 1.8367346939, 1.2244897959,
      1.3469387755, 0.6734693878, 0.7346938776, 0.4285714286, 0.4897959184,
      0.9795918367, 1.1020408163, 1.6530612245, 1.8367346939, 1.6530612245,
      1.8367346939, 1.6530612245, 1.8367346939, 1.6530612245, 1.8367346939,
      1.6530612245, 1.8367346939, 1.2244897959, 1.3469387755, 0.6734693878,
      0.7346938776, 0.4081632653, 0.4489795918, 0.8979591837, 0.9795918367,
      1.4693877551, 1.5918367347, 1.4693877551, 1.5918367347, 1.4693877551,
      1.5918367347, 1.4693877551, 1.5918367347, 1.4693877551, 1.5918367347,
      1.0612244898, 1.1428571429, 0.5714285714, 0.612244898,  0.2653061224,
      0.2857142857, 0.5714285714, 0.612244898,  0.9183673469, 0.9795918367,
      0.9183673469, 0.9795918367, 0.9183673469, 0.9795918367, 0.9183673469,
      0.9795918367, 0.9183673469, 0.9795918367, 0.6530612245, 0.693877551,
      0.3469387755, 0.3673469388};
  const std::array<int, 4> in_shape = {{1, 9, 9, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x9x9x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      29.8004591837,  30.3773356009,  30.9542120181,  31.5310884354,
      36.5919557823,  37.2773356009,  37.9627154195,  38.6480952381,
      43.8174659864,  44.6113492063,  45.4052324263,  46.1991156463,
      52.7535770975,  53.674047619,   54.5945181406,  55.5149886621,
      55.2375056689,  56.12,          57.0024943311,  57.8849886621,
      62.4754818594,  63.395952381,   64.3164229025,  65.236893424,
      55.5647675737,  56.3586507937,  57.1525340136,  57.9464172336,
      49.2072845805,  49.8926643991,  50.5780442177,  51.2634240363,
      42.4157879819,  42.9926643991,  43.5695408163,  44.1464172336,
      46.0831122449,  46.7684920635,  47.4538718821,  48.1392517007,
      56.1603231293,  56.9746145125,  57.7889058957,  58.6031972789,
      66.7531802721,  67.69638322,    68.6395861678,  69.5827891156,
      79.713100907,   80.8067006803,  81.9003004535,  82.9939002268,
      81.9613151927,  83.0097959184,  84.058276644,   85.1067573696,
      91.2635770975,  92.3571768707,  93.450776644,   94.5443764172,
      80.7100056689,  81.6532086168,  82.5964115646,  83.5396145125,
      71.1484410431,  71.9627324263,  72.7770238095,  73.5913151927,
      61.0712301587,  61.7566099773,  62.4419897959,  63.1273696145,
      66.2718877551,  67.0657709751,  67.859654195,   68.653537415,
      80.3695068027,  81.3127097506,  82.2559126984,  83.1991156463,
      95.0644047619,  96.1569274376,  97.2494501134,  98.3419727891,
      112.9052777778, 114.1720068027, 115.4387358277, 116.7054648526,
      114.6606349206, 115.8751020408, 117.089569161,  118.3040362812,
      126.2843253968, 127.5510544218, 128.8177834467, 130.0845124717,
      111.2307539683, 112.323276644,  113.4157993197, 114.5083219955,
      97.7304138322,  98.67361678,    99.6168197279,  100.5600226757,
      83.6327947846,  84.4266780045,  85.2205612245,  86.0144444444,
      94.3826020408,  95.3030725624,  96.2235430839,  97.1440136054,
      114.0278401361, 115.1214399093, 116.2150396825, 117.3086394558,
      134.3655952381, 135.632324263,  136.899053288,  138.1657823129,
      158.9009126984, 160.3696258503, 161.8383390023, 163.3070521542,
      159.7812698413, 161.1893877551, 162.5975056689, 164.0056235828,
      174.4132936508, 175.8820068027, 177.3507199546, 178.8194331066,
      153.1097222222, 154.3764512472, 155.6431802721, 156.9099092971,
      134.1570011338, 135.250600907,  136.3442006803, 137.4378004535,
      114.5117630385, 115.4322335601, 116.3527040816, 117.2731746032,
      132.432244898,  133.314739229,  134.1972335601, 135.0797278912,
      159.1560544218, 160.2045351474, 161.253015873,  162.3014965986,
      186.5438095238, 187.758276644,  188.9727437642, 190.1872108844,
      219.2707936508, 220.6789115646, 222.0870294785, 223.4951473923,
      217.3536507937, 218.7036734694, 220.0536961451, 221.4037188209,
      234.1431746032, 235.551292517,  236.9594104308, 238.3675283447,
      204.5146031746, 205.7290702948, 206.943537415,  208.1580045351,
      178.454739229,  179.5032199546, 180.5517006803, 181.6001814059,
      151.7309297052, 152.6134240363, 153.4959183673, 154.3784126984,
      181.879744898,  182.8002154195, 183.720685941,  184.6411564626,
      217.9821258503, 219.0757256236, 220.1693253968, 221.2629251701,
      254.7770238095, 256.0437528345, 257.3104818594, 258.5772108844,
      298.5123412698, 299.9810544218, 301.4497675737, 302.9184807256,
      293.6326984127, 295.0408163265, 296.4489342404, 297.8570521542,
      314.0247222222, 315.4934353741, 316.9621485261, 318.430861678,
      273.5211507937, 274.7878798186, 276.0546088435, 277.3213378685,
      238.1112868481, 239.2048866213, 240.2984863946, 241.3920861678,
      202.0089058957, 202.9293764172, 203.8498469388, 204.7703174603,
      171.9976020408, 172.7914852608, 173.5853684807, 174.3792517007,
      205.9809353741, 206.924138322,  207.8673412698, 208.8105442177,
      240.561547619,  241.6540702948, 242.7465929705, 243.8391156463,
      281.6024206349, 282.8691496599, 284.1358786848, 285.4026077098,
      276.3977777778, 277.612244898,  278.8267120181, 280.0411791383,
      294.981468254,  296.2481972789, 297.5149263039, 298.7816553288,
      256.7278968254, 257.8204195011, 258.9129421769, 260.0054648526,
      223.3418424036, 224.2850453515, 225.2282482993, 226.1714512472,
      189.3585090703, 190.1523922902, 190.9462755102, 191.7401587302,
      159.6210714286, 160.3064512472, 160.9918310658, 161.6772108844,
      191.0533843537, 191.867675737,  192.6819671202, 193.4962585034,
      223.0013435374, 223.9445464853, 224.8877494331, 225.830952381,
      260.8755498866, 261.9691496599, 263.0627494331, 264.1563492063,
      255.649478458,  256.6979591837, 257.7464399093, 258.7949206349,
      272.4260260771, 273.5196258503, 274.6132256236, 275.7068253968,
      236.9581689342, 237.9013718821, 238.8445748299, 239.7877777778,
      206.0415022676, 206.8557936508, 207.670085034,  208.4843764172,
      174.6091893424, 175.294569161,  175.9799489796, 176.6653287982,
      143.3384183673, 143.9152947846, 144.4921712018, 145.069047619,
      171.4850170068, 172.1703968254, 172.855776644,  173.5411564626,
      200.0656292517, 200.8595124717, 201.6533956916, 202.4472789116,
      233.9160260771, 234.8364965986, 235.7569671202, 236.6774376417,
      228.9256689342, 229.8081632653, 230.6906575964, 231.5731519274,
      243.637930839,  244.5584013605, 245.4788718821, 246.3993424036,
      211.812930839,  212.606814059,  213.4006972789, 214.1945804989,
      184.100345805,  184.7857256236, 185.4711054422, 186.1564852608,
      155.9537471655, 156.5306235828, 157.1075,       157.6843764172};
  const std::array<int, 4> in_shape = {{1, 9, 9, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x9x9x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.0204081633, 0.0408163265, 0.0612244898, 0.0816326531, 0.1224489796,
      0.1632653061, 0.2040816327, 0.2448979592, 0.306122449,  0.3673469388,
      0.4285714286, 0.4897959184, 0.306122449,  0.3673469388, 0.4285714286,
      0.4897959184, 0.306122449,  0.3673469388, 0.4285714286, 0.4897959184,
      0.306122449,  0.3673469388, 0.4285714286, 0.4897959184, 0.306122449,
      0.3673469388, 0.4285714286, 0.4897959184, 0.2857142857, 0.3265306122,
      0.3673469388, 0.4081632653, 0.1836734694, 0.2040816327, 0.2244897959,
      0.2448979592, 0.2857142857, 0.3265306122, 0.3673469388, 0.4081632653,
      0.7346938776, 0.8163265306, 0.8979591837, 0.9795918367, 1.3469387755,
      1.4693877551, 1.5918367347, 1.7142857143, 1.3469387755, 1.4693877551,
      1.5918367347, 1.7142857143, 1.3469387755, 1.4693877551, 1.5918367347,
      1.7142857143, 1.3469387755, 1.4693877551, 1.5918367347, 1.7142857143,
      1.3469387755, 1.4693877551, 1.5918367347, 1.7142857143, 1.0612244898,
      1.1428571429, 1.2244897959, 1.306122449,  0.612244898,  0.6530612245,
      0.693877551,  0.7346938776, 0.7959183673, 0.8571428571, 0.9183673469,
      0.9795918367, 1.8367346939, 1.9591836735, 2.0816326531, 2.2040816327,
      3.1224489796, 3.306122449,  3.4897959184, 3.6734693878, 3.1224489796,
      3.306122449,  3.4897959184, 3.6734693878, 3.1224489796, 3.306122449,
      3.4897959184, 3.6734693878, 3.1224489796, 3.306122449,  3.4897959184,
      3.6734693878, 3.1224489796, 3.306122449,  3.4897959184, 3.6734693878,
      2.3265306122, 2.4489795918, 2.5714285714, 2.693877551,  1.2857142857,
      1.3469387755, 1.4081632653, 1.4693877551, 0.7959183673, 0.8571428571,
      0.9183673469, 0.9795918367, 1.8367346939, 1.9591836735, 2.0816326531,
      2.2040816327, 3.1224489796, 3.306122449,  3.4897959184, 3.6734693878,
      3.1224489796, 3.306122449,  3.4897959184, 3.6734693878, 3.1224489796,
      3.306122449,  3.4897959184, 3.6734693878, 3.1224489796, 3.306122449,
      3.4897959184, 3.6734693878, 3.1224489796, 3.306122449,  3.4897959184,
      3.6734693878, 2.3265306122, 2.4489795918, 2.5714285714, 2.693877551,
      1.2857142857, 1.3469387755, 1.4081632653, 1.4693877551, 0.7959183673,
      0.8571428571, 0.9183673469, 0.9795918367, 1.8367346939, 1.9591836735,
      2.0816326531, 2.2040816327, 3.1224489796, 3.306122449,  3.4897959184,
      3.6734693878, 3.1224489796, 3.306122449,  3.4897959184, 3.6734693878,
      3.1224489796, 3.306122449,  3.4897959184, 3.6734693878, 3.1224489796,
      3.306122449,  3.4897959184, 3.6734693878, 3.1224489796, 3.306122449,
      3.4897959184, 3.6734693878, 2.3265306122, 2.4489795918, 2.5714285714,
      2.693877551,  1.2857142857, 1.3469387755, 1.4081632653, 1.4693877551,
      0.7959183673, 0.8571428571, 0.9183673469, 0.9795918367, 1.8367346939,
      1.9591836735, 2.0816326531, 2.2040816327, 3.1224489796, 3.306122449,
      3.4897959184, 3.6734693878, 3.1224489796, 3.306122449,  3.4897959184,
      3.6734693878, 3.1224489796, 3.306122449,  3.4897959184, 3.6734693878,
      3.1224489796, 3.306122449,  3.4897959184, 3.6734693878, 3.1224489796,
      3.306122449,  3.4897959184, 3.6734693878, 2.3265306122, 2.4489795918,
      2.5714285714, 2.693877551,  1.2857142857, 1.3469387755, 1.4081632653,
      1.4693877551, 0.7959183673, 0.8571428571, 0.9183673469, 0.9795918367,
      1.8367346939, 1.9591836735, 2.0816326531, 2.2040816327, 3.1224489796,
      3.306122449,  3.4897959184, 3.6734693878, 3.1224489796, 3.306122449,
      3.4897959184, 3.6734693878, 3.1224489796, 3.306122449,  3.4897959184,
      3.6734693878, 3.1224489796, 3.306122449,  3.4897959184, 3.6734693878,
      3.1224489796, 3.306122449,  3.4897959184, 3.6734693878, 2.3265306122,
      2.4489795918, 2.5714285714, 2.693877551,  1.2857142857, 1.3469387755,
      1.4081632653, 1.4693877551, 0.7755102041, 0.8163265306, 0.8571428571,
      0.8979591837, 1.7142857143, 1.7959183673, 1.8775510204, 1.9591836735,
      2.8163265306, 2.9387755102, 3.0612244898, 3.1836734694, 2.8163265306,
      2.9387755102, 3.0612244898, 3.1836734694, 2.8163265306, 2.9387755102,
      3.0612244898, 3.1836734694, 2.8163265306, 2.9387755102, 3.0612244898,
      3.1836734694, 2.8163265306, 2.9387755102, 3.0612244898, 3.1836734694,
      2.0408163265, 2.1224489796, 2.2040816327, 2.2857142857, 1.1020408163,
      1.1428571429, 1.1836734694, 1.2244897959, 0.5102040816, 0.5306122449,
      0.5510204082, 0.5714285714, 1.1020408163, 1.1428571429, 1.1836734694,
      1.2244897959, 1.7755102041, 1.8367346939, 1.8979591837, 1.9591836735,
      1.7755102041, 1.8367346939, 1.8979591837, 1.9591836735, 1.7755102041,
      1.8367346939, 1.8979591837, 1.9591836735, 1.7755102041, 1.8367346939,
      1.8979591837, 1.9591836735, 1.7755102041, 1.8367346939, 1.8979591837,
      1.9591836735, 1.2653061224, 1.306122449,  1.3469387755, 1.387755102,
      0.6734693878, 0.693877551,  0.7142857143, 0.7346938776};
  const std::array<int, 4> in_shape = {{1, 9, 9, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x9x10x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      8.613361678,   10.5300283447, 12.5551984127, 14.6888718821,
      14.7101020408, 15.7734353741, 18.0940702948, 16.2859070295,
      14.3692403628, 12.3440702948, 13.1994160998, 16.0344501134,
      18.9983956916, 22.0912528345, 21.7910544218, 23.0543877551,
      26.1369274376, 23.4308049887, 20.5957709751, 17.6318253968,
      18.8705045351, 22.8279875283, 26.9347902494, 31.1909126984,
      30.4502380952, 31.9135714286, 35.8770634921, 32.0689002268,
      28.1114172336, 24.0046145125, 26.7526473923, 32.2577494331,
      37.9359807256, 43.7873412698, 42.3938888889, 44.0905555556,
      49.2207142857, 43.8887414966, 38.3836394558, 32.7054081633,
      37.2999092971, 44.7692970522, 52.4046712018, 60.206031746,
      57.5917460317, 59.2184126984, 65.4152380952, 58.1118367347,
      50.6424489796, 43.0070748299, 51.0574092971, 61.1339399093,
      71.3835997732, 81.8063888889, 77.7462698413, 79.4429365079,
      87.2397619048, 77.3363605442, 67.259829932,  57.010170068,
      48.2387585034, 57.7200510204, 67.3506632653, 77.1305952381,
      73.1676984127, 74.631031746,  81.8167460317, 72.4847732426,
      63.0034807256, 53.3728684807, 44.7377380952, 53.504744898,
      62.4006632653, 71.4254931973, 67.6649773243, 68.9283106576,
      75.4711678005, 66.8330725624, 58.0660657596, 49.1701473923,
      40.1516836735, 48.0003231293, 55.9574659864, 64.0231122449,
      60.5840249433, 61.6473582766, 67.4283106576, 59.6881746032,
      51.8395351474, 43.8823922902};
  const std::array<int, 4> in_shape = {{1, 9, 10, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x9x10x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.0204081633, 0.0612244898, 0.1224489796, 0.2040816327, 0.2040816327,
      0.2040816327, 0.2040816327, 0.1836734694, 0.1428571429, 0.0816326531,
      0.1224489796, 0.2857142857, 0.4897959184, 0.7346938776, 0.7346938776,
      0.7346938776, 0.7346938776, 0.612244898,  0.4489795918, 0.2448979592,
      0.306122449,  0.6734693878, 1.1020408163, 1.5918367347, 1.5918367347,
      1.5918367347, 1.5918367347, 1.2857142857, 0.9183673469, 0.4897959184,
      0.306122449,  0.6734693878, 1.1020408163, 1.5918367347, 1.5918367347,
      1.5918367347, 1.5918367347, 1.2857142857, 0.9183673469, 0.4897959184,
      0.306122449,  0.6734693878, 1.1020408163, 1.5918367347, 1.5918367347,
      1.5918367347, 1.5918367347, 1.2857142857, 0.9183673469, 0.4897959184,
      0.306122449,  0.6734693878, 1.1020408163, 1.5918367347, 1.5918367347,
      1.5918367347, 1.5918367347, 1.2857142857, 0.9183673469, 0.4897959184,
      0.306122449,  0.6734693878, 1.1020408163, 1.5918367347, 1.5918367347,
      1.5918367347, 1.5918367347, 1.2857142857, 0.9183673469, 0.4897959184,
      0.2857142857, 0.612244898,  0.9795918367, 1.387755102,  1.387755102,
      1.387755102,  1.387755102,  1.1020408163, 0.7755102041, 0.4081632653,
      0.1836734694, 0.387755102,  0.612244898,  0.8571428571, 0.8571428571,
      0.8571428571, 0.8571428571, 0.6734693878, 0.4693877551, 0.2448979592};
  const std::array<int, 4> in_shape = {{1, 9, 10, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x9x10x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      16.6498469388,  17.226723356,   20.3746768707,  21.0600566893,
      24.3165136054,  25.1103968254,  28.4753571429,  29.3777437642,
      28.5811111111,  29.4202040816,  30.7077777778,  31.5468707483,
      35.2857539683,  36.1881405896,  31.777930839,   32.571814059,
      28.053100907,   28.7384807256,  24.1112641723,  24.6881405896,
      25.713452381,   26.3988321995,  31.2546088435,  32.0689002268,
      37.0535884354,  37.9967913832,  43.1103911565,  44.1825056689,
      42.5851927438,  43.5821088435,  45.1118594104,  46.1087755102,
      51.2017403628,  52.2738548753,  45.9184070295,  46.8616099773,
      40.3772505669,  41.1915419501,  34.5782709751,  35.2636507937,
      36.9471258503,  37.7410090703,  44.7127721088,  45.6559750567,
      52.7770578231,  53.8695804989,  61.1399829932,  62.3818253968,
      59.7457369615,  60.9004761905,  62.6724036281,  63.8271428571,
      70.5122845805,  71.7541269841,  63.0452777778,  64.1378004535,
      55.2796315193,  56.2228344671,  47.215345805,   48.0092290249,
      52.584824263,   53.5052947846,  63.421899093,   64.5154988662,
      74.6052324263,  75.8719614512,  86.134824263,   87.5746825397,
      83.4489115646,  84.7877777778,  86.842244898,   88.1811111111,
      97.0015702948,  98.4414285714,  86.5107539683,  87.7774829932,
      75.6736791383,  76.7672789116,  64.490345805,   65.4108163265,
      73.717324263,   74.5998185941,  88.4901133787,  89.5385941043,
      103.5948752834, 104.8093424036, 119.0316099773, 120.4120634921,
      113.8998639456, 115.1834920635, 117.1531972789, 118.4368253968,
      129.4500226757, 130.8304761905, 115.0092063492, 116.2236734694,
      100.2364172336, 101.2848979592, 85.1316553288,  86.0141496599,
      101.1943480726, 102.1148185941, 121.1742800454, 122.2678798186,
      141.5004705215, 142.7671995465, 162.1729195011, 163.6127777778,
      154.1536734694, 155.4925396825, 157.5470068027, 158.8858730159,
      173.0396655329, 174.4795238095, 153.4059920635, 154.6727210884,
      133.4260600907, 134.5196598639, 113.0998696145, 114.0203401361,
      95.6836337868,  96.4775170068,  114.496899093,  115.4401020408,
      133.6088038549, 134.7013265306, 153.0193480726, 154.2611904762,
      145.1806575964, 146.3353968254, 148.107324263,  149.2620634921,
      162.3916496599, 163.6334920635, 143.8770238095, 144.9695464853,
      125.0637585034, 126.0069614512, 105.9518537415, 106.7457369615,
      88.7900963719,  89.4754761905,  106.1951984127, 107.0094897959,
      123.8581235828, 124.8013265306, 141.7788718821, 142.8509863946,
      134.3330385488, 135.3299546485, 136.8597052154, 137.8566213152,
      149.8702210884, 150.9423356009, 132.7229421769, 133.6661451247,
      115.3178401361, 116.1321315193, 97.654914966,   98.3402947846,
      79.7264909297,  80.3033673469,  95.3152664399,  96.0006462585,
      111.1210487528, 111.9149319728, 127.1438378685, 128.0462244898,
      120.3289569161, 121.1680498866, 122.4556235828, 123.2947165533,
      133.9542346939, 134.8566213152, 118.5824659864, 119.3763492063,
      102.9936904762, 103.6790702948, 87.1879081633,  87.7647845805};
  const std::array<int, 4> in_shape = {{1, 9, 10, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x9x10x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.0204081633, 0.0408163265, 0.0816326531, 0.1224489796, 0.1836734694,
      0.2448979592, 0.3265306122, 0.4081632653, 0.3265306122, 0.4081632653,
      0.3265306122, 0.4081632653, 0.3265306122, 0.4081632653, 0.306122449,
      0.3673469388, 0.2448979592, 0.2857142857, 0.1428571429, 0.1632653061,
      0.2040816327, 0.2448979592, 0.4897959184, 0.5714285714, 0.8571428571,
      0.9795918367, 1.306122449,  1.4693877551, 1.306122449,  1.4693877551,
      1.306122449,  1.4693877551, 1.306122449,  1.4693877551, 1.1020408163,
      1.2244897959, 0.8163265306, 0.8979591837, 0.4489795918, 0.4897959184,
      0.5510204082, 0.612244898,  1.2244897959, 1.3469387755, 2.0204081633,
      2.2040816327, 2.9387755102, 3.1836734694, 2.9387755102, 3.1836734694,
      2.9387755102, 3.1836734694, 2.9387755102, 3.1836734694, 2.387755102,
      2.5714285714, 1.7142857143, 1.8367346939, 0.9183673469, 0.9795918367,
      0.5510204082, 0.612244898,  1.2244897959, 1.3469387755, 2.0204081633,
      2.2040816327, 2.9387755102, 3.1836734694, 2.9387755102, 3.1836734694,
      2.9387755102, 3.1836734694, 2.9387755102, 3.1836734694, 2.387755102,
      2.5714285714, 1.7142857143, 1.8367346939, 0.9183673469, 0.9795918367,
      0.5510204082, 0.612244898,  1.2244897959, 1.3469387755, 2.0204081633,
      2.2040816327, 2.9387755102, 3.1836734694, 2.9387755102, 3.1836734694,
      2.9387755102, 3.1836734694, 2.9387755102, 3.1836734694, 2.387755102,
      2.5714285714, 1.7142857143, 1.8367346939, 0.9183673469, 0.9795918367,
      0.5510204082, 0.612244898,  1.2244897959, 1.3469387755, 2.0204081633,
      2.2040816327, 2.9387755102, 3.1836734694, 2.9387755102, 3.1836734694,
      2.9387755102, 3.1836734694, 2.9387755102, 3.1836734694, 2.387755102,
      2.5714285714, 1.7142857143, 1.8367346939, 0.9183673469, 0.9795918367,
      0.5510204082, 0.612244898,  1.2244897959, 1.3469387755, 2.0204081633,
      2.2040816327, 2.9387755102, 3.1836734694, 2.9387755102, 3.1836734694,
      2.9387755102, 3.1836734694, 2.9387755102, 3.1836734694, 2.387755102,
      2.5714285714, 1.7142857143, 1.8367346939, 0.9183673469, 0.9795918367,
      0.5306122449, 0.5714285714, 1.1428571429, 1.2244897959, 1.8367346939,
      1.9591836735, 2.612244898,  2.7755102041, 2.612244898,  2.7755102041,
      2.612244898,  2.7755102041, 2.612244898,  2.7755102041, 2.0816326531,
      2.2040816327, 1.4693877551, 1.5510204082, 0.7755102041, 0.8163265306,
      0.3469387755, 0.3673469388, 0.7346938776, 0.7755102041, 1.1632653061,
      1.2244897959, 1.6326530612, 1.7142857143, 1.6326530612, 1.7142857143,
      1.6326530612, 1.7142857143, 1.6326530612, 1.7142857143, 1.2857142857,
      1.3469387755, 0.8979591837, 0.9387755102, 0.4693877551, 0.4897959184};
  const std::array<int, 4> in_shape = {{1, 9, 10, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x9x10x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      32.7228174603,  33.2996938776,  33.8765702948,  34.453446712,
      40.0639739229,  40.7493537415,  41.4347335601,  42.1201133787,
      47.8391439909,  48.6330272109,  49.4269104308,  50.2207936508,
      56.0483276644,  56.9507142857,  57.853100907,   58.7554875283,
      56.3231292517,  57.1622222222,  58.0013151927,  58.8404081633,
      60.576462585,   61.4155555556,  62.2546485261,  63.0937414966,
      69.6691213152,  70.5715079365,  71.4738945578,  72.3762811791,
      62.761978458,   63.555861678,   64.349744898,   65.1436281179,
      55.4208219955,  56.1062018141,  56.7915816327,  57.4769614512,
      47.6456519274,  48.2225283447,  48.7994047619,  49.3762811791,
      50.7415249433,  51.4269047619,  52.1122845805,  52.7976643991,
      61.6949263039,  62.5092176871,  63.3235090703,  64.1378004535,
      73.1639739229,  74.1071768707,  75.0503798186,  75.9935827664,
      85.1486678005,  86.2207823129,  87.2928968254,  88.3650113379,
      84.1734693878,  85.1703854875,  86.1673015873,  87.1642176871,
      89.2268027211,  90.2237188209,  91.2206349206,  92.2175510204,
      101.3313662132, 102.4034807256, 103.4755952381, 104.5477097506,
      90.8936111111,  91.836814059,   92.7800170068,  93.7232199546,
      79.9402097506,  80.7545011338,  81.568792517,   82.3830839002,
      68.4711621315,  69.1565419501,  69.8419217687,  70.5273015873,
      73.1003684807,  73.8942517007,  74.6881349206,  75.4820181406,
      88.4823412698,  89.4255442177,  90.3687471655,  91.3119501134,
      104.4615929705, 105.5541156463, 106.646638322,  107.7391609977,
      121.0381235828, 122.2799659864, 123.52180839,   124.7636507937,
      118.3367346939, 119.4914739229, 120.6462131519, 121.800952381,
      124.1900680272, 125.3448072562, 126.4995464853, 127.6542857143,
      139.7827267574, 141.024569161,  142.2664115646, 143.5082539683,
      124.9980328798, 126.0905555556, 127.1830782313, 128.275600907,
      109.6160600907, 110.5592630385, 111.5024659864, 112.4456689342,
      93.63680839,    94.43069161,    95.2245748299,  96.0184580499,
      104.2491780045, 105.1696485261, 106.0901190476, 107.0105895692,
      125.7501984127, 126.8437981859, 127.9373979592, 129.0309977324,
      147.9437358277, 149.2104648526, 150.4771938776, 151.7439229025,
      170.8297902494, 172.2696485261, 173.7095068027, 175.1493650794,
      165.5589569161, 166.8978231293, 168.2366893424, 169.5755555556,
      172.3456235828, 173.6844897959, 175.0233560091, 176.3622222222,
      192.5632823129, 194.0031405896, 195.4429988662, 196.8828571429,
      171.7547789116, 173.0215079365, 174.2882369615, 175.5549659864,
      150.2537585034, 151.3473582766, 152.4409580499, 153.5345578231,
      128.0602210884, 128.98069161,   129.9011621315, 130.8216326531,
      146.552154195,  147.4346485261, 148.3171428571, 149.1996371882,
      175.9317460317, 176.9802267574, 178.028707483,  179.0771882086,
      205.9752834467, 207.1897505669, 208.4042176871, 209.6186848073,
      236.6827664399, 238.0632199546, 239.4436734694, 240.8241269841,
      226.5160997732, 227.7997278912, 229.0833560091, 230.366984127,
      233.0227664399, 234.3063945578, 235.5900226757, 236.8736507937,
      257.5195918367, 258.9000453515, 260.2804988662, 261.660952381,
      228.8039455782, 230.0184126984, 231.2328798186, 232.4473469388,
      199.4243537415, 200.4728344671, 201.5213151927, 202.5697959184,
      169.3808163265, 170.2633106576, 171.1458049887, 172.0282993197,
      201.4682256236, 202.3886961451, 203.3091666667, 204.2296371882,
      241.2549603175, 242.3485600907, 243.4421598639, 244.5357596372,
      281.7342120181, 283.0009410431, 284.267670068,  285.534399093,
      322.9059807256, 324.3458390023, 325.7856972789, 327.2255555556,
      306.9684807256, 308.3073469388, 309.6462131519, 310.9850793651,
      313.7551473923, 315.0940136054, 316.4328798186, 317.7717460317,
      344.6394727891, 346.0793310658, 347.5191893424, 348.959047619,
      305.545255102,  306.811984127,  308.0787131519, 309.3454421769,
      265.7585204082, 266.8521201814, 267.9457199546, 269.0393197279,
      225.2792687075, 226.199739229,  227.1202097506, 228.0406802721,
      190.5733843537, 191.3672675737, 192.1611507937, 192.9550340136,
      228.0505952381, 228.9937981859, 229.9370011338, 230.8802040816,
      266.125085034,  267.2176077098, 268.3101303855, 269.4026530612,
      304.7968537415, 306.0386961451, 307.2805385488, 308.5223809524,
      289.2065759637, 290.3613151927, 291.5160544218, 292.6707936508,
      295.0599092971, 296.2146485261, 297.3693877551, 298.5241269841,
      323.5414569161, 324.7832993197, 326.0251417234, 327.266984127,
      286.6615249433, 287.754047619,  288.8465702948, 289.9390929705,
      249.184314059,  250.1275170068, 251.0707199546, 252.0139229025,
      211.109824263,  211.903707483,  212.6975907029, 213.4914739229,
      176.8948129252, 177.5801927438, 178.2655725624, 178.950952381,
      211.5761054422, 212.3903968254, 213.2046882086, 214.0189795918,
      246.7730442177, 247.7162471655, 248.6594501134, 249.6026530612,
      282.4856292517, 283.5577437642, 284.6298582766, 285.7019727891,
      267.6691609977, 268.6660770975, 269.6629931973, 270.6599092971,
      272.7224943311, 273.7194104308, 274.7163265306, 275.7132426304,
      298.6683276644, 299.7404421769, 300.8125566893, 301.8846712018,
      264.5026814059, 265.4458843537, 266.3890873016, 267.3322902494,
      229.8213888889, 230.6356802721, 231.4499716553, 232.2642630385,
      194.6244501134, 195.309829932,  195.9952097506, 196.6805895692,
      158.8761054422, 159.4529818594, 160.0298582766, 160.6067346939,
      189.9451530612, 190.6305328798, 191.3159126984, 192.001292517,
      221.4482142857, 222.2420975057, 223.0359807256, 223.8298639456,
      253.3852891156, 254.287675737,  255.1900623583, 256.0924489796,
      239.8188208617, 240.6579138322, 241.4970068027, 242.3360997732,
      244.072154195,  244.9112471655, 245.7503401361, 246.5894331066,
      267.0060827664, 267.9084693878, 268.8108560091, 269.7132426304,
      236.3710487528, 237.1649319728, 237.9588151927, 238.7526984127,
      205.3020011338, 205.9873809524, 206.672760771,  207.3581405896,
      173.7989399093, 174.3758163265, 174.9526927438, 175.529569161,
  };
  const std::array<int, 4> in_shape = {{1, 9, 10, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x9x10x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.0204081633, 0.0408163265, 0.0612244898, 0.0816326531, 0.1224489796,
      0.1632653061, 0.2040816327, 0.2448979592, 0.306122449,  0.3673469388,
      0.4285714286, 0.4897959184, 0.5714285714, 0.6530612245, 0.7346938776,
      0.8163265306, 0.5714285714, 0.6530612245, 0.7346938776, 0.8163265306,
      0.5714285714, 0.6530612245, 0.7346938776, 0.8163265306, 0.5714285714,
      0.6530612245, 0.7346938776, 0.8163265306, 0.5510204082, 0.612244898,
      0.6734693878, 0.7346938776, 0.4489795918, 0.4897959184, 0.5306122449,
      0.5714285714, 0.2653061224, 0.2857142857, 0.306122449,  0.3265306122,
      0.3673469388, 0.4081632653, 0.4489795918, 0.4897959184, 0.8979591837,
      0.9795918367, 1.0612244898, 1.1428571429, 1.5918367347, 1.7142857143,
      1.8367346939, 1.9591836735, 2.4489795918, 2.612244898,  2.7755102041,
      2.9387755102, 2.4489795918, 2.612244898,  2.7755102041, 2.9387755102,
      2.4489795918, 2.612244898,  2.7755102041, 2.9387755102, 2.4489795918,
      2.612244898,  2.7755102041, 2.9387755102, 2.0816326531, 2.2040816327,
      2.3265306122, 2.4489795918, 1.5510204082, 1.6326530612, 1.7142857143,
      1.7959183673, 0.8571428571, 0.8979591837, 0.9387755102, 0.9795918367,
      1.0408163265, 1.1020408163, 1.1632653061, 1.2244897959, 2.3265306122,
      2.4489795918, 2.5714285714, 2.693877551,  3.8571428571, 4.0408163265,
      4.2244897959, 4.4081632653, 5.6326530612, 5.8775510204, 6.1224489796,
      6.3673469388, 5.6326530612, 5.8775510204, 6.1224489796, 6.3673469388,
      5.6326530612, 5.8775510204, 6.1224489796, 6.3673469388, 5.6326530612,
      5.8775510204, 6.1224489796, 6.3673469388, 4.5918367347, 4.7755102041,
      4.9591836735, 5.1428571429, 3.306122449,  3.4285714286, 3.5510204082,
      3.6734693878, 1.7755102041, 1.8367346939, 1.8979591837, 1.9591836735,
      1.0408163265, 1.1020408163, 1.1632653061, 1.2244897959, 2.3265306122,
      2.4489795918, 2.5714285714, 2.693877551,  3.8571428571, 4.0408163265,
      4.2244897959, 4.4081632653, 5.6326530612, 5.8775510204, 6.1224489796,
      6.3673469388, 5.6326530612, 5.8775510204, 6.1224489796, 6.3673469388,
      5.6326530612, 5.8775510204, 6.1224489796, 6.3673469388, 5.6326530612,
      5.8775510204, 6.1224489796, 6.3673469388, 4.5918367347, 4.7755102041,
      4.9591836735, 5.1428571429, 3.306122449,  3.4285714286, 3.5510204082,
      3.6734693878, 1.7755102041, 1.8367346939, 1.8979591837, 1.9591836735,
      1.0408163265, 1.1020408163, 1.1632653061, 1.2244897959, 2.3265306122,
      2.4489795918, 2.5714285714, 2.693877551,  3.8571428571, 4.0408163265,
      4.2244897959, 4.4081632653, 5.6326530612, 5.8775510204, 6.1224489796,
      6.3673469388, 5.6326530612, 5.8775510204, 6.1224489796, 6.3673469388,
      5.6326530612, 5.8775510204, 6.1224489796, 6.3673469388, 5.6326530612,
      5.8775510204, 6.1224489796, 6.3673469388, 4.5918367347, 4.7755102041,
      4.9591836735, 5.1428571429, 3.306122449,  3.4285714286, 3.5510204082,
      3.6734693878, 1.7755102041, 1.8367346939, 1.8979591837, 1.9591836735,
      1.0408163265, 1.1020408163, 1.1632653061, 1.2244897959, 2.3265306122,
      2.4489795918, 2.5714285714, 2.693877551,  3.8571428571, 4.0408163265,
      4.2244897959, 4.4081632653, 5.6326530612, 5.8775510204, 6.1224489796,
      6.3673469388, 5.6326530612, 5.8775510204, 6.1224489796, 6.3673469388,
      5.6326530612, 5.8775510204, 6.1224489796, 6.3673469388, 5.6326530612,
      5.8775510204, 6.1224489796, 6.3673469388, 4.5918367347, 4.7755102041,
      4.9591836735, 5.1428571429, 3.306122449,  3.4285714286, 3.5510204082,
      3.6734693878, 1.7755102041, 1.8367346939, 1.8979591837, 1.9591836735,
      1.0408163265, 1.1020408163, 1.1632653061, 1.2244897959, 2.3265306122,
      2.4489795918, 2.5714285714, 2.693877551,  3.8571428571, 4.0408163265,
      4.2244897959, 4.4081632653, 5.6326530612, 5.8775510204, 6.1224489796,
      6.3673469388, 5.6326530612, 5.8775510204, 6.1224489796, 6.3673469388,
      5.6326530612, 5.8775510204, 6.1224489796, 6.3673469388, 5.6326530612,
      5.8775510204, 6.1224489796, 6.3673469388, 4.5918367347, 4.7755102041,
      4.9591836735, 5.1428571429, 3.306122449,  3.4285714286, 3.5510204082,
      3.6734693878, 1.7755102041, 1.8367346939, 1.8979591837, 1.9591836735,
      1.0204081633, 1.0612244898, 1.1020408163, 1.1428571429, 2.2040816327,
      2.2857142857, 2.3673469388, 2.4489795918, 3.5510204082, 3.6734693878,
      3.7959183673, 3.9183673469, 5.0612244898, 5.2244897959, 5.387755102,
      5.5510204082, 5.0612244898, 5.2244897959, 5.387755102,  5.5510204082,
      5.0612244898, 5.2244897959, 5.387755102,  5.5510204082, 5.0612244898,
      5.2244897959, 5.387755102,  5.5510204082, 4.0408163265, 4.1632653061,
      4.2857142857, 4.4081632653, 2.8571428571, 2.9387755102, 3.0204081633,
      3.1020408163, 1.5102040816, 1.5510204082, 1.5918367347, 1.6326530612,
      0.6734693878, 0.693877551,  0.7142857143, 0.7346938776, 1.4285714286,
      1.4693877551, 1.5102040816, 1.5510204082, 2.2653061224, 2.3265306122,
      2.387755102,  2.4489795918, 3.1836734694, 3.2653061224, 3.3469387755,
      3.4285714286, 3.1836734694, 3.2653061224, 3.3469387755, 3.4285714286,
      3.1836734694, 3.2653061224, 3.3469387755, 3.4285714286, 3.1836734694,
      3.2653061224, 3.3469387755, 3.4285714286, 2.5102040816, 2.5714285714,
      2.6326530612, 2.693877551,  1.7551020408, 1.7959183673, 1.8367346939,
      1.8775510204, 0.9183673469, 0.9387755102, 0.9591836735, 0.9795918367};
  const std::array<int, 4> in_shape = {{1, 9, 10, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x10x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      7.1521825397,  8.7940192744,  10.8360827664, 13.4384637188,
      14.7676303855, 12.9247732426, 11.2624716553, 9.729138322,
      10.8702097506, 13.2671485261, 16.2139739229, 19.9306405896,
      21.5098072562, 18.695521542,  16.1998866213, 13.9318594104,
      15.4562641723, 18.7715702948, 22.8136337868, 27.8731575964,
      29.702324263,  25.6880385488, 22.1685941043, 19.0026077098,
      20.910345805,  25.3072845805, 30.6350623583, 37.2660147392,
      39.3451814059, 33.902324263,  29.1685941043, 24.94138322,
      27.8557823129, 33.5265306122, 40.3265306122, 48.7074829932,
      50.6408163265, 43.3646258503, 37.1170068027, 31.6040816327,
      36.3624489796, 43.6331972789, 52.2998639456, 62.9208163265,
      64.8541496599, 55.3379591837, 47.2236734694, 40.1107482993,
      48.1519331066, 57.6726814059, 68.9782369615, 82.7825226757,
      84.8616893424, 72.2454988662, 61.5339909297, 52.1829705215,
      45.3019331066, 54.2308446712, 64.8221145125, 77.740685941,
      79.5698526077, 67.6965192744, 57.6278684807, 48.848276644,
      41.5839058957, 49.7577154195, 59.444223356,  71.2485090703,
      72.827675737,  61.9257709751, 52.6904535147, 44.6455555556,
      36.9978514739, 44.2532936508, 52.8445634921, 63.3059920635,
      64.6351587302, 54.9332539683, 46.7217460317, 39.5748072562};
  const std::array<int, 4> in_shape = {{1, 10, 8, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x10x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.0204081633, 0.0612244898, 0.0612244898, 0.0612244898, 0.0612244898,
      0.0612244898, 0.0612244898, 0.0408163265, 0.0816326531, 0.2040816327,
      0.2040816327, 0.2040816327, 0.2040816327, 0.2040816327, 0.2040816327,
      0.1224489796, 0.1836734694, 0.4285714286, 0.4285714286, 0.4285714286,
      0.4285714286, 0.4285714286, 0.4285714286, 0.2448979592, 0.3265306122,
      0.7346938776, 0.7346938776, 0.7346938776, 0.7346938776, 0.7346938776,
      0.7346938776, 0.4081632653, 0.3265306122, 0.7346938776, 0.7346938776,
      0.7346938776, 0.7346938776, 0.7346938776, 0.7346938776, 0.4081632653,
      0.3265306122, 0.7346938776, 0.7346938776, 0.7346938776, 0.7346938776,
      0.7346938776, 0.7346938776, 0.4081632653, 0.3265306122, 0.7346938776,
      0.7346938776, 0.7346938776, 0.7346938776, 0.7346938776, 0.7346938776,
      0.4081632653, 0.306122449,  0.6734693878, 0.6734693878, 0.6734693878,
      0.6734693878, 0.6734693878, 0.6734693878, 0.3673469388, 0.2448979592,
      0.5306122449, 0.5306122449, 0.5306122449, 0.5306122449, 0.5306122449,
      0.5306122449, 0.2857142857, 0.1428571429, 0.306122449,  0.306122449,
      0.306122449,  0.306122449,  0.306122449,  0.306122449,  0.1632653061};
  const std::array<int, 4> in_shape = {{1, 10, 8, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x10x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      13.7274886621,  14.3043650794,  16.9026587302,  17.5880385488,
      20.8601984127,  21.6721655329,  25.9130555556,  26.8769274376,
      28.5713888889,  29.535260771,   25.0375793651,  25.8495464853,
      21.8395634921,  22.5249433107,  18.8814002268,  19.458276644,
      21.0550396825,  21.7404195011,  25.7200056689,  26.5342970522,
      31.4632596372,  32.4279478458,  38.71611678,    39.8612811791,
      41.8744501134,  43.0196145125,  36.4263548753,  37.3910430839,
      31.5854818594,  32.3997732426,  27.1783390023,  27.8637188209,
      30.1186451247,  30.9125283447,  36.5999376417,  37.5431405896,
      44.5098582766,  45.6272675737,  54.4198582766,  55.7463151927,
      58.07819161,    59.4046485261,  50.2586678005,  51.3760770975,
      43.3939852608,  44.3371882086,  37.2113321995,  38.0052154195,
      40.9183049887,  41.82069161,    49.5424546485,  50.614569161,
      59.9999943311,  61.2701247166,  73.0242800454,  74.5320294785,
      77.1826133787,  78.6903628118,  66.5345181406,  67.8046485261,
      57.2650736961,  58.3371882086,  48.9803798186,  49.8827664399,
      54.8724716553,  55.7115646259,  66.0561451247,  67.0530612245,
      79.4720181406,  80.6530612245,  96.0129705215,  97.4149659864,
      99.8796371882,  101.2816326531, 85.5482086168,  86.7292517007,
      73.2370975057,  74.2340136054,  62.3690702948,  63.2081632653,
      71.8858049887,  72.7248979592,  86.269478458,   87.2663945578,
      103.4186848073, 104.5997278912, 124.4396371882, 125.8416326531,
      128.3063038549, 129.7082993197, 109.4948752834, 110.6759183673,
      93.450430839,   94.4473469388,  79.3824036281,  80.2214965986,
      95.4014795918,  96.3038662132,  114.2732482993, 115.3453628118,
      136.6863435374, 137.9564739229, 164.0572959184, 165.5650453515,
      168.2156292517, 169.7233786848, 143.2208673469, 144.4909977324,
      121.9958673469, 123.0679818594, 103.4635544218, 104.3659410431,
      89.8099829932,  90.6038662132,  107.5184863946, 108.4616893424,
      128.5268197279, 129.6442290249, 154.154914966,  155.4813718821,
      157.8132482993, 159.1397052154, 134.2756292517, 135.3930385488,
      114.3125340136, 115.2557369615, 96.902670068,   97.696553288,
      82.4824319728,  83.1678117914,  98.7011394558,  99.515430839,
      117.9237585034, 118.888446712,  141.3518537415, 142.4970181406,
      144.5101870748, 145.6553514739, 122.8868537415, 123.8515419501,
      104.5666156463, 105.3809070295, 88.6057312925,  89.2911111111,
      73.4188265306,  73.9957029478,  87.821207483,   88.5065873016,
      104.8771598639, 105.6891269841, 125.6481122449, 126.611984127,
      128.3064455782, 129.2703174603, 109.0545408163, 109.8665079365,
      92.7581122449,  93.4434920635,  78.5727380952,  79.1496145125};
  const std::array<int, 4> in_shape = {{1, 10, 8, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x10x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.0204081633, 0.0408163265, 0.0816326531, 0.1224489796, 0.0816326531,
      0.1224489796, 0.0816326531, 0.1224489796, 0.0816326531, 0.1224489796,
      0.0816326531, 0.1224489796, 0.0816326531, 0.1224489796, 0.0612244898,
      0.0816326531, 0.1224489796, 0.1632653061, 0.3265306122, 0.4081632653,
      0.3265306122, 0.4081632653, 0.3265306122, 0.4081632653, 0.3265306122,
      0.4081632653, 0.3265306122, 0.4081632653, 0.3265306122, 0.4081632653,
      0.2040816327, 0.2448979592, 0.306122449,  0.3673469388, 0.7346938776,
      0.8571428571, 0.7346938776, 0.8571428571, 0.7346938776, 0.8571428571,
      0.7346938776, 0.8571428571, 0.7346938776, 0.8571428571, 0.7346938776,
      0.8571428571, 0.4285714286, 0.4897959184, 0.5714285714, 0.6530612245,
      1.306122449,  1.4693877551, 1.306122449,  1.4693877551, 1.306122449,
      1.4693877551, 1.306122449,  1.4693877551, 1.306122449,  1.4693877551,
      1.306122449,  1.4693877551, 0.7346938776, 0.8163265306, 0.5714285714,
      0.6530612245, 1.306122449,  1.4693877551, 1.306122449,  1.4693877551,
      1.306122449,  1.4693877551, 1.306122449,  1.4693877551, 1.306122449,
      1.4693877551, 1.306122449,  1.4693877551, 0.7346938776, 0.8163265306,
      0.5714285714, 0.6530612245, 1.306122449,  1.4693877551, 1.306122449,
      1.4693877551, 1.306122449,  1.4693877551, 1.306122449,  1.4693877551,
      1.306122449,  1.4693877551, 1.306122449,  1.4693877551, 0.7346938776,
      0.8163265306, 0.5714285714, 0.6530612245, 1.306122449,  1.4693877551,
      1.306122449,  1.4693877551, 1.306122449,  1.4693877551, 1.306122449,
      1.4693877551, 1.306122449,  1.4693877551, 1.306122449,  1.4693877551,
      0.7346938776, 0.8163265306, 0.5510204082, 0.612244898,  1.2244897959,
      1.3469387755, 1.2244897959, 1.3469387755, 1.2244897959, 1.3469387755,
      1.2244897959, 1.3469387755, 1.2244897959, 1.3469387755, 1.2244897959,
      1.3469387755, 0.6734693878, 0.7346938776, 0.4489795918, 0.4897959184,
      0.9795918367, 1.0612244898, 0.9795918367, 1.0612244898, 0.9795918367,
      1.0612244898, 0.9795918367, 1.0612244898, 0.9795918367, 1.0612244898,
      0.9795918367, 1.0612244898, 0.5306122449, 0.5714285714, 0.2653061224,
      0.2857142857, 0.5714285714, 0.612244898,  0.5714285714, 0.612244898,
      0.5714285714, 0.612244898,  0.5714285714, 0.612244898,  0.5714285714,
      0.612244898,  0.5714285714, 0.612244898,  0.306122449,  0.3265306122};
  const std::array<int, 4> in_shape = {{1, 10, 8, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x10x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      26.878100907,   27.4549773243,  28.0318537415,  28.6087301587,
      33.1199376417,  33.8053174603,  34.4906972789,  35.1760770975,
      40.9084297052,  41.7203968254,  42.5323639456,  43.3443310658,
      50.862239229,   51.8261111111,  52.7899829932,  53.7538548753,
      56.1789058957,  57.1427777778,  58.1066496599,  59.070521542,
      49.26319161,    50.0751587302,  50.8871258503,  51.6990929705,
      42.9937471655,  43.6791269841,  44.3645068027,  45.0498866213,
      37.1859240363,  37.7628004535,  38.3396768707,  38.916553288,
      41.4246995465,  42.1100793651,  42.7954591837,  43.4808390023,
      50.6257199546,  51.4400113379,  52.2543027211,  53.0685941043,
      61.9618310658,  62.9265192744,  63.891207483,   64.8558956916,
      76.287069161,   77.4322335601,  78.5773979592,  79.7225623583,
      82.6037358277,  83.7489002268,  84.8940646259,  86.0392290249,
      71.888021542,   72.8527097506,  73.8173979592,  74.7820861678,
      62.3566723356,  63.1709637188,  63.985255102,   64.7995464853,
      53.6712981859,  54.3566780045,  55.0420578231,  55.7274376417,
      59.4434070295,  60.2372902494,  61.0311734694,  61.8250566893,
      72.2566723356,  73.1998752834,  74.1430782313,  75.0862811791,
      87.9023072562,  89.0197165533,  90.1371258503,  91.2545351474,
      107.5132596372, 108.8397165533, 110.1661734694, 111.4926303855,
      114.8299263039, 116.15638322,   117.4828401361, 118.8092970522,
      99.3999263039,  100.5173356009, 101.634744898,  102.752154195,
      85.8447675737,  86.7879705215,  87.7311734694,  88.6743764172,
      73.6287811791,  74.4226643991,  75.216547619,   76.010430839,
      80.934223356,   81.8366099773,  82.7389965986,  83.64138322,
      98.0127947846,  99.0849092971,  100.1570238095, 101.229138322,
      118.7298582766, 119.9999886621, 121.2701190476, 122.5402494331,
      144.5408106576, 146.0485600907, 147.5563095238, 149.0640589569,
      152.8574773243, 154.3652267574, 155.8729761905, 157.3807256236,
      131.7989058957, 133.0690362812, 134.3391666667, 135.6092970522,
      113.4580328798, 114.5301473923, 115.6022619048, 116.6743764172,
      97.0583730159,  97.9607596372,  98.8631462585,  99.7655328798,
      108.9058503401, 109.7449433107, 110.5840362812, 111.4231292517,
      131.1153741497, 132.1122902494, 133.1092063492, 134.106122449,
      157.7629931973, 158.9440362812, 160.1250793651, 161.306122449,
      190.6239455782, 192.0259410431, 193.4279365079, 194.8299319728,
      198.3572789116, 199.7592743764, 201.1612698413, 202.5632653061,
      169.9153741497, 171.0964172336, 172.2774603175, 173.4585034014,
      145.4772789116, 146.4741950113, 147.4711111111, 148.4680272109,
      123.899047619,  124.7381405896, 125.5772335601, 126.4163265306,
      142.9325170068, 143.7716099773, 144.6107029478, 145.4497959184,
      171.5420408163, 172.5389569161, 173.5358730159, 174.5327891156,
      205.6563265306, 206.8373696145, 208.0184126984, 209.1994557823,
      247.4772789116, 248.8792743764, 250.2812698413, 251.6832653061,
      255.2106122449, 256.6126077098, 258.0146031746, 259.4165986395,
      217.808707483,  218.9897505669, 220.1707936508, 221.3518367347,
      185.9039455782, 186.900861678,  187.8977777778, 188.8946938776,
      157.9257142857, 158.7648072562, 159.6039002268, 160.4429931973,
      189.9005725624, 190.8029591837, 191.705345805,  192.6077324263,
      227.4743820862, 228.5464965986, 229.6186111111, 230.6907256236,
      272.1025566893, 273.3726870748, 274.6428174603, 275.9129478458,
      326.6068424036, 328.1145918367, 329.6223412698, 331.1300907029,
      334.9235090703, 336.4312585034, 337.9390079365, 339.4467573696,
      285.1716043084, 286.4417346939, 287.7118650794, 288.9819954649,
      242.9196201814, 243.9917346939, 245.0638492063, 246.1359637188,
      206.0247222222, 206.9271088435, 207.8294954649, 208.7318820862,
      178.8260827664, 179.6199659864, 180.4138492063, 181.2077324263,
      214.0937698413, 215.0369727891, 215.980175737,  216.9233786848,
      255.9362301587, 257.0536394558, 258.1710487528, 259.2884580499,
      306.9833730159, 308.309829932,  309.6362868481, 310.9627437642,
      314.3000396825, 315.6264965986, 316.9529535147, 318.2794104308,
      267.4338492063, 268.5512585034, 269.6686678005, 270.7860770975,
      227.6818650794, 228.6250680272, 229.5682709751, 230.5114739229,
      193.0114569161, 193.8053401361, 194.599223356,  195.393106576,
      164.279484127,  164.9648639456, 165.6502437642, 166.3356235828,
      196.5879875283, 197.4022789116, 198.2165702948, 199.030861678,
      234.8828287982, 235.8475170068, 236.8122052154, 237.776893424,
      281.5585430839, 282.703707483,  283.8488718821, 284.9940362812,
      287.8752097506, 289.0203741497, 290.1655385488, 291.3107029478,
      244.8090192744, 245.773707483,  246.7383956916, 247.7030839002,
      208.3189399093, 209.1332312925, 209.9475226757, 210.761814059,
      176.5260827664, 177.211462585,  177.8968424036, 178.5822222222,
      146.260776644,  146.8376530612, 147.4145294785, 147.9914058957,
      174.9570351474, 175.642414966,  176.3277947846, 177.0131746032,
      208.9423526077, 209.7543197279, 210.5662868481, 211.3782539683,
      250.3323526077, 251.2962244898, 252.2600963719, 253.223968254,
      255.6490192744, 256.6128911565, 257.5767630385, 258.5406349206,
      217.2971145125, 218.1090816327, 218.9210487528, 219.733015873,
      184.8308446712, 185.5162244898, 186.2016043084, 186.886984127,
      156.5685997732, 157.1454761905, 157.7223526077, 158.2992290249};
  const std::array<int, 4> in_shape = {{1, 10, 8, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x10x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.0204081633, 0.0408163265, 0.0612244898, 0.0816326531, 0.1224489796,
      0.1632653061, 0.2040816327, 0.2448979592, 0.1224489796, 0.1632653061,
      0.2040816327, 0.2448979592, 0.1224489796, 0.1632653061, 0.2040816327,
      0.2448979592, 0.1224489796, 0.1632653061, 0.2040816327, 0.2448979592,
      0.1224489796, 0.1632653061, 0.2040816327, 0.2448979592, 0.1224489796,
      0.1632653061, 0.2040816327, 0.2448979592, 0.1020408163, 0.1224489796,
      0.1428571429, 0.1632653061, 0.2040816327, 0.2448979592, 0.2857142857,
      0.3265306122, 0.5714285714, 0.6530612245, 0.7346938776, 0.8163265306,
      0.5714285714, 0.6530612245, 0.7346938776, 0.8163265306, 0.5714285714,
      0.6530612245, 0.7346938776, 0.8163265306, 0.5714285714, 0.6530612245,
      0.7346938776, 0.8163265306, 0.5714285714, 0.6530612245, 0.7346938776,
      0.8163265306, 0.5714285714, 0.6530612245, 0.7346938776, 0.8163265306,
      0.3673469388, 0.4081632653, 0.4489795918, 0.4897959184, 0.5510204082,
      0.612244898,  0.6734693878, 0.7346938776, 1.3469387755, 1.4693877551,
      1.5918367347, 1.7142857143, 1.3469387755, 1.4693877551, 1.5918367347,
      1.7142857143, 1.3469387755, 1.4693877551, 1.5918367347, 1.7142857143,
      1.3469387755, 1.4693877551, 1.5918367347, 1.7142857143, 1.3469387755,
      1.4693877551, 1.5918367347, 1.7142857143, 1.3469387755, 1.4693877551,
      1.5918367347, 1.7142857143, 0.7959183673, 0.8571428571, 0.9183673469,
      0.9795918367, 1.0612244898, 1.1428571429, 1.2244897959, 1.306122449,
      2.4489795918, 2.612244898,  2.7755102041, 2.9387755102, 2.4489795918,
      2.612244898,  2.7755102041, 2.9387755102, 2.4489795918, 2.612244898,
      2.7755102041, 2.9387755102, 2.4489795918, 2.612244898,  2.7755102041,
      2.9387755102, 2.4489795918, 2.612244898,  2.7755102041, 2.9387755102,
      2.4489795918, 2.612244898,  2.7755102041, 2.9387755102, 1.387755102,
      1.4693877551, 1.5510204082, 1.6326530612, 1.0612244898, 1.1428571429,
      1.2244897959, 1.306122449,  2.4489795918, 2.612244898,  2.7755102041,
      2.9387755102, 2.4489795918, 2.612244898,  2.7755102041, 2.9387755102,
      2.4489795918, 2.612244898,  2.7755102041, 2.9387755102, 2.4489795918,
      2.612244898,  2.7755102041, 2.9387755102, 2.4489795918, 2.612244898,
      2.7755102041, 2.9387755102, 2.4489795918, 2.612244898,  2.7755102041,
      2.9387755102, 1.387755102,  1.4693877551, 1.5510204082, 1.6326530612,
      1.0612244898, 1.1428571429, 1.2244897959, 1.306122449,  2.4489795918,
      2.612244898,  2.7755102041, 2.9387755102, 2.4489795918, 2.612244898,
      2.7755102041, 2.9387755102, 2.4489795918, 2.612244898,  2.7755102041,
      2.9387755102, 2.4489795918, 2.612244898,  2.7755102041, 2.9387755102,
      2.4489795918, 2.612244898,  2.7755102041, 2.9387755102, 2.4489795918,
      2.612244898,  2.7755102041, 2.9387755102, 1.387755102,  1.4693877551,
      1.5510204082, 1.6326530612, 1.0612244898, 1.1428571429, 1.2244897959,
      1.306122449,  2.4489795918, 2.612244898,  2.7755102041, 2.9387755102,
      2.4489795918, 2.612244898,  2.7755102041, 2.9387755102, 2.4489795918,
      2.612244898,  2.7755102041, 2.9387755102, 2.4489795918, 2.612244898,
      2.7755102041, 2.9387755102, 2.4489795918, 2.612244898,  2.7755102041,
      2.9387755102, 2.4489795918, 2.612244898,  2.7755102041, 2.9387755102,
      1.387755102,  1.4693877551, 1.5510204082, 1.6326530612, 1.0408163265,
      1.1020408163, 1.1632653061, 1.2244897959, 2.3265306122, 2.4489795918,
      2.5714285714, 2.693877551,  2.3265306122, 2.4489795918, 2.5714285714,
      2.693877551,  2.3265306122, 2.4489795918, 2.5714285714, 2.693877551,
      2.3265306122, 2.4489795918, 2.5714285714, 2.693877551,  2.3265306122,
      2.4489795918, 2.5714285714, 2.693877551,  2.3265306122, 2.4489795918,
      2.5714285714, 2.693877551,  1.2857142857, 1.3469387755, 1.4081632653,
      1.4693877551, 0.8571428571, 0.8979591837, 0.9387755102, 0.9795918367,
      1.8775510204, 1.9591836735, 2.0408163265, 2.1224489796, 1.8775510204,
      1.9591836735, 2.0408163265, 2.1224489796, 1.8775510204, 1.9591836735,
      2.0408163265, 2.1224489796, 1.8775510204, 1.9591836735, 2.0408163265,
      2.1224489796, 1.8775510204, 1.9591836735, 2.0408163265, 2.1224489796,
      1.8775510204, 1.9591836735, 2.0408163265, 2.1224489796, 1.0204081633,
      1.0612244898, 1.1020408163, 1.1428571429, 0.5102040816, 0.5306122449,
      0.5510204082, 0.5714285714, 1.1020408163, 1.1428571429, 1.1836734694,
      1.2244897959, 1.1020408163, 1.1428571429, 1.1836734694, 1.2244897959,
      1.1020408163, 1.1428571429, 1.1836734694, 1.2244897959, 1.1020408163,
      1.1428571429, 1.1836734694, 1.2244897959, 1.1020408163, 1.1428571429,
      1.1836734694, 1.2244897959, 1.1020408163, 1.1428571429, 1.1836734694,
      1.2244897959, 0.5918367347, 0.612244898,  0.6326530612, 0.6530612245};
  const std::array<int, 4> in_shape = {{1, 10, 8, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x10x9x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      7.8827721088,  9.6620238095,  11.5497789116, 13.8787471655,
      14.4712471655, 16.309223356,  14.4866043084, 12.8158560091,
      11.0366043084, 12.0348129252, 14.6507993197, 17.3956972789,
      20.7484750567, 21.2766893424, 23.6360941043, 20.8849036281,
      18.3978287982, 15.7818424036, 17.1633843537, 20.7997789116,
      24.5854931973, 29.1763662132, 29.5760090703, 32.5211281179,
      28.6270804989, 25.1400056689, 21.5036111111, 23.2684863946,
      28.108962585,  33.1191666667, 39.1624206349, 39.3692063492,
      42.9643253968, 37.7131349206, 33.0423866213, 28.2019104308,
      31.1000340136, 37.3809863946, 43.8197619048, 51.5157936508,
      51.0850793651, 55.051031746,  48.0915079365, 41.9683786848,
      35.6874263039, 40.6700340136, 48.7509863946, 56.9897619048,
      66.7857936508, 65.7250793651, 70.321031746,  61.2615079365,
      53.3383786848, 45.2574263039, 53.9152721088, 64.5200340136,
      75.2945238095, 88.0627777778, 86.2520634921, 91.8646825397,
      79.8884920635, 69.4534580499, 58.8486961451, 50.7397619048,
      60.691462585,  70.7924829932, 82.7512131519, 80.9404988662,
      86.0959750567, 74.8340702948, 65.0316893424, 55.0799886621,
      46.5877210884, 55.7026870748, 64.9465646259, 75.8814852608,
      74.1350566893, 78.7691043084, 68.4357709751, 59.4497165533,
      50.3347505669, 41.4591496599, 49.553707483,  57.7567687075,
      67.4535941043, 65.8357369615, 69.8840702948, 60.6935941043,
      52.7075396825, 44.6129818594};
  const std::array<int, 4> in_shape = {{1, 10, 9, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x10x9x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.0204081633, 0.0612244898, 0.1224489796, 0.1224489796, 0.1224489796,
      0.1224489796, 0.1224489796, 0.1020408163, 0.0612244898, 0.1020408163,
      0.2448979592, 0.4285714286, 0.4285714286, 0.4285714286, 0.4285714286,
      0.4285714286, 0.3265306122, 0.1836734694, 0.2448979592, 0.5510204082,
      0.9183673469, 0.9183673469, 0.9183673469, 0.9183673469, 0.9183673469,
      0.6734693878, 0.3673469388, 0.4489795918, 0.9795918367, 1.5918367347,
      1.5918367347, 1.5918367347, 1.5918367347, 1.5918367347, 1.1428571429,
      0.612244898,  0.4489795918, 0.9795918367, 1.5918367347, 1.5918367347,
      1.5918367347, 1.5918367347, 1.5918367347, 1.1428571429, 0.612244898,
      0.4489795918, 0.9795918367, 1.5918367347, 1.5918367347, 1.5918367347,
      1.5918367347, 1.5918367347, 1.1428571429, 0.612244898,  0.4489795918,
      0.9795918367, 1.5918367347, 1.5918367347, 1.5918367347, 1.5918367347,
      1.5918367347, 1.1428571429, 0.612244898,  0.4285714286, 0.9183673469,
      1.4693877551, 1.4693877551, 1.4693877551, 1.4693877551, 1.4693877551,
      1.0408163265, 0.5510204082, 0.3469387755, 0.7346938776, 1.1632653061,
      1.1632653061, 1.1632653061, 1.1632653061, 1.1632653061, 0.8163265306,
      0.4285714286, 0.2040816327, 0.4285714286, 0.6734693878, 0.6734693878,
      0.6734693878, 0.6734693878, 0.6734693878, 0.4693877551, 0.2448979592};
  const std::array<int, 4> in_shape = {{1, 10, 9, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x10x9x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      15.1886678005,  15.7655442177,  18.6386678005,  19.324047619,
      22.3056746032,  23.0995578231,  26.8370238095,  27.7574943311,
      28.06,          28.9424943311,  31.6979761905,  32.618446712,
      28.1793253968,  28.9732086168,  24.9463321995,  25.6317120181,
      21.4963321995,  22.0732086168,  23.3842460317,  24.0696258503,
      28.4873072562,  29.3015986395,  33.84819161,    34.7913945578,
      40.4033503401,  41.4969501134,  41.5048979592,  42.5533786848,
      46.1785884354,  47.2721882086,  40.8266043084,  41.7698072562,
      35.9813662132,  36.7956575964,  30.8783049887,  31.5636848073,
      33.5328854875,  34.3267687075,  40.6563548753,  41.5995578231,
      48.0784637188,  49.1709863946,  57.0860034014,  58.3527324263,
      57.9375510204,  59.1520181406,  63.7755272109,  65.0422562358,
      56.161638322,   57.2541609977,  49.33680839,    50.2800113379,
      42.2133390023,  43.0072222222,  45.6345861678,  46.5369727891,
      55.1458106576,  56.2179251701,  64.9964909297,  66.2383333333,
      76.8849829932,  78.3248412698,  77.3579591837,  78.7384126984,
      84.488792517,   85.9286507937,  74.1844274376,  75.4262698413,
      65.0126587302,  66.0847732426,  55.5014342404,  56.4038208617,
      61.3609750567,  62.2000680272,  73.7650566893,  74.7619727891,
      86.4847845805,  87.6395238095,  101.6927210884, 103.0315873016,
      100.8865306122, 102.1701587302, 108.7631972789, 110.1020634921,
      95.028276644,   96.183015873,   82.9398412698,  83.9367573696,
      70.5357596372,  71.3748526077,  80.5009750567,  81.3400680272,
      96.5050566893,  97.5019727891,  112.8247845805, 113.9795238095,
      132.2327210884, 133.5715873016, 130.1665306122, 131.4501587302,
      139.3031972789, 140.6420634921, 121.368276644,  122.523015873,
      105.6798412698, 106.6767573696, 89.6757596372,  90.5148526077,
      106.9281575964, 107.8305442177, 127.9679535147, 129.0400680272,
      149.3472052154, 150.589047619,  174.6856972789, 176.1255555556,
      171.1236734694, 172.5041269841, 182.2895068027, 183.7293650794,
      158.5351417234, 159.776984127,  137.8348015873, 138.9069160998,
      116.7950056689, 117.6973922902, 100.6856405896, 101.4795238095,
      120.4397222222, 121.3829251701, 140.4924433107, 141.5849659864,
      164.2356972789, 165.5024263039, 160.6665306122, 161.8809977324,
      170.9252210884, 172.1919501134, 148.5756179138, 149.6681405896,
      129.120175737,  130.0633786848, 109.3660941043, 110.1599773243,
      92.4900623583,  93.1754421769,  110.5910827664, 111.4053741497,
      128.9499263039, 129.8931292517, 150.6693707483, 151.7629705215,
      147.2216326531, 148.2701133787, 156.4446088435, 157.5382086168,
      135.9283390023, 136.8715419501, 118.0851417234, 118.8994331066,
      99.9841213152,  100.6695011338, 82.3414229025,  82.9182993197,
      98.4220351474,  99.107414966,   114.719654195,  115.513537415,
      133.9867176871, 134.9071882086, 130.7889795918, 131.6714739229,
      138.847670068,  139.7681405896, 120.5933049887, 121.3871882086,
      104.7296995465, 105.4150793651, 88.6490873016,  89.2259637188};
  const std::array<int, 4> in_shape = {{1, 10, 9, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x10x9x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.0204081633, 0.0408163265, 0.0816326531, 0.1224489796, 0.1836734694,
      0.2448979592, 0.1836734694, 0.2448979592, 0.1836734694, 0.2448979592,
      0.1836734694, 0.2448979592, 0.1836734694, 0.2448979592, 0.1632653061,
      0.2040816327, 0.1020408163, 0.1224489796, 0.1632653061, 0.2040816327,
      0.4081632653, 0.4897959184, 0.7346938776, 0.8571428571, 0.7346938776,
      0.8571428571, 0.7346938776, 0.8571428571, 0.7346938776, 0.8571428571,
      0.7346938776, 0.8571428571, 0.5714285714, 0.6530612245, 0.3265306122,
      0.3673469388, 0.4285714286, 0.4897959184, 0.9795918367, 1.1020408163,
      1.6530612245, 1.8367346939, 1.6530612245, 1.8367346939, 1.6530612245,
      1.8367346939, 1.6530612245, 1.8367346939, 1.6530612245, 1.8367346939,
      1.2244897959, 1.3469387755, 0.6734693878, 0.7346938776, 0.8163265306,
      0.8979591837, 1.7959183673, 1.9591836735, 2.9387755102, 3.1836734694,
      2.9387755102, 3.1836734694, 2.9387755102, 3.1836734694, 2.9387755102,
      3.1836734694, 2.9387755102, 3.1836734694, 2.1224489796, 2.2857142857,
      1.1428571429, 1.2244897959, 0.8163265306, 0.8979591837, 1.7959183673,
      1.9591836735, 2.9387755102, 3.1836734694, 2.9387755102, 3.1836734694,
      2.9387755102, 3.1836734694, 2.9387755102, 3.1836734694, 2.9387755102,
      3.1836734694, 2.1224489796, 2.2857142857, 1.1428571429, 1.2244897959,
      0.8163265306, 0.8979591837, 1.7959183673, 1.9591836735, 2.9387755102,
      3.1836734694, 2.9387755102, 3.1836734694, 2.9387755102, 3.1836734694,
      2.9387755102, 3.1836734694, 2.9387755102, 3.1836734694, 2.1224489796,
      2.2857142857, 1.1428571429, 1.2244897959, 0.8163265306, 0.8979591837,
      1.7959183673, 1.9591836735, 2.9387755102, 3.1836734694, 2.9387755102,
      3.1836734694, 2.9387755102, 3.1836734694, 2.9387755102, 3.1836734694,
      2.9387755102, 3.1836734694, 2.1224489796, 2.2857142857, 1.1428571429,
      1.2244897959, 0.7959183673, 0.8571428571, 1.7142857143, 1.8367346939,
      2.7551020408, 2.9387755102, 2.7551020408, 2.9387755102, 2.7551020408,
      2.9387755102, 2.7551020408, 2.9387755102, 2.7551020408, 2.9387755102,
      1.9591836735, 2.0816326531, 1.0408163265, 1.1020408163, 0.6530612245,
      0.693877551,  1.387755102,  1.4693877551, 2.2040816327, 2.3265306122,
      2.2040816327, 2.3265306122, 2.2040816327, 2.3265306122, 2.2040816327,
      2.3265306122, 2.2040816327, 2.3265306122, 1.5510204082, 1.6326530612,
      0.8163265306, 0.8571428571, 0.387755102,  0.4081632653, 0.8163265306,
      0.8571428571, 1.2857142857, 1.3469387755, 1.2857142857, 1.3469387755,
      1.2857142857, 1.3469387755, 1.2857142857, 1.3469387755, 1.2857142857,
      1.3469387755, 0.8979591837, 0.9387755102, 0.4693877551, 0.4897959184};
  const std::array<int, 4> in_shape = {{1, 10, 9, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x10x9x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      29.8004591837,  30.3773356009,  30.9542120181,  31.5310884354,
      36.5919557823,  37.2773356009,  37.9627154195,  38.6480952381,
      43.8174659864,  44.6113492063,  45.4052324263,  46.1991156463,
      52.7535770975,  53.674047619,   54.5945181406,  55.5149886621,
      55.2375056689,  56.12,          57.0024943311,  57.8849886621,
      62.4754818594,  63.395952381,   64.3164229025,  65.236893424,
      55.5647675737,  56.3586507937,  57.1525340136,  57.9464172336,
      49.2072845805,  49.8926643991,  50.5780442177,  51.2634240363,
      42.4157879819,  42.9926643991,  43.5695408163,  44.1464172336,
      46.0831122449,  46.7684920635,  47.4538718821,  48.1392517007,
      56.1603231293,  56.9746145125,  57.7889058957,  58.6031972789,
      66.7531802721,  67.69638322,    68.6395861678,  69.5827891156,
      79.713100907,   80.8067006803,  81.9003004535,  82.9939002268,
      81.9613151927,  83.0097959184,  84.058276644,   85.1067573696,
      91.2635770975,  92.3571768707,  93.450776644,   94.5443764172,
      80.7100056689,  81.6532086168,  82.5964115646,  83.5396145125,
      71.1484410431,  71.9627324263,  72.7770238095,  73.5913151927,
      61.0712301587,  61.7566099773,  62.4419897959,  63.1273696145,
      66.2718877551,  67.0657709751,  67.859654195,   68.653537415,
      80.3695068027,  81.3127097506,  82.2559126984,  83.1991156463,
      95.0644047619,  96.1569274376,  97.2494501134,  98.3419727891,
      112.9052777778, 114.1720068027, 115.4387358277, 116.7054648526,
      114.6606349206, 115.8751020408, 117.089569161,  118.3040362812,
      126.2843253968, 127.5510544218, 128.8177834467, 130.0845124717,
      111.2307539683, 112.323276644,  113.4157993197, 114.5083219955,
      97.7304138322,  98.67361678,    99.6168197279,  100.5600226757,
      83.6327947846,  84.4266780045,  85.2205612245,  86.0144444444,
      90.3667857143,  91.2691723356,  92.1715589569,  93.0739455782,
      109.2195068027, 110.2916213152, 111.3637358277, 112.4358503401,
      128.7511394558, 129.9929818594, 131.234824263,  132.4766666667,
      152.3301077098, 153.7699659864, 155.209824263,  156.6496825397,
      153.3354648526, 154.7159183673, 156.0963718821, 157.4768253968,
      167.5377267574, 168.977585034,  170.4174433107, 171.8573015873,
      147.1270124717, 148.3688548753, 149.6106972789, 150.8525396825,
      128.9532029478, 130.0253174603, 131.0974319728, 132.1695464853,
      110.1004818594, 111.0028684807, 111.905255102,  112.8076417234,
      121.8828571429, 122.7219501134, 123.5610430839, 124.4001360544,
      146.5331972789, 147.5301133787, 148.5270294785, 149.5239455782,
      171.814829932,  172.969569161,  174.12430839,   175.279047619,
      202.0465759637, 203.3854421769, 204.72430839,   206.0631746032,
      200.4894331066, 201.7730612245, 203.0566893424, 204.3403174603,
      216.1875283447, 217.5263945578, 218.865260771,  220.2041269841,
      188.901814059,  190.056553288,  191.211292517,  192.366031746,
      164.8827664399, 165.8796825397, 166.8765986395, 167.8735147392,
      140.2324263039, 141.0715192744, 141.9106122449, 142.7497052154,
      160.1628571429, 161.0019501134, 161.8410430839, 162.6801360544,
      192.0131972789, 193.0101133787, 194.0070294785, 195.0039455782,
      224.494829932,  225.649569161,  226.80430839,   227.959047619,
      263.1265759637, 264.4654421769, 265.80430839,   267.1431746032,
      259.0494331066, 260.3330612245, 261.6166893424, 262.9003174603,
      277.2675283447, 278.6063945578, 279.945260771,  281.2841269841,
      241.581814059,  242.736553288,  243.891292517,  245.046031746,
      210.3627664399, 211.3596825397, 212.3565986395, 213.3535147392,
      178.5124263039, 179.3515192744, 180.1906122449, 181.0297052154,
      212.9539285714, 213.8563151927, 214.7587018141, 215.6610884354,
      254.863792517,  255.9359070295, 257.008021542,  258.0801360544,
      297.4525680272, 298.6944104308, 299.9362528345, 301.1780952381,
      347.9315362812, 349.3713945578, 350.8112528345, 352.2511111111,
      340.866893424,  342.2473469388, 343.6278004535, 345.0082539683,
      363.1391553288, 364.5790136054, 366.0188718821, 367.4587301587,
      315.8284410431, 317.0702834467, 318.3121258503, 319.553968254,
      274.5974886621, 275.6696031746, 276.7417176871, 277.8138321995,
      232.6876247166, 233.5900113379, 234.4923979592, 235.3947845805,
      200.5773979592, 201.3712811791, 202.1651643991, 202.959047619,
      239.9362414966, 240.8794444444, 241.8226473923, 242.7658503401,
      279.8923639456, 280.9848866213, 282.0774092971, 283.1699319728,
      327.2046655329, 328.4713945578, 329.7381235828, 331.0048526077,
      320.1185941043, 321.3330612245, 322.5475283447, 323.7619954649,
      340.5837131519, 341.8504421769, 343.1171712018, 344.3839002268,
      296.0587131519, 297.1512358277, 298.2437585034, 299.3362811791,
      257.2971485261, 258.2403514739, 259.1835544218, 260.1267573696,
      217.9383049887, 218.7321882086, 219.5260714286, 220.3199546485,
      184.294744898,  184.9801247166, 185.6655045351, 186.3508843537,
      220.3678741497, 221.1821655329, 221.9964569161, 222.8107482993,
      256.9566496599, 257.8998526077, 258.8430555556, 259.7862585034,
      300.2451417234, 301.3387414966, 302.4323412698, 303.5259410431,
      293.3947845805, 294.4432653061, 295.4917460317, 296.5402267574,
      311.7956179138, 312.8892176871, 313.9828174603, 315.0764172336,
      270.9134750567, 271.8566780045, 272.7998809524, 273.7430839002,
      235.3559920635, 236.1702834467, 236.9845748299, 237.7988662132,
      199.2828628118, 199.9682426304, 200.653622449,  201.3390022676,
      164.1059693878, 164.682845805,  165.2597222222, 165.8365986395,
      196.1586904762, 196.8440702948, 197.5294501134, 198.214829932,
      228.6454251701, 229.43930839,   230.23319161,   231.0270748299,
      267.0529648526, 267.9734353741, 268.8939058957, 269.8143764172,
      260.6954648526, 261.5779591837, 262.4604535147, 263.3429478458,
      276.7748696145, 277.6953401361, 278.6158106576, 279.5362811791,
      240.3927267574, 241.1866099773, 241.9804931973, 242.7743764172,
      208.7740192744, 209.459399093,  210.1447789116, 210.8301587302,
      176.7212981859, 177.2981746032, 177.8750510204, 178.4519274376};
  const std::array<int, 4> in_shape = {{1, 10, 9, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x10x9x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.0204081633, 0.0408163265, 0.0612244898, 0.0816326531, 0.1224489796,
      0.1632653061, 0.2040816327, 0.2448979592, 0.306122449,  0.3673469388,
      0.4285714286, 0.4897959184, 0.306122449,  0.3673469388, 0.4285714286,
      0.4897959184, 0.306122449,  0.3673469388, 0.4285714286, 0.4897959184,
      0.306122449,  0.3673469388, 0.4285714286, 0.4897959184, 0.306122449,
      0.3673469388, 0.4285714286, 0.4897959184, 0.2857142857, 0.3265306122,
      0.3673469388, 0.4081632653, 0.1836734694, 0.2040816327, 0.2244897959,
      0.2448979592, 0.2857142857, 0.3265306122, 0.3673469388, 0.4081632653,
      0.7346938776, 0.8163265306, 0.8979591837, 0.9795918367, 1.3469387755,
      1.4693877551, 1.5918367347, 1.7142857143, 1.3469387755, 1.4693877551,
      1.5918367347, 1.7142857143, 1.3469387755, 1.4693877551, 1.5918367347,
      1.7142857143, 1.3469387755, 1.4693877551, 1.5918367347, 1.7142857143,
      1.3469387755, 1.4693877551, 1.5918367347, 1.7142857143, 1.0612244898,
      1.1428571429, 1.2244897959, 1.306122449,  0.612244898,  0.6530612245,
      0.693877551,  0.7346938776, 0.7959183673, 0.8571428571, 0.9183673469,
      0.9795918367, 1.8367346939, 1.9591836735, 2.0816326531, 2.2040816327,
      3.1224489796, 3.306122449,  3.4897959184, 3.6734693878, 3.1224489796,
      3.306122449,  3.4897959184, 3.6734693878, 3.1224489796, 3.306122449,
      3.4897959184, 3.6734693878, 3.1224489796, 3.306122449,  3.4897959184,
      3.6734693878, 3.1224489796, 3.306122449,  3.4897959184, 3.6734693878,
      2.3265306122, 2.4489795918, 2.5714285714, 2.693877551,  1.2857142857,
      1.3469387755, 1.4081632653, 1.4693877551, 1.5510204082, 1.6326530612,
      1.7142857143, 1.7959183673, 3.4285714286, 3.5918367347, 3.7551020408,
      3.9183673469, 5.6326530612, 5.8775510204, 6.1224489796, 6.3673469388,
      5.6326530612, 5.8775510204, 6.1224489796, 6.3673469388, 5.6326530612,
      5.8775510204, 6.1224489796, 6.3673469388, 5.6326530612, 5.8775510204,
      6.1224489796, 6.3673469388, 5.6326530612, 5.8775510204, 6.1224489796,
      6.3673469388, 4.0816326531, 4.2448979592, 4.4081632653, 4.5714285714,
      2.2040816327, 2.2857142857, 2.3673469388, 2.4489795918, 1.5510204082,
      1.6326530612, 1.7142857143, 1.7959183673, 3.4285714286, 3.5918367347,
      3.7551020408, 3.9183673469, 5.6326530612, 5.8775510204, 6.1224489796,
      6.3673469388, 5.6326530612, 5.8775510204, 6.1224489796, 6.3673469388,
      5.6326530612, 5.8775510204, 6.1224489796, 6.3673469388, 5.6326530612,
      5.8775510204, 6.1224489796, 6.3673469388, 5.6326530612, 5.8775510204,
      6.1224489796, 6.3673469388, 4.0816326531, 4.2448979592, 4.4081632653,
      4.5714285714, 2.2040816327, 2.2857142857, 2.3673469388, 2.4489795918,
      1.5510204082, 1.6326530612, 1.7142857143, 1.7959183673, 3.4285714286,
      3.5918367347, 3.7551020408, 3.9183673469, 5.6326530612, 5.8775510204,
      6.1224489796, 6.3673469388, 5.6326530612, 5.8775510204, 6.1224489796,
      6.3673469388, 5.6326530612, 5.8775510204, 6.1224489796, 6.3673469388,
      5.6326530612, 5.8775510204, 6.1224489796, 6.3673469388, 5.6326530612,
      5.8775510204, 6.1224489796, 6.3673469388, 4.0816326531, 4.2448979592,
      4.4081632653, 4.5714285714, 2.2040816327, 2.2857142857, 2.3673469388,
      2.4489795918, 1.5510204082, 1.6326530612, 1.7142857143, 1.7959183673,
      3.4285714286, 3.5918367347, 3.7551020408, 3.9183673469, 5.6326530612,
      5.8775510204, 6.1224489796, 6.3673469388, 5.6326530612, 5.8775510204,
      6.1224489796, 6.3673469388, 5.6326530612, 5.8775510204, 6.1224489796,
      6.3673469388, 5.6326530612, 5.8775510204, 6.1224489796, 6.3673469388,
      5.6326530612, 5.8775510204, 6.1224489796, 6.3673469388, 4.0816326531,
      4.2448979592, 4.4081632653, 4.5714285714, 2.2040816327, 2.2857142857,
      2.3673469388, 2.4489795918, 1.5306122449, 1.5918367347, 1.6530612245,
      1.7142857143, 3.306122449,  3.4285714286, 3.5510204082, 3.6734693878,
      5.3265306122, 5.5102040816, 5.693877551,  5.8775510204, 5.3265306122,
      5.5102040816, 5.693877551,  5.8775510204, 5.3265306122, 5.5102040816,
      5.693877551,  5.8775510204, 5.3265306122, 5.5102040816, 5.693877551,
      5.8775510204, 5.3265306122, 5.5102040816, 5.693877551,  5.8775510204,
      3.7959183673, 3.9183673469, 4.0408163265, 4.1632653061, 2.0204081633,
      2.0816326531, 2.1428571429, 2.2040816327, 1.2653061224, 1.306122449,
      1.3469387755, 1.387755102,  2.693877551,  2.7755102041, 2.8571428571,
      2.9387755102, 4.2857142857, 4.4081632653, 4.5306122449, 4.6530612245,
      4.2857142857, 4.4081632653, 4.5306122449, 4.6530612245, 4.2857142857,
      4.4081632653, 4.5306122449, 4.6530612245, 4.2857142857, 4.4081632653,
      4.5306122449, 4.6530612245, 4.2857142857, 4.4081632653, 4.5306122449,
      4.6530612245, 3.0204081633, 3.1020408163, 3.1836734694, 3.2653061224,
      1.5918367347, 1.6326530612, 1.6734693878, 1.7142857143, 0.7551020408,
      0.7755102041, 0.7959183673, 0.8163265306, 1.5918367347, 1.6326530612,
      1.6734693878, 1.7142857143, 2.5102040816, 2.5714285714, 2.6326530612,
      2.693877551,  2.5102040816, 2.5714285714, 2.6326530612, 2.693877551,
      2.5102040816, 2.5714285714, 2.6326530612, 2.693877551,  2.5102040816,
      2.5714285714, 2.6326530612, 2.693877551,  2.5102040816, 2.5714285714,
      2.6326530612, 2.693877551,  1.7551020408, 1.7959183673, 1.8367346939,
      1.8775510204, 0.9183673469, 0.9387755102, 0.9591836735, 0.9795918367};
  const std::array<int, 4> in_shape = {{1, 10, 9, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x10x10x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      8.613361678,   10.5300283447, 12.5551984127,  14.6888718821,
      14.7101020408, 15.7734353741, 18.0940702948,  16.2859070295,
      14.3692403628, 12.3440702948, 13.1994160998,  16.0344501134,
      18.9983956916, 22.0912528345, 21.7910544218,  23.0543877551,
      26.1369274376, 23.4308049887, 20.5957709751,  17.6318253968,
      18.8705045351, 22.8279875283, 26.9347902494,  31.1909126984,
      30.4502380952, 31.9135714286, 35.8770634921,  32.0689002268,
      28.1114172336, 24.0046145125, 25.6266269841,  30.9106405896,
      36.3643820862, 41.9878514739, 40.6876530612,  42.3509863946,
      47.314478458,  42.2001927438, 36.9161791383,  31.4624376417,
      34.3442857143, 41.2354421769, 48.2844217687,  55.4912244898,
      53.1285260771, 54.6751927438, 60.4442403628,  53.7109070295,
      46.8197505669, 39.7707709751, 44.9776190476,  53.8687755102,
      62.917755102,  72.1245578231, 68.5951927438,  70.1418594104,
      77.0775736961, 68.3442403628, 59.4530839002,  50.4041043084,
      59.6786111111, 71.3673866213, 83.2258900227,  95.2541213152,
      90.2178117914, 91.8811451247, 100.5807482993, 89.0617006803,
      77.3729251701, 65.5144217687, 56.1775907029,  67.1520804989,
      78.2758900227, 89.5490192744, 84.7150907029,  86.1784240363,
      94.235170068,  83.41,         72.4355102041,  61.3117006803,
      51.5915362812, 61.6476587302, 71.8326927438,  82.146638322,
      77.634138322,  78.8974716553, 86.1923129252,  76.2651020408,
      66.2089795918, 56.0239455782, 45.9204478458,  54.8541213152,
      63.8962981859, 73.046978458,  68.9749546485,  70.0382879819,
      76.4521768707, 67.6270068027, 58.6933333333,  49.6511564626};
  const std::array<int, 4> in_shape = {{1, 10, 10, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x10x10x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.0204081633, 0.0612244898, 0.1224489796, 0.2040816327, 0.2040816327,
      0.2040816327, 0.2040816327, 0.1836734694, 0.1428571429, 0.0816326531,
      0.1224489796, 0.2857142857, 0.4897959184, 0.7346938776, 0.7346938776,
      0.7346938776, 0.7346938776, 0.612244898,  0.4489795918, 0.2448979592,
      0.306122449,  0.6734693878, 1.1020408163, 1.5918367347, 1.5918367347,
      1.5918367347, 1.5918367347, 1.2857142857, 0.9183673469, 0.4897959184,
      0.5714285714, 1.2244897959, 1.9591836735, 2.7755102041, 2.7755102041,
      2.7755102041, 2.7755102041, 2.2040816327, 1.5510204082, 0.8163265306,
      0.5714285714, 1.2244897959, 1.9591836735, 2.7755102041, 2.7755102041,
      2.7755102041, 2.7755102041, 2.2040816327, 1.5510204082, 0.8163265306,
      0.5714285714, 1.2244897959, 1.9591836735, 2.7755102041, 2.7755102041,
      2.7755102041, 2.7755102041, 2.2040816327, 1.5510204082, 0.8163265306,
      0.5714285714, 1.2244897959, 1.9591836735, 2.7755102041, 2.7755102041,
      2.7755102041, 2.7755102041, 2.2040816327, 1.5510204082, 0.8163265306,
      0.5510204082, 1.1632653061, 1.8367346939, 2.5714285714, 2.5714285714,
      2.5714285714, 2.5714285714, 2.0204081633, 1.4081632653, 0.7346938776,
      0.4489795918, 0.9387755102, 1.4693877551, 2.0408163265, 2.0408163265,
      2.0408163265, 2.0408163265, 1.5918367347, 1.1020408163, 0.5714285714,
      0.2653061224, 0.5510204082, 0.8571428571, 1.1836734694, 1.1836734694,
      1.1836734694, 1.1836734694, 0.9183673469, 0.6326530612, 0.3265306122};
  const std::array<int, 4> in_shape = {{1, 10, 10, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x10x10x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      16.6498469388,  17.226723356,   20.3746768707,  21.0600566893,
      24.3165136054,  25.1103968254,  28.4753571429,  29.3777437642,
      28.5811111111,  29.4202040816,  30.7077777778,  31.5468707483,
      35.2857539683,  36.1881405896,  31.777930839,   32.571814059,
      28.053100907,   28.7384807256,  24.1112641723,  24.6881405896,
      25.713452381,   26.3988321995,  31.2546088435,  32.0689002268,
      37.0535884354,  37.9967913832,  43.1103911565,  44.1825056689,
      42.5851927438,  43.5821088435,  45.1118594104,  46.1087755102,
      51.2017403628,  52.2738548753,  45.9184070295,  46.8616099773,
      40.3772505669,  41.1915419501,  34.5782709751,  35.2636507937,
      36.9471258503,  37.7410090703,  44.7127721088,  45.6559750567,
      52.7770578231,  53.8695804989,  61.1399829932,  62.3818253968,
      59.7457369615,  60.9004761905,  62.6724036281,  63.8271428571,
      70.5122845805,  71.7541269841,  63.0452777778,  64.1378004535,
      55.2796315193,  56.2228344671,  47.215345805,   48.0092290249,
      50.3508673469,  51.2532539683,  60.7491666667,  61.8212811791,
      71.4869217687,  72.7287641723,  82.5641326531,  83.9757029478,
      80.0627437642,  81.3753061224,  83.3894104308,  84.7019727891,
      93.2173866213,  94.6289569161,  83.1585430839,  84.4003854875,
      72.7602437642,  73.8323582766,  62.0224886621,  62.9248752834,
      67.849478458,   68.6885714286,  81.473968254,   82.4708843537,
      95.4141043084,  96.5688435374,  109.6698866213, 110.9824489796,
      105.036553288,  106.2570521542, 108.1298866213, 109.3503854875,
      119.5759183673, 120.8884807256, 106.2670748299, 107.421814059,
      92.642585034,   93.6395011338,  78.7024489796,  79.5415419501,
      89.1161451247,  89.9552380952,  106.7406349206, 107.7375510204,
      124.6807709751, 125.8355102041, 142.936553288,  144.2491156463,
      135.9698866213, 137.1903854875, 139.0632199546, 140.2837188209,
      152.842585034,  154.1551473923, 135.5337414966, 136.6884807256,
      117.9092517007, 118.9061678005, 99.9691156463,  100.8082086168,
      118.4548356009, 119.3572222222, 141.6626587302, 142.7347732426,
      165.2099376417, 166.4517800454, 189.0966723356, 190.5082426304,
      179.1230612245, 180.4356235828, 182.4497278912, 183.7622902494,
      199.7499263039, 201.1614965986, 176.8815589569, 178.1234013605,
      153.6737358277, 154.7458503401, 130.1264569161, 131.0288435374,
      111.5612981859, 112.3551814059, 133.3609580499, 134.3041609977,
      155.4592573696, 156.5517800454, 177.8561961451, 179.0980385488,
      168.2754421769, 169.4301814059, 171.2021088435, 172.3568480726,
      187.2284977324, 188.4703401361, 165.7274773243, 166.82,
      143.9278174603, 144.8710204082, 121.8295181406, 122.6234013605,
      102.4976927438, 103.1830725624, 122.4810260771, 123.2953174603,
      142.7221825397, 143.6653854875, 163.2211621315, 164.293276644,
      154.2713605442, 155.268276644,  156.7980272109, 157.7949433107,
      171.3125113379, 172.3846258503, 151.5870011338, 152.5302040816,
      131.6036678005, 132.4179591837, 111.3625113379, 112.0478911565,
      91.2640192744,  91.8408956916,  109.0228628118, 109.7082426304,
      126.9987131519, 127.7925963719, 145.1915702948, 146.0939569161,
      137.1108163265, 137.9499092971, 139.2374829932, 140.0765759637,
      152.0019671202, 152.9043537415, 134.4601303855, 135.2540136054,
      116.7012868481, 117.3866666667, 98.7254365079,  99.3023129252};
  const std::array<int, 4> in_shape = {{1, 10, 10, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x10x10x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.0204081633, 0.0408163265, 0.0816326531, 0.1224489796, 0.1836734694,
      0.2448979592, 0.3265306122, 0.4081632653, 0.3265306122, 0.4081632653,
      0.3265306122, 0.4081632653, 0.3265306122, 0.4081632653, 0.306122449,
      0.3673469388, 0.2448979592, 0.2857142857, 0.1428571429, 0.1632653061,
      0.2040816327, 0.2448979592, 0.4897959184, 0.5714285714, 0.8571428571,
      0.9795918367, 1.306122449,  1.4693877551, 1.306122449,  1.4693877551,
      1.306122449,  1.4693877551, 1.306122449,  1.4693877551, 1.1020408163,
      1.2244897959, 0.8163265306, 0.8979591837, 0.4489795918, 0.4897959184,
      0.5510204082, 0.612244898,  1.2244897959, 1.3469387755, 2.0204081633,
      2.2040816327, 2.9387755102, 3.1836734694, 2.9387755102, 3.1836734694,
      2.9387755102, 3.1836734694, 2.9387755102, 3.1836734694, 2.387755102,
      2.5714285714, 1.7142857143, 1.8367346939, 0.9183673469, 0.9795918367,
      1.0612244898, 1.1428571429, 2.2857142857, 2.4489795918, 3.6734693878,
      3.9183673469, 5.2244897959, 5.5510204082, 5.2244897959, 5.5510204082,
      5.2244897959, 5.5510204082, 5.2244897959, 5.5510204082, 4.1632653061,
      4.4081632653, 2.9387755102, 3.1020408163, 1.5510204082, 1.6326530612,
      1.0612244898, 1.1428571429, 2.2857142857, 2.4489795918, 3.6734693878,
      3.9183673469, 5.2244897959, 5.5510204082, 5.2244897959, 5.5510204082,
      5.2244897959, 5.5510204082, 5.2244897959, 5.5510204082, 4.1632653061,
      4.4081632653, 2.9387755102, 3.1020408163, 1.5510204082, 1.6326530612,
      1.0612244898, 1.1428571429, 2.2857142857, 2.4489795918, 3.6734693878,
      3.9183673469, 5.2244897959, 5.5510204082, 5.2244897959, 5.5510204082,
      5.2244897959, 5.5510204082, 5.2244897959, 5.5510204082, 4.1632653061,
      4.4081632653, 2.9387755102, 3.1020408163, 1.5510204082, 1.6326530612,
      1.0612244898, 1.1428571429, 2.2857142857, 2.4489795918, 3.6734693878,
      3.9183673469, 5.2244897959, 5.5510204082, 5.2244897959, 5.5510204082,
      5.2244897959, 5.5510204082, 5.2244897959, 5.5510204082, 4.1632653061,
      4.4081632653, 2.9387755102, 3.1020408163, 1.5510204082, 1.6326530612,
      1.0408163265, 1.1020408163, 2.2040816327, 2.3265306122, 3.4897959184,
      3.6734693878, 4.8979591837, 5.1428571429, 4.8979591837, 5.1428571429,
      4.8979591837, 5.1428571429, 4.8979591837, 5.1428571429, 3.8571428571,
      4.0408163265, 2.693877551,  2.8163265306, 1.4081632653, 1.4693877551,
      0.8571428571, 0.8979591837, 1.7959183673, 1.8775510204, 2.8163265306,
      2.9387755102, 3.9183673469, 4.0816326531, 3.9183673469, 4.0816326531,
      3.9183673469, 4.0816326531, 3.9183673469, 4.0816326531, 3.0612244898,
      3.1836734694, 2.1224489796, 2.2040816327, 1.1020408163, 1.1428571429,
      0.5102040816, 0.5306122449, 1.0612244898, 1.1020408163, 1.6530612245,
      1.7142857143, 2.2857142857, 2.3673469388, 2.2857142857, 2.3673469388,
      2.2857142857, 2.3673469388, 2.2857142857, 2.3673469388, 1.7755102041,
      1.8367346939, 1.2244897959, 1.2653061224, 0.6326530612, 0.6530612245};
  const std::array<int, 4> in_shape = {{1, 10, 10, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x10x10x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      32.7228174603,  33.2996938776,  33.8765702948,  34.453446712,
      40.0639739229,  40.7493537415,  41.4347335601,  42.1201133787,
      47.8391439909,  48.6330272109,  49.4269104308,  50.2207936508,
      56.0483276644,  56.9507142857,  57.853100907,   58.7554875283,
      56.3231292517,  57.1622222222,  58.0013151927,  58.8404081633,
      60.576462585,   61.4155555556,  62.2546485261,  63.0937414966,
      69.6691213152,  70.5715079365,  71.4738945578,  72.3762811791,
      62.761978458,   63.555861678,   64.349744898,   65.1436281179,
      55.4208219955,  56.1062018141,  56.7915816327,  57.4769614512,
      47.6456519274,  48.2225283447,  48.7994047619,  49.3762811791,
      50.7415249433,  51.4269047619,  52.1122845805,  52.7976643991,
      61.6949263039,  62.5092176871,  63.3235090703,  64.1378004535,
      73.1639739229,  74.1071768707,  75.0503798186,  75.9935827664,
      85.1486678005,  86.2207823129,  87.2928968254,  88.3650113379,
      84.1734693878,  85.1703854875,  86.1673015873,  87.1642176871,
      89.2268027211,  90.2237188209,  91.2206349206,  92.2175510204,
      101.3313662132, 102.4034807256, 103.4755952381, 104.5477097506,
      90.8936111111,  91.836814059,   92.7800170068,  93.7232199546,
      79.9402097506,  80.7545011338,  81.568792517,   82.3830839002,
      68.4711621315,  69.1565419501,  69.8419217687,  70.5273015873,
      73.1003684807,  73.8942517007,  74.6881349206,  75.4820181406,
      88.4823412698,  89.4255442177,  90.3687471655,  91.3119501134,
      104.4615929705, 105.5541156463, 106.646638322,  107.7391609977,
      121.0381235828, 122.2799659864, 123.52180839,   124.7636507937,
      118.3367346939, 119.4914739229, 120.6462131519, 121.800952381,
      124.1900680272, 125.3448072562, 126.4995464853, 127.6542857143,
      139.7827267574, 141.024569161,  142.2664115646, 143.5082539683,
      124.9980328798, 126.0905555556, 127.1830782313, 128.275600907,
      109.6160600907, 110.5592630385, 111.5024659864, 112.4456689342,
      93.63680839,    94.43069161,    95.2245748299,  96.0184580499,
      99.7993480726,  100.7017346939, 101.6041213152, 102.5065079365,
      120.4262188209, 121.4983333333, 122.5704478458, 123.6425623583,
      141.7320011338, 142.9738435374, 144.215685941,  145.4575283447,
      163.7166950113, 165.1282653061, 166.5398356009, 167.9514058957,
      158.8129251701, 160.1254875283, 161.4380498866, 162.7506122449,
      165.4662585034, 166.7788208617, 168.09138322,   169.4039455782,
      185.0232029478, 186.4347732426, 187.8463435374, 189.2579138322,
      165.0752437642, 166.3170861678, 167.5589285714, 168.8007709751,
      144.4483730159, 145.5204875283, 146.5926020408, 147.6647165533,
      123.1425907029, 124.0449773243, 124.9473639456, 125.8497505669,
      134.8598639456, 135.6989569161, 136.5380498866, 137.3771428571,
      161.9510204082, 162.9479365079, 163.9448526077, 164.9417687075,
      189.6734693878, 190.8282086168, 191.9829478458, 193.1376870748,
      218.0272108844, 219.3397732426, 220.6523356009, 221.9648979592,
      208.8526077098, 210.073106576,  211.2936054422, 212.5141043084,
      215.0392743764, 216.2597732426, 217.4802721088, 218.7007709751,
      237.8392743764, 239.1518367347, 240.464399093,  241.7769614512,
      211.3794104308, 212.5341496599, 213.6888888889, 214.8436281179,
      184.2882539683, 185.285170068,  186.2820861678, 187.2790022676,
      156.5658049887, 157.4048979592, 158.2439909297, 159.0830839002,
      177.3931972789, 178.2322902494, 179.07138322,   179.9104761905,
      212.4843537415, 213.4812698413, 214.478185941,  215.4751020408,
      248.2068027211, 249.3615419501, 250.5162811791, 251.6710204082,
      284.5605442177, 285.873106576,  287.1856689342, 288.4982312925,
      270.7192743764, 271.9397732426, 273.1602721088, 274.3807709751,
      276.9059410431, 278.1264399093, 279.3469387755, 280.5674376417,
      304.3726077098, 305.685170068,  306.9977324263, 308.3102947846,
      269.9127437642, 271.0674829932, 272.2222222222, 273.3769614512,
      234.8215873016, 235.8185034014, 236.8154195011, 237.8123356009,
      199.099138322,  199.9382312925, 200.777324263,  201.6164172336,
      236.0072845805, 236.9096712018, 237.8120578231, 238.7144444444,
      282.2532029478, 283.3253174603, 284.3974319728, 285.4695464853,
      329.1780328798, 330.4198752834, 331.6617176871, 332.9035600907,
      376.7817743764, 378.1933446712, 379.604914966,  381.0164852608,
      356.9335600907, 358.246122449,  359.5586848073, 360.8712471655,
      363.586893424,  364.8994557823, 366.2120181406, 367.5245804989,
      398.0882823129, 399.4998526077, 400.9114229025, 402.3229931973,
      352.5212755102, 353.7631179138, 355.0049603175, 356.2468027211,
      306.2753571429, 307.3474716553, 308.4195861678, 309.4917006803,
      259.3505272109, 260.2529138322, 261.1553004535, 262.0576870748,
      222.3287131519, 223.1225963719, 223.9164795918, 224.7103628118,
      265.7787131519, 266.7219160998, 267.6651190476, 268.6083219955,
      309.8259920635, 310.9185147392, 312.011037415,  313.1035600907,
      354.4705498866, 355.7123922902, 356.9542346939, 358.1960770975,
      335.3961451247, 336.5508843537, 337.7056235828, 338.8603628118,
      341.249478458,  342.4042176871, 343.5589569161, 344.7136961451,
      373.2151530612, 374.4569954649, 375.6988378685, 376.9406802721,
      330.3624319728, 331.4549546485, 332.5474773243, 333.64,
      286.9124319728, 287.8556349206, 288.7988378685, 289.7420408163,
      242.8651530612, 243.6590362812, 244.4529195011, 245.2468027211,
      204.3100056689, 204.9953854875, 205.6807653061, 206.3661451247,
      244.147760771,  244.9620521542, 245.7763435374, 246.5906349206,
      284.5011621315, 285.4443650794, 286.3875680272, 287.3307709751,
      325.3702097506, 326.442324263,  327.5144387755, 328.586553288,
      307.5458049887, 308.5427210884, 309.5396371882, 310.536553288,
      312.599138322,  313.5960544218, 314.5929705215, 315.5898866213,
      341.5529081633, 342.6250226757, 343.6971371882, 344.7692517007,
      302.2307993197, 303.1740022676, 304.1172052154, 305.0604081633,
      262.3930442177, 263.2073356009, 264.0216269841, 264.8359183673,
      222.0396428571, 222.7250226757, 223.4104024943, 224.0957823129,
      181.9511621315, 182.5280385488, 183.104914966,  183.6817913832,
      217.360345805,  218.0457256236, 218.7311054422, 219.4164852608,
      253.2035430839, 253.9974263039, 254.7913095238, 255.5851927438,
      289.4807539683, 290.3831405896, 291.2855272109, 292.1879138322,
      273.3825396825, 274.2216326531, 275.0607256236, 275.8998185941,
      277.6358730159, 278.4749659864, 279.3140589569, 280.1531519274,
      303.101547619,  304.0039342404, 304.9063208617, 305.808707483,
      268.126377551,  268.920260771,  269.7141439909, 270.5080272109,
      232.7171938776, 233.4025736961, 234.0879535147, 234.7733333333,
      196.8739965986, 197.4508730159, 198.0277494331, 198.6046258503};
  const std::array<int, 4> in_shape = {{1, 10, 10, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x10x10x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.0204081633,
      0.0408163265,
      0.0612244898,
      0.0816326531,
      0.1224489796,
      0.1632653061,
      0.2040816327,
      0.2448979592,
      0.306122449,
      0.3673469388,
      0.4285714286,
      0.4897959184,
      0.5714285714,
      0.6530612245,
      0.7346938776,
      0.8163265306,
      0.5714285714,
      0.6530612245,
      0.7346938776,
      0.8163265306,
      0.5714285714,
      0.6530612245,
      0.7346938776,
      0.8163265306,
      0.5714285714,
      0.6530612245,
      0.7346938776,
      0.8163265306,
      0.5510204082,
      0.612244898,
      0.6734693878,
      0.7346938776,
      0.4489795918,
      0.4897959184,
      0.5306122449,
      0.5714285714,
      0.2653061224,
      0.2857142857,
      0.306122449,
      0.3265306122,
      0.3673469388,
      0.4081632653,
      0.4489795918,
      0.4897959184,
      0.8979591837,
      0.9795918367,
      1.0612244898,
      1.1428571429,
      1.5918367347,
      1.7142857143,
      1.8367346939,
      1.9591836735,
      2.4489795918,
      2.612244898,
      2.7755102041,
      2.9387755102,
      2.4489795918,
      2.612244898,
      2.7755102041,
      2.9387755102,
      2.4489795918,
      2.612244898,
      2.7755102041,
      2.9387755102,
      2.4489795918,
      2.612244898,
      2.7755102041,
      2.9387755102,
      2.0816326531,
      2.2040816327,
      2.3265306122,
      2.4489795918,
      1.5510204082,
      1.6326530612,
      1.7142857143,
      1.7959183673,
      0.8571428571,
      0.8979591837,
      0.9387755102,
      0.9795918367,
      1.0408163265,
      1.1020408163,
      1.1632653061,
      1.2244897959,
      2.3265306122,
      2.4489795918,
      2.5714285714,
      2.693877551,
      3.8571428571,
      4.0408163265,
      4.2244897959,
      4.4081632653,
      5.6326530612,
      5.8775510204,
      6.1224489796,
      6.3673469388,
      5.6326530612,
      5.8775510204,
      6.1224489796,
      6.3673469388,
      5.6326530612,
      5.8775510204,
      6.1224489796,
      6.3673469388,
      5.6326530612,
      5.8775510204,
      6.1224489796,
      6.3673469388,
      4.5918367347,
      4.7755102041,
      4.9591836735,
      5.1428571429,
      3.306122449,
      3.4285714286,
      3.5510204082,
      3.6734693878,
      1.7755102041,
      1.8367346939,
      1.8979591837,
      1.9591836735,
      2.0408163265,
      2.1224489796,
      2.2040816327,
      2.2857142857,
      4.4081632653,
      4.5714285714,
      4.7346938776,
      4.8979591837,
      7.1020408163,
      7.3469387755,
      7.5918367347,
      7.8367346939,
      10.1224489796,
      10.4489795918,
      10.7755102041,
      11.1020408163,
      10.1224489796,
      10.4489795918,
      10.7755102041,
      11.1020408163,
      10.1224489796,
      10.4489795918,
      10.7755102041,
      11.1020408163,
      10.1224489796,
      10.4489795918,
      10.7755102041,
      11.1020408163,
      8.0816326531,
      8.3265306122,
      8.5714285714,
      8.8163265306,
      5.7142857143,
      5.8775510204,
      6.0408163265,
      6.2040816327,
      3.0204081633,
      3.1020408163,
      3.1836734694,
      3.2653061224,
      2.0408163265,
      2.1224489796,
      2.2040816327,
      2.2857142857,
      4.4081632653,
      4.5714285714,
      4.7346938776,
      4.8979591837,
      7.1020408163,
      7.3469387755,
      7.5918367347,
      7.8367346939,
      10.1224489796,
      10.4489795918,
      10.7755102041,
      11.1020408163,
      10.1224489796,
      10.4489795918,
      10.7755102041,
      11.1020408163,
      10.1224489796,
      10.4489795918,
      10.7755102041,
      11.1020408163,
      10.1224489796,
      10.4489795918,
      10.7755102041,
      11.1020408163,
      8.0816326531,
      8.3265306122,
      8.5714285714,
      8.8163265306,
      5.7142857143,
      5.8775510204,
      6.0408163265,
      6.2040816327,
      3.0204081633,
      3.1020408163,
      3.1836734694,
      3.2653061224,
      2.0408163265,
      2.1224489796,
      2.2040816327,
      2.2857142857,
      4.4081632653,
      4.5714285714,
      4.7346938776,
      4.8979591837,
      7.1020408163,
      7.3469387755,
      7.5918367347,
      7.8367346939,
      10.1224489796,
      10.4489795918,
      10.7755102041,
      11.1020408163,
      10.1224489796,
      10.4489795918,
      10.7755102041,
      11.1020408163,
      10.1224489796,
      10.4489795918,
      10.7755102041,
      11.1020408163,
      10.1224489796,
      10.4489795918,
      10.7755102041,
      11.1020408163,
      8.0816326531,
      8.3265306122,
      8.5714285714,
      8.8163265306,
      5.7142857143,
      5.8775510204,
      6.0408163265,
      6.2040816327,
      3.0204081633,
      3.1020408163,
      3.1836734694,
      3.2653061224,
      2.0408163265,
      2.1224489796,
      2.2040816327,
      2.2857142857,
      4.4081632653,
      4.5714285714,
      4.7346938776,
      4.8979591837,
      7.1020408163,
      7.3469387755,
      7.5918367347,
      7.8367346939,
      10.1224489796,
      10.4489795918,
      10.7755102041,
      11.1020408163,
      10.1224489796,
      10.4489795918,
      10.7755102041,
      11.1020408163,
      10.1224489796,
      10.4489795918,
      10.7755102041,
      11.1020408163,
      10.1224489796,
      10.4489795918,
      10.7755102041,
      11.1020408163,
      8.0816326531,
      8.3265306122,
      8.5714285714,
      8.8163265306,
      5.7142857143,
      5.8775510204,
      6.0408163265,
      6.2040816327,
      3.0204081633,
      3.1020408163,
      3.1836734694,
      3.2653061224,
      2.0204081633,
      2.0816326531,
      2.1428571429,
      2.2040816327,
      4.2857142857,
      4.4081632653,
      4.5306122449,
      4.6530612245,
      6.7959183673,
      6.9795918367,
      7.1632653061,
      7.3469387755,
      9.5510204082,
      9.7959183673,
      10.0408163265,
      10.2857142857,
      9.5510204082,
      9.7959183673,
      10.0408163265,
      10.2857142857,
      9.5510204082,
      9.7959183673,
      10.0408163265,
      10.2857142857,
      9.5510204082,
      9.7959183673,
      10.0408163265,
      10.2857142857,
      7.5306122449,
      7.7142857143,
      7.8979591837,
      8.0816326531,
      5.2653061224,
      5.387755102,
      5.5102040816,
      5.6326530612,
      2.7551020408,
      2.8163265306,
      2.8775510204,
      2.9387755102,
      1.6734693878,
      1.7142857143,
      1.7551020408,
      1.7959183673,
      3.5102040816,
      3.5918367347,
      3.6734693878,
      3.7551020408,
      5.5102040816,
      5.6326530612,
      5.7551020408,
      5.8775510204,
      7.6734693878,
      7.8367346939,
      8.,
      8.1632653061,
      7.6734693878,
      7.8367346939,
      8.,
      8.1632653061,
      7.6734693878,
      7.8367346939,
      8.,
      8.1632653061,
      7.6734693878,
      7.8367346939,
      8.,
      8.1632653061,
      6.,
      6.1224489796,
      6.2448979592,
      6.3673469388,
      4.1632653061,
      4.2448979592,
      4.3265306122,
      4.4081632653,
      2.1632653061,
      2.2040816327,
      2.2448979592,
      2.2857142857,
      1.,
      1.0204081633,
      1.0408163265,
      1.0612244898,
      2.0816326531,
      2.1224489796,
      2.1632653061,
      2.2040816327,
      3.2448979592,
      3.306122449,
      3.3673469388,
      3.4285714286,
      4.4897959184,
      4.5714285714,
      4.6530612245,
      4.7346938776,
      4.4897959184,
      4.5714285714,
      4.6530612245,
      4.7346938776,
      4.4897959184,
      4.5714285714,
      4.6530612245,
      4.7346938776,
      4.4897959184,
      4.5714285714,
      4.6530612245,
      4.7346938776,
      3.4897959184,
      3.5510204082,
      3.612244898,
      3.6734693878,
      2.4081632653,
      2.4489795918,
      2.4897959184,
      2.5306122449,
      1.2448979592,
      1.2653061224,
      1.2857142857,
      1.306122449,
  };
  const std::array<int, 4> in_shape = {{1, 10, 10, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x8x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      7.1521825397,   8.7940192744,   10.8360827664,  13.4384637188,
      14.7676303855,  12.9247732426,  11.2624716553,  9.729138322,
      10.8702097506,  13.2671485261,  16.2139739229,  19.9306405896,
      21.5098072562,  18.695521542,   16.1998866213,  13.9318594104,
      16.220606576,   19.6889739229,  23.9135770975,  29.1969104308,
      31.0677437642,  26.8534580499,  23.1633786848,  19.8477324263,
      23.8563208617,  28.8389739229,  34.8635770975,  42.3469104308,
      44.5677437642,  38.3534580499,  32.9633786848,  28.1620181406,
      34.489654195,   41.4723072562,  49.8302437642,  60.1135770975,
      62.3344104308,  53.3201247166,  45.5967120181,  38.7953514739,
      32.9301303855,  39.5413548753,  47.4326247166,  57.1159580499,
      58.9867913832,  50.3725056689,  43.0157596372,  36.5572562358,
      30.6178287982,  36.729053288,   44.0092120181,  52.9258786848,
      54.5050453515,  46.4907596372,  39.6617913832,  33.679478458,
      27.7678287982,  33.2872165533,  39.8530895692,  47.8840419501,
      49.2132086168,  41.9417800454,  35.7556689342,  30.3447845805,
      44.0722732426,  52.6583276644,  62.801978458,   75.1262641723,
      76.455430839,   64.8906689342,  55.1267800454,  46.6492290249,
      54.7345181406,  65.3817970522,  77.9540192744,  93.2211621315,
      94.8003287982,  80.4355668934,  68.3145351474,  57.7961678005,
      68.1865022676,  81.4290192744,  97.0567970522,  116.0239399093,
      117.8947732426, 99.9966780045,  84.9034240363,  71.8136281179,
      85.5441213152,  102.1294954649, 121.690606576,  145.4177494331,
      147.6385827664, 125.1804875283, 106.2539002268, 89.8498185941,
      96.1774546485,  114.7628287982, 136.6572732426, 163.1844160998,
      165.4052494331, 140.147154195,  118.8872335601, 100.4831519274,
      84.8960260771,  101.2814002268, 120.5758446712, 143.9429875283,
      145.8138208617, 123.5157256236, 104.7558049887, 88.5231519274,
      74.4821371882,  88.8437018141,  105.7492573696, 126.2164002268,
      127.7955668934, 108.2308049887, 91.7764399093,  77.5437868481,
      64.6879195011,  77.1515249433,  91.8189852608,  109.5718424036,
      110.9010090703, 93.907675737,   79.6199773243,  67.2648752834,
      80.9923639456,  96.5226360544,  114.7678741497, 136.8140646259,
      138.1432312925, 116.8565646259, 98.9910884354,  83.5693197279,
      98.5988265306,  117.4964455782, 139.6940646259, 166.5116836735,
      168.0908503401, 142.1756122449, 120.4291836735, 101.6604761905,
      120.1523979592, 143.1690646259, 170.2000170068, 202.8509693878,
      204.7218027211, 173.1398979592, 146.6434693878, 123.7795238095,
      147.2319217687, 175.4200170068, 208.5176360544, 248.4885884354,
      250.7094217687, 212.0075170068, 179.5444217687, 151.5376190476,
      157.865255102,  188.0533503401, 223.4843027211, 266.255255102,
      268.4760884354, 226.9741836735, 192.177755102,  162.170952381,
      136.8619217687, 163.0214455782, 193.7190646259, 230.7700170068,
      232.6408503401, 196.6589455782, 166.4958503401, 140.489047619,
      118.3464455782, 140.9583503401, 167.4893027211, 199.5069217687,
      201.0860884354, 169.9708503401, 143.8910884354, 121.4080952381,
      101.6080102041, 121.0158333333, 143.7848809524, 171.2596428571,
      172.5888095238, 145.8735714286, 123.4842857143, 104.1849659864};
  const std::array<int, 4> in_shape = {{3, 8, 8, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x8x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.0204081633, 0.0612244898, 0.0612244898, 0.0612244898, 0.0612244898,
      0.0612244898, 0.0612244898, 0.0408163265, 0.0816326531, 0.2040816327,
      0.2040816327, 0.2040816327, 0.2040816327, 0.2040816327, 0.2040816327,
      0.1224489796, 0.0816326531, 0.2040816327, 0.2040816327, 0.2040816327,
      0.2040816327, 0.2040816327, 0.2040816327, 0.1224489796, 0.0816326531,
      0.2040816327, 0.2040816327, 0.2040816327, 0.2040816327, 0.2040816327,
      0.2040816327, 0.1224489796, 0.0816326531, 0.2040816327, 0.2040816327,
      0.2040816327, 0.2040816327, 0.2040816327, 0.2040816327, 0.1224489796,
      0.0816326531, 0.2040816327, 0.2040816327, 0.2040816327, 0.2040816327,
      0.2040816327, 0.2040816327, 0.1224489796, 0.0816326531, 0.2040816327,
      0.2040816327, 0.2040816327, 0.2040816327, 0.2040816327, 0.2040816327,
      0.1224489796, 0.0612244898, 0.1428571429, 0.1428571429, 0.1428571429,
      0.1428571429, 0.1428571429, 0.1428571429, 0.0816326531, 0.1020408163,
      0.2244897959, 0.2244897959, 0.2244897959, 0.2244897959, 0.2244897959,
      0.2244897959, 0.1224489796, 0.2448979592, 0.5306122449, 0.5306122449,
      0.5306122449, 0.5306122449, 0.5306122449, 0.5306122449, 0.2857142857,
      0.2448979592, 0.5306122449, 0.5306122449, 0.5306122449, 0.5306122449,
      0.5306122449, 0.5306122449, 0.2857142857, 0.2448979592, 0.5306122449,
      0.5306122449, 0.5306122449, 0.5306122449, 0.5306122449, 0.5306122449,
      0.2857142857, 0.2448979592, 0.5306122449, 0.5306122449, 0.5306122449,
      0.5306122449, 0.5306122449, 0.5306122449, 0.2857142857, 0.2448979592,
      0.5306122449, 0.5306122449, 0.5306122449, 0.5306122449, 0.5306122449,
      0.5306122449, 0.2857142857, 0.2448979592, 0.5306122449, 0.5306122449,
      0.5306122449, 0.5306122449, 0.5306122449, 0.5306122449, 0.2857142857,
      0.1428571429, 0.306122449,  0.306122449,  0.306122449,  0.306122449,
      0.306122449,  0.306122449,  0.1632653061, 0.1836734694, 0.387755102,
      0.387755102,  0.387755102,  0.387755102,  0.387755102,  0.387755102,
      0.2040816327, 0.4081632653, 0.8571428571, 0.8571428571, 0.8571428571,
      0.8571428571, 0.8571428571, 0.8571428571, 0.4489795918, 0.4081632653,
      0.8571428571, 0.8571428571, 0.8571428571, 0.8571428571, 0.8571428571,
      0.8571428571, 0.4489795918, 0.4081632653, 0.8571428571, 0.8571428571,
      0.8571428571, 0.8571428571, 0.8571428571, 0.8571428571, 0.4489795918,
      0.4081632653, 0.8571428571, 0.8571428571, 0.8571428571, 0.8571428571,
      0.8571428571, 0.8571428571, 0.4489795918, 0.4081632653, 0.8571428571,
      0.8571428571, 0.8571428571, 0.8571428571, 0.8571428571, 0.8571428571,
      0.4489795918, 0.4081632653, 0.8571428571, 0.8571428571, 0.8571428571,
      0.8571428571, 0.8571428571, 0.8571428571, 0.4489795918, 0.2244897959,
      0.4693877551, 0.4693877551, 0.4693877551, 0.4693877551, 0.4693877551,
      0.4693877551, 0.2448979592};
  const std::array<int, 4> in_shape = {{3, 8, 8, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x8x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      13.7274886621,  14.3043650794,  16.9026587302,  17.5880385488,
      20.8601984127,  21.6721655329,  25.9130555556,  26.8769274376,
      28.5713888889,  29.535260771,   25.0375793651,  25.8495464853,
      21.8395634921,  22.5249433107,  18.8814002268,  19.458276644,
      21.0550396825,  21.7404195011,  25.7200056689,  26.5342970522,
      31.4632596372,  32.4279478458,  38.71611678,    39.8612811791,
      41.8744501134,  43.0196145125,  36.4263548753,  37.3910430839,
      31.5854818594,  32.3997732426,  27.1783390023,  27.8637188209,
      31.6292460317,  32.4412131519,  38.4132596372,  39.3779478458,
      46.6842913832,  47.827154195,   57.0371485261,  58.3938208617,
      60.7788151927,  62.1354875283,  52.564053288,   53.7069160998,
      45.362069161,   46.3267573696,  38.8834977324,  39.6954648526,
      46.7487698413,  47.7126417234,  56.5327834467,  57.6779478458,
      68.3704818594,  69.727154195,   83.0833390023,  84.6938208617,
      87.5250056689,  89.1354875283,  75.3502437642,  76.7069160998,
      64.7815929705,  65.9267573696,  55.3601643991,  56.3240362812,
      68.0154365079,  68.97930839,    81.7994501134,  82.9446145125,
      98.3038151927,  99.6604875283,  118.6166723356, 120.227154195,
      123.0583390023, 124.6688208617, 105.2835770975, 106.6402494331,
      90.0482596372,  91.1934240363,  76.6268310658,  77.5907029478,
      65.0482936508,  65.860260771,   78.118021542,   79.0827097506,
      93.7223866213,  94.8652494331,  112.8752437642, 114.2319160998,
      116.6169104308, 117.9735827664, 99.6021485261,  100.7450113379,
      85.0668310658,  86.0315192744,  72.3025453515,  73.1145124717,
      60.5502777778,  61.2356575964,  72.6438151927,  73.458106576,
      87.0537358277,  88.0184240363,  104.7065929705, 105.8517573696,
      107.8649263039, 109.0100907029, 92.0168310658,  92.9815192744,
      78.5092913832,  79.3235827664,  66.6735770975,  67.3589569161,
      54.9587811791,  55.5356575964,  65.889053288,   66.5744331066,
      78.8942120181,  79.7061791383,  94.8042120181,  95.7680839002,
      97.4625453515,  98.4264172336,  83.0715929705,  83.8835600907,
      70.8259580499,  71.5113378685,  60.1126927438,  60.689569161,
      87.567670068,   88.1445464853,  104.6312755102, 105.3166553288,
      124.7919897959, 125.6039569161, 149.2886564626, 150.2525283447,
      151.9469897959, 152.910861678,  128.9693707483, 129.7813378685,
      109.5681802721, 110.2535600907, 92.7215816327,  93.2984580499,
      108.7836564626, 109.4690362812, 129.9493027211, 130.7635941043,
      154.9433503401, 155.9080385488, 185.2971598639, 186.442324263,
      188.4554931973, 189.6006575964, 159.9064455782, 160.8711337868,
      135.8147789116, 136.6290702948, 114.9069557823, 115.5923356009,
      135.561037415,  136.3730045351, 161.8933503401, 162.8580385488,
      192.9707312925, 194.1135941043, 230.691207483,  232.0478798186,
      234.4328741497, 235.7895464853, 198.8504931973, 199.9933560091,
      168.8421598639, 169.8068480726, 142.8152891156, 143.6272562358,
      170.1243707483, 171.0882426304, 203.1138265306, 204.2589909297,
      242.0245408163, 243.3812131519, 289.2250170068, 290.8354988662,
      293.6666836735, 295.2771655329, 249.0043027211, 250.3609750567,
      211.3626360544, 212.5078004535, 178.7357653061, 179.6996371882,
      191.391037415,  192.3549092971, 228.3804931973, 229.5256575964,
      271.9578741497, 273.3145464853, 324.7583503401, 326.3688321995,
      329.2000170068, 330.8104988662, 278.9376360544, 280.29430839,
      236.6293027211, 237.7744671202, 200.0024319728, 200.9663038549,
      168.980085034,  169.7920521542, 201.5981122449, 202.5628004535,
      240.0088265306, 241.1516893424, 286.5293027211, 287.8859750567,
      290.2709693878, 291.6276417234, 245.8885884354, 247.0314512472,
      208.5469217687, 209.5116099773, 176.2343367347, 177.0463038549,
      148.2788945578, 148.9642743764, 176.8731122449, 177.6874036281,
      210.5338265306, 211.4985147392, 251.2876360544, 252.4328004535,
      254.4459693878, 255.5911337868, 215.4969217687, 216.4616099773,
      182.7385884354, 183.5528798186, 154.4021938776, 155.0875736961,
      128.798962585,  129.3758390023, 153.617670068,  154.3030498866,
      182.8260034014, 183.6379705215, 218.1798129252, 219.1436848073,
      220.8381462585, 221.8020181406, 187.0033843537, 187.8153514739,
      158.5545748299, 159.2399546485, 133.9528741497, 134.5297505669,
      161.4078514739, 161.9847278912, 192.3598922902, 193.0452721088,
      228.7237811791, 229.5357482993, 272.6642573696, 273.6281292517,
      275.3225907029, 276.286462585,  232.9011621315, 233.7131292517,
      197.2967970522, 197.9821768707, 166.5617630385, 167.1386394558,
      196.5122732426, 197.1976530612, 234.1785997732, 234.9928911565,
      278.4234410431, 279.3881292517, 331.8782029478, 333.0233673469,
      335.0365362812, 336.1817006803, 283.3865362812, 284.3512244898,
      240.0440759637, 240.8583673469, 202.6355725624, 203.320952381,
      239.4928287982, 240.3047959184, 285.3734410431, 286.3381292517,
      339.2571712018, 340.4000340136, 404.3452664399, 405.7019387755,
      408.0869331066, 409.4436054422, 345.1369331066, 346.2797959184,
      292.3222505669, 293.2869387755, 246.7470804989, 247.559047619,
      293.4999716553, 294.4638435374, 349.6948696145, 350.8400340136,
      415.6785997732, 417.0352721088, 495.3666950113, 496.9771768707,
      499.808361678,  501.4188435374, 422.658361678,  424.0150340136,
      357.9436791383, 359.0888435374, 302.1113662132, 303.0752380952,
      314.766638322,  315.7305102041, 374.9615362812, 376.1067006803,
      445.6119331066, 446.9686054422, 530.9000283447, 532.5105102041,
      535.3416950113, 536.9521768707, 452.5916950113, 453.9483673469,
      383.210345805,  384.3555102041, 323.3780328798, 324.3419047619,
      272.9118764172, 273.7238435374, 325.0782029478, 326.0428911565,
      386.2952664399, 387.4381292517, 460.183361678,  461.5400340136,
      463.9250283447, 465.2817006803, 392.1750283447, 393.3178911565,
      332.0270124717, 332.9917006803, 280.1661281179, 280.9780952381,
      236.0075113379, 236.6928911565, 281.1024092971, 281.9167006803,
      334.0139172336, 334.9786054422, 397.8686791383, 399.0138435374,
      401.0270124717, 402.1721768707, 338.9770124717, 339.9417006803,
      286.9678854875, 287.7821768707, 242.1308106576, 242.8161904762,
      202.6391439909, 203.2160204082, 241.3462868481, 242.0316666667,
      286.7577947846, 287.5697619048, 341.5554138322, 342.5192857143,
      344.2137471655, 345.1776190476, 290.935175737,  291.7471428571,
      246.28319161,   246.9685714286, 207.7930555556, 208.3699319728};
  const std::array<int, 4> in_shape = {{3, 8, 8, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x8x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.0204081633, 0.0408163265, 0.0816326531, 0.1224489796, 0.0816326531,
      0.1224489796, 0.0816326531, 0.1224489796, 0.0816326531, 0.1224489796,
      0.0816326531, 0.1224489796, 0.0816326531, 0.1224489796, 0.0612244898,
      0.0816326531, 0.1224489796, 0.1632653061, 0.3265306122, 0.4081632653,
      0.3265306122, 0.4081632653, 0.3265306122, 0.4081632653, 0.3265306122,
      0.4081632653, 0.3265306122, 0.4081632653, 0.3265306122, 0.4081632653,
      0.2040816327, 0.2448979592, 0.1224489796, 0.1632653061, 0.3265306122,
      0.4081632653, 0.3265306122, 0.4081632653, 0.3265306122, 0.4081632653,
      0.3265306122, 0.4081632653, 0.3265306122, 0.4081632653, 0.3265306122,
      0.4081632653, 0.2040816327, 0.2448979592, 0.1224489796, 0.1632653061,
      0.3265306122, 0.4081632653, 0.3265306122, 0.4081632653, 0.3265306122,
      0.4081632653, 0.3265306122, 0.4081632653, 0.3265306122, 0.4081632653,
      0.3265306122, 0.4081632653, 0.2040816327, 0.2448979592, 0.1224489796,
      0.1632653061, 0.3265306122, 0.4081632653, 0.3265306122, 0.4081632653,
      0.3265306122, 0.4081632653, 0.3265306122, 0.4081632653, 0.3265306122,
      0.4081632653, 0.3265306122, 0.4081632653, 0.2040816327, 0.2448979592,
      0.1224489796, 0.1632653061, 0.3265306122, 0.4081632653, 0.3265306122,
      0.4081632653, 0.3265306122, 0.4081632653, 0.3265306122, 0.4081632653,
      0.3265306122, 0.4081632653, 0.3265306122, 0.4081632653, 0.2040816327,
      0.2448979592, 0.1224489796, 0.1632653061, 0.3265306122, 0.4081632653,
      0.3265306122, 0.4081632653, 0.3265306122, 0.4081632653, 0.3265306122,
      0.4081632653, 0.3265306122, 0.4081632653, 0.3265306122, 0.4081632653,
      0.2040816327, 0.2448979592, 0.1020408163, 0.1224489796, 0.2448979592,
      0.2857142857, 0.2448979592, 0.2857142857, 0.2448979592, 0.2857142857,
      0.2448979592, 0.2857142857, 0.2448979592, 0.2857142857, 0.2448979592,
      0.2857142857, 0.1428571429, 0.1632653061, 0.1836734694, 0.2040816327,
      0.4081632653, 0.4489795918, 0.4081632653, 0.4489795918, 0.4081632653,
      0.4489795918, 0.4081632653, 0.4489795918, 0.4081632653, 0.4489795918,
      0.4081632653, 0.4489795918, 0.2244897959, 0.2448979592, 0.4489795918,
      0.4897959184, 0.9795918367, 1.0612244898, 0.9795918367, 1.0612244898,
      0.9795918367, 1.0612244898, 0.9795918367, 1.0612244898, 0.9795918367,
      1.0612244898, 0.9795918367, 1.0612244898, 0.5306122449, 0.5714285714,
      0.4489795918, 0.4897959184, 0.9795918367, 1.0612244898, 0.9795918367,
      1.0612244898, 0.9795918367, 1.0612244898, 0.9795918367, 1.0612244898,
      0.9795918367, 1.0612244898, 0.9795918367, 1.0612244898, 0.5306122449,
      0.5714285714, 0.4489795918, 0.4897959184, 0.9795918367, 1.0612244898,
      0.9795918367, 1.0612244898, 0.9795918367, 1.0612244898, 0.9795918367,
      1.0612244898, 0.9795918367, 1.0612244898, 0.9795918367, 1.0612244898,
      0.5306122449, 0.5714285714, 0.4489795918, 0.4897959184, 0.9795918367,
      1.0612244898, 0.9795918367, 1.0612244898, 0.9795918367, 1.0612244898,
      0.9795918367, 1.0612244898, 0.9795918367, 1.0612244898, 0.9795918367,
      1.0612244898, 0.5306122449, 0.5714285714, 0.4489795918, 0.4897959184,
      0.9795918367, 1.0612244898, 0.9795918367, 1.0612244898, 0.9795918367,
      1.0612244898, 0.9795918367, 1.0612244898, 0.9795918367, 1.0612244898,
      0.9795918367, 1.0612244898, 0.5306122449, 0.5714285714, 0.4489795918,
      0.4897959184, 0.9795918367, 1.0612244898, 0.9795918367, 1.0612244898,
      0.9795918367, 1.0612244898, 0.9795918367, 1.0612244898, 0.9795918367,
      1.0612244898, 0.9795918367, 1.0612244898, 0.5306122449, 0.5714285714,
      0.2653061224, 0.2857142857, 0.5714285714, 0.612244898,  0.5714285714,
      0.612244898,  0.5714285714, 0.612244898,  0.5714285714, 0.612244898,
      0.5714285714, 0.612244898,  0.5714285714, 0.612244898,  0.306122449,
      0.3265306122, 0.3469387755, 0.3673469388, 0.7346938776, 0.7755102041,
      0.7346938776, 0.7755102041, 0.7346938776, 0.7755102041, 0.7346938776,
      0.7755102041, 0.7346938776, 0.7755102041, 0.7346938776, 0.7755102041,
      0.387755102,  0.4081632653, 0.7755102041, 0.8163265306, 1.6326530612,
      1.7142857143, 1.6326530612, 1.7142857143, 1.6326530612, 1.7142857143,
      1.6326530612, 1.7142857143, 1.6326530612, 1.7142857143, 1.6326530612,
      1.7142857143, 0.8571428571, 0.8979591837, 0.7755102041, 0.8163265306,
      1.6326530612, 1.7142857143, 1.6326530612, 1.7142857143, 1.6326530612,
      1.7142857143, 1.6326530612, 1.7142857143, 1.6326530612, 1.7142857143,
      1.6326530612, 1.7142857143, 0.8571428571, 0.8979591837, 0.7755102041,
      0.8163265306, 1.6326530612, 1.7142857143, 1.6326530612, 1.7142857143,
      1.6326530612, 1.7142857143, 1.6326530612, 1.7142857143, 1.6326530612,
      1.7142857143, 1.6326530612, 1.7142857143, 0.8571428571, 0.8979591837,
      0.7755102041, 0.8163265306, 1.6326530612, 1.7142857143, 1.6326530612,
      1.7142857143, 1.6326530612, 1.7142857143, 1.6326530612, 1.7142857143,
      1.6326530612, 1.7142857143, 1.6326530612, 1.7142857143, 0.8571428571,
      0.8979591837, 0.7755102041, 0.8163265306, 1.6326530612, 1.7142857143,
      1.6326530612, 1.7142857143, 1.6326530612, 1.7142857143, 1.6326530612,
      1.7142857143, 1.6326530612, 1.7142857143, 1.6326530612, 1.7142857143,
      0.8571428571, 0.8979591837, 0.7755102041, 0.8163265306, 1.6326530612,
      1.7142857143, 1.6326530612, 1.7142857143, 1.6326530612, 1.7142857143,
      1.6326530612, 1.7142857143, 1.6326530612, 1.7142857143, 1.6326530612,
      1.7142857143, 0.8571428571, 0.8979591837, 0.4285714286, 0.4489795918,
      0.8979591837, 0.9387755102, 0.8979591837, 0.9387755102, 0.8979591837,
      0.9387755102, 0.8979591837, 0.9387755102, 0.8979591837, 0.9387755102,
      0.8979591837, 0.9387755102, 0.4693877551, 0.4897959184};
  const std::array<int, 4> in_shape = {{3, 8, 8, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x8x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      26.878100907,    27.4549773243,   28.0318537415,   28.6087301587,
      33.1199376417,   33.8053174603,   34.4906972789,   35.1760770975,
      40.9084297052,   41.7203968254,   42.5323639456,   43.3443310658,
      50.862239229,    51.8261111111,   52.7899829932,   53.7538548753,
      56.1789058957,   57.1427777778,   58.1066496599,   59.070521542,
      49.26319161,     50.0751587302,   50.8871258503,   51.6990929705,
      42.9937471655,   43.6791269841,   44.3645068027,   45.0498866213,
      37.1859240363,   37.7628004535,   38.3396768707,   38.916553288,
      41.4246995465,   42.1100793651,   42.7954591837,   43.4808390023,
      50.6257199546,   51.4400113379,   52.2543027211,   53.0685941043,
      61.9618310658,   62.9265192744,   63.891207483,    64.8558956916,
      76.287069161,    77.4322335601,   78.5773979592,   79.7225623583,
      82.6037358277,   83.7489002268,   84.8940646259,   86.0392290249,
      71.888021542,    72.8527097506,   73.8173979592,   74.7820861678,
      62.3566723356,   63.1709637188,   63.985255102,    64.7995464853,
      53.6712981859,   54.3566780045,   55.0420578231,   55.7274376417,
      62.4465249433,   63.2584920635,   64.0704591837,   64.8824263039,
      75.8618310658,   76.8265192744,   77.791207483,    78.7558956916,
      92.2257199546,   93.3685827664,   94.5114455782,   95.65430839,
      112.7176247166,  114.0742970522,  115.4309693878,  116.7876417234,
      120.2009580499,  121.5576303855,  122.9143027211,  124.2709750567,
      103.9852437642,  105.128106576,   106.2709693878,  107.4138321995,
      89.7594501134,   90.724138322,    91.6888265306,   92.6535147392,
      76.9550283447,   77.7669954649,   78.578962585,    79.3909297052,
      92.5336678005,   93.4975396825,   94.4614115646,   95.4252834467,
      111.9204024943,  113.0655668934,  114.2107312925,  115.3558956916,
      135.3842913832,  136.7409637188,  138.0976360544,  139.45430839,
      164.5561961451,  166.1666780045,  167.7771598639,  169.3876417234,
      173.4395294785,  175.0500113379,  176.6604931973,  178.2709750567,
      149.3438151927,  150.7004875283,  152.0571598639,  153.4138321995,
      128.418021542,   129.563185941,   130.7083503401,  131.8535147392,
      109.7564569161,  110.7203287982,  111.6842006803,  112.6480725624,
      135.0670011338,  136.0308730159,  136.994744898,   137.95861678,
      162.4537358277,  163.5989002268,  164.7440646259,  165.8892290249,
      195.2509580499,  196.6076303855,  197.9643027211,  199.3209750567,
      235.6228628118,  237.2333446712,  238.8438265306,  240.45430839,
      244.5061961451,  246.1166780045,  247.7271598639,  249.3376417234,
      209.2104818594,  210.567154195,   211.9238265306,  213.2804988662,
      178.9513548753,  180.0965192744,  181.2416836735,  182.3868480726,
      152.2897902494,  153.2536621315,  154.2175340136,  155.1814058957,
      129.2846201814,  130.0965873016,  130.9085544218,  131.720521542,
      155.2713548753,  156.2360430839,  157.2007312925,  158.1654195011,
      186.3019104308,  187.4447732426,  188.5876360544,  189.7304988662,
      224.3938151927,  225.7504875283,  227.1071598639,  228.4638321995,
      231.8771485261,  233.2338208617,  234.5904931973,  235.9471655329,
      198.0614342404,  199.2042970522,  200.3471598639,  201.4900226757,
      169.1689739229,  170.1336621315,  171.0983503401,  172.0630385488,
      143.7931235828,  144.6050907029,  145.4170578231,  146.2290249433,
      120.415175737,   121.1005555556,  121.7859353741,  122.4713151927,
      144.4733390023,  145.2876303855,  146.1019217687,  146.9162131519,
      173.1427834467,  174.1074716553,  175.0721598639,  176.0368480726,
      208.268021542,   209.413185941,   210.5583503401,  211.7035147392,
      214.5846882086,  215.7298526077,  216.8750170068,  218.0201814059,
      183.0689739229,  184.0336621315,  184.9983503401,  185.9630385488,
      156.2042913832,  157.0185827664,  157.8328741497,  158.6471655329,
      132.6617743764,  133.347154195,   134.0325340136,  134.7179138322,
      109.340685941,   109.9175623583,  110.4944387755,  111.0713151927,
      131.0927267574,  131.778106576,   132.4634863946,  133.1488662132,
      156.9764569161,  157.7884240363,  158.6003911565,  159.4123582766,
      188.6445521542,  189.6084240363,  190.5722959184,  191.5361678005,
      193.9612188209,  194.9250907029,  195.888962585,   196.8528344671,
      165.3312188209,  166.143185941,   166.9551530612,  167.7671201814,
      140.9665362812,  141.6519160998,  142.3372959184,  143.022675737,
      119.6485090703,  120.2253854875,  120.8022619048,  121.379138322,
      174.5584637188,  175.1353401361,  175.7122165533,  176.2890929705,
      208.5771712018,  209.2625510204,  209.947930839,   210.6333106576,
      248.7720124717,  249.5839795918,  250.395946712,   251.2079138322,
      297.6134410431,  298.5773129252,  299.5411848073,  300.5050566893,
      302.9301077098,  303.8939795918,  304.8578514739,  305.821723356,
      257.1267743764,  257.9387414966,  258.7507086168,  259.562675737,
      218.4509807256,  219.1363605442,  219.8217403628,  220.5071201814,
      184.8662868481,  185.4431632653,  186.0200396825,  186.5969160998,
      216.8819331066,  217.5673129252,  218.2526927438,  218.9380725624,
      259.084314059,   259.8986054422,  260.7128968254,  261.5271882086,
      308.9220124717,  309.8867006803,  310.8513888889,  311.8160770975,
      369.4491553288,  370.5943197279,  371.739484127,   372.8846485261,
      375.7658219955,  376.9109863946,  378.0561507937,  379.2013151927,
      318.8482029478,  319.8128911565,  320.7775793651,  321.7422675737,
      270.8152664399,  271.6295578231,  272.4438492063,  273.2581405896,
      229.128531746,   229.8139115646,  230.4992913832,  231.1846712018,
      270.3101077098,  271.1220748299,  271.9340419501,  272.7460090703,
      322.8220124717,  323.7867006803,  324.7513888889,  325.7160770975,
      384.7985997732,  385.941462585,   387.0843253968,  388.2271882086,
      460.0257426304,  461.382414966,   462.7390873016,  464.0957596372,
      467.5090759637,  468.8657482993,  470.2224206349,  471.5790929705,
      396.5581235828,  397.7009863946,  398.8438492063,  399.9867120181,
      336.7196315193,  337.6843197279,  338.6490079365,  339.6136961451,
      284.8186111111,  285.6305782313,  286.4425453515,  287.2545124717,
      339.2848696145,  340.2487414966,  341.2126133787,  342.1764852608,
      405.0824886621,  406.2276530612,  407.3728174603,  408.5179818594,
      482.6924092971,  484.0490816327,  485.4057539683,  486.7624263039,
      576.8395521542,  578.4500340136,  580.060515873,   581.6709977324,
      585.7228854875,  587.3333673469,  588.9438492063,  590.5543310658,
      496.6519331066,  498.0086054422,  499.3652777778,  500.7219501134,
      421.5801077098,  422.7252721088,  423.8704365079,  425.015600907,
      356.5076587302,  357.4715306122,  358.4354024943,  359.3992743764,
      381.8182029478,  382.7820748299,  383.745946712,   384.7098185941,
      455.6158219955,  456.7609863946,  457.9061507937,  459.0513151927,
      542.5590759637,  543.9157482993,  545.2724206349,  546.6290929705,
      647.9062188209,  649.5167006803,  651.1271825397,  652.7376643991,
      656.7895521542,  658.4000340136,  660.010515873,   661.6209977324,
      556.5185997732,  557.8752721088,  559.2319444444,  560.58861678,
      472.1134410431,  473.2586054422,  474.4037698413,  475.5489342404,
      399.0409920635,  400.0048639456,  400.9687358277,  401.9326077098,
      337.1482029478,  337.960170068,   338.7721371882,  339.5841043084,
      402.2315362812,  403.1962244898,  404.1609126984,  405.125600907,
      478.8747902494,  480.0176530612,  481.160515873,   482.3033786848,
      571.7019331066,  573.0586054422,  574.4152777778,  575.7719501134,
      579.1852664399,  580.5419387755,  581.8986111111,  583.2552834467,
      490.634314059,   491.7771768707,  492.9200396825,  494.0629024943,
      416.1291553288,  417.0938435374,  418.058531746,   419.0232199546,
      351.6567063492,  352.4686734694,  353.2806405896,  354.0926077098,
      295.8724092971,  296.5577891156,  297.2431689342,  297.9285487528,
      352.9319331066,  353.7462244898,  354.560515873,   355.3748072562,
      420.1029648526,  421.0676530612,  422.0323412698,  422.9970294785,
      501.4301077098,  502.5752721088,  503.7204365079,  504.865600907,
      507.7467743764,  508.8919387755,  510.0371031746,  511.1822675737,
      430.0291553288,  430.9938435374,  431.958531746,   432.9232199546,
      364.6628854875,  365.4771768707,  366.291468254,   367.1057596372,
      308.1190079365,  308.8043877551,  309.4897675737,  310.1751473923,
      257.0210487528,  257.5979251701,  258.1748015873,  258.7516780045,
      306.5499603175,  307.2353401361,  307.9207199546,  308.6060997732,
      364.8400396825,  365.6520068027,  366.4639739229,  367.2759410431,
      435.3957539683,  436.3596258503,  437.3234977324,  438.2873696145,
      440.7124206349,  441.676292517,   442.6401643991,  443.6040362812,
      373.1948015873,  374.0067687075,  374.8187358277,  375.6307029478,
      316.4237698413,  317.1091496599,  317.7945294785,  318.4799092971,
      267.3288718821,  267.9057482993,  268.4826247166,  269.0595011338,
      322.2388265306,  322.8157029478,  323.3925793651,  323.9694557823,
      384.0344047619,  384.7197845805,  385.4051643991,  386.0905442177,
      456.6355952381,  457.4475623583,  458.2595294785,  459.0714965986,
      544.3646428571,  545.3285147392,  546.2923866213,  547.2562585034,
      549.6813095238,  550.6451814059,  551.609053288,   552.5729251701,
      464.9903571429,  465.802324263,   466.6142913832,  467.4262585034,
      393.9082142857,  394.5935941043,  395.2789739229,  395.9643537415,
      332.5466496599,  333.1235260771,  333.7004024943,  334.2772789116,
      392.3391666667,  393.0245464853,  393.7099263039,  394.3953061224,
      467.5429081633,  468.3571995465,  469.1714909297,  469.9857823129,
      555.8821938776,  556.8468820862,  557.8115702948,  558.7762585034,
      662.6112414966,  663.7564058957,  664.9015702948,  666.0467346939,
      668.9279081633,  670.0730725624,  671.2182369615,  672.3634013605,
      565.8083843537,  566.7730725624,  567.737760771,   568.7024489796,
      479.2738605442,  480.0881519274,  480.9024433107,  481.7167346939,
      404.5857653061,  405.2711451247,  405.9565249433,  406.6419047619,
      478.1736904762,  478.9856575964,  479.7976247166,  480.6095918367,
      569.7821938776,  570.7468820862,  571.7115702948,  572.6762585034,
      677.3714795918,  678.5143424036,  679.6572052154,  680.8000680272,
      807.3338605442,  808.6905328798,  810.0472052154,  811.403877551,
      814.8171938776,  816.1738662132,  817.5305385488,  818.8872108844,
      689.1310034014,  690.2738662132,  691.4167290249,  692.5595918367,
      583.6798129252,  584.6445011338,  585.6091893424,  586.573877551,
      492.6821938776,  493.4941609977,  494.3061281179,  495.1180952381,
      586.0360714286,  586.9999433107,  587.9638151927,  588.9276870748,
      698.2445748299,  699.389739229,   700.5349036281,  701.6800680272,
      830.0005272109,  831.3571995465,  832.7138718821,  834.0705442177,
      989.1229081633,  990.7333900227,  992.3438718821,  993.9543537415,
      998.0062414966,  999.616723356,   1001.2272052154, 1002.8376870748,
      843.9600510204,  845.316723356,   846.6733956916,  848.0300680272,
      714.7421938776,  715.8873582766,  717.0325226757,  718.1776870748,
      603.2588605442,  604.2227324263,  605.1866043084,  606.1504761905,
      628.5694047619,  629.533276644,   630.4971485261,  631.4610204082,
      748.7779081633,  749.9230725624,  751.0682369615,  752.2134013605,
      889.8671938776,  891.2238662132,  892.5805385488,  893.9372108844,
      1060.1895748299, 1061.8000566893, 1063.4105385488, 1065.0210204082,
      1069.0729081633, 1070.6833900227, 1072.2938718821, 1073.9043537415,
      903.8267176871,  905.1833900227,  906.5400623583,  907.8967346939,
      765.2755272109,  766.42069161,    767.5658560091,  768.7110204082,
      645.7921938776,  646.7560657596,  647.7199376417,  648.6838095238,
      545.0117857143,  545.8237528345,  546.6357199546,  547.4476870748,
      649.1917176871,  650.1564058957,  651.1210941043,  652.0857823129,
      771.447670068,   772.5905328798,  773.7333956916,  774.8762585034,
      919.0100510204,  920.366723356,   921.7233956916,  923.0800680272,
      926.4933843537,  927.8500566893,  929.2067290249,  930.5634013605,
      783.2071938776,  784.3500566893,  785.4929195011,  786.6357823129,
      663.0893367347,  664.0540249433,  665.0187131519,  665.9834013605,
      559.5202891156,  560.3322562358,  561.144223356,   561.9561904762,
      471.3296428571,  472.0150226757,  472.7004024943,  473.3857823129,
      561.3905272109,  562.2048185941,  563.0191099773,  563.8334013605,
      667.0631462585,  668.0278344671,  668.9925226757,  669.9572108844,
      794.5921938776,  795.7373582766,  796.8825226757,  798.0276870748,
      800.9088605442,  802.0540249433,  803.1991893424,  804.3443537415,
      676.9893367347,  677.9540249433,  678.9187131519,  679.8834013605,
      573.1214795918,  573.9357709751,  574.7500623583,  575.5643537415,
      483.5762414966,  484.2616213152,  484.9470011338,  485.6323809524,
      404.7014115646,  405.2782879819,  405.8551643991,  406.4320408163,
      482.0071938776,  482.6925736961,  483.3779535147,  484.0633333333,
      572.703622449,   573.5155895692,  574.3275566893,  575.1395238095,
      682.1469557823,  683.1108276644,  684.0746995465,  685.0385714286,
      687.463622449,   688.4274943311,  689.3913662132,  690.3552380952,
      581.0583843537,  581.8703514739,  582.6823185941,  583.4942857143,
      491.8810034014,  492.56638322,    493.2517630385,  493.9371428571,
      415.0092346939,  415.5861111111,  416.1629875283,  416.7398639456};
  const std::array<int, 4> in_shape = {{3, 8, 8, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x8x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.0204081633, 0.0408163265, 0.0612244898, 0.0816326531, 0.1224489796,
      0.1632653061, 0.2040816327, 0.2448979592, 0.1224489796, 0.1632653061,
      0.2040816327, 0.2448979592, 0.1224489796, 0.1632653061, 0.2040816327,
      0.2448979592, 0.1224489796, 0.1632653061, 0.2040816327, 0.2448979592,
      0.1224489796, 0.1632653061, 0.2040816327, 0.2448979592, 0.1224489796,
      0.1632653061, 0.2040816327, 0.2448979592, 0.1020408163, 0.1224489796,
      0.1428571429, 0.1632653061, 0.2040816327, 0.2448979592, 0.2857142857,
      0.3265306122, 0.5714285714, 0.6530612245, 0.7346938776, 0.8163265306,
      0.5714285714, 0.6530612245, 0.7346938776, 0.8163265306, 0.5714285714,
      0.6530612245, 0.7346938776, 0.8163265306, 0.5714285714, 0.6530612245,
      0.7346938776, 0.8163265306, 0.5714285714, 0.6530612245, 0.7346938776,
      0.8163265306, 0.5714285714, 0.6530612245, 0.7346938776, 0.8163265306,
      0.3673469388, 0.4081632653, 0.4489795918, 0.4897959184, 0.2040816327,
      0.2448979592, 0.2857142857, 0.3265306122, 0.5714285714, 0.6530612245,
      0.7346938776, 0.8163265306, 0.5714285714, 0.6530612245, 0.7346938776,
      0.8163265306, 0.5714285714, 0.6530612245, 0.7346938776, 0.8163265306,
      0.5714285714, 0.6530612245, 0.7346938776, 0.8163265306, 0.5714285714,
      0.6530612245, 0.7346938776, 0.8163265306, 0.5714285714, 0.6530612245,
      0.7346938776, 0.8163265306, 0.3673469388, 0.4081632653, 0.4489795918,
      0.4897959184, 0.2040816327, 0.2448979592, 0.2857142857, 0.3265306122,
      0.5714285714, 0.6530612245, 0.7346938776, 0.8163265306, 0.5714285714,
      0.6530612245, 0.7346938776, 0.8163265306, 0.5714285714, 0.6530612245,
      0.7346938776, 0.8163265306, 0.5714285714, 0.6530612245, 0.7346938776,
      0.8163265306, 0.5714285714, 0.6530612245, 0.7346938776, 0.8163265306,
      0.5714285714, 0.6530612245, 0.7346938776, 0.8163265306, 0.3673469388,
      0.4081632653, 0.4489795918, 0.4897959184, 0.2040816327, 0.2448979592,
      0.2857142857, 0.3265306122, 0.5714285714, 0.6530612245, 0.7346938776,
      0.8163265306, 0.5714285714, 0.6530612245, 0.7346938776, 0.8163265306,
      0.5714285714, 0.6530612245, 0.7346938776, 0.8163265306, 0.5714285714,
      0.6530612245, 0.7346938776, 0.8163265306, 0.5714285714, 0.6530612245,
      0.7346938776, 0.8163265306, 0.5714285714, 0.6530612245, 0.7346938776,
      0.8163265306, 0.3673469388, 0.4081632653, 0.4489795918, 0.4897959184,
      0.2040816327, 0.2448979592, 0.2857142857, 0.3265306122, 0.5714285714,
      0.6530612245, 0.7346938776, 0.8163265306, 0.5714285714, 0.6530612245,
      0.7346938776, 0.8163265306, 0.5714285714, 0.6530612245, 0.7346938776,
      0.8163265306, 0.5714285714, 0.6530612245, 0.7346938776, 0.8163265306,
      0.5714285714, 0.6530612245, 0.7346938776, 0.8163265306, 0.5714285714,
      0.6530612245, 0.7346938776, 0.8163265306, 0.3673469388, 0.4081632653,
      0.4489795918, 0.4897959184, 0.2040816327, 0.2448979592, 0.2857142857,
      0.3265306122, 0.5714285714, 0.6530612245, 0.7346938776, 0.8163265306,
      0.5714285714, 0.6530612245, 0.7346938776, 0.8163265306, 0.5714285714,
      0.6530612245, 0.7346938776, 0.8163265306, 0.5714285714, 0.6530612245,
      0.7346938776, 0.8163265306, 0.5714285714, 0.6530612245, 0.7346938776,
      0.8163265306, 0.5714285714, 0.6530612245, 0.7346938776, 0.8163265306,
      0.3673469388, 0.4081632653, 0.4489795918, 0.4897959184, 0.1836734694,
      0.2040816327, 0.2244897959, 0.2448979592, 0.4489795918, 0.4897959184,
      0.5306122449, 0.5714285714, 0.4489795918, 0.4897959184, 0.5306122449,
      0.5714285714, 0.4489795918, 0.4897959184, 0.5306122449, 0.5714285714,
      0.4489795918, 0.4897959184, 0.5306122449, 0.5714285714, 0.4489795918,
      0.4897959184, 0.5306122449, 0.5714285714, 0.4489795918, 0.4897959184,
      0.5306122449, 0.5714285714, 0.2653061224, 0.2857142857, 0.306122449,
      0.3265306122, 0.3469387755, 0.3673469388, 0.387755102,  0.4081632653,
      0.7755102041, 0.8163265306, 0.8571428571, 0.8979591837, 0.7755102041,
      0.8163265306, 0.8571428571, 0.8979591837, 0.7755102041, 0.8163265306,
      0.8571428571, 0.8979591837, 0.7755102041, 0.8163265306, 0.8571428571,
      0.8979591837, 0.7755102041, 0.8163265306, 0.8571428571, 0.8979591837,
      0.7755102041, 0.8163265306, 0.8571428571, 0.8979591837, 0.4285714286,
      0.4489795918, 0.4693877551, 0.4897959184, 0.8571428571, 0.8979591837,
      0.9387755102, 0.9795918367, 1.8775510204, 1.9591836735, 2.0408163265,
      2.1224489796, 1.8775510204, 1.9591836735, 2.0408163265, 2.1224489796,
      1.8775510204, 1.9591836735, 2.0408163265, 2.1224489796, 1.8775510204,
      1.9591836735, 2.0408163265, 2.1224489796, 1.8775510204, 1.9591836735,
      2.0408163265, 2.1224489796, 1.8775510204, 1.9591836735, 2.0408163265,
      2.1224489796, 1.0204081633, 1.0612244898, 1.1020408163, 1.1428571429,
      0.8571428571, 0.8979591837, 0.9387755102, 0.9795918367, 1.8775510204,
      1.9591836735, 2.0408163265, 2.1224489796, 1.8775510204, 1.9591836735,
      2.0408163265, 2.1224489796, 1.8775510204, 1.9591836735, 2.0408163265,
      2.1224489796, 1.8775510204, 1.9591836735, 2.0408163265, 2.1224489796,
      1.8775510204, 1.9591836735, 2.0408163265, 2.1224489796, 1.8775510204,
      1.9591836735, 2.0408163265, 2.1224489796, 1.0204081633, 1.0612244898,
      1.1020408163, 1.1428571429, 0.8571428571, 0.8979591837, 0.9387755102,
      0.9795918367, 1.8775510204, 1.9591836735, 2.0408163265, 2.1224489796,
      1.8775510204, 1.9591836735, 2.0408163265, 2.1224489796, 1.8775510204,
      1.9591836735, 2.0408163265, 2.1224489796, 1.8775510204, 1.9591836735,
      2.0408163265, 2.1224489796, 1.8775510204, 1.9591836735, 2.0408163265,
      2.1224489796, 1.8775510204, 1.9591836735, 2.0408163265, 2.1224489796,
      1.0204081633, 1.0612244898, 1.1020408163, 1.1428571429, 0.8571428571,
      0.8979591837, 0.9387755102, 0.9795918367, 1.8775510204, 1.9591836735,
      2.0408163265, 2.1224489796, 1.8775510204, 1.9591836735, 2.0408163265,
      2.1224489796, 1.8775510204, 1.9591836735, 2.0408163265, 2.1224489796,
      1.8775510204, 1.9591836735, 2.0408163265, 2.1224489796, 1.8775510204,
      1.9591836735, 2.0408163265, 2.1224489796, 1.8775510204, 1.9591836735,
      2.0408163265, 2.1224489796, 1.0204081633, 1.0612244898, 1.1020408163,
      1.1428571429, 0.8571428571, 0.8979591837, 0.9387755102, 0.9795918367,
      1.8775510204, 1.9591836735, 2.0408163265, 2.1224489796, 1.8775510204,
      1.9591836735, 2.0408163265, 2.1224489796, 1.8775510204, 1.9591836735,
      2.0408163265, 2.1224489796, 1.8775510204, 1.9591836735, 2.0408163265,
      2.1224489796, 1.8775510204, 1.9591836735, 2.0408163265, 2.1224489796,
      1.8775510204, 1.9591836735, 2.0408163265, 2.1224489796, 1.0204081633,
      1.0612244898, 1.1020408163, 1.1428571429, 0.8571428571, 0.8979591837,
      0.9387755102, 0.9795918367, 1.8775510204, 1.9591836735, 2.0408163265,
      2.1224489796, 1.8775510204, 1.9591836735, 2.0408163265, 2.1224489796,
      1.8775510204, 1.9591836735, 2.0408163265, 2.1224489796, 1.8775510204,
      1.9591836735, 2.0408163265, 2.1224489796, 1.8775510204, 1.9591836735,
      2.0408163265, 2.1224489796, 1.8775510204, 1.9591836735, 2.0408163265,
      2.1224489796, 1.0204081633, 1.0612244898, 1.1020408163, 1.1428571429,
      0.5102040816, 0.5306122449, 0.5510204082, 0.5714285714, 1.1020408163,
      1.1428571429, 1.1836734694, 1.2244897959, 1.1020408163, 1.1428571429,
      1.1836734694, 1.2244897959, 1.1020408163, 1.1428571429, 1.1836734694,
      1.2244897959, 1.1020408163, 1.1428571429, 1.1836734694, 1.2244897959,
      1.1020408163, 1.1428571429, 1.1836734694, 1.2244897959, 1.1020408163,
      1.1428571429, 1.1836734694, 1.2244897959, 0.5918367347, 0.612244898,
      0.6326530612, 0.6530612245, 0.6734693878, 0.693877551,  0.7142857143,
      0.7346938776, 1.4285714286, 1.4693877551, 1.5102040816, 1.5510204082,
      1.4285714286, 1.4693877551, 1.5102040816, 1.5510204082, 1.4285714286,
      1.4693877551, 1.5102040816, 1.5510204082, 1.4285714286, 1.4693877551,
      1.5102040816, 1.5510204082, 1.4285714286, 1.4693877551, 1.5102040816,
      1.5510204082, 1.4285714286, 1.4693877551, 1.5102040816, 1.5510204082,
      0.7551020408, 0.7755102041, 0.7959183673, 0.8163265306, 1.5102040816,
      1.5510204082, 1.5918367347, 1.6326530612, 3.1836734694, 3.2653061224,
      3.3469387755, 3.4285714286, 3.1836734694, 3.2653061224, 3.3469387755,
      3.4285714286, 3.1836734694, 3.2653061224, 3.3469387755, 3.4285714286,
      3.1836734694, 3.2653061224, 3.3469387755, 3.4285714286, 3.1836734694,
      3.2653061224, 3.3469387755, 3.4285714286, 3.1836734694, 3.2653061224,
      3.3469387755, 3.4285714286, 1.6734693878, 1.7142857143, 1.7551020408,
      1.7959183673, 1.5102040816, 1.5510204082, 1.5918367347, 1.6326530612,
      3.1836734694, 3.2653061224, 3.3469387755, 3.4285714286, 3.1836734694,
      3.2653061224, 3.3469387755, 3.4285714286, 3.1836734694, 3.2653061224,
      3.3469387755, 3.4285714286, 3.1836734694, 3.2653061224, 3.3469387755,
      3.4285714286, 3.1836734694, 3.2653061224, 3.3469387755, 3.4285714286,
      3.1836734694, 3.2653061224, 3.3469387755, 3.4285714286, 1.6734693878,
      1.7142857143, 1.7551020408, 1.7959183673, 1.5102040816, 1.5510204082,
      1.5918367347, 1.6326530612, 3.1836734694, 3.2653061224, 3.3469387755,
      3.4285714286, 3.1836734694, 3.2653061224, 3.3469387755, 3.4285714286,
      3.1836734694, 3.2653061224, 3.3469387755, 3.4285714286, 3.1836734694,
      3.2653061224, 3.3469387755, 3.4285714286, 3.1836734694, 3.2653061224,
      3.3469387755, 3.4285714286, 3.1836734694, 3.2653061224, 3.3469387755,
      3.4285714286, 1.6734693878, 1.7142857143, 1.7551020408, 1.7959183673,
      1.5102040816, 1.5510204082, 1.5918367347, 1.6326530612, 3.1836734694,
      3.2653061224, 3.3469387755, 3.4285714286, 3.1836734694, 3.2653061224,
      3.3469387755, 3.4285714286, 3.1836734694, 3.2653061224, 3.3469387755,
      3.4285714286, 3.1836734694, 3.2653061224, 3.3469387755, 3.4285714286,
      3.1836734694, 3.2653061224, 3.3469387755, 3.4285714286, 3.1836734694,
      3.2653061224, 3.3469387755, 3.4285714286, 1.6734693878, 1.7142857143,
      1.7551020408, 1.7959183673, 1.5102040816, 1.5510204082, 1.5918367347,
      1.6326530612, 3.1836734694, 3.2653061224, 3.3469387755, 3.4285714286,
      3.1836734694, 3.2653061224, 3.3469387755, 3.4285714286, 3.1836734694,
      3.2653061224, 3.3469387755, 3.4285714286, 3.1836734694, 3.2653061224,
      3.3469387755, 3.4285714286, 3.1836734694, 3.2653061224, 3.3469387755,
      3.4285714286, 3.1836734694, 3.2653061224, 3.3469387755, 3.4285714286,
      1.6734693878, 1.7142857143, 1.7551020408, 1.7959183673, 1.5102040816,
      1.5510204082, 1.5918367347, 1.6326530612, 3.1836734694, 3.2653061224,
      3.3469387755, 3.4285714286, 3.1836734694, 3.2653061224, 3.3469387755,
      3.4285714286, 3.1836734694, 3.2653061224, 3.3469387755, 3.4285714286,
      3.1836734694, 3.2653061224, 3.3469387755, 3.4285714286, 3.1836734694,
      3.2653061224, 3.3469387755, 3.4285714286, 3.1836734694, 3.2653061224,
      3.3469387755, 3.4285714286, 1.6734693878, 1.7142857143, 1.7551020408,
      1.7959183673, 0.8367346939, 0.8571428571, 0.8775510204, 0.8979591837,
      1.7551020408, 1.7959183673, 1.8367346939, 1.8775510204, 1.7551020408,
      1.7959183673, 1.8367346939, 1.8775510204, 1.7551020408, 1.7959183673,
      1.8367346939, 1.8775510204, 1.7551020408, 1.7959183673, 1.8367346939,
      1.8775510204, 1.7551020408, 1.7959183673, 1.8367346939, 1.8775510204,
      1.7551020408, 1.7959183673, 1.8367346939, 1.8775510204, 0.9183673469,
      0.9387755102, 0.9591836735, 0.9795918367};
  const std::array<int, 4> in_shape = {{3, 8, 8, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x8x9x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      7.8827721088,   9.6620238095,   11.5497789116,  13.8787471655,
      14.4712471655,  16.309223356,   14.4866043084,  12.8158560091,
      11.0366043084,  12.0348129252,  14.6507993197,  17.3956972789,
      20.7484750567,  21.2766893424,  23.6360941043,  20.8849036281,
      18.3978287982,  15.7818424036,  18.0181462585,  21.8246088435,
      25.783792517,   30.5810147392,  30.9592290249,  34.0019671202,
      29.9174433107,  26.2637018141,  22.457239229,   26.5652891156,
      32.0574659864,  37.7309353741,  44.5614909297,  44.6697052154,
      48.6224433107,  42.6379195011,  37.3270351474,  31.8348582766,
      38.5277891156,  46.2699659864,  54.1934353741,  63.6489909297,
      62.9697052154,  67.7099433107,  59.1004195011,  51.5395351474,
      43.7973582766,  36.8163605442,  44.158537415,   51.6534353741,
      60.5756575964,  59.7163718821,  63.9966099773,  55.7870861678,
      48.5976303855,  41.2554535147,  34.2508843537,  41.0454421769,
      47.9689115646,  56.1966893424,  55.2624036281,  59.08430839,
      51.4581179138,  44.7924716553,  37.9979138322,  31.0753741497,
      37.2168707483,  43.4668707483,  50.8851247166,  49.9508390023,
      53.315600907,   46.4036961451,  40.3707029478,  34.2292063492,
      49.4178741497,  59.0093707483,  68.7093707483,  80.1526247166,
      78.0108390023,  82.583100907,   71.6461961451,  62.1632029478,
      52.5717063492,  61.3821598639,  73.2797789116,  85.3063095238,
      99.4876587302,  96.7673015873,  102.3752777778, 88.795515873,
      77.02680839,    65.1291893424,  76.4797789116,  91.2821598639,
      106.2372619048, 123.8630555556, 120.3926984127, 127.2840079365,
      110.3709126984, 95.7212528345,  80.9188718821,  95.9640646259,
      114.5093027211, 133.2358333333, 155.2949603175, 150.8346031746,
      159.3559126984, 138.1428174603, 119.7788718821, 101.2336337868,
      107.9265646259, 128.7218027211, 149.6983333333, 174.3824603175,
      169.1346031746, 178.4434126984, 154.6053174603, 133.9913718821,
      113.1961337868, 95.2779931973,  113.6160884354, 132.1069047619,
      153.8576984127, 149.1498412698, 157.2786507937, 136.2405555556,
      118.0551814059, 99.7170861678,  83.5982312925,  99.6744217687,
      115.8795238095, 134.9358730159, 130.753015873,  137.8234920635,
      119.3687301587, 103.4214512472, 87.345260771,   72.6104761905,
      86.5642176871,  100.626462585,  117.1590022676, 113.490430839,
      119.589478458,  103.5632879819, 89.7180498866,  75.76430839,
      90.9529761905,  108.3567176871, 125.868962585,  146.4265022676,
      141.550430839,  148.856978458,  128.8057879819, 111.5105498866,
      94.10680839,    110.7295068027, 131.9087585034, 153.2169217687,
      178.2268424036, 172.2579138322, 181.1144614512, 156.7061281179,
      135.6557879819, 114.4765362812, 134.9414115646, 160.7397108844,
      186.6907312925, 217.1450963719, 209.8261678005, 220.5660487528,
      190.8243820862, 165.1788038549, 139.3805045351, 165.3628401361,
      196.9611394558, 228.7407312925, 266.0284297052, 256.9995011338,
      270.0893820862, 233.6477154195, 202.2307086168, 170.6324092971,
      177.3253401361, 211.1736394558, 245.2032312925, 285.1159297052,
      275.2995011338, 289.1768820862, 250.1102154195, 216.4432086168,
      182.5949092971, 153.7396258503, 183.0736394558, 212.5603741497,
      247.139739229,  238.5833106576, 250.56069161,   216.6940249433,
      187.5127324263, 158.1787188209, 132.9455782313, 158.3034013605,
      183.7901360544, 213.6750566893, 206.2436281179, 216.562675737,
      187.2793424036, 162.050430839,  136.6926077098, 114.1455782313,
      135.9115646259, 157.7860544218, 183.4328798186, 177.0300226757,
      185.8633560091, 160.7228798186, 139.0653968254, 117.2994104308};
  const std::array<int, 4> in_shape = {{3, 8, 9, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x8x9x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.0204081633, 0.0612244898, 0.1224489796, 0.1224489796, 0.1224489796,
      0.1224489796, 0.1224489796, 0.1020408163, 0.0612244898, 0.1020408163,
      0.2448979592, 0.4285714286, 0.4285714286, 0.4285714286, 0.4285714286,
      0.4285714286, 0.3265306122, 0.1836734694, 0.1020408163, 0.2448979592,
      0.4285714286, 0.4285714286, 0.4285714286, 0.4285714286, 0.4285714286,
      0.3265306122, 0.1836734694, 0.1020408163, 0.2448979592, 0.4285714286,
      0.4285714286, 0.4285714286, 0.4285714286, 0.4285714286, 0.3265306122,
      0.1836734694, 0.1020408163, 0.2448979592, 0.4285714286, 0.4285714286,
      0.4285714286, 0.4285714286, 0.4285714286, 0.3265306122, 0.1836734694,
      0.1020408163, 0.2448979592, 0.4285714286, 0.4285714286, 0.4285714286,
      0.4285714286, 0.4285714286, 0.3265306122, 0.1836734694, 0.1020408163,
      0.2448979592, 0.4285714286, 0.4285714286, 0.4285714286, 0.4285714286,
      0.4285714286, 0.3265306122, 0.1836734694, 0.0816326531, 0.1836734694,
      0.306122449,  0.306122449,  0.306122449,  0.306122449,  0.306122449,
      0.2244897959, 0.1224489796, 0.1428571429, 0.306122449,  0.4897959184,
      0.4897959184, 0.4897959184, 0.4897959184, 0.4897959184, 0.3469387755,
      0.1836734694, 0.3469387755, 0.7346938776, 1.1632653061, 1.1632653061,
      1.1632653061, 1.1632653061, 1.1632653061, 0.8163265306, 0.4285714286,
      0.3469387755, 0.7346938776, 1.1632653061, 1.1632653061, 1.1632653061,
      1.1632653061, 1.1632653061, 0.8163265306, 0.4285714286, 0.3469387755,
      0.7346938776, 1.1632653061, 1.1632653061, 1.1632653061, 1.1632653061,
      1.1632653061, 0.8163265306, 0.4285714286, 0.3469387755, 0.7346938776,
      1.1632653061, 1.1632653061, 1.1632653061, 1.1632653061, 1.1632653061,
      0.8163265306, 0.4285714286, 0.3469387755, 0.7346938776, 1.1632653061,
      1.1632653061, 1.1632653061, 1.1632653061, 1.1632653061, 0.8163265306,
      0.4285714286, 0.3469387755, 0.7346938776, 1.1632653061, 1.1632653061,
      1.1632653061, 1.1632653061, 1.1632653061, 0.8163265306, 0.4285714286,
      0.2040816327, 0.4285714286, 0.6734693878, 0.6734693878, 0.6734693878,
      0.6734693878, 0.6734693878, 0.4693877551, 0.2448979592, 0.2653061224,
      0.5510204082, 0.8571428571, 0.8571428571, 0.8571428571, 0.8571428571,
      0.8571428571, 0.5918367347, 0.306122449,  0.5918367347, 1.2244897959,
      1.8979591837, 1.8979591837, 1.8979591837, 1.8979591837, 1.8979591837,
      1.306122449,  0.6734693878, 0.5918367347, 1.2244897959, 1.8979591837,
      1.8979591837, 1.8979591837, 1.8979591837, 1.8979591837, 1.306122449,
      0.6734693878, 0.5918367347, 1.2244897959, 1.8979591837, 1.8979591837,
      1.8979591837, 1.8979591837, 1.8979591837, 1.306122449,  0.6734693878,
      0.5918367347, 1.2244897959, 1.8979591837, 1.8979591837, 1.8979591837,
      1.8979591837, 1.8979591837, 1.306122449,  0.6734693878, 0.5918367347,
      1.2244897959, 1.8979591837, 1.8979591837, 1.8979591837, 1.8979591837,
      1.8979591837, 1.306122449,  0.6734693878, 0.5918367347, 1.2244897959,
      1.8979591837, 1.8979591837, 1.8979591837, 1.8979591837, 1.8979591837,
      1.306122449,  0.6734693878, 0.3265306122, 0.6734693878, 1.0408163265,
      1.0408163265, 1.0408163265, 1.0408163265, 1.0408163265, 0.7142857143,
      0.3673469388};
  const std::array<int, 4> in_shape = {{3, 8, 9, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x8x9x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      15.1886678005,  15.7655442177,  18.6386678005,  19.324047619,
      22.3056746032,  23.0995578231,  26.8370238095,  27.7574943311,
      28.06,          28.9424943311,  31.6979761905,  32.618446712,
      28.1793253968,  28.9732086168,  24.9463321995,  25.6317120181,
      21.4963321995,  22.0732086168,  23.3842460317,  24.0696258503,
      28.4873072562,  29.3015986395,  33.84819161,    34.7913945578,
      40.4033503401,  41.4969501134,  41.5048979592,  42.5533786848,
      46.1785884354,  47.2721882086,  40.8266043084,  41.7698072562,
      35.9813662132,  36.7956575964,  30.8783049887,  31.5636848073,
      35.2243253968,  36.036292517,   42.6845294785,  43.6492176871,
      50.450175737,   51.567585034,   59.8664455782,  61.1620294785,
      60.6763265306,  61.9184580499,  66.7083503401,  68.0039342404,
      58.7174773243,  59.8348866213,  51.5627154195,  52.5274036281,
      44.1025113379,  44.914478458,   52.1667063492,  53.1305782313,
      62.9697675737,  64.1149319728,  74.1354138322,  75.4618707483,
      87.5850170068,  89.1229818594,  87.8648979592,  89.3394104308,
      95.7069217687,  97.2448866213,  83.9493820862,  85.2758390023,
      73.5089058957,  74.6540702948,  62.7058446712,  63.6697165533,
      76.0917063492,  77.0555782313,  91.3947675737,  92.5399319728,
      107.0604138322, 108.3868707483, 125.7600170068, 127.2979818594,
      124.4648979592, 125.9394104308, 133.8819217687, 135.4198866213,
      116.8743820862, 118.2008390023, 101.9339058957, 103.0790702948,
      86.6308446712,  87.5947165533,  72.8207539683,  73.6327210884,
      87.3523866213,  88.3170748299,  102.1894614512, 103.3068707483,
      119.8557312925, 121.1513151927, 118.1906122449, 119.4327437642,
      126.6976360544, 127.9932199546, 110.4567630385, 111.5741723356,
      96.2305725624,  97.195260771,   81.6989399093,  82.5109070295,
      67.8163888889,  68.5017687075,  81.2765929705,  82.0908843537,
      94.9946201814,  95.9378231293,  111.2997789116, 112.3933786848,
      109.4763265306, 110.5248072562, 117.0750170068, 118.16861678,
      101.9730328798, 102.9162358277, 88.7706519274,  89.5849433107,
      75.3104478458,  75.9958276644,  61.5738718821,  62.1507482993,
      73.748361678,   74.4337414966,  86.1398582766,  86.9337414966,
      100.8497789116, 101.7702494331, 99.0191836735,  99.9016780045,
      105.7107312925, 106.6312018141, 92.0135090703,  92.8073922902,
      80.0560260771,  80.7414058957,  67.8815362812,  68.4584126984,
      98.2588718821,  98.8357482993,  117.333361678,  118.0187414966,
      136.6248582766, 137.4187414966, 159.3847789116, 160.3052494331,
      155.1391836735, 156.0216780045, 164.2457312925, 165.1662018141,
      142.4985090703, 143.2923922902, 123.6410260771, 124.3264058957,
      104.5665362812, 105.1434126984, 122.0789399093, 122.7643197279,
      145.7452664399, 146.5595578231, 169.6694160998, 170.6126190476,
      197.8817176871, 198.9753174603, 192.486122449,  193.5346031746,
      203.6569557823, 204.7505555556, 176.6478287982, 177.591031746,
      153.2393253968, 154.05361678,   129.5729988662, 130.2583786848,
      152.1475907029, 152.9595578231, 181.5996315193, 182.5643197279,
      211.3571145125, 212.4745238095, 246.4305272109, 247.7261111111,
      239.5432653061, 240.7853968254, 253.2724319728, 254.568015873,
      219.6244160998, 220.7418253968, 190.4778174603, 191.4425056689,
      161.025776644,  161.8377437642, 190.9642573696, 191.9281292517,
      227.8734410431, 229.0186054422, 265.1452097506, 266.4716666667,
      309.0519557823, 310.5899206349, 300.1946938776, 301.6692063492,
      317.1738605442, 318.7118253968, 274.9591780045, 276.2856349206,
      238.4125793651, 239.5577437642, 201.5033956916, 202.4672675737,
      214.8892573696, 215.8531292517, 256.2984410431, 257.4436054422,
      298.0702097506, 299.3966666667, 347.2269557823, 348.7649206349,
      336.7946938776, 338.2692063492, 355.3488605442, 356.8868253968,
      307.8841780045, 309.2106349206, 266.8375793651, 267.9827437642,
      225.4283956916, 226.3922675737, 189.7440192744, 190.5559863946,
      226.2674886621, 227.2321768707, 263.0964002268, 264.2138095238,
      306.4198129252, 307.7153968254, 297.0575510204, 298.2996825397,
      313.2617176871, 314.5573015873, 271.3637018141, 272.4811111111,
      235.1456746032, 236.1103628118, 198.6222052154, 199.4341723356,
      166.5110827664, 167.196462585,  198.5345521542, 199.3488435374,
      230.8158446712, 231.759047619,  268.7781462585, 269.8717460317,
      260.4575510204, 261.506031746,  274.5533843537, 275.646984127,
      237.7942573696, 238.7374603175, 206.0286111111, 206.8429024943,
      174.0051417234, 174.690521542,  144.6440759637, 145.220952381,
      172.4430555556, 173.1284353741, 200.4590419501, 201.2529251701,
      233.3975340136, 234.3180045351, 226.0983673469, 226.980861678,
      238.2584863946, 239.1789569161, 206.3326927438, 207.1265759637,
      178.7507199546, 179.4360997732, 150.9517403628, 151.52861678,
      181.3290759637, 181.905952381,  216.0280555556, 216.7134353741,
      250.9440419501, 251.7379251701, 291.9325340136, 292.8530045351,
      282.2183673469, 283.100861678,  296.7934863946, 297.7139569161,
      256.8176927438, 257.6115759637, 222.3357199546, 223.0210997732,
      187.6367403628, 188.21361678,   220.7736337868, 221.4590136054,
      263.0032256236, 263.8175170068, 305.4906405896, 306.4338435374,
      355.360085034,  356.4536848073, 343.4673469388, 344.5158276644,
      361.1353231293, 362.2289229025, 312.469053288,  313.4122562358,
      270.4972845805, 271.3115759637, 228.2676927438, 228.9530725624,
      269.0708560091, 269.8828231293, 320.5147335601, 321.4794217687,
      372.264053288,  373.381462585,  432.9946088435, 434.2901927438,
      418.4102040816, 419.6523356009, 439.8365136054, 441.1320975057,
      380.5313548753, 381.6487641723, 329.3929195011, 330.3576077098,
      277.9490419501, 278.7610090703, 329.76180839,   330.7256802721,
      392.7771145125, 393.9222789116, 456.1550056689, 457.481462585,
      530.5188945578, 532.0568594104, 512.5244897959, 513.9990022676,
      538.6407993197, 540.1787641723, 465.9689739229, 467.295430839,
      403.3162528345, 404.4614172336, 340.300946712,  341.2648185941,
      353.68680839,   354.6506802721, 421.2021145125, 422.3472789116,
      489.0800056689, 490.406462585,  568.6938945578, 570.2318594104,
      549.1244897959, 550.5990022676, 576.8157993197, 578.3537641723,
      498.8939739229, 500.220430839,  431.7412528345, 432.8864172336,
      364.225946712,  365.1898185941, 306.6672845805, 307.4792517007,
      365.1825907029, 366.1472789116, 424.0033390023, 425.1207482993,
      492.9838945578, 494.279478458,  475.9244897959, 477.1666213152,
      499.8257993197, 501.12138322,   432.2706405896, 433.3880498866,
      374.060776644,  375.0254648526, 315.5454705215, 316.3574376417,
      265.205776644,  265.8911564626, 315.7925113379, 316.6068027211,
      366.637069161,  367.5802721088, 426.2565136054, 427.3501133787,
      411.4387755102, 412.4872562358, 432.0317517007, 433.1253514739,
      373.6154818594, 374.5586848073, 323.2865702948, 324.100861678,
      272.6998356009, 273.3852154195, 227.7142800454, 228.2911564626,
      271.1377494331, 271.8231292517, 314.7782256236, 315.5721088435,
      365.9452891156, 366.8657596372, 353.1775510204, 354.0600453515,
      370.8062414966, 371.7267120181, 320.6518764172, 321.4457596372,
      277.4454138322, 278.1307936508, 234.0219444444, 234.5988208617};
  const std::array<int, 4> in_shape = {{3, 8, 9, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x8x9x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.0204081633, 0.0408163265, 0.0816326531, 0.1224489796, 0.1836734694,
      0.2448979592, 0.1836734694, 0.2448979592, 0.1836734694, 0.2448979592,
      0.1836734694, 0.2448979592, 0.1836734694, 0.2448979592, 0.1632653061,
      0.2040816327, 0.1020408163, 0.1224489796, 0.1632653061, 0.2040816327,
      0.4081632653, 0.4897959184, 0.7346938776, 0.8571428571, 0.7346938776,
      0.8571428571, 0.7346938776, 0.8571428571, 0.7346938776, 0.8571428571,
      0.7346938776, 0.8571428571, 0.5714285714, 0.6530612245, 0.3265306122,
      0.3673469388, 0.1632653061, 0.2040816327, 0.4081632653, 0.4897959184,
      0.7346938776, 0.8571428571, 0.7346938776, 0.8571428571, 0.7346938776,
      0.8571428571, 0.7346938776, 0.8571428571, 0.7346938776, 0.8571428571,
      0.5714285714, 0.6530612245, 0.3265306122, 0.3673469388, 0.1632653061,
      0.2040816327, 0.4081632653, 0.4897959184, 0.7346938776, 0.8571428571,
      0.7346938776, 0.8571428571, 0.7346938776, 0.8571428571, 0.7346938776,
      0.8571428571, 0.7346938776, 0.8571428571, 0.5714285714, 0.6530612245,
      0.3265306122, 0.3673469388, 0.1632653061, 0.2040816327, 0.4081632653,
      0.4897959184, 0.7346938776, 0.8571428571, 0.7346938776, 0.8571428571,
      0.7346938776, 0.8571428571, 0.7346938776, 0.8571428571, 0.7346938776,
      0.8571428571, 0.5714285714, 0.6530612245, 0.3265306122, 0.3673469388,
      0.1632653061, 0.2040816327, 0.4081632653, 0.4897959184, 0.7346938776,
      0.8571428571, 0.7346938776, 0.8571428571, 0.7346938776, 0.8571428571,
      0.7346938776, 0.8571428571, 0.7346938776, 0.8571428571, 0.5714285714,
      0.6530612245, 0.3265306122, 0.3673469388, 0.1632653061, 0.2040816327,
      0.4081632653, 0.4897959184, 0.7346938776, 0.8571428571, 0.7346938776,
      0.8571428571, 0.7346938776, 0.8571428571, 0.7346938776, 0.8571428571,
      0.7346938776, 0.8571428571, 0.5714285714, 0.6530612245, 0.3265306122,
      0.3673469388, 0.1428571429, 0.1632653061, 0.3265306122, 0.3673469388,
      0.5510204082, 0.612244898,  0.5510204082, 0.612244898,  0.5510204082,
      0.612244898,  0.5510204082, 0.612244898,  0.5510204082, 0.612244898,
      0.4081632653, 0.4489795918, 0.2244897959, 0.2448979592, 0.2653061224,
      0.2857142857, 0.5714285714, 0.612244898,  0.9183673469, 0.9795918367,
      0.9183673469, 0.9795918367, 0.9183673469, 0.9795918367, 0.9183673469,
      0.9795918367, 0.9183673469, 0.9795918367, 0.6530612245, 0.693877551,
      0.3469387755, 0.3673469388, 0.6530612245, 0.693877551,  1.387755102,
      1.4693877551, 2.2040816327, 2.3265306122, 2.2040816327, 2.3265306122,
      2.2040816327, 2.3265306122, 2.2040816327, 2.3265306122, 2.2040816327,
      2.3265306122, 1.5510204082, 1.6326530612, 0.8163265306, 0.8571428571,
      0.6530612245, 0.693877551,  1.387755102,  1.4693877551, 2.2040816327,
      2.3265306122, 2.2040816327, 2.3265306122, 2.2040816327, 2.3265306122,
      2.2040816327, 2.3265306122, 2.2040816327, 2.3265306122, 1.5510204082,
      1.6326530612, 0.8163265306, 0.8571428571, 0.6530612245, 0.693877551,
      1.387755102,  1.4693877551, 2.2040816327, 2.3265306122, 2.2040816327,
      2.3265306122, 2.2040816327, 2.3265306122, 2.2040816327, 2.3265306122,
      2.2040816327, 2.3265306122, 1.5510204082, 1.6326530612, 0.8163265306,
      0.8571428571, 0.6530612245, 0.693877551,  1.387755102,  1.4693877551,
      2.2040816327, 2.3265306122, 2.2040816327, 2.3265306122, 2.2040816327,
      2.3265306122, 2.2040816327, 2.3265306122, 2.2040816327, 2.3265306122,
      1.5510204082, 1.6326530612, 0.8163265306, 0.8571428571, 0.6530612245,
      0.693877551,  1.387755102,  1.4693877551, 2.2040816327, 2.3265306122,
      2.2040816327, 2.3265306122, 2.2040816327, 2.3265306122, 2.2040816327,
      2.3265306122, 2.2040816327, 2.3265306122, 1.5510204082, 1.6326530612,
      0.8163265306, 0.8571428571, 0.6530612245, 0.693877551,  1.387755102,
      1.4693877551, 2.2040816327, 2.3265306122, 2.2040816327, 2.3265306122,
      2.2040816327, 2.3265306122, 2.2040816327, 2.3265306122, 2.2040816327,
      2.3265306122, 1.5510204082, 1.6326530612, 0.8163265306, 0.8571428571,
      0.387755102,  0.4081632653, 0.8163265306, 0.8571428571, 1.2857142857,
      1.3469387755, 1.2857142857, 1.3469387755, 1.2857142857, 1.3469387755,
      1.2857142857, 1.3469387755, 1.2857142857, 1.3469387755, 0.8979591837,
      0.9387755102, 0.4693877551, 0.4897959184, 0.5102040816, 0.5306122449,
      1.0612244898, 1.1020408163, 1.6530612245, 1.7142857143, 1.6530612245,
      1.7142857143, 1.6530612245, 1.7142857143, 1.6530612245, 1.7142857143,
      1.6530612245, 1.7142857143, 1.1428571429, 1.1836734694, 0.5918367347,
      0.612244898,  1.1428571429, 1.1836734694, 2.3673469388, 2.4489795918,
      3.6734693878, 3.7959183673, 3.6734693878, 3.7959183673, 3.6734693878,
      3.7959183673, 3.6734693878, 3.7959183673, 3.6734693878, 3.7959183673,
      2.5306122449, 2.612244898,  1.306122449,  1.3469387755, 1.1428571429,
      1.1836734694, 2.3673469388, 2.4489795918, 3.6734693878, 3.7959183673,
      3.6734693878, 3.7959183673, 3.6734693878, 3.7959183673, 3.6734693878,
      3.7959183673, 3.6734693878, 3.7959183673, 2.5306122449, 2.612244898,
      1.306122449,  1.3469387755, 1.1428571429, 1.1836734694, 2.3673469388,
      2.4489795918, 3.6734693878, 3.7959183673, 3.6734693878, 3.7959183673,
      3.6734693878, 3.7959183673, 3.6734693878, 3.7959183673, 3.6734693878,
      3.7959183673, 2.5306122449, 2.612244898,  1.306122449,  1.3469387755,
      1.1428571429, 1.1836734694, 2.3673469388, 2.4489795918, 3.6734693878,
      3.7959183673, 3.6734693878, 3.7959183673, 3.6734693878, 3.7959183673,
      3.6734693878, 3.7959183673, 3.6734693878, 3.7959183673, 2.5306122449,
      2.612244898,  1.306122449,  1.3469387755, 1.1428571429, 1.1836734694,
      2.3673469388, 2.4489795918, 3.6734693878, 3.7959183673, 3.6734693878,
      3.7959183673, 3.6734693878, 3.7959183673, 3.6734693878, 3.7959183673,
      3.6734693878, 3.7959183673, 2.5306122449, 2.612244898,  1.306122449,
      1.3469387755, 1.1428571429, 1.1836734694, 2.3673469388, 2.4489795918,
      3.6734693878, 3.7959183673, 3.6734693878, 3.7959183673, 3.6734693878,
      3.7959183673, 3.6734693878, 3.7959183673, 3.6734693878, 3.7959183673,
      2.5306122449, 2.612244898,  1.306122449,  1.3469387755, 0.6326530612,
      0.6530612245, 1.306122449,  1.3469387755, 2.0204081633, 2.0816326531,
      2.0204081633, 2.0816326531, 2.0204081633, 2.0816326531, 2.0204081633,
      2.0816326531, 2.0204081633, 2.0816326531, 1.387755102,  1.4285714286,
      0.7142857143, 0.7346938776};
  const std::array<int, 4> in_shape = {{3, 8, 9, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x8x9x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      29.8004591837,   30.3773356009,   30.9542120181,   31.5310884354,
      36.5919557823,   37.2773356009,   37.9627154195,   38.6480952381,
      43.8174659864,   44.6113492063,   45.4052324263,   46.1991156463,
      52.7535770975,   53.674047619,    54.5945181406,   55.5149886621,
      55.2375056689,   56.12,           57.0024943311,   57.8849886621,
      62.4754818594,   63.395952381,    64.3164229025,   65.236893424,
      55.5647675737,   56.3586507937,   57.1525340136,   57.9464172336,
      49.2072845805,   49.8926643991,   50.5780442177,   51.2634240363,
      42.4157879819,   42.9926643991,   43.5695408163,   44.1464172336,
      46.0831122449,   46.7684920635,   47.4538718821,   48.1392517007,
      56.1603231293,   56.9746145125,   57.7889058957,   58.6031972789,
      66.7531802721,   67.69638322,     68.6395861678,   69.5827891156,
      79.713100907,    80.8067006803,   81.9003004535,   82.9939002268,
      81.9613151927,   83.0097959184,   84.058276644,    85.1067573696,
      91.2635770975,   92.3571768707,   93.450776644,    94.5443764172,
      80.7100056689,   81.6532086168,   82.5964115646,   83.5396145125,
      71.1484410431,   71.9627324263,   72.7770238095,   73.5913151927,
      61.0712301587,   61.7566099773,   62.4419897959,   63.1273696145,
      69.6366836735,   70.4486507937,   71.2606179138,   72.072585034,
      84.4043707483,   85.3690589569,   86.3337471655,   87.2984353741,
      99.7829421769,   100.9003514739,  102.017760771,   103.135170068,
      118.4373072562,  119.7328911565,  121.0284750567,  122.3240589569,
      120.110521542,   121.3526530612,  122.5947845805,  123.8369160998,
      132.12111678,    133.4167006803,  134.7122845805,  136.0078684807,
      116.3175453515,  117.4349546485,  118.5523639456,  119.6697732426,
      102.1607426304,  103.125430839,   104.0901190476,  105.0548072562,
      87.3930555556,   88.2050226757,   89.0169897959,   89.8289569161,
      103.3695408163,  104.3334126984,  105.2972845805,  106.2611564626,
      124.7943707483,  125.9395351474,  127.0846995465,  128.2298639456,
      146.9443707483,  148.2708276644,  149.5972845805,  150.9237414966,
      173.632069161,   175.1700340136,  176.7079988662,  178.2459637188,
      174.2552834467,  175.7297959184,  177.20430839,    178.6788208617,
      189.8758786848,  191.4138435374,  192.95180839,    194.4897732426,
      166.5723072562,  167.8987641723,  169.2252210884,  170.5516780045,
      145.8726473923,  147.0178117914,  148.1629761905,  149.3081405896,
      124.4478174603,  125.4116893424,  126.3755612245,  127.3394331066,
      151.2195408163,  152.1834126984,  153.1472845805,  154.1111564626,
      181.6443707483,  182.7895351474,  183.9346995465,  185.0798639456,
      212.7943707483,  214.1208276644,  215.4472845805,  216.7737414966,
      249.982069161,   251.5200340136,  253.0579988662,  254.5959637188,
      247.4552834467,  248.9297959184,  250.40430839,    251.8788208617,
      266.2258786848,  267.7638435374,  269.30180839,    270.8397732426,
      232.4223072562,  233.7487641723,  235.0752210884,  236.4016780045,
      202.7226473923,  203.8678117914,  205.0129761905,  206.1581405896,
      172.2978174603,  173.2616893424,  174.2255612245,  175.1894331066,
      144.8295408163,  145.6415079365,  146.4534750567,  147.2654421769,
      173.740085034,   174.7047732426,  175.6694614512,  176.6341496599,
      203.2615136054,  204.3789229025,  205.4963321995,  206.6137414966,
      238.4158786848,  239.711462585,   241.0070464853,  242.3026303855,
      235.1390929705,  236.3812244898,  237.6233560091,  238.8654875283,
      252.0996882086,  253.3952721088,  254.6908560091,  255.9864399093,
      219.79611678,    220.9135260771,  222.0309353741,  223.1483446712,
      191.4964569161,  192.4611451247,  193.4258333333,  194.390521542,
      162.5859126984,  163.3978798186,  164.2098469388,  165.021814059,
      134.9473979592,  135.6327777778,  136.3181575964,  137.003537415,
      161.7388945578,  162.553185941,   163.3674773243,  164.1817687075,
      189.046037415,   189.9892403628,  190.9324433107,  191.8756462585,
      221.5059580499,  222.5995578231,  223.6931575964,  224.7867573696,
      217.9041723356,  218.9526530612,  220.0011337868,  221.0496145125,
      233.0564342404,  234.1500340136,  235.2436337868,  236.3372335601,
      203.0028628118,  203.9460657596,  204.8892687075,  205.8324716553,
      176.7270124717,  177.5413038549,  178.3555952381,  179.1698866213,
      149.935515873,   150.6208956916,  151.3062755102,  151.9916553288,
      122.5708673469,  123.1477437642,  123.7246201814,  124.3014965986,
      146.8113435374,  147.496723356,   148.1821031746,  148.8674829932,
      171.4858333333,  172.2797165533,  173.0735997732,  173.8674829932,
      200.7790873016,  201.6995578231,  202.6200283447,  203.5404988662,
      197.1558730159,  198.0383673469,  198.920861678,   199.8033560091,
      210.5009920635,  211.421462585,   212.3419331066,  213.2624036281,
      183.2331349206,  184.0270181406,  184.8209013605,  185.6147845805,
      159.4266723356,  160.1120521542,  160.7974319728,  161.4828117914,
      135.1861961451,  135.7630725624,  136.3399489796,  136.9168253968,
      195.9408673469,  196.5177437642,  197.0946201814,  197.6714965986,
      233.9813435374,  234.666723356,   235.3521031746,  236.0374829932,
      272.4558333333,  273.2497165533,  274.0435997732,  274.8374829932,
      317.8490873016,  318.7695578231,  319.6900283447,  320.6104988662,
      309.3958730159,  310.2783673469,  311.160861678,   312.0433560091,
      327.5709920635,  328.491462585,   329.4119331066,  330.3324036281,
      284.2031349206,  284.9970181406,  285.7909013605,  286.5847845805,
      246.5966723356,  247.2820521542,  247.9674319728,  248.6528117914,
      208.5561961451,  209.1330725624,  209.7099489796,  210.2868253968,
      243.4725,        244.1578798186,  244.8432596372,  245.5286394558,
      290.6762414966,  291.4905328798,  292.304824263,   293.1191156463,
      338.3956292517,  339.3388321995,  340.2820351474,  341.2252380952,
      394.6698356009,  395.7634353741,  396.8570351474,  397.9506349206,
      383.9237641723,  384.972244898,   386.0207256236,  387.0692063492,
      406.2203117914,  407.3139115646,  408.4075113379,  409.5011111111,
      352.3524546485,  353.2956575964,  354.2388605442,  355.1820634921,
      305.6643594104,  306.4786507937,  307.2929421769,  308.1072335601,
      258.4606179138,  259.1459977324,  259.831377551,   260.5167573696,
      303.4832142857,  304.2951814059,  305.1071485261,  305.9191156463,
      362.2345748299,  363.1992630385,  364.1639512472,  365.1286394558,
      421.5968197279,  422.7142290249,  423.831638322,   424.949047619,
      491.5654705215,  492.8610544218,  494.156638322,   495.4522222222,
      477.844399093,   479.0865306122,  480.3286621315,  481.5707936508,
      505.2492800454,  506.5448639456,  507.8404478458,  509.136031746,
      438.1314229025,  439.2488321995,  440.3662414966,  441.4836507937,
      379.990946712,   380.9556349206,  381.9203231293,  382.8850113379,
      321.2395861678,  322.051553288,   322.8635204082,  323.6754875283,
      380.9646428571,  381.9285147392,  382.8923866213,  383.8562585034,
      454.6017176871,  455.7468820862,  456.8920464853,  458.0372108844,
      528.963962585,   530.2904195011,  531.6168764172,  532.9433333333,
      616.565946712,   618.1039115646,  619.6418764172,  621.1798412698,
      598.9148752834,  600.3893877551,  601.8639002268,  603.3384126984,
      632.8097562358,  634.3477210884,  635.885685941,   637.4236507937,
      548.591899093,   549.9183560091,  551.2448129252,  552.5712698413,
      475.6799943311,  476.8251587302,  477.9703231293,  479.1154875283,
      402.0429195011,  403.0067913832,  403.9706632653,  404.9345351474,
      428.8146428571,  429.7785147392,  430.7423866213,  431.7062585034,
      511.4517176871,  512.5968820862,  513.7420464853,  514.8872108844,
      594.813962585,   596.1404195011,  597.4668764172,  598.7933333333,
      692.915946712,   694.4539115646,  695.9918764172,  697.5298412698,
      672.1148752834,  673.5893877551,  675.0639002268,  676.5384126984,
      709.1597562358,  710.6977210884,  712.235685941,   713.7736507937,
      614.441899093,   615.7683560091,  617.0948129252,  618.4212698413,
      532.5299943311,  533.6751587302,  534.8203231293,  535.9654875283,
      449.8929195011,  450.8567913832,  451.8206632653,  452.7845351474,
      378.6760714286,  379.4880385488,  380.3000056689,  381.1119727891,
      451.5702891156,  452.5349773243,  453.4996655329,  454.4643537415,
      525.0753911565,  526.1928004535,  527.3102097506,  528.4276190476,
      611.5440419501,  612.8396258503,  614.1352097506,  615.4307936508,
      592.8729705215,  594.1151020408,  595.3572335601,  596.5993650794,
      625.2278514739,  626.5234353741,  627.8190192744,  629.1146031746,
      541.6099943311,  542.7274036281,  543.8448129252,  544.9622222222,
      469.3266609977,  470.2913492063,  471.256037415,   472.2207256236,
      396.4324433107,  397.2444104308,  398.056377551,   398.8683446712,
      332.3367857143,  333.0221655329,  333.7075453515,  334.3929251701,
      396.2548129252,  397.0691043084,  397.8833956916,  398.6976870748,
      460.6884863946,  461.6316893424,  462.5748922902,  463.5180952381,
      536.4626927438,  537.556292517,   538.6498922902,  539.7434920635,
      519.8666213152,  520.9151020408,  521.9635827664,  523.0120634921,
      548.0131689342,  549.1067687075,  550.2003684807,  551.293968254,
      474.6453117914,  475.5885147392,  476.5317176871,  477.4749206349,
      411.242930839,   412.0572222222,  412.8715136054,  413.6858049887,
      347.3249036281,  348.0102834467,  348.6956632653,  349.3810430839,
      288.7112755102,  289.2881519274,  289.8650283447,  290.4419047619,
      344.2007312925,  344.8861111111,  345.5714909297,  346.2568707483,
      400.1242006803,  400.9180839002,  401.7119671202,  402.5058503401,
      465.8745975057,  466.7950680272,  467.7155385488,  468.6360090703,
      451.3142403628,  452.1967346939,  453.0792290249,  453.961723356,
      475.5965022676,  476.5169727891,  477.4374433107,  478.3579138322,
      411.8715022676,  412.6653854875,  413.4592687075,  414.2531519274,
      356.8160600907,  357.5014399093,  358.1868197279,  358.8721995465,
      301.3266043084,  301.9034807256,  302.4803571429,  303.0572335601,
      362.0812755102,  362.6581519274,  363.2350283447,  363.8119047619,
      431.3707312925,  432.0561111111,  432.7414909297,  433.4268707483,
      501.0942006803,  501.8880839002,  502.6819671202,  503.4758503401,
      582.9445975057,  583.8650680272,  584.7855385488,  585.7060090703,
      563.5542403628,  564.4367346939,  565.3192290249,  566.201723356,
      592.6665022676,  593.5869727891,  594.5074433107,  595.4279138322,
      512.8415022676,  513.6353854875,  514.4292687075,  515.2231519274,
      443.9860600907,  444.6714399093,  445.3568197279,  446.0421995465,
      374.6966043084,  375.2734807256,  375.8503571429,  376.4272335601,
      440.8618877551,  441.5472675737,  442.2326473923,  442.9180272109,
      525.1921598639,  526.0064512472,  526.8207426304,  527.6350340136,
      610.0380782313,  610.9812811791,  611.924484127,   612.8676870748,
      709.6265702948,  710.720170068,   711.8137698413,  712.9073696145,
      685.8862131519,  686.9346938776,  687.9831746032,  689.0316553288,
      721.1770464853,  722.2706462585,  723.3642460317,  724.457845805,
      623.9949036281,  624.938106576,   625.8813095238,  626.8245124717,
      540.1802777778,  540.994569161,   541.8088605442,  542.6231519274,
      455.8500056689,  456.5353854875,  457.2207653061,  457.9061451247,
      537.329744898,   538.1417120181,  538.9536791383,  539.7656462585,
      640.0647789116,  641.0294671202,  641.9941553288,  642.9588435374,
      743.4106972789,  744.528106576,   745.645515873,   746.7629251701,
      864.6936337868,  865.9892176871,  867.2848015873,  868.5803854875,
      835.578276644,   836.8204081633,  838.0625396825,  839.3046712018,
      878.3774433107,  879.6730272109,  880.9686111111,  882.2641950113,
      759.9453004535,  761.0627097506,  762.1801190476,  763.2975283447,
      657.8211507937,  658.7858390023,  659.7505272109,  660.7152154195,
      555.08611678,    555.8980839002,  556.7100510204,  557.5220181406,
      658.559744898,   659.52361678,    660.4874886621,  661.4513605442,
      784.4090646259,  785.5542290249,  786.699393424,   787.8445578231,
      910.9835544218,  912.3100113379,  913.636468254,   914.9629251701,
      1059.499824263,  1061.0377891156, 1062.5757539683, 1064.1137188209,
      1023.5744671202, 1025.0489795918, 1026.5234920635, 1027.9980045351,
      1075.7436337868, 1077.2815986395, 1078.8195634921, 1080.3575283447,
      930.6114909297,  931.9379478458,  933.2644047619,  934.590861678,
      805.4873412698,  806.6325056689,  807.777670068,   808.9228344671,
      679.638021542,   680.601893424,   681.5657653061,  682.5296371882,
      706.409744898,   707.37361678,    708.3374886621,  709.3013605442,
      841.2590646259,  842.4042290249,  843.549393424,   844.6945578231,
      976.8335544218,  978.1600113379,  979.486468254,   980.8129251701,
      1135.849824263,  1137.3877891156, 1138.9257539683, 1140.4637188209,
      1096.7744671202, 1098.2489795918, 1099.7234920635, 1101.1980045351,
      1152.0936337868, 1153.6315986395, 1155.1695634921, 1156.7075283447,
      996.4614909297,  997.7879478458,  999.1144047619,  1000.440861678,
      862.3373412698,  863.4825056689,  864.627670068,   865.7728344671,
      727.488021542,   728.451893424,   729.4157653061,  730.3796371882,
      612.5226020408,  613.334569161,   614.1465362812,  614.9585034014,
      729.4004931973,  730.3651814059,  731.3298696145,  732.2945578231,
      846.8892687075,  848.0066780045,  849.1240873016,  850.2414965986,
      984.6722052154,  985.9677891156,  987.2633730159,  988.5589569161,
      950.6068480726,  951.8489795918,  953.0911111111,  954.3332426304,
      998.3560147392,  999.6515986395,  1000.9471825397, 1002.2427664399,
      863.4238718821,  864.5412811791,  865.6586904762,  866.7760997732,
      747.1568650794,  748.121553288,   749.0862414966,  750.0509297052,
      630.2789739229,  631.0909410431,  631.9029081633,  632.7148752834,
      529.7261734694,  530.411553288,   531.0969331066,  531.7823129252,
      630.7707312925,  631.5850226757,  632.399314059,   633.2136054422,
      732.3309353741,  733.274138322,   734.2173412698,  735.1605442177,
      851.4194274376,  852.5130272109,  853.6066269841,  854.7002267574,
      821.8290702948,  822.8775510204,  823.926031746,   824.9745124717,
      862.9699036281,  864.0635034014,  865.1571031746,  866.2507029478,
      746.287760771,   747.2309637188,  748.1741666667,  749.1173696145,
      645.7588492063,  646.5731405896,  647.3874319728,  648.201723356,
      544.7142913832,  545.3996712018,  546.0850510204,  546.770430839,
      454.8516836735,  455.4285600907,  456.0054365079,  456.5823129252,
      541.5901190476,  542.2754988662,  542.9608786848,  543.6462585034,
      628.7625680272,  629.5564512472,  630.3503344671,  631.1442176871,
      730.9701077098,  731.8905782313,  732.8110487528,  733.7315192744,
      705.4726077098,  706.3551020408,  707.2375963719,  708.1200907029,
      740.6920124717,  741.6124829932,  742.5329535147,  743.4534240363,
      640.5098696145,  641.3037528345,  642.0976360544,  642.8915192744,
      554.2054478458,  554.8908276644,  555.576207483,   556.2615873016,
      467.4670124717,  468.0438888889,  468.6207653061,  469.1976417234};
  const std::array<int, 4> in_shape = {{3, 8, 9, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x8x9x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.0204081633, 0.0408163265, 0.0612244898, 0.0816326531, 0.1224489796,
      0.1632653061, 0.2040816327, 0.2448979592, 0.306122449,  0.3673469388,
      0.4285714286, 0.4897959184, 0.306122449,  0.3673469388, 0.4285714286,
      0.4897959184, 0.306122449,  0.3673469388, 0.4285714286, 0.4897959184,
      0.306122449,  0.3673469388, 0.4285714286, 0.4897959184, 0.306122449,
      0.3673469388, 0.4285714286, 0.4897959184, 0.2857142857, 0.3265306122,
      0.3673469388, 0.4081632653, 0.1836734694, 0.2040816327, 0.2244897959,
      0.2448979592, 0.2857142857, 0.3265306122, 0.3673469388, 0.4081632653,
      0.7346938776, 0.8163265306, 0.8979591837, 0.9795918367, 1.3469387755,
      1.4693877551, 1.5918367347, 1.7142857143, 1.3469387755, 1.4693877551,
      1.5918367347, 1.7142857143, 1.3469387755, 1.4693877551, 1.5918367347,
      1.7142857143, 1.3469387755, 1.4693877551, 1.5918367347, 1.7142857143,
      1.3469387755, 1.4693877551, 1.5918367347, 1.7142857143, 1.0612244898,
      1.1428571429, 1.2244897959, 1.306122449,  0.612244898,  0.6530612245,
      0.693877551,  0.7346938776, 0.2857142857, 0.3265306122, 0.3673469388,
      0.4081632653, 0.7346938776, 0.8163265306, 0.8979591837, 0.9795918367,
      1.3469387755, 1.4693877551, 1.5918367347, 1.7142857143, 1.3469387755,
      1.4693877551, 1.5918367347, 1.7142857143, 1.3469387755, 1.4693877551,
      1.5918367347, 1.7142857143, 1.3469387755, 1.4693877551, 1.5918367347,
      1.7142857143, 1.3469387755, 1.4693877551, 1.5918367347, 1.7142857143,
      1.0612244898, 1.1428571429, 1.2244897959, 1.306122449,  0.612244898,
      0.6530612245, 0.693877551,  0.7346938776, 0.2857142857, 0.3265306122,
      0.3673469388, 0.4081632653, 0.7346938776, 0.8163265306, 0.8979591837,
      0.9795918367, 1.3469387755, 1.4693877551, 1.5918367347, 1.7142857143,
      1.3469387755, 1.4693877551, 1.5918367347, 1.7142857143, 1.3469387755,
      1.4693877551, 1.5918367347, 1.7142857143, 1.3469387755, 1.4693877551,
      1.5918367347, 1.7142857143, 1.3469387755, 1.4693877551, 1.5918367347,
      1.7142857143, 1.0612244898, 1.1428571429, 1.2244897959, 1.306122449,
      0.612244898,  0.6530612245, 0.693877551,  0.7346938776, 0.2857142857,
      0.3265306122, 0.3673469388, 0.4081632653, 0.7346938776, 0.8163265306,
      0.8979591837, 0.9795918367, 1.3469387755, 1.4693877551, 1.5918367347,
      1.7142857143, 1.3469387755, 1.4693877551, 1.5918367347, 1.7142857143,
      1.3469387755, 1.4693877551, 1.5918367347, 1.7142857143, 1.3469387755,
      1.4693877551, 1.5918367347, 1.7142857143, 1.3469387755, 1.4693877551,
      1.5918367347, 1.7142857143, 1.0612244898, 1.1428571429, 1.2244897959,
      1.306122449,  0.612244898,  0.6530612245, 0.693877551,  0.7346938776,
      0.2857142857, 0.3265306122, 0.3673469388, 0.4081632653, 0.7346938776,
      0.8163265306, 0.8979591837, 0.9795918367, 1.3469387755, 1.4693877551,
      1.5918367347, 1.7142857143, 1.3469387755, 1.4693877551, 1.5918367347,
      1.7142857143, 1.3469387755, 1.4693877551, 1.5918367347, 1.7142857143,
      1.3469387755, 1.4693877551, 1.5918367347, 1.7142857143, 1.3469387755,
      1.4693877551, 1.5918367347, 1.7142857143, 1.0612244898, 1.1428571429,
      1.2244897959, 1.306122449,  0.612244898,  0.6530612245, 0.693877551,
      0.7346938776, 0.2857142857, 0.3265306122, 0.3673469388, 0.4081632653,
      0.7346938776, 0.8163265306, 0.8979591837, 0.9795918367, 1.3469387755,
      1.4693877551, 1.5918367347, 1.7142857143, 1.3469387755, 1.4693877551,
      1.5918367347, 1.7142857143, 1.3469387755, 1.4693877551, 1.5918367347,
      1.7142857143, 1.3469387755, 1.4693877551, 1.5918367347, 1.7142857143,
      1.3469387755, 1.4693877551, 1.5918367347, 1.7142857143, 1.0612244898,
      1.1428571429, 1.2244897959, 1.306122449,  0.612244898,  0.6530612245,
      0.693877551,  0.7346938776, 0.2653061224, 0.2857142857, 0.306122449,
      0.3265306122, 0.612244898,  0.6530612245, 0.693877551,  0.7346938776,
      1.0408163265, 1.1020408163, 1.1632653061, 1.2244897959, 1.0408163265,
      1.1020408163, 1.1632653061, 1.2244897959, 1.0408163265, 1.1020408163,
      1.1632653061, 1.2244897959, 1.0408163265, 1.1020408163, 1.1632653061,
      1.2244897959, 1.0408163265, 1.1020408163, 1.1632653061, 1.2244897959,
      0.7755102041, 0.8163265306, 0.8571428571, 0.8979591837, 0.4285714286,
      0.4489795918, 0.4693877551, 0.4897959184, 0.5102040816, 0.5306122449,
      0.5510204082, 0.5714285714, 1.1020408163, 1.1428571429, 1.1836734694,
      1.2244897959, 1.7755102041, 1.8367346939, 1.8979591837, 1.9591836735,
      1.7755102041, 1.8367346939, 1.8979591837, 1.9591836735, 1.7755102041,
      1.8367346939, 1.8979591837, 1.9591836735, 1.7755102041, 1.8367346939,
      1.8979591837, 1.9591836735, 1.7755102041, 1.8367346939, 1.8979591837,
      1.9591836735, 1.2653061224, 1.306122449,  1.3469387755, 1.387755102,
      0.6734693878, 0.693877551,  0.7142857143, 0.7346938776, 1.2653061224,
      1.306122449,  1.3469387755, 1.387755102,  2.693877551,  2.7755102041,
      2.8571428571, 2.9387755102, 4.2857142857, 4.4081632653, 4.5306122449,
      4.6530612245, 4.2857142857, 4.4081632653, 4.5306122449, 4.6530612245,
      4.2857142857, 4.4081632653, 4.5306122449, 4.6530612245, 4.2857142857,
      4.4081632653, 4.5306122449, 4.6530612245, 4.2857142857, 4.4081632653,
      4.5306122449, 4.6530612245, 3.0204081633, 3.1020408163, 3.1836734694,
      3.2653061224, 1.5918367347, 1.6326530612, 1.6734693878, 1.7142857143,
      1.2653061224, 1.306122449,  1.3469387755, 1.387755102,  2.693877551,
      2.7755102041, 2.8571428571, 2.9387755102, 4.2857142857, 4.4081632653,
      4.5306122449, 4.6530612245, 4.2857142857, 4.4081632653, 4.5306122449,
      4.6530612245, 4.2857142857, 4.4081632653, 4.5306122449, 4.6530612245,
      4.2857142857, 4.4081632653, 4.5306122449, 4.6530612245, 4.2857142857,
      4.4081632653, 4.5306122449, 4.6530612245, 3.0204081633, 3.1020408163,
      3.1836734694, 3.2653061224, 1.5918367347, 1.6326530612, 1.6734693878,
      1.7142857143, 1.2653061224, 1.306122449,  1.3469387755, 1.387755102,
      2.693877551,  2.7755102041, 2.8571428571, 2.9387755102, 4.2857142857,
      4.4081632653, 4.5306122449, 4.6530612245, 4.2857142857, 4.4081632653,
      4.5306122449, 4.6530612245, 4.2857142857, 4.4081632653, 4.5306122449,
      4.6530612245, 4.2857142857, 4.4081632653, 4.5306122449, 4.6530612245,
      4.2857142857, 4.4081632653, 4.5306122449, 4.6530612245, 3.0204081633,
      3.1020408163, 3.1836734694, 3.2653061224, 1.5918367347, 1.6326530612,
      1.6734693878, 1.7142857143, 1.2653061224, 1.306122449,  1.3469387755,
      1.387755102,  2.693877551,  2.7755102041, 2.8571428571, 2.9387755102,
      4.2857142857, 4.4081632653, 4.5306122449, 4.6530612245, 4.2857142857,
      4.4081632653, 4.5306122449, 4.6530612245, 4.2857142857, 4.4081632653,
      4.5306122449, 4.6530612245, 4.2857142857, 4.4081632653, 4.5306122449,
      4.6530612245, 4.2857142857, 4.4081632653, 4.5306122449, 4.6530612245,
      3.0204081633, 3.1020408163, 3.1836734694, 3.2653061224, 1.5918367347,
      1.6326530612, 1.6734693878, 1.7142857143, 1.2653061224, 1.306122449,
      1.3469387755, 1.387755102,  2.693877551,  2.7755102041, 2.8571428571,
      2.9387755102, 4.2857142857, 4.4081632653, 4.5306122449, 4.6530612245,
      4.2857142857, 4.4081632653, 4.5306122449, 4.6530612245, 4.2857142857,
      4.4081632653, 4.5306122449, 4.6530612245, 4.2857142857, 4.4081632653,
      4.5306122449, 4.6530612245, 4.2857142857, 4.4081632653, 4.5306122449,
      4.6530612245, 3.0204081633, 3.1020408163, 3.1836734694, 3.2653061224,
      1.5918367347, 1.6326530612, 1.6734693878, 1.7142857143, 1.2653061224,
      1.306122449,  1.3469387755, 1.387755102,  2.693877551,  2.7755102041,
      2.8571428571, 2.9387755102, 4.2857142857, 4.4081632653, 4.5306122449,
      4.6530612245, 4.2857142857, 4.4081632653, 4.5306122449, 4.6530612245,
      4.2857142857, 4.4081632653, 4.5306122449, 4.6530612245, 4.2857142857,
      4.4081632653, 4.5306122449, 4.6530612245, 4.2857142857, 4.4081632653,
      4.5306122449, 4.6530612245, 3.0204081633, 3.1020408163, 3.1836734694,
      3.2653061224, 1.5918367347, 1.6326530612, 1.6734693878, 1.7142857143,
      0.7551020408, 0.7755102041, 0.7959183673, 0.8163265306, 1.5918367347,
      1.6326530612, 1.6734693878, 1.7142857143, 2.5102040816, 2.5714285714,
      2.6326530612, 2.693877551,  2.5102040816, 2.5714285714, 2.6326530612,
      2.693877551,  2.5102040816, 2.5714285714, 2.6326530612, 2.693877551,
      2.5102040816, 2.5714285714, 2.6326530612, 2.693877551,  2.5102040816,
      2.5714285714, 2.6326530612, 2.693877551,  1.7551020408, 1.7959183673,
      1.8367346939, 1.8775510204, 0.9183673469, 0.9387755102, 0.9591836735,
      0.9795918367, 1.,           1.0204081633, 1.0408163265, 1.0612244898,
      2.0816326531, 2.1224489796, 2.1632653061, 2.2040816327, 3.2448979592,
      3.306122449,  3.3673469388, 3.4285714286, 3.2448979592, 3.306122449,
      3.3673469388, 3.4285714286, 3.2448979592, 3.306122449,  3.3673469388,
      3.4285714286, 3.2448979592, 3.306122449,  3.3673469388, 3.4285714286,
      3.2448979592, 3.306122449,  3.3673469388, 3.4285714286, 2.2448979592,
      2.2857142857, 2.3265306122, 2.3673469388, 1.1632653061, 1.1836734694,
      1.2040816327, 1.2244897959, 2.2448979592, 2.2857142857, 2.3265306122,
      2.3673469388, 4.6530612245, 4.7346938776, 4.8163265306, 4.8979591837,
      7.2244897959, 7.3469387755, 7.4693877551, 7.5918367347, 7.2244897959,
      7.3469387755, 7.4693877551, 7.5918367347, 7.2244897959, 7.3469387755,
      7.4693877551, 7.5918367347, 7.2244897959, 7.3469387755, 7.4693877551,
      7.5918367347, 7.2244897959, 7.3469387755, 7.4693877551, 7.5918367347,
      4.9795918367, 5.0612244898, 5.1428571429, 5.2244897959, 2.5714285714,
      2.612244898,  2.6530612245, 2.693877551,  2.2448979592, 2.2857142857,
      2.3265306122, 2.3673469388, 4.6530612245, 4.7346938776, 4.8163265306,
      4.8979591837, 7.2244897959, 7.3469387755, 7.4693877551, 7.5918367347,
      7.2244897959, 7.3469387755, 7.4693877551, 7.5918367347, 7.2244897959,
      7.3469387755, 7.4693877551, 7.5918367347, 7.2244897959, 7.3469387755,
      7.4693877551, 7.5918367347, 7.2244897959, 7.3469387755, 7.4693877551,
      7.5918367347, 4.9795918367, 5.0612244898, 5.1428571429, 5.2244897959,
      2.5714285714, 2.612244898,  2.6530612245, 2.693877551,  2.2448979592,
      2.2857142857, 2.3265306122, 2.3673469388, 4.6530612245, 4.7346938776,
      4.8163265306, 4.8979591837, 7.2244897959, 7.3469387755, 7.4693877551,
      7.5918367347, 7.2244897959, 7.3469387755, 7.4693877551, 7.5918367347,
      7.2244897959, 7.3469387755, 7.4693877551, 7.5918367347, 7.2244897959,
      7.3469387755, 7.4693877551, 7.5918367347, 7.2244897959, 7.3469387755,
      7.4693877551, 7.5918367347, 4.9795918367, 5.0612244898, 5.1428571429,
      5.2244897959, 2.5714285714, 2.612244898,  2.6530612245, 2.693877551,
      2.2448979592, 2.2857142857, 2.3265306122, 2.3673469388, 4.6530612245,
      4.7346938776, 4.8163265306, 4.8979591837, 7.2244897959, 7.3469387755,
      7.4693877551, 7.5918367347, 7.2244897959, 7.3469387755, 7.4693877551,
      7.5918367347, 7.2244897959, 7.3469387755, 7.4693877551, 7.5918367347,
      7.2244897959, 7.3469387755, 7.4693877551, 7.5918367347, 7.2244897959,
      7.3469387755, 7.4693877551, 7.5918367347, 4.9795918367, 5.0612244898,
      5.1428571429, 5.2244897959, 2.5714285714, 2.612244898,  2.6530612245,
      2.693877551,  2.2448979592, 2.2857142857, 2.3265306122, 2.3673469388,
      4.6530612245, 4.7346938776, 4.8163265306, 4.8979591837, 7.2244897959,
      7.3469387755, 7.4693877551, 7.5918367347, 7.2244897959, 7.3469387755,
      7.4693877551, 7.5918367347, 7.2244897959, 7.3469387755, 7.4693877551,
      7.5918367347, 7.2244897959, 7.3469387755, 7.4693877551, 7.5918367347,
      7.2244897959, 7.3469387755, 7.4693877551, 7.5918367347, 4.9795918367,
      5.0612244898, 5.1428571429, 5.2244897959, 2.5714285714, 2.612244898,
      2.6530612245, 2.693877551,  2.2448979592, 2.2857142857, 2.3265306122,
      2.3673469388, 4.6530612245, 4.7346938776, 4.8163265306, 4.8979591837,
      7.2244897959, 7.3469387755, 7.4693877551, 7.5918367347, 7.2244897959,
      7.3469387755, 7.4693877551, 7.5918367347, 7.2244897959, 7.3469387755,
      7.4693877551, 7.5918367347, 7.2244897959, 7.3469387755, 7.4693877551,
      7.5918367347, 7.2244897959, 7.3469387755, 7.4693877551, 7.5918367347,
      4.9795918367, 5.0612244898, 5.1428571429, 5.2244897959, 2.5714285714,
      2.612244898,  2.6530612245, 2.693877551,  1.2448979592, 1.2653061224,
      1.2857142857, 1.306122449,  2.5714285714, 2.612244898,  2.6530612245,
      2.693877551,  3.9795918367, 4.0408163265, 4.1020408163, 4.1632653061,
      3.9795918367, 4.0408163265, 4.1020408163, 4.1632653061, 3.9795918367,
      4.0408163265, 4.1020408163, 4.1632653061, 3.9795918367, 4.0408163265,
      4.1020408163, 4.1632653061, 3.9795918367, 4.0408163265, 4.1020408163,
      4.1632653061, 2.7346938776, 2.7755102041, 2.8163265306, 2.8571428571,
      1.4081632653, 1.4285714286, 1.4489795918, 1.4693877551};
  const std::array<int, 4> in_shape = {{3, 8, 9, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x8x10x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      8.613361678,    10.5300283447,  12.5551984127,  14.6888718821,
      14.7101020408,  15.7734353741,  18.0940702948,  16.2859070295,
      14.3692403628,  12.3440702948,  13.1994160998,  16.0344501134,
      18.9983956916,  22.0912528345,  21.7910544218,  23.0543877551,
      26.1369274376,  23.4308049887,  20.5957709751,  17.6318253968,
      19.815685941,   23.9602437642,  28.2575226757,  32.7075226757,
      31.8934353741,  33.3901020408,  37.5004195011,  33.5085827664,
      29.3640249433,  25.0667460317,  29.2742573696,  35.2759580499,
      41.4589512472,  47.8232369615,  46.2258163265,  48.0024829932,
      53.5128004535,  47.6923922902,  41.69069161,    35.5076984127,
      42.5659240363,  51.0676247166,  59.7506179138,  68.6149036281,
      65.5591496599,  67.3358163265,  74.3044671202,  65.9840589569,
      57.4823582766,  48.7993650794,  40.7025907029,  48.7757199546,
      57.0015702948,  65.3801417234,  62.2743877551,  63.7710544218,
      70.1730385488,  62.2526303855,  54.1795011338,  45.9536507937,
      37.8839399093,  45.3618310658,  52.9686337868,  60.7043480726,
      57.6958163265,  58.9591496599,  64.7500226757,  57.4010430839,
      49.9231519274,  42.3163492063,  34.3829195011,  41.1465249433,
      48.0186337868,  54.9992460317,  52.1930952381,  53.2564285714,
      58.4044444444,  51.7493424036,  44.9857369615,  38.1136281179,
      54.7634750567,  65.3604138322,  76.0658560091,  86.8798015873,
      81.8375396825,  82.9008730159,  90.285,         79.7965646259,
      69.1996258503,  58.4941836735,  68.0298015873,  81.177760771,
      94.4546315193,  107.8604138322, 101.5443424036, 102.807675737,
      111.9060884354, 98.8870408163,  85.7390816327,  72.4622108844,
      84.7730555556,  101.1353004535, 117.6502664399, 134.3179535147,
      126.3768820862, 127.8735487528, 139.1108503401, 122.9013265306,
      106.5390816327, 90.0241156463,  106.3840079365, 126.8891099773,
      147.5755045351, 168.44319161,   158.3854535147, 160.1621201814,
      174.132755102,  153.8089455782, 133.3038435374, 112.6174489796,
      119.6756746032, 142.680776644,  165.8671712018, 189.2348582766,
      177.7187868481, 179.4954535147, 194.9244217687, 172.1006122449,
      149.0955102041, 125.9091156463, 105.6599603175, 125.950776644,
      146.394314059,  166.9905725624, 156.7578344671, 158.2545011338,
      171.7834693878, 151.6453741497, 131.3545578231, 110.9110204082,
      92.7143253968,  110.5051417234, 128.4248696145, 146.4735090703,
      137.4491043084, 138.7124376417, 150.5191836735, 132.8572789116,
      115.066462585,  97.1467346939,  80.5330328798,  95.9769104308,
      111.5292913832, 127.190175737,  119.3205328798, 120.3838662132,
      130.5953741497, 115.26,         99.816122449,   84.2637414966,
      100.9135884354, 120.1907993197, 139.5765136054, 159.0707312925,
      148.9649773243, 150.0283106576, 162.4759297052, 143.3072222222,
      124.0300113379, 104.6442970522, 122.8601870748, 146.3210714286,
      169.9108673469, 193.6295748299, 181.2976303855, 182.5609637188,
      197.6752494331, 174.343276644,  150.8823922902, 127.2925963719,
      149.7304251701, 178.3103571429, 207.0430102041, 235.9283843537,
      220.8603287982, 222.3569954649, 240.7212811791, 212.2940702948,
      183.714138322,  154.9814852608, 183.4937585034, 218.5022619048,
      253.6920578231, 289.0631462585, 270.5450907029, 272.3217573696,
      294.7527097506, 259.9254988662, 224.9169954649, 189.7271995465,
      196.7854251701, 234.2939285714, 271.9837244898, 309.8548129252,
      289.8784240363, 291.6550907029, 315.5443764172, 278.2171655329,
      240.7086621315, 203.0188662132, 170.617329932,  203.1258333333,
      235.7870578231, 268.6010034014, 251.2412811791, 252.7379478458,
      273.3939002268, 241.0381179138, 208.5296145125, 175.8683900227,
      147.5447108844, 175.648452381,  203.8811054422, 232.242670068,
      217.2023922902, 218.4657256236, 236.2883446712, 208.3135147392,
      180.2097732426, 151.9771201814, 126.6831462585, 150.8072959184,
      175.0399489796, 199.3811054422, 186.4479705215, 187.5113038549,
      202.7863038549, 178.7706575964, 154.6465079365, 130.4138548753};
  const std::array<int, 4> in_shape = {{3, 8, 10, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x8x10x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.0204081633, 0.0612244898, 0.1224489796, 0.2040816327, 0.2040816327,
      0.2040816327, 0.2040816327, 0.1836734694, 0.1428571429, 0.0816326531,
      0.1224489796, 0.2857142857, 0.4897959184, 0.7346938776, 0.7346938776,
      0.7346938776, 0.7346938776, 0.612244898,  0.4489795918, 0.2448979592,
      0.1224489796, 0.2857142857, 0.4897959184, 0.7346938776, 0.7346938776,
      0.7346938776, 0.7346938776, 0.612244898,  0.4489795918, 0.2448979592,
      0.1224489796, 0.2857142857, 0.4897959184, 0.7346938776, 0.7346938776,
      0.7346938776, 0.7346938776, 0.612244898,  0.4489795918, 0.2448979592,
      0.1224489796, 0.2857142857, 0.4897959184, 0.7346938776, 0.7346938776,
      0.7346938776, 0.7346938776, 0.612244898,  0.4489795918, 0.2448979592,
      0.1224489796, 0.2857142857, 0.4897959184, 0.7346938776, 0.7346938776,
      0.7346938776, 0.7346938776, 0.612244898,  0.4489795918, 0.2448979592,
      0.1224489796, 0.2857142857, 0.4897959184, 0.7346938776, 0.7346938776,
      0.7346938776, 0.7346938776, 0.612244898,  0.4489795918, 0.2448979592,
      0.1020408163, 0.2244897959, 0.3673469388, 0.5306122449, 0.5306122449,
      0.5306122449, 0.5306122449, 0.4285714286, 0.306122449,  0.1632653061,
      0.1836734694, 0.387755102,  0.612244898,  0.8571428571, 0.8571428571,
      0.8571428571, 0.8571428571, 0.6734693878, 0.4693877551, 0.2448979592,
      0.4489795918, 0.9387755102, 1.4693877551, 2.0408163265, 2.0408163265,
      2.0408163265, 2.0408163265, 1.5918367347, 1.1020408163, 0.5714285714,
      0.4489795918, 0.9387755102, 1.4693877551, 2.0408163265, 2.0408163265,
      2.0408163265, 2.0408163265, 1.5918367347, 1.1020408163, 0.5714285714,
      0.4489795918, 0.9387755102, 1.4693877551, 2.0408163265, 2.0408163265,
      2.0408163265, 2.0408163265, 1.5918367347, 1.1020408163, 0.5714285714,
      0.4489795918, 0.9387755102, 1.4693877551, 2.0408163265, 2.0408163265,
      2.0408163265, 2.0408163265, 1.5918367347, 1.1020408163, 0.5714285714,
      0.4489795918, 0.9387755102, 1.4693877551, 2.0408163265, 2.0408163265,
      2.0408163265, 2.0408163265, 1.5918367347, 1.1020408163, 0.5714285714,
      0.4489795918, 0.9387755102, 1.4693877551, 2.0408163265, 2.0408163265,
      2.0408163265, 2.0408163265, 1.5918367347, 1.1020408163, 0.5714285714,
      0.2653061224, 0.5510204082, 0.8571428571, 1.1836734694, 1.1836734694,
      1.1836734694, 1.1836734694, 0.9183673469, 0.6326530612, 0.3265306122,
      0.3469387755, 0.7142857143, 1.1020408163, 1.5102040816, 1.5102040816,
      1.5102040816, 1.5102040816, 1.1632653061, 0.7959183673, 0.4081632653,
      0.7755102041, 1.5918367347, 2.4489795918, 3.3469387755, 3.3469387755,
      3.3469387755, 3.3469387755, 2.5714285714, 1.7551020408, 0.8979591837,
      0.7755102041, 1.5918367347, 2.4489795918, 3.3469387755, 3.3469387755,
      3.3469387755, 3.3469387755, 2.5714285714, 1.7551020408, 0.8979591837,
      0.7755102041, 1.5918367347, 2.4489795918, 3.3469387755, 3.3469387755,
      3.3469387755, 3.3469387755, 2.5714285714, 1.7551020408, 0.8979591837,
      0.7755102041, 1.5918367347, 2.4489795918, 3.3469387755, 3.3469387755,
      3.3469387755, 3.3469387755, 2.5714285714, 1.7551020408, 0.8979591837,
      0.7755102041, 1.5918367347, 2.4489795918, 3.3469387755, 3.3469387755,
      3.3469387755, 3.3469387755, 2.5714285714, 1.7551020408, 0.8979591837,
      0.7755102041, 1.5918367347, 2.4489795918, 3.3469387755, 3.3469387755,
      3.3469387755, 3.3469387755, 2.5714285714, 1.7551020408, 0.8979591837,
      0.4285714286, 0.8775510204, 1.3469387755, 1.8367346939, 1.8367346939,
      1.8367346939, 1.8367346939, 1.4081632653, 0.9591836735, 0.4897959184};
  const std::array<int, 4> in_shape = {{3, 8, 10, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x8x10x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      16.6498469388,  17.226723356,   20.3746768707,  21.0600566893,
      24.3165136054,  25.1103968254,  28.4753571429,  29.3777437642,
      28.5811111111,  29.4202040816,  30.7077777778,  31.5468707483,
      35.2857539683,  36.1881405896,  31.777930839,   32.571814059,
      28.053100907,   28.7384807256,  24.1112641723,  24.6881405896,
      25.713452381,   26.3988321995,  31.2546088435,  32.0689002268,
      37.0535884354,  37.9967913832,  43.1103911565,  44.1825056689,
      42.5851927438,  43.5821088435,  45.1118594104,  46.1087755102,
      51.2017403628,  52.2738548753,  45.9184070295,  46.8616099773,
      40.3772505669,  41.1915419501,  34.5782709751,  35.2636507937,
      38.8194047619,  39.6313718821,  46.9557993197,  47.9204875283,
      55.3976360544,  56.5150453515,  64.144914966,   65.4150453515,
      62.6058276644,  63.7868707483,  65.5991609977,  66.7802040816,
      73.7307086168,  75.0008390023,  65.8997562358,  67.0171655329,
      57.763361678,   58.7280498866,  49.3215249433,  50.1334920635,
      57.5846428571,  58.5485147392,  69.4067517007,  70.5519160998,
      81.5914455782,  82.9179024943,  94.1387244898,  95.6464739229,
      91.0496371882,  92.4516326531,  94.6029705215,  96.0049659864,
      105.5178514739, 107.025600907,  94.0583276644,  95.3847845805,
      82.2362188209,  83.38138322,    70.0515249433,  71.0153968254,
      84.1679761905,  85.1318480726,  100.990085034,  102.1352494331,
      118.1747789116, 119.5012358277, 135.7220578231, 137.2298072562,
      129.7163038549, 131.1182993197, 133.2696371882, 134.6716326531,
      147.1011848073, 148.6089342404, 130.6416609977, 131.9681179138,
      113.8195521542, 114.9647165533, 96.6348582766,  97.5987301587,
      80.5932142857,  81.4051814059,  96.5867517007,  97.5514399093,
      112.8857312925, 114.0031405896, 129.4901530612, 130.7602834467,
      123.3677324263, 124.5487755102, 126.3610657596, 127.5421088435,
      139.075946712,  140.3460770975, 123.3878514739, 124.505260771,
      107.394314059,  108.3590022676, 91.0953344671,  91.9073015873,
      75.0825,        75.7678798186,  89.9093707483,  90.7236621315,
      104.9940646259, 105.9372675737, 120.3365816327, 121.4086961451,
      114.3947165533, 115.3916326531, 116.92138322,   117.9182993197,
      128.427930839,  129.5000453515, 113.85888322,   114.8020861678,
      99.0320124717,  99.8463038549,  83.9473185941,  84.6326984127,
      68.188962585,   68.7658390023,  81.607670068,   82.2930498866,
      95.2433843537,  96.0372675737,  109.0961054422, 109.9984920635,
      103.5470975057, 104.3861904762, 105.6737641723, 106.5128571429,
      115.9065022676, 116.8088888889, 102.7048015873, 103.4986848073,
      89.2860941043,  89.9714739229,  75.6503798186,  76.2272562358,
      108.9500736961, 109.5269501134, 130.0354478458, 130.7208276644,
      151.3378287982, 152.1317120181, 172.8572165533, 173.7596031746,
      162.8359863946, 163.6750793651, 164.9626530612, 165.8017460317,
      179.6676133787, 180.57,         158.7992460317, 159.5931292517,
      137.7138718821, 138.3992517007, 116.4114909297, 116.9883673469,
      135.374223356,  136.0596031746, 161.5412301587, 162.355521542,
      187.9660600907, 188.9092630385, 214.6487131519, 215.7208276644,
      202.0917687075, 203.0886848073, 204.6184353741, 205.6153514739,
      222.7400623583, 223.8121768707, 196.8308786848, 197.7740816327,
      170.6638718821, 171.4781632653, 144.2390419501, 144.9244217687,
      168.7341439909, 169.5461111111, 201.3059126984, 202.270600907,
      234.1831235828, 235.3005328798, 267.365776644,  268.6359070295,
      251.5727210884, 252.7537641723, 254.5660544218, 255.7470975057,
      276.9515702948, 278.2217006803, 244.6852437642, 245.8026530612,
      212.1134750567, 213.0781632653, 179.2362641723, 180.0482312925,
      211.8041439909, 212.768015873,  252.6330555556, 253.7782199546,
      293.8245521542, 295.1510090703, 335.3786337868, 336.88638322,
      315.3689115646, 316.7709070295, 318.922244898,  320.3242403628,
      346.757760771,  348.2655102041, 306.2914342404, 307.6178911565,
      265.4625226757, 266.6076870748, 224.2710260771, 225.2348979592,
      238.3874773243, 239.3513492063, 284.2163888889, 285.361553288,
      330.4078854875, 331.7343424036, 376.9619671202, 378.4697165533,
      354.0355782313, 355.4375736961, 357.5889115646, 358.9909070295,
      388.3410941043, 389.8488435374, 342.8747675737, 344.2012244898,
      297.0458560091, 298.1910204082, 250.8543594104, 251.8182312925,
      210.5079535147, 211.3199206349, 250.9368650794, 251.901553288,
      291.6712188209, 292.7886281179, 332.7110147392, 333.9811451247,
      312.3346258503, 313.5156689342, 315.3279591837, 316.5090022676,
      342.29680839,   343.5669387755, 302.1733390023, 303.2907482993,
      261.7444274376, 262.7091156463, 221.0100736961, 221.8220408163,
      184.7432709751, 185.4286507937, 220.1959920635, 221.0102834467,
      255.9065362812, 256.849739229,  291.8749036281, 292.9470181406,
      273.901292517,  274.8982086168, 276.4279591837, 277.4248752834,
      299.9662528345, 301.0383673469, 264.7713548753, 265.7145578231,
      229.3186337868, 230.1329251701, 193.6080895692, 194.2934693878,
      160.4891893424, 161.0660657596, 191.2684410431, 191.9538208617,
      222.2646995465, 223.0585827664, 253.4779648526, 254.3803514739,
      237.8019727891, 238.6410657596, 239.9286394558, 240.7677324263,
      260.288361678,  261.1907482993, 229.72611678,   230.52,
      198.9468650794, 199.632244898,  167.950606576,  168.5274829932,
      201.2503004535, 201.8271768707, 239.6962188209, 240.3815986395,
      278.3591439909, 279.1530272109, 317.2390759637, 318.141462585,
      297.090861678,  297.9299546485, 299.2175283447, 300.0566213152,
      324.0494727891, 324.9518594104, 285.8205612245, 286.6144444444,
      247.3746428571, 248.0600226757, 208.7117176871, 209.2885941043,
      245.0349943311, 245.7203741497, 291.8278514739, 292.6421428571,
      338.878531746,  339.8217346939, 386.1870351474, 387.2591496599,
      361.5983446712, 362.595260771,  364.1250113379, 365.1219274376,
      394.2783843537, 395.3504988662, 347.7433503401, 348.686553288,
      300.9504931973, 301.7647845805, 253.8998129252, 254.5851927438,
      298.64888322,   299.4608503401, 355.6560260771, 356.6207142857,
      412.9686111111, 414.0860204082, 470.586638322,  471.8567687075,
      440.5396145125, 441.7206575964, 443.5329478458, 444.7139909297,
      480.1724319728, 481.4425623583, 423.4707312925, 424.5881405896,
      366.4635884354, 367.428276644,  309.1510034014, 309.9629705215,
      366.0236451247, 366.9875170068, 435.8593594104, 437.0045238095,
      506.0576587302, 507.3841156463, 576.6185430839, 578.126292517,
      539.688185941,  541.0901814059, 543.2415192744, 544.6435147392,
      587.997670068,  589.5054195011, 518.5245408163, 519.8509977324,
      448.6888265306, 449.8339909297, 378.4905272109, 379.454399093,
      392.606978458,  393.5708503401, 467.4426927438, 468.5878571429,
      542.6409920635, 543.9674489796, 618.2018764172, 619.7096258503,
      578.3548526077, 579.7568480726, 581.908185941,  583.3101814059,
      629.5810034014, 631.0887528345, 555.1078741497, 556.4343310658,
      480.2721598639, 481.417324263,  405.0738605442, 406.0377324263,
      340.4226927438, 341.2346598639, 405.286978458,  406.2516666667,
      470.4567063492, 471.5741156463, 535.9318764172, 537.2020068027,
      501.3015192744, 502.4825623583, 504.2948526077, 505.4758956916,
      545.517670068,  546.7878004535, 480.9588265306, 482.0762358277,
      416.0945408163, 417.0592290249, 350.9248129252, 351.7367800454,
      294.4040419501, 295.0894217687, 350.4826133787, 351.2969047619,
      406.8190079365, 407.7622108844, 463.4132256236, 464.4853401361,
      433.4078684807, 434.4047845805, 435.9345351474, 436.9314512472,
      471.5045748299, 472.5766893424, 415.6838265306, 416.6270294785,
      359.605255102,  360.4195464853, 303.2688605442, 303.9542403628,
      252.7894160998, 253.366292517,  300.9292120181, 301.6145918367,
      349.2860147392, 350.0798979592, 397.859824263,  398.7622108844,
      372.0568480726, 372.8959410431, 374.1835147392, 375.0226077098,
      404.6702210884, 405.5726077098, 356.7474319728, 357.5413151927,
      308.6076360544, 309.293015873,  260.2508333333, 260.8277097506};
  const std::array<int, 4> in_shape = {{3, 8, 10, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x8x10x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.0204081633, 0.0408163265, 0.0816326531, 0.1224489796, 0.1836734694,
      0.2448979592, 0.3265306122, 0.4081632653, 0.3265306122, 0.4081632653,
      0.3265306122, 0.4081632653, 0.3265306122, 0.4081632653, 0.306122449,
      0.3673469388, 0.2448979592, 0.2857142857, 0.1428571429, 0.1632653061,
      0.2040816327, 0.2448979592, 0.4897959184, 0.5714285714, 0.8571428571,
      0.9795918367, 1.306122449,  1.4693877551, 1.306122449,  1.4693877551,
      1.306122449,  1.4693877551, 1.306122449,  1.4693877551, 1.1020408163,
      1.2244897959, 0.8163265306, 0.8979591837, 0.4489795918, 0.4897959184,
      0.2040816327, 0.2448979592, 0.4897959184, 0.5714285714, 0.8571428571,
      0.9795918367, 1.306122449,  1.4693877551, 1.306122449,  1.4693877551,
      1.306122449,  1.4693877551, 1.306122449,  1.4693877551, 1.1020408163,
      1.2244897959, 0.8163265306, 0.8979591837, 0.4489795918, 0.4897959184,
      0.2040816327, 0.2448979592, 0.4897959184, 0.5714285714, 0.8571428571,
      0.9795918367, 1.306122449,  1.4693877551, 1.306122449,  1.4693877551,
      1.306122449,  1.4693877551, 1.306122449,  1.4693877551, 1.1020408163,
      1.2244897959, 0.8163265306, 0.8979591837, 0.4489795918, 0.4897959184,
      0.2040816327, 0.2448979592, 0.4897959184, 0.5714285714, 0.8571428571,
      0.9795918367, 1.306122449,  1.4693877551, 1.306122449,  1.4693877551,
      1.306122449,  1.4693877551, 1.306122449,  1.4693877551, 1.1020408163,
      1.2244897959, 0.8163265306, 0.8979591837, 0.4489795918, 0.4897959184,
      0.2040816327, 0.2448979592, 0.4897959184, 0.5714285714, 0.8571428571,
      0.9795918367, 1.306122449,  1.4693877551, 1.306122449,  1.4693877551,
      1.306122449,  1.4693877551, 1.306122449,  1.4693877551, 1.1020408163,
      1.2244897959, 0.8163265306, 0.8979591837, 0.4489795918, 0.4897959184,
      0.2040816327, 0.2448979592, 0.4897959184, 0.5714285714, 0.8571428571,
      0.9795918367, 1.306122449,  1.4693877551, 1.306122449,  1.4693877551,
      1.306122449,  1.4693877551, 1.306122449,  1.4693877551, 1.1020408163,
      1.2244897959, 0.8163265306, 0.8979591837, 0.4489795918, 0.4897959184,
      0.1836734694, 0.2040816327, 0.4081632653, 0.4489795918, 0.6734693878,
      0.7346938776, 0.9795918367, 1.0612244898, 0.9795918367, 1.0612244898,
      0.9795918367, 1.0612244898, 0.9795918367, 1.0612244898, 0.7959183673,
      0.8571428571, 0.5714285714, 0.612244898,  0.306122449,  0.3265306122,
      0.3469387755, 0.3673469388, 0.7346938776, 0.7755102041, 1.1632653061,
      1.2244897959, 1.6326530612, 1.7142857143, 1.6326530612, 1.7142857143,
      1.6326530612, 1.7142857143, 1.6326530612, 1.7142857143, 1.2857142857,
      1.3469387755, 0.8979591837, 0.9387755102, 0.4693877551, 0.4897959184,
      0.8571428571, 0.8979591837, 1.7959183673, 1.8775510204, 2.8163265306,
      2.9387755102, 3.9183673469, 4.0816326531, 3.9183673469, 4.0816326531,
      3.9183673469, 4.0816326531, 3.9183673469, 4.0816326531, 3.0612244898,
      3.1836734694, 2.1224489796, 2.2040816327, 1.1020408163, 1.1428571429,
      0.8571428571, 0.8979591837, 1.7959183673, 1.8775510204, 2.8163265306,
      2.9387755102, 3.9183673469, 4.0816326531, 3.9183673469, 4.0816326531,
      3.9183673469, 4.0816326531, 3.9183673469, 4.0816326531, 3.0612244898,
      3.1836734694, 2.1224489796, 2.2040816327, 1.1020408163, 1.1428571429,
      0.8571428571, 0.8979591837, 1.7959183673, 1.8775510204, 2.8163265306,
      2.9387755102, 3.9183673469, 4.0816326531, 3.9183673469, 4.0816326531,
      3.9183673469, 4.0816326531, 3.9183673469, 4.0816326531, 3.0612244898,
      3.1836734694, 2.1224489796, 2.2040816327, 1.1020408163, 1.1428571429,
      0.8571428571, 0.8979591837, 1.7959183673, 1.8775510204, 2.8163265306,
      2.9387755102, 3.9183673469, 4.0816326531, 3.9183673469, 4.0816326531,
      3.9183673469, 4.0816326531, 3.9183673469, 4.0816326531, 3.0612244898,
      3.1836734694, 2.1224489796, 2.2040816327, 1.1020408163, 1.1428571429,
      0.8571428571, 0.8979591837, 1.7959183673, 1.8775510204, 2.8163265306,
      2.9387755102, 3.9183673469, 4.0816326531, 3.9183673469, 4.0816326531,
      3.9183673469, 4.0816326531, 3.9183673469, 4.0816326531, 3.0612244898,
      3.1836734694, 2.1224489796, 2.2040816327, 1.1020408163, 1.1428571429,
      0.8571428571, 0.8979591837, 1.7959183673, 1.8775510204, 2.8163265306,
      2.9387755102, 3.9183673469, 4.0816326531, 3.9183673469, 4.0816326531,
      3.9183673469, 4.0816326531, 3.9183673469, 4.0816326531, 3.0612244898,
      3.1836734694, 2.1224489796, 2.2040816327, 1.1020408163, 1.1428571429,
      0.5102040816, 0.5306122449, 1.0612244898, 1.1020408163, 1.6530612245,
      1.7142857143, 2.2857142857, 2.3673469388, 2.2857142857, 2.3673469388,
      2.2857142857, 2.3673469388, 2.2857142857, 2.3673469388, 1.7755102041,
      1.8367346939, 1.2244897959, 1.2653061224, 0.6326530612, 0.6530612245,
      0.6734693878, 0.693877551,  1.387755102,  1.4285714286, 2.1428571429,
      2.2040816327, 2.9387755102, 3.0204081633, 2.9387755102, 3.0204081633,
      2.9387755102, 3.0204081633, 2.9387755102, 3.0204081633, 2.2653061224,
      2.3265306122, 1.5510204082, 1.5918367347, 0.7959183673, 0.8163265306,
      1.5102040816, 1.5510204082, 3.1020408163, 3.1836734694, 4.7755102041,
      4.8979591837, 6.5306122449, 6.693877551,  6.5306122449, 6.693877551,
      6.5306122449, 6.693877551,  6.5306122449, 6.693877551,  5.0204081633,
      5.1428571429, 3.4285714286, 3.5102040816, 1.7551020408, 1.7959183673,
      1.5102040816, 1.5510204082, 3.1020408163, 3.1836734694, 4.7755102041,
      4.8979591837, 6.5306122449, 6.693877551,  6.5306122449, 6.693877551,
      6.5306122449, 6.693877551,  6.5306122449, 6.693877551,  5.0204081633,
      5.1428571429, 3.4285714286, 3.5102040816, 1.7551020408, 1.7959183673,
      1.5102040816, 1.5510204082, 3.1020408163, 3.1836734694, 4.7755102041,
      4.8979591837, 6.5306122449, 6.693877551,  6.5306122449, 6.693877551,
      6.5306122449, 6.693877551,  6.5306122449, 6.693877551,  5.0204081633,
      5.1428571429, 3.4285714286, 3.5102040816, 1.7551020408, 1.7959183673,
      1.5102040816, 1.5510204082, 3.1020408163, 3.1836734694, 4.7755102041,
      4.8979591837, 6.5306122449, 6.693877551,  6.5306122449, 6.693877551,
      6.5306122449, 6.693877551,  6.5306122449, 6.693877551,  5.0204081633,
      5.1428571429, 3.4285714286, 3.5102040816, 1.7551020408, 1.7959183673,
      1.5102040816, 1.5510204082, 3.1020408163, 3.1836734694, 4.7755102041,
      4.8979591837, 6.5306122449, 6.693877551,  6.5306122449, 6.693877551,
      6.5306122449, 6.693877551,  6.5306122449, 6.693877551,  5.0204081633,
      5.1428571429, 3.4285714286, 3.5102040816, 1.7551020408, 1.7959183673,
      1.5102040816, 1.5510204082, 3.1020408163, 3.1836734694, 4.7755102041,
      4.8979591837, 6.5306122449, 6.693877551,  6.5306122449, 6.693877551,
      6.5306122449, 6.693877551,  6.5306122449, 6.693877551,  5.0204081633,
      5.1428571429, 3.4285714286, 3.5102040816, 1.7551020408, 1.7959183673,
      0.8367346939, 0.8571428571, 1.7142857143, 1.7551020408, 2.6326530612,
      2.693877551,  3.5918367347, 3.6734693878, 3.5918367347, 3.6734693878,
      3.5918367347, 3.6734693878, 3.5918367347, 3.6734693878, 2.7551020408,
      2.8163265306, 1.8775510204, 1.9183673469, 0.9591836735, 0.9795918367};
  const std::array<int, 4> in_shape = {{3, 8, 10, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x8x10x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      32.7228174603,   33.2996938776,   33.8765702948,   34.453446712,
      40.0639739229,   40.7493537415,   41.4347335601,   42.1201133787,
      47.8391439909,   48.6330272109,   49.4269104308,   50.2207936508,
      56.0483276644,   56.9507142857,   57.853100907,    58.7554875283,
      56.3231292517,   57.1622222222,   58.0013151927,   58.8404081633,
      60.576462585,    61.4155555556,   62.2546485261,   63.0937414966,
      69.6691213152,   70.5715079365,   71.4738945578,   72.3762811791,
      62.761978458,    63.555861678,    64.349744898,    65.1436281179,
      55.4208219955,   56.1062018141,   56.7915816327,   57.4769614512,
      47.6456519274,   48.2225283447,   48.7994047619,   49.3762811791,
      50.7415249433,   51.4269047619,   52.1122845805,   52.7976643991,
      61.6949263039,   62.5092176871,   63.3235090703,   64.1378004535,
      73.1639739229,   74.1071768707,   75.0503798186,   75.9935827664,
      85.1486678005,   86.2207823129,   87.2928968254,   88.3650113379,
      84.1734693878,   85.1703854875,   86.1673015873,   87.1642176871,
      89.2268027211,   90.2237188209,   91.2206349206,   92.2175510204,
      101.3313662132,  102.4034807256,  103.4755952381,  104.5477097506,
      90.8936111111,   91.836814059,    92.7800170068,   93.7232199546,
      79.9402097506,   80.7545011338,   81.568792517,    82.3830839002,
      68.4711621315,   69.1565419501,   69.8419217687,   70.5273015873,
      76.8268424036,   77.6388095238,   78.450776644,    79.2627437642,
      92.9469104308,   93.9115986395,   94.8762868481,   95.8409750567,
      109.6778628118,  110.7952721088,  111.9126814059,  113.0300907029,
      127.0196995465,  128.289829932,   129.5599603175,  130.8300907029,
      124.0306122449,  125.2116553288,  126.3926984127,  127.5737414966,
      130.0172789116,  131.1983219955,  132.3793650794,  133.5604081633,
      146.1912868481,  147.4614172336,  148.731547619,   150.0016780045,
      130.6821031746,  131.7995124717,  132.9169217687,  134.0343310658,
      114.5620351474,  115.526723356,   116.4914115646,  117.4560997732,
      97.8310827664,   98.6430498866,   99.4550170068,   100.266984127,
      114.2054138322,  115.1692857143,  116.1331575964,  117.0970294785,
      137.6683390023,  138.8135034014,  139.9586678005,  141.1038321995,
      161.8564342404,  163.1828911565,  164.5093480726,  165.8358049887,
      186.7696995465,  188.2774489796,  189.7851984127,  191.2929478458,
      180.6972789116,  182.0992743764,  183.5012698413,  184.9032653061,
      187.8039455782,  189.2059410431,  190.6079365079,  192.0099319728,
      209.5279535147,  211.0357029478,  212.543452381,   214.0512018141,
      186.7901984127,  188.1166553288,  189.4431122449,  190.769569161,
      163.3272732426,  164.4724376417,  165.6176020408,  166.7627664399,
      139.1391780045,  140.1030498866,  141.0669217687,  142.0307936508,
      167.3720804989,  168.335952381,   169.299824263,   170.2636961451,
      200.8350056689,  201.980170068,   203.1253344671,  204.2704988662,
      235.023100907,   236.3495578231,  237.6760147392,  239.0024716553,
      269.9363662132,  271.4441156463,  272.9518650794,  274.4596145125,
      258.0306122449,  259.4326077098,  260.8346031746,  262.2365986395,
      265.1372789116,  266.5392743764,  267.9412698413,  269.3432653061,
      292.6946201814,  294.2023696145,  295.7101190476,  297.2178684807,
      259.9568650794,  261.2833219955,  262.6097789116,  263.9362358277,
      226.4939399093,  227.6391043084,  228.7842687075,  229.9294331066,
      192.3058446712,  193.2697165533,  194.2335884354,  195.1974603175,
      160.3744614512,  161.1864285714,  161.9983956916,  162.8103628118,
      192.2088151927,  193.1735034014,  194.13819161,    195.1028798186,
      224.654053288,   225.771462585,   226.8888718821,  228.0062811791,
      257.710175737,   258.9803061224,  260.2504365079,  261.5205668934,
      245.5544217687,  246.7354648526,  247.9165079365,  249.0975510204,
      251.5410884354,  252.7221315193,  253.9031746032,  255.0842176871,
      276.8817630385,  278.151893424,   279.4220238095,  280.692154195,
      245.6582936508,  246.7757029478,  247.8931122449,  249.010521542,
      213.8239399093,  214.7886281179,  215.7533163265,  216.7180045351,
      181.3787018141,  182.1906689342,  183.0026360544,  183.8146031746,
      149.4796201814,  150.165,         150.8503798186,  151.5357596372,
      179.0044501134,  179.8187414966,  180.6330328798,  181.447324263,
      209.0449263039,  209.9881292517,  210.9313321995,  211.8745351474,
      239.6010487528,  240.6731632653,  241.7452777778,  242.8173922902,
      227.7925170068,  228.7894331066,  229.7863492063,  230.7832653061,
      232.8458503401,  233.8427664399,  234.8396825397,  235.8365986395,
      255.7837471655,  256.855861678,   257.9279761905,  259.0000907029,
      226.7745634921,  227.7177664399,  228.6609693878,  229.6041723356,
      197.2497335601,  198.0640249433,  198.8783163265,  199.6926077098,
      167.2092573696,  167.8946371882,  168.5800170068,  169.2653968254,
      135.8010487528,  136.3779251701,  136.9548015873,  137.5316780045,
      162.5299603175,  163.2153401361,  163.9007199546,  164.5860997732,
      189.6928854875,  190.4867687075,  191.2806519274,  192.0745351474,
      217.289824263,   218.1922108844,  219.0945975057,  219.996984127,
      206.2551020408,  207.0941950113,  207.9332879819,  208.7723809524,
      210.5084353741,  211.3475283447,  212.1866213152,  213.0257142857,
      230.9106179138,  231.8130045351,  232.7153911565,  233.6177777778,
      204.6157199546,  205.4096031746,  206.2034863946,  206.9973696145,
      177.88680839,    178.5721882086,  179.2575680272,  179.9429478458,
      150.72388322,    151.3007596372,  151.8776360544,  152.4545124717,
      217.3232709751,  217.9001473923,  218.4770238095,  219.0539002268,
      259.385515873,   260.0708956916,  260.7562755102,  261.4416553288,
      301.8817743764,  302.6756575964,  303.4695408163,  304.2634240363,
      344.8120464853,  345.7144331066,  346.6168197279,  347.5192063492,
      324.8328798186,  325.6719727891,  326.5110657596,  327.3501587302,
      329.0862131519,  329.9253061224,  330.764399093,   331.6034920635,
      358.4328401361,  359.3352267574,  360.2376133787,  361.14,
      316.8046088435,  317.5984920635,  318.3923752834,  319.1862585034,
      274.7423639456,  275.4277437642,  276.1131235828,  276.7985034014,
      232.2461054422,  232.8229818594,  233.3998582766,  233.9767346939,
      270.0630668934,  270.748446712,   271.4338265306,  272.1192063492,
      322.2681689342,  323.0824603175,  323.8967517007,  324.7110430839,
      374.9889172336,  375.9321201814,  376.8753231293,  377.8185260771,
      428.2253117914,  429.2974263039,  430.3695408163,  431.4416553288,
      403.1866213152,  404.183537415,   405.1804535147,  406.1773696145,
      408.2399546485,  409.2368707483,  410.2337868481,  411.2307029478,
      444.4080102041,  445.4801247166,  446.552239229,   447.6243537415,
      392.7185544218,  393.6617573696,  394.6049603175,  395.5481632653,
      340.513452381,   341.3277437642,  342.1420351474,  342.9563265306,
      287.7927040816,  288.4780839002,  289.1634637188,  289.8488435374,
      336.6563208617,  337.4682879819,  338.280255102,   339.0922222222,
      401.6471371882,  402.6118253968,  403.5765136054,  404.5412018141,
      467.2488378685,  468.3662471655,  469.4836564626,  470.6010657596,
      533.4614229025,  534.731553288,   536.0016836735,  537.271814059,
      501.964399093,   503.1454421769,  504.3264852608,  505.5075283447,
      507.9510657596,  509.1321088435,  510.3131519274,  511.4941950113,
      552.6330102041,  553.9031405896,  555.1732709751,  556.4434013605,
      488.2530782313,  489.3704875283,  490.4878968254,  491.6053061224,
      423.2622619048,  424.2269501134,  425.191638322,   426.1563265306,
      357.6605612245,  358.4725283447,  359.2844954649,  360.096462585,
      422.6444160998,  423.6082879819,  424.5721598639,  425.536031746,
      504.120946712,   505.2661111111,  506.4112755102,  507.5564399093,
      586.3226473923,  587.6491043084,  588.9755612245,  590.3020181406,
      669.2495181406,  670.7572675737,  672.2650170068,  673.7727664399,
      629.3358276644,  630.7378231293,  632.1398185941,  633.541814059,
      636.4424943311,  637.8444897959,  639.2464852608,  640.6484807256,
      692.0077721088,  693.515521542,   695.0232709751,  696.5310204082,
      611.2564115646,  612.5828684807,  613.9093253968,  615.2357823129,
      529.7798809524,  530.9250453515,  532.0702097506,  533.2153741497,
      447.5781802721,  448.5420521542,  449.5059240363,  450.4697959184,
      475.8110827664,  476.7749546485,  477.7388265306,  478.7026984127,
      567.2876133787,  568.4327777778,  569.5779421769,  570.723106576,
      659.489314059,   660.8157709751,  662.1422278912,  663.4686848073,
      752.4161848073,  753.9239342404,  755.4316836735,  756.9394331066,
      706.6691609977,  708.0711564626,  709.4731519274,  710.8751473923,
      713.7758276644,  715.1778231293,  716.5798185941,  717.981814059,
      775.1744387755,  776.6821882086,  778.1899376417,  779.6976870748,
      684.4230782313,  685.7495351474,  687.0759920635,  688.4024489796,
      592.946547619,   594.0917120181,  595.2368764172,  596.3820408163,
      500.7448469388,  501.7087188209,  502.6725907029,  503.636462585,
      420.2039399093,  421.0159070295,  421.8278741497,  422.6398412698,
      500.9090419501,  501.8737301587,  502.8384183673,  503.803106576,
      582.2250283447,  583.3424376417,  584.4598469388,  585.5772562358,
      664.151899093,   665.4220294785,  666.6921598639,  667.9622902494,
      623.4882086168,  624.6692517007,  625.8502947846,  627.0313378685,
      629.4748752834,  630.6559183673,  631.8369614512,  633.0180045351,
      683.3234863946,  684.59361678,    685.8637471655,  687.133877551,
      603.2292687075,  604.3466780045,  605.4640873016,  606.5814965986,
      522.5241666667,  523.4888548753,  524.4535430839,  525.4182312925,
      441.2081802721,  442.0201473923,  442.8321145125,  443.6440816327,
      368.8011621315,  369.4865419501,  370.1719217687,  370.8573015873,
      439.5776927438,  440.391984127,   441.2062755102,  442.0205668934,
      510.8698696145,  511.8130725624,  512.7562755102,  513.699478458,
      582.6776927438,  583.7498072562,  584.8219217687,  585.8940362812,
      546.8056689342,  547.802585034,   548.7995011338,  549.7964172336,
      551.8590022676,  552.8559183673,  553.8528344671,  554.8497505669,
      598.8603911565,  599.9325056689,  601.0046201814,  602.0767346939,
      528.5995068027,  529.5427097506,  530.4859126984,  531.4291156463,
      457.8229761905,  458.6372675737,  459.4515589569,  460.2658503401,
      386.5307993197,  387.2161791383,  387.9015589569,  388.5869387755,
      320.4015022676,  320.9783786848,  321.555255102,   322.1321315193,
      381.8515022676,  382.5368820862,  383.2222619048,  383.9076417234,
      443.735515873,   444.529399093,   445.3232823129,  446.1171655329,
      506.0535430839,  506.9559297052,  507.8583163265,  508.7607029478,
      474.7648526077,  475.6039455782,  476.4430385488,  477.2821315193,
      479.018185941,   479.8572789116,  480.6963718821,  481.5354648526,
      519.6743367347,  520.576723356,   521.4791099773,  522.3814965986,
      458.6583503401,  459.4522335601,  460.24611678,    461.04,
      397.2083503401,  397.8937301587,  398.5791099773,  399.2644897959,
      335.3243367347,  335.9012131519,  336.4780895692,  337.0549659864,
      401.9237244898,  402.500600907,   403.0774773243,  403.6543537415,
      478.7070578231,  479.3924376417,  480.0778174603,  480.7631972789,
      555.9244047619,  556.7182879819,  557.5121712018,  558.3060544218,
      633.5757653061,  634.4781519274,  635.3805385488,  636.2829251701,
      593.3426303855,  594.181723356,   595.0208163265,  595.8599092971,
      597.5959637188,  598.4350566893,  599.2741496599,  600.1132426304,
      647.1965589569,  648.0989455782,  649.0013321995,  649.9037188209,
      570.847239229,   571.641122449,   572.4350056689,  573.2288888889,
      494.0639058957,  494.7492857143,  495.4346655329,  496.1200453515,
      416.8465589569,  417.4234353741,  418.0003117914,  418.5771882086,
      489.3846088435,  490.0699886621,  490.7553684807,  491.4407482993,
      582.8414115646,  583.6557029478,  584.4699943311,  585.2842857143,
      676.8138605442,  677.7570634921,  678.7002664399,  679.6434693878,
      771.3019557823,  772.3740702948,  773.4461848073,  774.5182993197,
      722.1997732426,  723.1966893424,  724.1936054422,  725.190521542,
      727.253106576,   728.2500226757,  729.2469387755,  730.2438548753,
      787.484654195,   788.5567687075,  789.62888322,    790.7009977324,
      694.5434977324,  695.4867006803,  696.4299036281,  697.373106576,
      601.0866950113,  601.9009863946,  602.7152777778,  603.529569161,
      507.1142460317,  507.7996258503,  508.4850056689,  509.1703854875,
      596.4857993197,  597.2977664399,  598.1097335601,  598.9217006803,
      710.3473639456,  711.3120521542,  712.2767403628,  713.2414285714,
      824.8198129252,  825.9372222222,  827.0546315193,  828.1720408163,
      939.9031462585,  941.173276644,   942.4434070295,  943.713537415,
      879.898185941,   881.0792290249,  882.2602721088,  883.4413151927,
      885.8848526077,  887.0658956916,  888.2469387755,  889.4279818594,
      959.0747335601,  960.3448639456,  961.6149943311,  962.8851247166,
      845.824053288,   846.941462585,   848.0588718821,  849.1762811791,
      731.9624886621,  732.9271768707,  733.8918650794,  734.856553288,
      617.4900396825,  618.3020068027,  619.1139739229,  619.9259410431,
      731.0834183673,  732.0472902494,  733.0111621315,  733.9750340136,
      870.5735544218,  871.7187188209,  872.86388322,    874.009047619,
      1010.7888605442, 1012.1153174603, 1013.4417743764, 1014.7682312925,
      1151.7293367347, 1153.2370861678, 1154.7448356009, 1156.252585034,
      1077.9743764172, 1079.3763718821, 1080.7783673469, 1082.1803628118,
      1085.0810430839, 1086.4830385488, 1087.8850340136, 1089.2870294785,
      1174.4875907029, 1175.9953401361, 1177.5030895692, 1179.0108390023,
      1035.7226247166, 1037.0490816327, 1038.3755385488, 1039.7019954649,
      896.2324886621,  897.3776530612,  898.5228174603,  899.6679818594,
      756.0171825397,  756.9810544218,  757.9449263039,  758.9087981859,
      784.250085034,   785.2139569161,  786.1778287982,  787.1417006803,
      933.7402210884,  934.8853854875,  936.0305498866,  937.1757142857,
      1083.9555272109, 1085.281984127,  1086.6084410431, 1087.9348979592,
      1234.8960034014, 1236.4037528345, 1237.9115022676, 1239.4192517007,
      1155.3077097506, 1156.7097052154, 1158.1117006803, 1159.5136961451,
      1162.4143764172, 1163.8163718821, 1165.2183673469, 1166.6203628118,
      1257.6542573696, 1259.1620068027, 1260.6697562358, 1262.1775056689,
      1108.8892913832, 1110.2157482993, 1111.5422052154, 1112.8686621315,
      959.3991553288,  960.5443197279,  961.689484127,   962.8346485261,
      809.1838492063,  810.1477210884,  811.1115929705,  812.0754648526,
      680.0334183673,  680.8453854875,  681.6573526077,  682.4693197279,
      809.6092687075,  810.5739569161,  811.5386451247,  812.5033333333,
      939.7960034014,  940.9134126984,  942.0308219955,  943.1482312925,
      1070.593622449,  1071.8637528345, 1073.13388322,   1074.4040136054,
      1001.4219954649, 1002.6030385488, 1003.7840816327, 1004.9651247166,
      1007.4086621315, 1008.5897052154, 1009.7707482993, 1010.9517913832,
      1089.7652097506, 1091.0353401361, 1092.3054705215, 1093.575600907,
      960.8002437642,  961.9176530612,  963.0350623583,  964.1524716553,
      831.224393424,   832.1890816327,  833.1537698413,  834.1184580499,
      701.0376587302,  701.8496258503,  702.6615929705,  703.4735600907,
      588.1227040816,  588.8080839002,  589.4934637188,  590.1788435374,
      700.1509353741,  700.9652267574,  701.7795181406,  702.5938095238,
      812.6948129252,  813.638015873,   814.5812188209,  815.5244217687,
      925.7543367347,  926.8264512472,  927.8985657596,  928.9706802721,
      865.8188208617,  866.8157369615,  867.8126530612,  868.809569161,
      870.872154195,   871.8690702948,  872.8659863946,  873.8629024943,
      941.9370351474,  943.0091496599,  944.0812641723,  945.1533786848,
      830.4244501134,  831.3676530612,  832.3108560091,  833.2540589569,
      718.3962188209,  719.2105102041,  720.0248015873,  720.8390929705,
      605.8523412698,  606.5377210884,  607.223100907,   607.9084807256,
      505.0019557823,  505.5788321995,  506.1557086168,  506.732585034,
      601.1730442177,  601.8584240363,  602.5438038549,  603.2291836735,
      697.7781462585,  698.5720294785,  699.3659126984,  700.1597959184,
      794.8172619048,  795.7196485261,  796.6220351474,  797.5244217687,
      743.2746031746,  744.1136961451,  744.9527891156,  745.7918820862,
      747.5279365079,  748.3670294785,  749.206122449,   750.0452154195,
      808.4380555556,  809.3404421769,  810.2428287982,  811.1452154195,
      712.7009807256,  713.4948639456,  714.2887471655,  715.0826303855,
      616.5298922902,  617.2152721088,  617.9006519274,  618.586031746,
      519.9247902494,  520.5016666667,  521.0785430839,  521.6554195011};
  const std::array<int, 4> in_shape = {{3, 8, 10, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x8x10x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.0204081633,
                                         0.0408163265,
                                         0.0612244898,
                                         0.0816326531,
                                         0.1224489796,
                                         0.1632653061,
                                         0.2040816327,
                                         0.2448979592,
                                         0.306122449,
                                         0.3673469388,
                                         0.4285714286,
                                         0.4897959184,
                                         0.5714285714,
                                         0.6530612245,
                                         0.7346938776,
                                         0.8163265306,
                                         0.5714285714,
                                         0.6530612245,
                                         0.7346938776,
                                         0.8163265306,
                                         0.5714285714,
                                         0.6530612245,
                                         0.7346938776,
                                         0.8163265306,
                                         0.5714285714,
                                         0.6530612245,
                                         0.7346938776,
                                         0.8163265306,
                                         0.5510204082,
                                         0.612244898,
                                         0.6734693878,
                                         0.7346938776,
                                         0.4489795918,
                                         0.4897959184,
                                         0.5306122449,
                                         0.5714285714,
                                         0.2653061224,
                                         0.2857142857,
                                         0.306122449,
                                         0.3265306122,
                                         0.3673469388,
                                         0.4081632653,
                                         0.4489795918,
                                         0.4897959184,
                                         0.8979591837,
                                         0.9795918367,
                                         1.0612244898,
                                         1.1428571429,
                                         1.5918367347,
                                         1.7142857143,
                                         1.8367346939,
                                         1.9591836735,
                                         2.4489795918,
                                         2.612244898,
                                         2.7755102041,
                                         2.9387755102,
                                         2.4489795918,
                                         2.612244898,
                                         2.7755102041,
                                         2.9387755102,
                                         2.4489795918,
                                         2.612244898,
                                         2.7755102041,
                                         2.9387755102,
                                         2.4489795918,
                                         2.612244898,
                                         2.7755102041,
                                         2.9387755102,
                                         2.0816326531,
                                         2.2040816327,
                                         2.3265306122,
                                         2.4489795918,
                                         1.5510204082,
                                         1.6326530612,
                                         1.7142857143,
                                         1.7959183673,
                                         0.8571428571,
                                         0.8979591837,
                                         0.9387755102,
                                         0.9795918367,
                                         0.3673469388,
                                         0.4081632653,
                                         0.4489795918,
                                         0.4897959184,
                                         0.8979591837,
                                         0.9795918367,
                                         1.0612244898,
                                         1.1428571429,
                                         1.5918367347,
                                         1.7142857143,
                                         1.8367346939,
                                         1.9591836735,
                                         2.4489795918,
                                         2.612244898,
                                         2.7755102041,
                                         2.9387755102,
                                         2.4489795918,
                                         2.612244898,
                                         2.7755102041,
                                         2.9387755102,
                                         2.4489795918,
                                         2.612244898,
                                         2.7755102041,
                                         2.9387755102,
                                         2.4489795918,
                                         2.612244898,
                                         2.7755102041,
                                         2.9387755102,
                                         2.0816326531,
                                         2.2040816327,
                                         2.3265306122,
                                         2.4489795918,
                                         1.5510204082,
                                         1.6326530612,
                                         1.7142857143,
                                         1.7959183673,
                                         0.8571428571,
                                         0.8979591837,
                                         0.9387755102,
                                         0.9795918367,
                                         0.3673469388,
                                         0.4081632653,
                                         0.4489795918,
                                         0.4897959184,
                                         0.8979591837,
                                         0.9795918367,
                                         1.0612244898,
                                         1.1428571429,
                                         1.5918367347,
                                         1.7142857143,
                                         1.8367346939,
                                         1.9591836735,
                                         2.4489795918,
                                         2.612244898,
                                         2.7755102041,
                                         2.9387755102,
                                         2.4489795918,
                                         2.612244898,
                                         2.7755102041,
                                         2.9387755102,
                                         2.4489795918,
                                         2.612244898,
                                         2.7755102041,
                                         2.9387755102,
                                         2.4489795918,
                                         2.612244898,
                                         2.7755102041,
                                         2.9387755102,
                                         2.0816326531,
                                         2.2040816327,
                                         2.3265306122,
                                         2.4489795918,
                                         1.5510204082,
                                         1.6326530612,
                                         1.7142857143,
                                         1.7959183673,
                                         0.8571428571,
                                         0.8979591837,
                                         0.9387755102,
                                         0.9795918367,
                                         0.3673469388,
                                         0.4081632653,
                                         0.4489795918,
                                         0.4897959184,
                                         0.8979591837,
                                         0.9795918367,
                                         1.0612244898,
                                         1.1428571429,
                                         1.5918367347,
                                         1.7142857143,
                                         1.8367346939,
                                         1.9591836735,
                                         2.4489795918,
                                         2.612244898,
                                         2.7755102041,
                                         2.9387755102,
                                         2.4489795918,
                                         2.612244898,
                                         2.7755102041,
                                         2.9387755102,
                                         2.4489795918,
                                         2.612244898,
                                         2.7755102041,
                                         2.9387755102,
                                         2.4489795918,
                                         2.612244898,
                                         2.7755102041,
                                         2.9387755102,
                                         2.0816326531,
                                         2.2040816327,
                                         2.3265306122,
                                         2.4489795918,
                                         1.5510204082,
                                         1.6326530612,
                                         1.7142857143,
                                         1.7959183673,
                                         0.8571428571,
                                         0.8979591837,
                                         0.9387755102,
                                         0.9795918367,
                                         0.3673469388,
                                         0.4081632653,
                                         0.4489795918,
                                         0.4897959184,
                                         0.8979591837,
                                         0.9795918367,
                                         1.0612244898,
                                         1.1428571429,
                                         1.5918367347,
                                         1.7142857143,
                                         1.8367346939,
                                         1.9591836735,
                                         2.4489795918,
                                         2.612244898,
                                         2.7755102041,
                                         2.9387755102,
                                         2.4489795918,
                                         2.612244898,
                                         2.7755102041,
                                         2.9387755102,
                                         2.4489795918,
                                         2.612244898,
                                         2.7755102041,
                                         2.9387755102,
                                         2.4489795918,
                                         2.612244898,
                                         2.7755102041,
                                         2.9387755102,
                                         2.0816326531,
                                         2.2040816327,
                                         2.3265306122,
                                         2.4489795918,
                                         1.5510204082,
                                         1.6326530612,
                                         1.7142857143,
                                         1.7959183673,
                                         0.8571428571,
                                         0.8979591837,
                                         0.9387755102,
                                         0.9795918367,
                                         0.3673469388,
                                         0.4081632653,
                                         0.4489795918,
                                         0.4897959184,
                                         0.8979591837,
                                         0.9795918367,
                                         1.0612244898,
                                         1.1428571429,
                                         1.5918367347,
                                         1.7142857143,
                                         1.8367346939,
                                         1.9591836735,
                                         2.4489795918,
                                         2.612244898,
                                         2.7755102041,
                                         2.9387755102,
                                         2.4489795918,
                                         2.612244898,
                                         2.7755102041,
                                         2.9387755102,
                                         2.4489795918,
                                         2.612244898,
                                         2.7755102041,
                                         2.9387755102,
                                         2.4489795918,
                                         2.612244898,
                                         2.7755102041,
                                         2.9387755102,
                                         2.0816326531,
                                         2.2040816327,
                                         2.3265306122,
                                         2.4489795918,
                                         1.5510204082,
                                         1.6326530612,
                                         1.7142857143,
                                         1.7959183673,
                                         0.8571428571,
                                         0.8979591837,
                                         0.9387755102,
                                         0.9795918367,
                                         0.3469387755,
                                         0.3673469388,
                                         0.387755102,
                                         0.4081632653,
                                         0.7755102041,
                                         0.8163265306,
                                         0.8571428571,
                                         0.8979591837,
                                         1.2857142857,
                                         1.3469387755,
                                         1.4081632653,
                                         1.4693877551,
                                         1.8775510204,
                                         1.9591836735,
                                         2.0408163265,
                                         2.1224489796,
                                         1.8775510204,
                                         1.9591836735,
                                         2.0408163265,
                                         2.1224489796,
                                         1.8775510204,
                                         1.9591836735,
                                         2.0408163265,
                                         2.1224489796,
                                         1.8775510204,
                                         1.9591836735,
                                         2.0408163265,
                                         2.1224489796,
                                         1.5306122449,
                                         1.5918367347,
                                         1.6530612245,
                                         1.7142857143,
                                         1.1020408163,
                                         1.1428571429,
                                         1.1836734694,
                                         1.2244897959,
                                         0.5918367347,
                                         0.612244898,
                                         0.6326530612,
                                         0.6530612245,
                                         0.6734693878,
                                         0.693877551,
                                         0.7142857143,
                                         0.7346938776,
                                         1.4285714286,
                                         1.4693877551,
                                         1.5102040816,
                                         1.5510204082,
                                         2.2653061224,
                                         2.3265306122,
                                         2.387755102,
                                         2.4489795918,
                                         3.1836734694,
                                         3.2653061224,
                                         3.3469387755,
                                         3.4285714286,
                                         3.1836734694,
                                         3.2653061224,
                                         3.3469387755,
                                         3.4285714286,
                                         3.1836734694,
                                         3.2653061224,
                                         3.3469387755,
                                         3.4285714286,
                                         3.1836734694,
                                         3.2653061224,
                                         3.3469387755,
                                         3.4285714286,
                                         2.5102040816,
                                         2.5714285714,
                                         2.6326530612,
                                         2.693877551,
                                         1.7551020408,
                                         1.7959183673,
                                         1.8367346939,
                                         1.8775510204,
                                         0.9183673469,
                                         0.9387755102,
                                         0.9591836735,
                                         0.9795918367,
                                         1.6734693878,
                                         1.7142857143,
                                         1.7551020408,
                                         1.7959183673,
                                         3.5102040816,
                                         3.5918367347,
                                         3.6734693878,
                                         3.7551020408,
                                         5.5102040816,
                                         5.6326530612,
                                         5.7551020408,
                                         5.8775510204,
                                         7.6734693878,
                                         7.8367346939,
                                         8.,
                                         8.1632653061,
                                         7.6734693878,
                                         7.8367346939,
                                         8.,
                                         8.1632653061,
                                         7.6734693878,
                                         7.8367346939,
                                         8.,
                                         8.1632653061,
                                         7.6734693878,
                                         7.8367346939,
                                         8.,
                                         8.1632653061,
                                         6.,
                                         6.1224489796,
                                         6.2448979592,
                                         6.3673469388,
                                         4.1632653061,
                                         4.2448979592,
                                         4.3265306122,
                                         4.4081632653,
                                         2.1632653061,
                                         2.2040816327,
                                         2.2448979592,
                                         2.2857142857,
                                         1.6734693878,
                                         1.7142857143,
                                         1.7551020408,
                                         1.7959183673,
                                         3.5102040816,
                                         3.5918367347,
                                         3.6734693878,
                                         3.7551020408,
                                         5.5102040816,
                                         5.6326530612,
                                         5.7551020408,
                                         5.8775510204,
                                         7.6734693878,
                                         7.8367346939,
                                         8.,
                                         8.1632653061,
                                         7.6734693878,
                                         7.8367346939,
                                         8.,
                                         8.1632653061,
                                         7.6734693878,
                                         7.8367346939,
                                         8.,
                                         8.1632653061,
                                         7.6734693878,
                                         7.8367346939,
                                         8.,
                                         8.1632653061,
                                         6.,
                                         6.1224489796,
                                         6.2448979592,
                                         6.3673469388,
                                         4.1632653061,
                                         4.2448979592,
                                         4.3265306122,
                                         4.4081632653,
                                         2.1632653061,
                                         2.2040816327,
                                         2.2448979592,
                                         2.2857142857,
                                         1.6734693878,
                                         1.7142857143,
                                         1.7551020408,
                                         1.7959183673,
                                         3.5102040816,
                                         3.5918367347,
                                         3.6734693878,
                                         3.7551020408,
                                         5.5102040816,
                                         5.6326530612,
                                         5.7551020408,
                                         5.8775510204,
                                         7.6734693878,
                                         7.8367346939,
                                         8.,
                                         8.1632653061,
                                         7.6734693878,
                                         7.8367346939,
                                         8.,
                                         8.1632653061,
                                         7.6734693878,
                                         7.8367346939,
                                         8.,
                                         8.1632653061,
                                         7.6734693878,
                                         7.8367346939,
                                         8.,
                                         8.1632653061,
                                         6.,
                                         6.1224489796,
                                         6.2448979592,
                                         6.3673469388,
                                         4.1632653061,
                                         4.2448979592,
                                         4.3265306122,
                                         4.4081632653,
                                         2.1632653061,
                                         2.2040816327,
                                         2.2448979592,
                                         2.2857142857,
                                         1.6734693878,
                                         1.7142857143,
                                         1.7551020408,
                                         1.7959183673,
                                         3.5102040816,
                                         3.5918367347,
                                         3.6734693878,
                                         3.7551020408,
                                         5.5102040816,
                                         5.6326530612,
                                         5.7551020408,
                                         5.8775510204,
                                         7.6734693878,
                                         7.8367346939,
                                         8.,
                                         8.1632653061,
                                         7.6734693878,
                                         7.8367346939,
                                         8.,
                                         8.1632653061,
                                         7.6734693878,
                                         7.8367346939,
                                         8.,
                                         8.1632653061,
                                         7.6734693878,
                                         7.8367346939,
                                         8.,
                                         8.1632653061,
                                         6.,
                                         6.1224489796,
                                         6.2448979592,
                                         6.3673469388,
                                         4.1632653061,
                                         4.2448979592,
                                         4.3265306122,
                                         4.4081632653,
                                         2.1632653061,
                                         2.2040816327,
                                         2.2448979592,
                                         2.2857142857,
                                         1.6734693878,
                                         1.7142857143,
                                         1.7551020408,
                                         1.7959183673,
                                         3.5102040816,
                                         3.5918367347,
                                         3.6734693878,
                                         3.7551020408,
                                         5.5102040816,
                                         5.6326530612,
                                         5.7551020408,
                                         5.8775510204,
                                         7.6734693878,
                                         7.8367346939,
                                         8.,
                                         8.1632653061,
                                         7.6734693878,
                                         7.8367346939,
                                         8.,
                                         8.1632653061,
                                         7.6734693878,
                                         7.8367346939,
                                         8.,
                                         8.1632653061,
                                         7.6734693878,
                                         7.8367346939,
                                         8.,
                                         8.1632653061,
                                         6.,
                                         6.1224489796,
                                         6.2448979592,
                                         6.3673469388,
                                         4.1632653061,
                                         4.2448979592,
                                         4.3265306122,
                                         4.4081632653,
                                         2.1632653061,
                                         2.2040816327,
                                         2.2448979592,
                                         2.2857142857,
                                         1.6734693878,
                                         1.7142857143,
                                         1.7551020408,
                                         1.7959183673,
                                         3.5102040816,
                                         3.5918367347,
                                         3.6734693878,
                                         3.7551020408,
                                         5.5102040816,
                                         5.6326530612,
                                         5.7551020408,
                                         5.8775510204,
                                         7.6734693878,
                                         7.8367346939,
                                         8.,
                                         8.1632653061,
                                         7.6734693878,
                                         7.8367346939,
                                         8.,
                                         8.1632653061,
                                         7.6734693878,
                                         7.8367346939,
                                         8.,
                                         8.1632653061,
                                         7.6734693878,
                                         7.8367346939,
                                         8.,
                                         8.1632653061,
                                         6.,
                                         6.1224489796,
                                         6.2448979592,
                                         6.3673469388,
                                         4.1632653061,
                                         4.2448979592,
                                         4.3265306122,
                                         4.4081632653,
                                         2.1632653061,
                                         2.2040816327,
                                         2.2448979592,
                                         2.2857142857,
                                         1.,
                                         1.0204081633,
                                         1.0408163265,
                                         1.0612244898,
                                         2.0816326531,
                                         2.1224489796,
                                         2.1632653061,
                                         2.2040816327,
                                         3.2448979592,
                                         3.306122449,
                                         3.3673469388,
                                         3.4285714286,
                                         4.4897959184,
                                         4.5714285714,
                                         4.6530612245,
                                         4.7346938776,
                                         4.4897959184,
                                         4.5714285714,
                                         4.6530612245,
                                         4.7346938776,
                                         4.4897959184,
                                         4.5714285714,
                                         4.6530612245,
                                         4.7346938776,
                                         4.4897959184,
                                         4.5714285714,
                                         4.6530612245,
                                         4.7346938776,
                                         3.4897959184,
                                         3.5510204082,
                                         3.612244898,
                                         3.6734693878,
                                         2.4081632653,
                                         2.4489795918,
                                         2.4897959184,
                                         2.5306122449,
                                         1.2448979592,
                                         1.2653061224,
                                         1.2857142857,
                                         1.306122449,
                                         1.3265306122,
                                         1.3469387755,
                                         1.3673469388,
                                         1.387755102,
                                         2.7346938776,
                                         2.7755102041,
                                         2.8163265306,
                                         2.8571428571,
                                         4.2244897959,
                                         4.2857142857,
                                         4.3469387755,
                                         4.4081632653,
                                         5.7959183673,
                                         5.8775510204,
                                         5.9591836735,
                                         6.0408163265,
                                         5.7959183673,
                                         5.8775510204,
                                         5.9591836735,
                                         6.0408163265,
                                         5.7959183673,
                                         5.8775510204,
                                         5.9591836735,
                                         6.0408163265,
                                         5.7959183673,
                                         5.8775510204,
                                         5.9591836735,
                                         6.0408163265,
                                         4.4693877551,
                                         4.5306122449,
                                         4.5918367347,
                                         4.6530612245,
                                         3.0612244898,
                                         3.1020408163,
                                         3.1428571429,
                                         3.1836734694,
                                         1.5714285714,
                                         1.5918367347,
                                         1.612244898,
                                         1.6326530612,
                                         2.9795918367,
                                         3.0204081633,
                                         3.0612244898,
                                         3.1020408163,
                                         6.1224489796,
                                         6.2040816327,
                                         6.2857142857,
                                         6.3673469388,
                                         9.4285714286,
                                         9.5510204082,
                                         9.6734693878,
                                         9.7959183673,
                                         12.8979591837,
                                         13.0612244898,
                                         13.2244897959,
                                         13.387755102,
                                         12.8979591837,
                                         13.0612244898,
                                         13.2244897959,
                                         13.387755102,
                                         12.8979591837,
                                         13.0612244898,
                                         13.2244897959,
                                         13.387755102,
                                         12.8979591837,
                                         13.0612244898,
                                         13.2244897959,
                                         13.387755102,
                                         9.9183673469,
                                         10.0408163265,
                                         10.1632653061,
                                         10.2857142857,
                                         6.7755102041,
                                         6.8571428571,
                                         6.9387755102,
                                         7.0204081633,
                                         3.4693877551,
                                         3.5102040816,
                                         3.5510204082,
                                         3.5918367347,
                                         2.9795918367,
                                         3.0204081633,
                                         3.0612244898,
                                         3.1020408163,
                                         6.1224489796,
                                         6.2040816327,
                                         6.2857142857,
                                         6.3673469388,
                                         9.4285714286,
                                         9.5510204082,
                                         9.6734693878,
                                         9.7959183673,
                                         12.8979591837,
                                         13.0612244898,
                                         13.2244897959,
                                         13.387755102,
                                         12.8979591837,
                                         13.0612244898,
                                         13.2244897959,
                                         13.387755102,
                                         12.8979591837,
                                         13.0612244898,
                                         13.2244897959,
                                         13.387755102,
                                         12.8979591837,
                                         13.0612244898,
                                         13.2244897959,
                                         13.387755102,
                                         9.9183673469,
                                         10.0408163265,
                                         10.1632653061,
                                         10.2857142857,
                                         6.7755102041,
                                         6.8571428571,
                                         6.9387755102,
                                         7.0204081633,
                                         3.4693877551,
                                         3.5102040816,
                                         3.5510204082,
                                         3.5918367347,
                                         2.9795918367,
                                         3.0204081633,
                                         3.0612244898,
                                         3.1020408163,
                                         6.1224489796,
                                         6.2040816327,
                                         6.2857142857,
                                         6.3673469388,
                                         9.4285714286,
                                         9.5510204082,
                                         9.6734693878,
                                         9.7959183673,
                                         12.8979591837,
                                         13.0612244898,
                                         13.2244897959,
                                         13.387755102,
                                         12.8979591837,
                                         13.0612244898,
                                         13.2244897959,
                                         13.387755102,
                                         12.8979591837,
                                         13.0612244898,
                                         13.2244897959,
                                         13.387755102,
                                         12.8979591837,
                                         13.0612244898,
                                         13.2244897959,
                                         13.387755102,
                                         9.9183673469,
                                         10.0408163265,
                                         10.1632653061,
                                         10.2857142857,
                                         6.7755102041,
                                         6.8571428571,
                                         6.9387755102,
                                         7.0204081633,
                                         3.4693877551,
                                         3.5102040816,
                                         3.5510204082,
                                         3.5918367347,
                                         2.9795918367,
                                         3.0204081633,
                                         3.0612244898,
                                         3.1020408163,
                                         6.1224489796,
                                         6.2040816327,
                                         6.2857142857,
                                         6.3673469388,
                                         9.4285714286,
                                         9.5510204082,
                                         9.6734693878,
                                         9.7959183673,
                                         12.8979591837,
                                         13.0612244898,
                                         13.2244897959,
                                         13.387755102,
                                         12.8979591837,
                                         13.0612244898,
                                         13.2244897959,
                                         13.387755102,
                                         12.8979591837,
                                         13.0612244898,
                                         13.2244897959,
                                         13.387755102,
                                         12.8979591837,
                                         13.0612244898,
                                         13.2244897959,
                                         13.387755102,
                                         9.9183673469,
                                         10.0408163265,
                                         10.1632653061,
                                         10.2857142857,
                                         6.7755102041,
                                         6.8571428571,
                                         6.9387755102,
                                         7.0204081633,
                                         3.4693877551,
                                         3.5102040816,
                                         3.5510204082,
                                         3.5918367347,
                                         2.9795918367,
                                         3.0204081633,
                                         3.0612244898,
                                         3.1020408163,
                                         6.1224489796,
                                         6.2040816327,
                                         6.2857142857,
                                         6.3673469388,
                                         9.4285714286,
                                         9.5510204082,
                                         9.6734693878,
                                         9.7959183673,
                                         12.8979591837,
                                         13.0612244898,
                                         13.2244897959,
                                         13.387755102,
                                         12.8979591837,
                                         13.0612244898,
                                         13.2244897959,
                                         13.387755102,
                                         12.8979591837,
                                         13.0612244898,
                                         13.2244897959,
                                         13.387755102,
                                         12.8979591837,
                                         13.0612244898,
                                         13.2244897959,
                                         13.387755102,
                                         9.9183673469,
                                         10.0408163265,
                                         10.1632653061,
                                         10.2857142857,
                                         6.7755102041,
                                         6.8571428571,
                                         6.9387755102,
                                         7.0204081633,
                                         3.4693877551,
                                         3.5102040816,
                                         3.5510204082,
                                         3.5918367347,
                                         2.9795918367,
                                         3.0204081633,
                                         3.0612244898,
                                         3.1020408163,
                                         6.1224489796,
                                         6.2040816327,
                                         6.2857142857,
                                         6.3673469388,
                                         9.4285714286,
                                         9.5510204082,
                                         9.6734693878,
                                         9.7959183673,
                                         12.8979591837,
                                         13.0612244898,
                                         13.2244897959,
                                         13.387755102,
                                         12.8979591837,
                                         13.0612244898,
                                         13.2244897959,
                                         13.387755102,
                                         12.8979591837,
                                         13.0612244898,
                                         13.2244897959,
                                         13.387755102,
                                         12.8979591837,
                                         13.0612244898,
                                         13.2244897959,
                                         13.387755102,
                                         9.9183673469,
                                         10.0408163265,
                                         10.1632653061,
                                         10.2857142857,
                                         6.7755102041,
                                         6.8571428571,
                                         6.9387755102,
                                         7.0204081633,
                                         3.4693877551,
                                         3.5102040816,
                                         3.5510204082,
                                         3.5918367347,
                                         1.6530612245,
                                         1.6734693878,
                                         1.693877551,
                                         1.7142857143,
                                         3.387755102,
                                         3.4285714286,
                                         3.4693877551,
                                         3.5102040816,
                                         5.2040816327,
                                         5.2653061224,
                                         5.3265306122,
                                         5.387755102,
                                         7.1020408163,
                                         7.1836734694,
                                         7.2653061224,
                                         7.3469387755,
                                         7.1020408163,
                                         7.1836734694,
                                         7.2653061224,
                                         7.3469387755,
                                         7.1020408163,
                                         7.1836734694,
                                         7.2653061224,
                                         7.3469387755,
                                         7.1020408163,
                                         7.1836734694,
                                         7.2653061224,
                                         7.3469387755,
                                         5.4489795918,
                                         5.5102040816,
                                         5.5714285714,
                                         5.6326530612,
                                         3.7142857143,
                                         3.7551020408,
                                         3.7959183673,
                                         3.8367346939,
                                         1.8979591837,
                                         1.9183673469,
                                         1.9387755102,
                                         1.9591836735};
  const std::array<int, 4> in_shape = {{3, 8, 10, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x9x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      7.1521825397,   8.7940192744,   10.8360827664,  13.4384637188,
      14.7676303855,  12.9247732426,  11.2624716553,  9.729138322,
      10.8702097506,  13.2671485261,  16.2139739229,  19.9306405896,
      21.5098072562,  18.695521542,   16.1998866213,  13.9318594104,
      15.4562641723,  18.7715702948,  22.8136337868,  27.8731575964,
      29.702324263,   25.6880385488,  22.1685941043,  19.0026077098,
      21.8193594104,  26.3965702948,  31.9386337868,  38.8314909297,
      40.952324263,   35.2713718821,  30.335260771,   25.9311791383,
      30.2399546485,  36.3814512472,  43.7401814059,  52.8030385488,
      54.8363718821,  46.9354195011,  40.1576417234,  34.1821315193,
      41.2631689342,  49.4975226757,  59.3062528345,  71.3191099773,
      73.4399433107,  62.6389909297,  53.4362131519,  45.3749886621,
      38.9508673469,  46.6852210884,  55.8828401361,  67.1290306122,
      68.9581972789,  58.757244898,   50.082244898,   42.4972108844,
      36.1008673469,  43.2433843537,  51.7267176871,  62.0871938776,
      63.6663605442,  54.2082653061,  46.176122449,   39.1625170068,
      32.3828401361,  38.770255102,   46.3488265306,  55.5950170068,
      56.9241836735,  48.4375170068,  41.238707483,   34.9597959184,
      48.6872845805,  58.1413662132,  69.2977154195,  82.837239229,
      84.1664058957,  71.3864058957,  60.6098185941,  51.2642403628,
      60.2175566893,  71.8961281179,  85.6715249433,  102.3824773243,
      103.9616439909, 88.1530725624,  74.8288662132,  63.2792063492,
      72.6158560091,  86.6821825397,  103.2671031746, 123.3780555556,
      125.2072222222, 106.1415079365, 90.0792063492,  76.1621995465,
      88.0932369615,  105.1357539683, 125.2206746032, 149.5649603175,
      151.6857936508, 128.5534126984, 109.0744444444, 92.2050566893,
      93.7795464853,  111.8720634921, 133.1736507937, 158.9679365079,
      161.0012698413, 136.3688888889, 115.6482539683, 97.721723356,
      107.5370464853, 128.2367063492, 152.5882936508, 182.0525793651,
      184.1734126984, 155.921031746,  132.1753968254, 111.6488662132,
      96.1104591837,  114.5958333333, 136.3363095238, 162.6339285714,
      164.4630952381, 139.2107142857, 117.9928571429, 99.6568027211,
      85.4482142857,  101.8723639456, 121.1842687075, 144.5390306122,
      146.1181972789, 123.6658163265, 104.8051020408, 88.5098639456,
      73.9179421769,  88.1176020408,  104.8104591837, 124.993792517,
      126.3229591837, 106.8991496599, 90.5860544218,  76.4948979592,
      90.2223866213,  107.4887131519, 127.7593480726, 152.2360147392,
      153.5651814059, 129.8480385488, 109.9571655329, 92.7993424036,
      109.5649036281, 130.5251077098, 155.1290759637, 184.834314059,
      186.4134807256, 157.6106235828, 133.457845805,  112.626553288,
      129.7754478458, 154.5927947846, 183.7205725624, 218.8829535147,
      220.7121201814, 186.5949773243, 157.9898185941, 133.3217913832,
      154.3671145125, 183.8749376417, 218.5027154195, 260.2984297052,
      262.4192630385, 221.8354535147, 187.8136281179, 158.4789342404,
      157.319138322,  187.362675737,  222.6071201814, 265.1328344671,
      267.1661678005, 225.8023582766, 191.1388662132, 161.2613151927,
      173.8109240363, 206.9758900227, 245.8703344671, 292.7860487528,
      294.9068820862, 249.2030725624, 210.9145804989, 177.9227437642,
      153.2700510204, 182.5064455782, 216.7897789116, 258.1388265306,
      259.9679931973, 219.6641836735, 185.9034693878, 156.8163945578,
      134.7955612245, 160.5013435374, 190.6418197279, 226.9908673469,
      228.5700340136, 193.1233673469, 163.4340816327, 137.8572108844,
      115.4530442177, 137.4649489796, 163.2720918367, 194.3925680272,
      195.7217346939, 165.3607823129, 139.9334013605, 118.03,
  };
  const std::array<int, 4> in_shape = {{3, 9, 8, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x9x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.0204081633, 0.0612244898, 0.0612244898, 0.0612244898, 0.0612244898,
      0.0612244898, 0.0612244898, 0.0408163265, 0.0816326531, 0.2040816327,
      0.2040816327, 0.2040816327, 0.2040816327, 0.2040816327, 0.2040816327,
      0.1224489796, 0.1836734694, 0.4285714286, 0.4285714286, 0.4285714286,
      0.4285714286, 0.4285714286, 0.4285714286, 0.2448979592, 0.1836734694,
      0.4285714286, 0.4285714286, 0.4285714286, 0.4285714286, 0.4285714286,
      0.4285714286, 0.2448979592, 0.1836734694, 0.4285714286, 0.4285714286,
      0.4285714286, 0.4285714286, 0.4285714286, 0.4285714286, 0.2448979592,
      0.1836734694, 0.4285714286, 0.4285714286, 0.4285714286, 0.4285714286,
      0.4285714286, 0.4285714286, 0.2448979592, 0.1836734694, 0.4285714286,
      0.4285714286, 0.4285714286, 0.4285714286, 0.4285714286, 0.4285714286,
      0.2448979592, 0.1632653061, 0.3673469388, 0.3673469388, 0.3673469388,
      0.3673469388, 0.3673469388, 0.3673469388, 0.2040816327, 0.1020408163,
      0.2244897959, 0.2244897959, 0.2244897959, 0.2244897959, 0.2244897959,
      0.2244897959, 0.1224489796, 0.1428571429, 0.306122449,  0.306122449,
      0.306122449,  0.306122449,  0.306122449,  0.306122449,  0.1632653061,
      0.3265306122, 0.693877551,  0.693877551,  0.693877551,  0.693877551,
      0.693877551,  0.693877551,  0.3673469388, 0.5510204082, 1.1632653061,
      1.1632653061, 1.1632653061, 1.1632653061, 1.1632653061, 1.1632653061,
      0.612244898,  0.5510204082, 1.1632653061, 1.1632653061, 1.1632653061,
      1.1632653061, 1.1632653061, 1.1632653061, 0.612244898,  0.5510204082,
      1.1632653061, 1.1632653061, 1.1632653061, 1.1632653061, 1.1632653061,
      1.1632653061, 0.612244898,  0.5510204082, 1.1632653061, 1.1632653061,
      1.1632653061, 1.1632653061, 1.1632653061, 1.1632653061, 0.612244898,
      0.5510204082, 1.1632653061, 1.1632653061, 1.1632653061, 1.1632653061,
      1.1632653061, 1.1632653061, 0.612244898,  0.4081632653, 0.8571428571,
      0.8571428571, 0.8571428571, 0.8571428571, 0.8571428571, 0.8571428571,
      0.4489795918, 0.2244897959, 0.4693877551, 0.4693877551, 0.4693877551,
      0.4693877551, 0.4693877551, 0.4693877551, 0.2448979592, 0.2653061224,
      0.5510204082, 0.5510204082, 0.5510204082, 0.5510204082, 0.5510204082,
      0.5510204082, 0.2857142857, 0.5714285714, 1.1836734694, 1.1836734694,
      1.1836734694, 1.1836734694, 1.1836734694, 1.1836734694, 0.612244898,
      0.9183673469, 1.8979591837, 1.8979591837, 1.8979591837, 1.8979591837,
      1.8979591837, 1.8979591837, 0.9795918367, 0.9183673469, 1.8979591837,
      1.8979591837, 1.8979591837, 1.8979591837, 1.8979591837, 1.8979591837,
      0.9795918367, 0.9183673469, 1.8979591837, 1.8979591837, 1.8979591837,
      1.8979591837, 1.8979591837, 1.8979591837, 0.9795918367, 0.9183673469,
      1.8979591837, 1.8979591837, 1.8979591837, 1.8979591837, 1.8979591837,
      1.8979591837, 0.9795918367, 0.9183673469, 1.8979591837, 1.8979591837,
      1.8979591837, 1.8979591837, 1.8979591837, 1.8979591837, 0.9795918367,
      0.6530612245, 1.3469387755, 1.3469387755, 1.3469387755, 1.3469387755,
      1.3469387755, 1.3469387755, 0.693877551,  0.3469387755, 0.7142857143,
      0.7142857143, 0.7142857143, 0.7142857143, 0.7142857143, 0.7142857143,
      0.3673469388};
  const std::array<int, 4> in_shape = {{3, 9, 8, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x9x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      13.7274886621,  14.3043650794,  16.9026587302,  17.5880385488,
      20.8601984127,  21.6721655329,  25.9130555556,  26.8769274376,
      28.5713888889,  29.535260771,   25.0375793651,  25.8495464853,
      21.8395634921,  22.5249433107,  18.8814002268,  19.458276644,
      21.0550396825,  21.7404195011,  25.7200056689,  26.5342970522,
      31.4632596372,  32.4279478458,  38.71611678,    39.8612811791,
      41.8744501134,  43.0196145125,  36.4263548753,  37.3910430839,
      31.5854818594,  32.3997732426,  27.1783390023,  27.8637188209,
      30.1186451247,  30.9125283447,  36.5999376417,  37.5431405896,
      44.5098582766,  45.6272675737,  54.4198582766,  55.7463151927,
      58.07819161,    59.4046485261,  50.2586678005,  51.3760770975,
      43.3939852608,  44.3371882086,  37.2113321995,  38.0052154195,
      42.7182482993,  43.6387188209,  51.6995408163,  52.7931405896,
      62.5816836735,  63.8772675737,  76.1250170068,  77.6629818594,
      80.3666836735,  81.9046485261,  69.2471598639,  70.5427437642,
      59.5769217687,  60.670521542,   50.9418877551,  51.8623582766,
      59.597414966,   60.4799092971,  71.7144217687,  72.7629024943,
      86.2382312925,  87.4803628118,  104.1315646259, 105.6060770975,
      108.1982312925, 109.6727437642, 92.628707483,   93.8708390023,
      79.2668027211,  80.3152834467,  67.4817687075,  68.3642630385,
      81.6058673469,  82.5263378685,  97.9014455782,  98.9950453515,
      117.3169217687, 118.6125056689, 141.100255102,  142.6382199546,
      145.3419217687, 146.8798866213, 123.9823979592, 125.2779818594,
      105.7788265306, 106.8724263039, 89.8295068027,  90.7499773243,
      77.1078514739,  77.9017346939,  92.427239229,   93.3704421769,
      110.6482709751, 111.7656802721, 132.9316043084, 134.2580612245,
      136.5899376417, 137.9163945578, 116.3970804989, 117.5144897959,
      99.2212868481,  100.1644897959, 84.2005385488,  84.9944217687,
      71.5163548753,  72.2017346939,  85.6724773243,  86.4867687075,
      102.4887471655, 103.4534353741, 123.029223356,  124.1743877551,
      126.1875566893, 127.3327210884, 107.4518424036, 108.4165306122,
      91.5379535147,  92.352244898,   77.639654195,   78.3250340136,
      64.1888038549,  64.7656802721,  76.8551303855,  77.5405102041,
      91.885685941,   92.6976530612,  110.2261621315, 111.1900340136,
      112.8844954649, 113.8483673469, 96.0630668934,  96.8750340136,
      81.7920351474,  82.477414966,   69.3427154195,  69.9195918367,
      96.7976927438,  97.374569161,   115.5973526077, 116.2827324263,
      137.7834637188, 138.595430839,  164.710606576,  165.674478458,
      167.3689399093, 168.3328117914, 141.9608446712, 142.7728117914,
      120.5342573696, 121.2196371882, 101.9516043084, 102.5284807256,
      119.7497335601, 120.4351133787, 142.9779648526, 143.7922562358,
      170.378361678,  171.3430498866, 203.6197902494, 204.7649546485,
      206.7781235828, 207.9232879819, 175.3414569161, 176.3061451247,
      148.8434410431, 149.6577324263, 125.8730328798, 126.5584126984,
      144.4378287982, 145.2317120181, 172.4211621315, 173.3643650794,
      205.4167970522, 206.5342063492, 245.429654195,  246.7561111111,
      249.0879875283, 250.4144444444, 211.165606576,  212.283015873,
      179.2152097506, 180.1584126984, 151.530515873,  152.324399093,
      175.2660034014, 176.1864739229, 209.1779081633, 210.2715079365,
      249.1457653061, 250.4413492063, 297.5919557823, 299.1299206349,
      301.833622449,  303.3715873016, 255.8112414966, 257.1068253968,
      217.0552891156, 218.1488888889, 183.4896428571, 184.4101133787,
      186.6765986395, 187.5590929705, 222.6956462585, 223.7441269841,
      265.105170068,  266.3473015873, 316.4613605442, 317.9358730159,
      320.5280272109, 322.0025396825, 271.4956462585, 272.7377777778,
      230.2480272109, 231.2965079365, 194.560952381,  195.443446712,
      214.153622449,  215.0740929705, 255.3798129252, 256.4734126984,
      303.8810034014, 305.1765873016, 362.5671938776, 364.1051587302,
      366.8088605442, 368.3468253968, 310.5464795918, 311.8420634921,
      263.2571938776, 264.3507936508, 222.3772619048, 223.2977324263,
      191.4270351474, 192.2209183673, 228.2484637188, 229.1916666667,
      271.5552097506, 272.6726190476, 323.9414002268, 325.2678571429,
      327.5997335601, 328.9261904762, 277.3040192744, 278.4214285714,
      235.0425113379, 235.9857142857, 198.5197222222, 199.3136054422,
      170.2110487528, 170.8964285714, 202.9304365079, 203.7447278912,
      241.4038492063, 242.368537415,  287.9328968254, 289.0780612245,
      291.0912301587, 292.2363945578, 246.3669444444, 247.3316326531,
      208.7959126984, 209.6102040816, 176.3343480726, 177.0197278912,
      147.2590079365, 147.8358843537, 175.549824263,  176.2352040816,
      208.8089512472, 209.6209183673, 249.0237131519, 249.987585034,
      251.6820464853, 252.6459183673, 212.9863321995, 213.7982993197,
      180.4867290249, 181.1721088435, 152.4129195011, 152.9897959184,
      179.8678968254, 180.4447732426, 214.2920464853, 214.9774263039,
      254.7067290249, 255.5186961451, 303.5081575964, 304.4720294785,
      306.1664909297, 307.1303628118, 258.8841099773, 259.6960770975,
      219.2289512472, 219.9143310658, 185.02180839,   185.5986848073,
      218.4444274376, 219.1298072562, 260.2359240363, 261.0502154195,
      309.2934637188, 310.2581519274, 368.5234637188, 369.6686281179,
      371.6817970522, 372.8269614512, 314.2565589569, 315.2212471655,
      266.1014002268, 266.91569161,   224.5677267574, 225.253106576,
      258.7570124717, 259.5508956916, 308.2423866213, 309.1855895692,
      366.3237358277, 367.4411451247, 436.4394501134, 437.7659070295,
      440.0977834467, 441.4242403628, 372.0725453515, 373.1899546485,
      315.0364342404, 315.9796371882, 265.8496995465, 266.6435827664,
      307.8137585034, 308.7342290249, 366.6562755102, 367.7498752834,
      435.7098469388, 437.005430839,  519.0588945578, 520.5968594104,
      523.3005612245, 524.8385260771, 442.3753231293, 443.6709070295,
      374.5336564626, 375.6272562358, 316.0373979592, 316.9578684807,
      313.7557823129, 314.638276644,  373.6768707483, 374.7253514739,
      443.9721088435, 445.2142403628, 528.7911564626, 530.2656689342,
      532.8578231293, 534.3323356009, 450.362585034,  451.6047165533,
      381.2292517007, 382.2777324263, 321.6401360544, 322.5226303855,
      346.701377551,  347.6218480726, 412.8581802721, 413.9517800454,
      490.445085034,  491.7406689342, 584.0341326531, 585.5720975057,
      588.2757993197, 589.8137641723, 497.1105612245, 498.4061451247,
      420.7355612245, 421.8291609977, 354.9250170068, 355.8454875283,
      305.7462188209, 306.5401020408, 364.0696882086, 365.0128911565,
      432.4621485261, 433.5795578231, 514.9511961451, 516.2776530612,
      518.6095294785, 519.9359863946, 438.2109580499, 439.3283673469,
      370.8637358277, 371.8069387755, 312.8389058957, 313.6327891156,
      268.9057426304, 269.591122449,  320.1883956916, 321.0026870748,
      380.3189512472, 381.2836394558, 452.8365702948, 453.9817346939,
      455.9949036281, 457.1400680272, 385.2820464853, 386.2467346939,
      326.0538718821, 326.8681632653, 275.0290419501, 275.7144217687,
      230.3292120181, 230.9060884354, 274.2445181406, 274.9298979592,
      325.7322165533, 326.5441836735, 387.8212641723, 388.7851360544,
      390.4795975057, 391.4434693878, 329.9095975057, 330.7215646259,
      279.1814229025, 279.8668027211, 235.4831235828, 236.06,
  };
  const std::array<int, 4> in_shape = {{3, 9, 8, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x9x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.0204081633, 0.0408163265, 0.0816326531, 0.1224489796, 0.0816326531,
      0.1224489796, 0.0816326531, 0.1224489796, 0.0816326531, 0.1224489796,
      0.0816326531, 0.1224489796, 0.0816326531, 0.1224489796, 0.0612244898,
      0.0816326531, 0.1224489796, 0.1632653061, 0.3265306122, 0.4081632653,
      0.3265306122, 0.4081632653, 0.3265306122, 0.4081632653, 0.3265306122,
      0.4081632653, 0.3265306122, 0.4081632653, 0.3265306122, 0.4081632653,
      0.2040816327, 0.2448979592, 0.306122449,  0.3673469388, 0.7346938776,
      0.8571428571, 0.7346938776, 0.8571428571, 0.7346938776, 0.8571428571,
      0.7346938776, 0.8571428571, 0.7346938776, 0.8571428571, 0.7346938776,
      0.8571428571, 0.4285714286, 0.4897959184, 0.306122449,  0.3673469388,
      0.7346938776, 0.8571428571, 0.7346938776, 0.8571428571, 0.7346938776,
      0.8571428571, 0.7346938776, 0.8571428571, 0.7346938776, 0.8571428571,
      0.7346938776, 0.8571428571, 0.4285714286, 0.4897959184, 0.306122449,
      0.3673469388, 0.7346938776, 0.8571428571, 0.7346938776, 0.8571428571,
      0.7346938776, 0.8571428571, 0.7346938776, 0.8571428571, 0.7346938776,
      0.8571428571, 0.7346938776, 0.8571428571, 0.4285714286, 0.4897959184,
      0.306122449,  0.3673469388, 0.7346938776, 0.8571428571, 0.7346938776,
      0.8571428571, 0.7346938776, 0.8571428571, 0.7346938776, 0.8571428571,
      0.7346938776, 0.8571428571, 0.7346938776, 0.8571428571, 0.4285714286,
      0.4897959184, 0.306122449,  0.3673469388, 0.7346938776, 0.8571428571,
      0.7346938776, 0.8571428571, 0.7346938776, 0.8571428571, 0.7346938776,
      0.8571428571, 0.7346938776, 0.8571428571, 0.7346938776, 0.8571428571,
      0.4285714286, 0.4897959184, 0.2857142857, 0.3265306122, 0.6530612245,
      0.7346938776, 0.6530612245, 0.7346938776, 0.6530612245, 0.7346938776,
      0.6530612245, 0.7346938776, 0.6530612245, 0.7346938776, 0.6530612245,
      0.7346938776, 0.3673469388, 0.4081632653, 0.1836734694, 0.2040816327,
      0.4081632653, 0.4489795918, 0.4081632653, 0.4489795918, 0.4081632653,
      0.4489795918, 0.4081632653, 0.4489795918, 0.4081632653, 0.4489795918,
      0.4081632653, 0.4489795918, 0.2244897959, 0.2448979592, 0.2653061224,
      0.2857142857, 0.5714285714, 0.612244898,  0.5714285714, 0.612244898,
      0.5714285714, 0.612244898,  0.5714285714, 0.612244898,  0.5714285714,
      0.612244898,  0.5714285714, 0.612244898,  0.306122449,  0.3265306122,
      0.612244898,  0.6530612245, 1.306122449,  1.387755102,  1.306122449,
      1.387755102,  1.306122449,  1.387755102,  1.306122449,  1.387755102,
      1.306122449,  1.387755102,  1.306122449,  1.387755102,  0.693877551,
      0.7346938776, 1.0408163265, 1.1020408163, 2.2040816327, 2.3265306122,
      2.2040816327, 2.3265306122, 2.2040816327, 2.3265306122, 2.2040816327,
      2.3265306122, 2.2040816327, 2.3265306122, 2.2040816327, 2.3265306122,
      1.1632653061, 1.2244897959, 1.0408163265, 1.1020408163, 2.2040816327,
      2.3265306122, 2.2040816327, 2.3265306122, 2.2040816327, 2.3265306122,
      2.2040816327, 2.3265306122, 2.2040816327, 2.3265306122, 2.2040816327,
      2.3265306122, 1.1632653061, 1.2244897959, 1.0408163265, 1.1020408163,
      2.2040816327, 2.3265306122, 2.2040816327, 2.3265306122, 2.2040816327,
      2.3265306122, 2.2040816327, 2.3265306122, 2.2040816327, 2.3265306122,
      2.2040816327, 2.3265306122, 1.1632653061, 1.2244897959, 1.0408163265,
      1.1020408163, 2.2040816327, 2.3265306122, 2.2040816327, 2.3265306122,
      2.2040816327, 2.3265306122, 2.2040816327, 2.3265306122, 2.2040816327,
      2.3265306122, 2.2040816327, 2.3265306122, 1.1632653061, 1.2244897959,
      1.0408163265, 1.1020408163, 2.2040816327, 2.3265306122, 2.2040816327,
      2.3265306122, 2.2040816327, 2.3265306122, 2.2040816327, 2.3265306122,
      2.2040816327, 2.3265306122, 2.2040816327, 2.3265306122, 1.1632653061,
      1.2244897959, 0.7755102041, 0.8163265306, 1.6326530612, 1.7142857143,
      1.6326530612, 1.7142857143, 1.6326530612, 1.7142857143, 1.6326530612,
      1.7142857143, 1.6326530612, 1.7142857143, 1.6326530612, 1.7142857143,
      0.8571428571, 0.8979591837, 0.4285714286, 0.4489795918, 0.8979591837,
      0.9387755102, 0.8979591837, 0.9387755102, 0.8979591837, 0.9387755102,
      0.8979591837, 0.9387755102, 0.8979591837, 0.9387755102, 0.8979591837,
      0.9387755102, 0.4693877551, 0.4897959184, 0.5102040816, 0.5306122449,
      1.0612244898, 1.1020408163, 1.0612244898, 1.1020408163, 1.0612244898,
      1.1020408163, 1.0612244898, 1.1020408163, 1.0612244898, 1.1020408163,
      1.0612244898, 1.1020408163, 0.5510204082, 0.5714285714, 1.1020408163,
      1.1428571429, 2.2857142857, 2.3673469388, 2.2857142857, 2.3673469388,
      2.2857142857, 2.3673469388, 2.2857142857, 2.3673469388, 2.2857142857,
      2.3673469388, 2.2857142857, 2.3673469388, 1.1836734694, 1.2244897959,
      1.7755102041, 1.8367346939, 3.6734693878, 3.7959183673, 3.6734693878,
      3.7959183673, 3.6734693878, 3.7959183673, 3.6734693878, 3.7959183673,
      3.6734693878, 3.7959183673, 3.6734693878, 3.7959183673, 1.8979591837,
      1.9591836735, 1.7755102041, 1.8367346939, 3.6734693878, 3.7959183673,
      3.6734693878, 3.7959183673, 3.6734693878, 3.7959183673, 3.6734693878,
      3.7959183673, 3.6734693878, 3.7959183673, 3.6734693878, 3.7959183673,
      1.8979591837, 1.9591836735, 1.7755102041, 1.8367346939, 3.6734693878,
      3.7959183673, 3.6734693878, 3.7959183673, 3.6734693878, 3.7959183673,
      3.6734693878, 3.7959183673, 3.6734693878, 3.7959183673, 3.6734693878,
      3.7959183673, 1.8979591837, 1.9591836735, 1.7755102041, 1.8367346939,
      3.6734693878, 3.7959183673, 3.6734693878, 3.7959183673, 3.6734693878,
      3.7959183673, 3.6734693878, 3.7959183673, 3.6734693878, 3.7959183673,
      3.6734693878, 3.7959183673, 1.8979591837, 1.9591836735, 1.7755102041,
      1.8367346939, 3.6734693878, 3.7959183673, 3.6734693878, 3.7959183673,
      3.6734693878, 3.7959183673, 3.6734693878, 3.7959183673, 3.6734693878,
      3.7959183673, 3.6734693878, 3.7959183673, 1.8979591837, 1.9591836735,
      1.2653061224, 1.306122449,  2.612244898,  2.693877551,  2.612244898,
      2.693877551,  2.612244898,  2.693877551,  2.612244898,  2.693877551,
      2.612244898,  2.693877551,  2.612244898,  2.693877551,  1.3469387755,
      1.387755102,  0.6734693878, 0.693877551,  1.387755102,  1.4285714286,
      1.387755102,  1.4285714286, 1.387755102,  1.4285714286, 1.387755102,
      1.4285714286, 1.387755102,  1.4285714286, 1.387755102,  1.4285714286,
      0.7142857143, 0.7346938776};
  const std::array<int, 4> in_shape = {{3, 9, 8, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x9x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      26.878100907,    27.4549773243,   28.0318537415,   28.6087301587,
      33.1199376417,   33.8053174603,   34.4906972789,   35.1760770975,
      40.9084297052,   41.7203968254,   42.5323639456,   43.3443310658,
      50.862239229,    51.8261111111,   52.7899829932,   53.7538548753,
      56.1789058957,   57.1427777778,   58.1066496599,   59.070521542,
      49.26319161,     50.0751587302,   50.8871258503,   51.6990929705,
      42.9937471655,   43.6791269841,   44.3645068027,   45.0498866213,
      37.1859240363,   37.7628004535,   38.3396768707,   38.916553288,
      41.4246995465,   42.1100793651,   42.7954591837,   43.4808390023,
      50.6257199546,   51.4400113379,   52.2543027211,   53.0685941043,
      61.9618310658,   62.9265192744,   63.891207483,    64.8558956916,
      76.287069161,    77.4322335601,   78.5773979592,   79.7225623583,
      82.6037358277,   83.7489002268,   84.8940646259,   86.0392290249,
      71.888021542,    72.8527097506,   73.8173979592,   74.7820861678,
      62.3566723356,   63.1709637188,   63.985255102,    64.7995464853,
      53.6712981859,   54.3566780045,   55.0420578231,   55.7274376417,
      59.4434070295,   60.2372902494,   61.0311734694,   61.8250566893,
      72.2566723356,   73.1998752834,   74.1430782313,   75.0862811791,
      87.9023072562,   89.0197165533,   90.1371258503,   91.2545351474,
      107.5132596372,  108.8397165533,  110.1661734694,  111.4926303855,
      114.8299263039,  116.15638322,    117.4828401361,  118.8092970522,
      99.3999263039,   100.5173356009,  101.634744898,   102.752154195,
      85.8447675737,   86.7879705215,   87.7311734694,   88.6743764172,
      73.6287811791,   74.4226643991,   75.216547619,    76.010430839,
      84.5160260771,   85.4364965986,   86.3569671202,   87.2774376417,
      102.3054818594,  103.3990816327,  104.4926814059,  105.5862811791,
      123.8677834467,  125.1633673469,  126.4589512472,  127.7545351474,
      150.712069161,   152.2500340136,  153.7879988662,  155.3259637188,
      159.1954024943,  160.7333673469,  162.2713321995,  163.8092970522,
      137.1987358277,  138.4943197279,  139.7899036281,  141.0854875283,
      118.0602437642,  119.1538435374,  120.2474433107,  121.3410430839,
      100.9633049887,  101.8837755102,  102.8042460317,  103.7247165533,
      118.3123356009,  119.194829932,   120.077324263,   120.9598185941,
      142.3803628118,  143.4288435374,  144.477324263,   145.5258049887,
      171.2343310658,  172.476462585,   173.7185941043,  174.9607256236,
      206.78861678,    208.2631292517,  209.7376417234,  211.212154195,
      214.9219501134,  216.396462585,   217.8709750567,  219.3454875283,
      184.0152834467,  185.257414966,   186.4995464853,  187.7416780045,
      157.4851247166,  158.5336054422,  159.5820861678,  160.6305668934,
      134.0810430839,  134.963537415,   135.846031746,   136.7285260771,
      162.2912641723,  163.2117346939,  164.1322052154,  165.052675737,
      194.7092913832,  195.8028911565,  196.8964909297,  197.9900907029,
      233.3382596372,  234.6338435374,  235.9294274376,  237.2250113379,
      280.6625453515,  282.2005102041,  283.7384750567,  285.2764399093,
      289.1458786848,  290.6838435374,  292.22180839,    293.7597732426,
      246.6692120181,  247.9647959184,  249.2603798186,  250.5559637188,
      210.464053288,   211.5576530612,  212.6512528345,  213.7448526077,
      178.7385430839,  179.6590136054,  180.579484127,   181.4999546485,
      153.4218197279,  154.2157029478,  155.0095861678,  155.8034693878,
      183.9112755102,  184.854478458,   185.7976814059,  186.7408843537,
      220.1791326531,  221.2965419501,  222.4139512472,  223.5313605442,
      264.5367517007,  265.8632086168,  267.1896655329,  268.516122449,
      271.8534183673,  273.1798752834,  274.5063321995,  275.8327891156,
      231.6767517007,  232.7941609977,  233.9115702948,  235.0289795918,
      197.4993707483,  198.4425736961,  199.385776644,   200.3289795918,
      167.6071938776,  168.4010770975,  169.1949603175,  169.9888435374,
      142.347329932,   143.0327097506,  143.7180895692,  144.4034693878,
      170.5306632653,  171.3449546485,  172.1592460317,  172.973537415,
      204.0128061224,  204.9774943311,  205.9421825397,  206.9068707483,
      244.9132823129,  246.058446712,   247.2036111111,  248.3487755102,
      251.2299489796,  252.3751133787,  253.5202777778,  254.6654421769,
      213.9389965986,  214.9036848073,  215.8683730159,  216.8330612245,
      182.2616156463,  183.0759070295,  183.8901984127,  184.7044897959,
      154.5939285714,  155.27930839,    155.9646882086,  156.6500680272,
      127.8007312925,  128.3776077098,  128.954484127,   129.5313605442,
      153.0248809524,  153.710260771,   154.3956405896,  155.0810204082,
      182.9594047619,  183.7713718821,  184.5833390023,  185.3953061224,
      219.488452381,   220.452324263,   221.4161961451,  222.3800680272,
      224.8051190476,  225.7689909297,  226.7328628118,  227.6967346939,
      191.3141666667,  192.1261337868,  192.938100907,   193.7500680272,
      162.8986904762,  163.5840702948,  164.2694501134,  164.954829932,
      138.1085544218,  138.685430839,   139.2623072562,  139.8391836735,
      193.0185090703,  193.5953854875,  194.1722619048,  194.749138322,
      230.5093253968,  231.1947052154,  231.880085034,   232.5654648526,
      274.7549603175,  275.5669274376,  276.3788945578,  277.190861678,
      328.4573412698,  329.4212131519,  330.385085034,   331.3489569161,
      333.7740079365,  334.7378798186,  335.7017517007,  336.6656235828,
      283.1097222222,  283.9216893424,  284.7336564626,  285.5456235828,
      240.3831349206,  241.0685147392,  241.7538945578,  242.4392743764,
      203.3263321995,  203.9032086168,  204.480085034,   205.0569614512,
      238.8140873016,  239.4994671202,  240.1848469388,  240.8702267574,
      285.141638322,   285.9559297052,  286.7702210884,  287.5845124717,
      339.7920351474,  340.756723356,   341.7214115646,  342.6860997732,
      406.0944160998,  407.2395804989,  408.384744898,   409.5299092971,
      412.4110827664,  413.5562471655,  414.7014115646,  415.8465759637,
      349.7182256236,  350.6829138322,  351.6476020408,  352.6122902494,
      296.8725907029,  297.6868820862,  298.5011734694,  299.3154648526,
      251.060685941,   251.7460657596,  252.4314455782,  253.1168253968,
      288.0817743764,  288.8756575964,  289.6695408163,  290.4634240363,
      343.8991213152,  344.842324263,   345.7855272109,  346.7287301587,
      409.7161848073,  410.8335941043,  411.9510034014,  413.0684126984,
      489.5328514739,  490.85930839,    492.1857653061,  493.5122222222,
      496.8495181406,  498.1759750567,  499.5024319728,  500.8288888889,
      421.2138038549,  422.3312131519,  423.448622449,   424.566031746,
      357.4872165533,  358.4304195011,  359.373622449,   360.3168253968,
      302.2671485261,  303.061031746,   303.854914966,   304.6487981859,
      349.6115362812,  350.5320068027,  351.4524773243,  352.3729478458,
      417.2622165533,  418.3558163265,  419.4494160998,  420.543015873,
      496.995946712,   498.2915306122,  499.5871145125,  500.8826984127,
      593.645946712,   595.1839115646,  596.7218764172,  598.2598412698,
      602.1292800454,  603.667244898,   605.2052097506,  606.7431746032,
      510.326899093,   511.6224829932,  512.9180668934,  514.2136507937,
      433.016978458,   434.1105782313,  435.2041780045,  436.2977777778,
      366.0588151927,  366.9792857143,  367.8997562358,  368.8202267574,
      372.4707029478,  373.3531972789,  374.23569161,    375.118185941,
      444.3428117914,  445.391292517,   446.4397732426,  447.4882539683,
      528.9682086168,  530.2103401361,  531.4524716553,  532.6946031746,
      631.4482086168,  632.9227210884,  634.3972335601,  635.8717460317,
      639.5815419501,  641.0560544218,  642.5305668934,  644.0050793651,
      541.7491609977,  542.991292517,   544.2334240363,  545.4755555556,
      459.4475736961,  460.4960544218,  461.5445351474,  462.593015873,
      388.2394104308,  389.1219047619,  390.004399093,   390.886893424,
      427.3867743764,  428.307244898,   429.2277154195,  430.148185941,
      509.6660260771,  510.7596258503,  511.8532256236,  512.9468253968,
      606.4664229025,  607.7620068027,  609.0575907029,  610.3531746032,
      723.5964229025,  725.1343877551,  726.6723526077,  728.2103174603,
      732.0797562358,  733.6177210884,  735.155685941,   736.6936507937,
      619.7973752834,  621.0929591837,  622.3885430839,  623.6841269841,
      525.4207879819,  526.5143877551,  527.6079875283,  528.7015873016,
      443.834053288,   444.7545238095,  445.6749943311,  446.5954648526,
      382.0601870748,  382.8540702948,  383.6479535147,  384.4418367347,
      455.5537244898,  456.4969274376,  457.4401303855,  458.3833333333,
      541.9930102041,  543.1104195011,  544.2278287982,  545.3452380952,
      646.5563435374,  647.8828004535,  649.2092573696,  650.5357142857,
      653.8730102041,  655.1994671202,  656.5259240363,  657.8523809524,
      553.4906292517,  554.6080385488,  555.7254478458,  556.8428571429,
      469.1418197279,  470.0850226757,  471.0282256236,  471.9714285714,
      396.2455612245,  397.0394444444,  397.8333276644,  398.6272108844,
      339.7367176871,  340.4220975057,  341.1074773243,  341.7928571429,
      405.0465816327,  405.8608730159,  406.6751643991,  407.4894557823,
      481.8430102041,  482.8076984127,  483.7723866213,  484.7370748299,
      574.7206292517,  575.8657936508,  577.0109580499,  578.156122449,
      581.0372959184,  582.1824603175,  583.3276247166,  584.4727891156,
      491.7692006803,  492.7338888889,  493.6985770975,  494.6632653061,
      416.7775340136,  417.5918253968,  418.40611678,    419.2204081633,
      351.9833163265,  352.6686961451,  353.3540759637,  354.0394557823,
      293.9411394558,  294.518015873,   295.0948922902,  295.6717687075,
      350.4142687075,  351.0996485261,  351.7850283447,  352.4704081633,
      416.8059353741,  417.6179024943,  418.4298696145,  419.2418367347,
      497.0835544218,  498.0474263039,  499.0112981859,  499.975170068,
      502.4002210884,  503.3640929705,  504.3279648526,  505.2918367347,
      425.1606972789,  425.9726643991,  426.7846315193,  427.5965986395,
      360.2880782313,  360.9734580499,  361.6588378685,  362.3442176871,
      304.248962585,   304.8258390023,  305.4027154195,  305.9795918367,
      359.1589172336,  359.7357936508,  360.312670068,   360.8895464853,
      427.8987131519,  428.5840929705,  429.2694727891,  429.9548526077,
      508.6014909297,  509.4134580499,  510.2254251701,  511.0373922902,
      606.0524433107,  607.0163151927,  607.9801870748,  608.9440589569,
      611.3691099773,  612.3329818594,  613.2968537415,  614.2607256236,
      516.9562528345,  517.7682199546,  518.5801870748,  519.392154195,
      437.7725226757,  438.4579024943,  439.1432823129,  439.8286621315,
      369.4667403628,  370.04361678,    370.6204931973,  371.1973696145,
      436.2034750567,  436.8888548753,  437.5742346939,  438.2596145125,
      519.6575566893,  520.4718480726,  521.2861394558,  522.100430839,
      617.622239229,   618.5869274376,  619.5516156463,  620.5163038549,
      735.9017630385,  737.0469274376,  738.1920918367,  739.3372562358,
      742.2184297052,  743.3635941043,  744.5087585034,  745.6539229025,
      627.5484297052,  628.5131179138,  629.4778061224,  630.4424943311,
      531.3885090703,  532.2028004535,  533.0170918367,  533.83138322,
      448.4500736961,  449.1354535147,  449.8208333333,  450.5062131519,
      516.7201417234,  517.5140249433,  518.3079081633,  519.1017913832,
      615.5415702948,  616.4847732426,  617.4279761905,  618.3711791383,
      731.5300623583,  732.6474716553,  733.7648809524,  734.8822902494,
      871.5524433107,  872.8789002268,  874.2053571429,  875.531814059,
      878.8691099773,  880.1955668934,  881.5220238095,  882.8484807256,
      743.0276814059,  744.1450907029,  745.2625,        746.3799092971,
      629.1296655329,  630.0728684807,  631.0160714286,  631.9592743764,
      530.905515873,   531.699399093,   532.4932823129,  533.2871655329,
      614.7070464853,  615.6275170068,  616.5479875283,  617.4684580499,
      732.2189512472,  733.3125510204,  734.4061507937,  735.4997505669,
      870.1241099773,  871.4196938776,  872.7152777778,  874.010861678,
      1036.579824263,  1038.1177891156, 1039.6557539683, 1041.1937188209,
      1045.0631575964, 1046.601122449,  1048.1390873016, 1049.6770521542,
      883.4550623583,  884.7506462585,  886.0462301587,  887.341814059,
      747.9737131519,  749.0673129252,  750.1609126984,  751.2545124717,
      631.1543253968,  632.0747959184,  632.9952664399,  633.9157369615,
      626.6290702948,  627.5115646259,  628.3940589569,  629.276553288,
      746.305260771,   747.3537414966,  748.4022222222,  749.4507029478,
      886.7020861678,  887.9442176871,  889.1863492063,  890.4284807256,
      1056.1078004535, 1057.5823129252, 1059.0568253968, 1060.5313378685,
      1064.2411337868, 1065.7156462585, 1067.1901587302, 1068.6646712018,
      899.4830385488,  900.725170068,   901.9673015873,  903.2094331066,
      761.4100226757,  762.4585034014,  763.506984127,   764.5554648526,
      642.3977777778,  643.2802721088,  644.1627664399,  645.045260771,
      692.4822845805,  693.402755102,   694.3232256236,  695.2436961451,
      824.622760771,   825.7163605442,  826.8099603175,  827.9035600907,
      979.5945861678,  980.890170068,   982.1857539683,  983.4813378685,
      1166.5303004535, 1168.0682653061, 1169.6062301587, 1171.1441950113,
      1175.0136337868, 1176.5515986395, 1178.0895634921, 1179.6275283447,
      992.9255385488,  994.221122449,   995.5167063492,  996.8122902494,
      840.3775226757,  841.471122449,   842.5647222222,  843.6583219955,
      708.9295634921,  709.8500340136,  710.7705045351,  711.6909750567,
      610.6985544218,  611.4924376417,  612.2863208617,  613.0802040816,
      727.1961734694,  728.1393764172,  729.0825793651,  730.0257823129,
      863.8068877551,  864.9242970522,  866.0417063492,  867.1591156463,
      1028.5759353741, 1029.9023922902, 1031.2288492063, 1032.5553061224,
      1035.8926020408, 1037.2190589569, 1038.545515873,  1039.8719727891,
      875.3045068027,  876.4219160998,  877.5393253968,  878.6567346939,
      740.7842687075,  741.7274716553,  742.6706746032,  743.613877551,
      624.8839285714,  625.6778117914,  626.4716950113,  627.2655782313,
      537.1261054422,  537.8114852608,  538.4968650794,  539.182244898,
      639.5625,        640.3767913832,  641.1910827664,  642.0053741497,
      759.6732142857,  760.6379024943,  761.6025907029,  762.5672789116,
      904.5279761905,  905.6731405896,  906.8183049887,  907.9634693878,
      910.8446428571,  911.9898072562,  913.1349716553,  914.2801360544,
      769.5994047619,  770.5640929705,  771.5287811791,  772.4934693878,
      651.293452381,   652.1077437642,  652.9220351474,  653.7363265306,
      549.3727040816,  550.0580839002,  550.7434637188,  551.4288435374,
      460.081547619,   460.6584240363,  461.2353004535,  461.8121768707,
      547.8036564626,  548.4890362812,  549.1744160998,  549.8597959184,
      650.6524659864,  651.4644331066,  652.2764002268,  653.0883673469,
      774.6786564626,  775.6425283447,  776.6064002268,  777.5702721088,
      779.9953231293,  780.9591950113,  781.9230668934,  782.8869387755,
      659.0072278912,  659.8191950113,  660.6311621315,  661.4431292517,
      557.6774659864,  558.362845805,   559.0482256236,  559.7336054422,
      470.3893707483,  470.9662471655,  471.5431235828,  472.12,
  };
  const std::array<int, 4> in_shape = {{3, 9, 8, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x9x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.0204081633, 0.0408163265, 0.0612244898, 0.0816326531, 0.1224489796,
      0.1632653061, 0.2040816327, 0.2448979592, 0.1224489796, 0.1632653061,
      0.2040816327, 0.2448979592, 0.1224489796, 0.1632653061, 0.2040816327,
      0.2448979592, 0.1224489796, 0.1632653061, 0.2040816327, 0.2448979592,
      0.1224489796, 0.1632653061, 0.2040816327, 0.2448979592, 0.1224489796,
      0.1632653061, 0.2040816327, 0.2448979592, 0.1020408163, 0.1224489796,
      0.1428571429, 0.1632653061, 0.2040816327, 0.2448979592, 0.2857142857,
      0.3265306122, 0.5714285714, 0.6530612245, 0.7346938776, 0.8163265306,
      0.5714285714, 0.6530612245, 0.7346938776, 0.8163265306, 0.5714285714,
      0.6530612245, 0.7346938776, 0.8163265306, 0.5714285714, 0.6530612245,
      0.7346938776, 0.8163265306, 0.5714285714, 0.6530612245, 0.7346938776,
      0.8163265306, 0.5714285714, 0.6530612245, 0.7346938776, 0.8163265306,
      0.3673469388, 0.4081632653, 0.4489795918, 0.4897959184, 0.5510204082,
      0.612244898,  0.6734693878, 0.7346938776, 1.3469387755, 1.4693877551,
      1.5918367347, 1.7142857143, 1.3469387755, 1.4693877551, 1.5918367347,
      1.7142857143, 1.3469387755, 1.4693877551, 1.5918367347, 1.7142857143,
      1.3469387755, 1.4693877551, 1.5918367347, 1.7142857143, 1.3469387755,
      1.4693877551, 1.5918367347, 1.7142857143, 1.3469387755, 1.4693877551,
      1.5918367347, 1.7142857143, 0.7959183673, 0.8571428571, 0.9183673469,
      0.9795918367, 0.5510204082, 0.612244898,  0.6734693878, 0.7346938776,
      1.3469387755, 1.4693877551, 1.5918367347, 1.7142857143, 1.3469387755,
      1.4693877551, 1.5918367347, 1.7142857143, 1.3469387755, 1.4693877551,
      1.5918367347, 1.7142857143, 1.3469387755, 1.4693877551, 1.5918367347,
      1.7142857143, 1.3469387755, 1.4693877551, 1.5918367347, 1.7142857143,
      1.3469387755, 1.4693877551, 1.5918367347, 1.7142857143, 0.7959183673,
      0.8571428571, 0.9183673469, 0.9795918367, 0.5510204082, 0.612244898,
      0.6734693878, 0.7346938776, 1.3469387755, 1.4693877551, 1.5918367347,
      1.7142857143, 1.3469387755, 1.4693877551, 1.5918367347, 1.7142857143,
      1.3469387755, 1.4693877551, 1.5918367347, 1.7142857143, 1.3469387755,
      1.4693877551, 1.5918367347, 1.7142857143, 1.3469387755, 1.4693877551,
      1.5918367347, 1.7142857143, 1.3469387755, 1.4693877551, 1.5918367347,
      1.7142857143, 0.7959183673, 0.8571428571, 0.9183673469, 0.9795918367,
      0.5510204082, 0.612244898,  0.6734693878, 0.7346938776, 1.3469387755,
      1.4693877551, 1.5918367347, 1.7142857143, 1.3469387755, 1.4693877551,
      1.5918367347, 1.7142857143, 1.3469387755, 1.4693877551, 1.5918367347,
      1.7142857143, 1.3469387755, 1.4693877551, 1.5918367347, 1.7142857143,
      1.3469387755, 1.4693877551, 1.5918367347, 1.7142857143, 1.3469387755,
      1.4693877551, 1.5918367347, 1.7142857143, 0.7959183673, 0.8571428571,
      0.9183673469, 0.9795918367, 0.5510204082, 0.612244898,  0.6734693878,
      0.7346938776, 1.3469387755, 1.4693877551, 1.5918367347, 1.7142857143,
      1.3469387755, 1.4693877551, 1.5918367347, 1.7142857143, 1.3469387755,
      1.4693877551, 1.5918367347, 1.7142857143, 1.3469387755, 1.4693877551,
      1.5918367347, 1.7142857143, 1.3469387755, 1.4693877551, 1.5918367347,
      1.7142857143, 1.3469387755, 1.4693877551, 1.5918367347, 1.7142857143,
      0.7959183673, 0.8571428571, 0.9183673469, 0.9795918367, 0.5306122449,
      0.5714285714, 0.612244898,  0.6530612245, 1.2244897959, 1.306122449,
      1.387755102,  1.4693877551, 1.2244897959, 1.306122449,  1.387755102,
      1.4693877551, 1.2244897959, 1.306122449,  1.387755102,  1.4693877551,
      1.2244897959, 1.306122449,  1.387755102,  1.4693877551, 1.2244897959,
      1.306122449,  1.387755102,  1.4693877551, 1.2244897959, 1.306122449,
      1.387755102,  1.4693877551, 0.693877551,  0.7346938776, 0.7755102041,
      0.8163265306, 0.3469387755, 0.3673469388, 0.387755102,  0.4081632653,
      0.7755102041, 0.8163265306, 0.8571428571, 0.8979591837, 0.7755102041,
      0.8163265306, 0.8571428571, 0.8979591837, 0.7755102041, 0.8163265306,
      0.8571428571, 0.8979591837, 0.7755102041, 0.8163265306, 0.8571428571,
      0.8979591837, 0.7755102041, 0.8163265306, 0.8571428571, 0.8979591837,
      0.7755102041, 0.8163265306, 0.8571428571, 0.8979591837, 0.4285714286,
      0.4489795918, 0.4693877551, 0.4897959184, 0.5102040816, 0.5306122449,
      0.5510204082, 0.5714285714, 1.1020408163, 1.1428571429, 1.1836734694,
      1.2244897959, 1.1020408163, 1.1428571429, 1.1836734694, 1.2244897959,
      1.1020408163, 1.1428571429, 1.1836734694, 1.2244897959, 1.1020408163,
      1.1428571429, 1.1836734694, 1.2244897959, 1.1020408163, 1.1428571429,
      1.1836734694, 1.2244897959, 1.1020408163, 1.1428571429, 1.1836734694,
      1.2244897959, 0.5918367347, 0.612244898,  0.6326530612, 0.6530612245,
      1.1836734694, 1.2244897959, 1.2653061224, 1.306122449,  2.5306122449,
      2.612244898,  2.693877551,  2.7755102041, 2.5306122449, 2.612244898,
      2.693877551,  2.7755102041, 2.5306122449, 2.612244898,  2.693877551,
      2.7755102041, 2.5306122449, 2.612244898,  2.693877551,  2.7755102041,
      2.5306122449, 2.612244898,  2.693877551,  2.7755102041, 2.5306122449,
      2.612244898,  2.693877551,  2.7755102041, 1.3469387755, 1.387755102,
      1.4285714286, 1.4693877551, 2.0204081633, 2.0816326531, 2.1428571429,
      2.2040816327, 4.2857142857, 4.4081632653, 4.5306122449, 4.6530612245,
      4.2857142857, 4.4081632653, 4.5306122449, 4.6530612245, 4.2857142857,
      4.4081632653, 4.5306122449, 4.6530612245, 4.2857142857, 4.4081632653,
      4.5306122449, 4.6530612245, 4.2857142857, 4.4081632653, 4.5306122449,
      4.6530612245, 4.2857142857, 4.4081632653, 4.5306122449, 4.6530612245,
      2.2653061224, 2.3265306122, 2.387755102,  2.4489795918, 2.0204081633,
      2.0816326531, 2.1428571429, 2.2040816327, 4.2857142857, 4.4081632653,
      4.5306122449, 4.6530612245, 4.2857142857, 4.4081632653, 4.5306122449,
      4.6530612245, 4.2857142857, 4.4081632653, 4.5306122449, 4.6530612245,
      4.2857142857, 4.4081632653, 4.5306122449, 4.6530612245, 4.2857142857,
      4.4081632653, 4.5306122449, 4.6530612245, 4.2857142857, 4.4081632653,
      4.5306122449, 4.6530612245, 2.2653061224, 2.3265306122, 2.387755102,
      2.4489795918, 2.0204081633, 2.0816326531, 2.1428571429, 2.2040816327,
      4.2857142857, 4.4081632653, 4.5306122449, 4.6530612245, 4.2857142857,
      4.4081632653, 4.5306122449, 4.6530612245, 4.2857142857, 4.4081632653,
      4.5306122449, 4.6530612245, 4.2857142857, 4.4081632653, 4.5306122449,
      4.6530612245, 4.2857142857, 4.4081632653, 4.5306122449, 4.6530612245,
      4.2857142857, 4.4081632653, 4.5306122449, 4.6530612245, 2.2653061224,
      2.3265306122, 2.387755102,  2.4489795918, 2.0204081633, 2.0816326531,
      2.1428571429, 2.2040816327, 4.2857142857, 4.4081632653, 4.5306122449,
      4.6530612245, 4.2857142857, 4.4081632653, 4.5306122449, 4.6530612245,
      4.2857142857, 4.4081632653, 4.5306122449, 4.6530612245, 4.2857142857,
      4.4081632653, 4.5306122449, 4.6530612245, 4.2857142857, 4.4081632653,
      4.5306122449, 4.6530612245, 4.2857142857, 4.4081632653, 4.5306122449,
      4.6530612245, 2.2653061224, 2.3265306122, 2.387755102,  2.4489795918,
      2.0204081633, 2.0816326531, 2.1428571429, 2.2040816327, 4.2857142857,
      4.4081632653, 4.5306122449, 4.6530612245, 4.2857142857, 4.4081632653,
      4.5306122449, 4.6530612245, 4.2857142857, 4.4081632653, 4.5306122449,
      4.6530612245, 4.2857142857, 4.4081632653, 4.5306122449, 4.6530612245,
      4.2857142857, 4.4081632653, 4.5306122449, 4.6530612245, 4.2857142857,
      4.4081632653, 4.5306122449, 4.6530612245, 2.2653061224, 2.3265306122,
      2.387755102,  2.4489795918, 1.5102040816, 1.5510204082, 1.5918367347,
      1.6326530612, 3.1836734694, 3.2653061224, 3.3469387755, 3.4285714286,
      3.1836734694, 3.2653061224, 3.3469387755, 3.4285714286, 3.1836734694,
      3.2653061224, 3.3469387755, 3.4285714286, 3.1836734694, 3.2653061224,
      3.3469387755, 3.4285714286, 3.1836734694, 3.2653061224, 3.3469387755,
      3.4285714286, 3.1836734694, 3.2653061224, 3.3469387755, 3.4285714286,
      1.6734693878, 1.7142857143, 1.7551020408, 1.7959183673, 0.8367346939,
      0.8571428571, 0.8775510204, 0.8979591837, 1.7551020408, 1.7959183673,
      1.8367346939, 1.8775510204, 1.7551020408, 1.7959183673, 1.8367346939,
      1.8775510204, 1.7551020408, 1.7959183673, 1.8367346939, 1.8775510204,
      1.7551020408, 1.7959183673, 1.8367346939, 1.8775510204, 1.7551020408,
      1.7959183673, 1.8367346939, 1.8775510204, 1.7551020408, 1.7959183673,
      1.8367346939, 1.8775510204, 0.9183673469, 0.9387755102, 0.9591836735,
      0.9795918367, 1.,           1.0204081633, 1.0408163265, 1.0612244898,
      2.0816326531, 2.1224489796, 2.1632653061, 2.2040816327, 2.0816326531,
      2.1224489796, 2.1632653061, 2.2040816327, 2.0816326531, 2.1224489796,
      2.1632653061, 2.2040816327, 2.0816326531, 2.1224489796, 2.1632653061,
      2.2040816327, 2.0816326531, 2.1224489796, 2.1632653061, 2.2040816327,
      2.0816326531, 2.1224489796, 2.1632653061, 2.2040816327, 1.0816326531,
      1.1020408163, 1.1224489796, 1.1428571429, 2.1632653061, 2.2040816327,
      2.2448979592, 2.2857142857, 4.4897959184, 4.5714285714, 4.6530612245,
      4.7346938776, 4.4897959184, 4.5714285714, 4.6530612245, 4.7346938776,
      4.4897959184, 4.5714285714, 4.6530612245, 4.7346938776, 4.4897959184,
      4.5714285714, 4.6530612245, 4.7346938776, 4.4897959184, 4.5714285714,
      4.6530612245, 4.7346938776, 4.4897959184, 4.5714285714, 4.6530612245,
      4.7346938776, 2.3265306122, 2.3673469388, 2.4081632653, 2.4489795918,
      3.4897959184, 3.5510204082, 3.612244898,  3.6734693878, 7.2244897959,
      7.3469387755, 7.4693877551, 7.5918367347, 7.2244897959, 7.3469387755,
      7.4693877551, 7.5918367347, 7.2244897959, 7.3469387755, 7.4693877551,
      7.5918367347, 7.2244897959, 7.3469387755, 7.4693877551, 7.5918367347,
      7.2244897959, 7.3469387755, 7.4693877551, 7.5918367347, 7.2244897959,
      7.3469387755, 7.4693877551, 7.5918367347, 3.7346938776, 3.7959183673,
      3.8571428571, 3.9183673469, 3.4897959184, 3.5510204082, 3.612244898,
      3.6734693878, 7.2244897959, 7.3469387755, 7.4693877551, 7.5918367347,
      7.2244897959, 7.3469387755, 7.4693877551, 7.5918367347, 7.2244897959,
      7.3469387755, 7.4693877551, 7.5918367347, 7.2244897959, 7.3469387755,
      7.4693877551, 7.5918367347, 7.2244897959, 7.3469387755, 7.4693877551,
      7.5918367347, 7.2244897959, 7.3469387755, 7.4693877551, 7.5918367347,
      3.7346938776, 3.7959183673, 3.8571428571, 3.9183673469, 3.4897959184,
      3.5510204082, 3.612244898,  3.6734693878, 7.2244897959, 7.3469387755,
      7.4693877551, 7.5918367347, 7.2244897959, 7.3469387755, 7.4693877551,
      7.5918367347, 7.2244897959, 7.3469387755, 7.4693877551, 7.5918367347,
      7.2244897959, 7.3469387755, 7.4693877551, 7.5918367347, 7.2244897959,
      7.3469387755, 7.4693877551, 7.5918367347, 7.2244897959, 7.3469387755,
      7.4693877551, 7.5918367347, 3.7346938776, 3.7959183673, 3.8571428571,
      3.9183673469, 3.4897959184, 3.5510204082, 3.612244898,  3.6734693878,
      7.2244897959, 7.3469387755, 7.4693877551, 7.5918367347, 7.2244897959,
      7.3469387755, 7.4693877551, 7.5918367347, 7.2244897959, 7.3469387755,
      7.4693877551, 7.5918367347, 7.2244897959, 7.3469387755, 7.4693877551,
      7.5918367347, 7.2244897959, 7.3469387755, 7.4693877551, 7.5918367347,
      7.2244897959, 7.3469387755, 7.4693877551, 7.5918367347, 3.7346938776,
      3.7959183673, 3.8571428571, 3.9183673469, 3.4897959184, 3.5510204082,
      3.612244898,  3.6734693878, 7.2244897959, 7.3469387755, 7.4693877551,
      7.5918367347, 7.2244897959, 7.3469387755, 7.4693877551, 7.5918367347,
      7.2244897959, 7.3469387755, 7.4693877551, 7.5918367347, 7.2244897959,
      7.3469387755, 7.4693877551, 7.5918367347, 7.2244897959, 7.3469387755,
      7.4693877551, 7.5918367347, 7.2244897959, 7.3469387755, 7.4693877551,
      7.5918367347, 3.7346938776, 3.7959183673, 3.8571428571, 3.9183673469,
      2.4897959184, 2.5306122449, 2.5714285714, 2.612244898,  5.1428571429,
      5.2244897959, 5.306122449,  5.387755102,  5.1428571429, 5.2244897959,
      5.306122449,  5.387755102,  5.1428571429, 5.2244897959, 5.306122449,
      5.387755102,  5.1428571429, 5.2244897959, 5.306122449,  5.387755102,
      5.1428571429, 5.2244897959, 5.306122449,  5.387755102,  5.1428571429,
      5.2244897959, 5.306122449,  5.387755102,  2.6530612245, 2.693877551,
      2.7346938776, 2.7755102041, 1.3265306122, 1.3469387755, 1.3673469388,
      1.387755102,  2.7346938776, 2.7755102041, 2.8163265306, 2.8571428571,
      2.7346938776, 2.7755102041, 2.8163265306, 2.8571428571, 2.7346938776,
      2.7755102041, 2.8163265306, 2.8571428571, 2.7346938776, 2.7755102041,
      2.8163265306, 2.8571428571, 2.7346938776, 2.7755102041, 2.8163265306,
      2.8571428571, 2.7346938776, 2.7755102041, 2.8163265306, 2.8571428571,
      1.4081632653, 1.4285714286, 1.4489795918, 1.4693877551};
  const std::array<int, 4> in_shape = {{3, 9, 8, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x9x9x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      7.8827721088,   9.6620238095,   11.5497789116,  13.8787471655,
      14.4712471655,  16.309223356,   14.4866043084,  12.8158560091,
      11.0366043084,  12.0348129252,  14.6507993197,  17.3956972789,
      20.7484750567,  21.2766893424,  23.6360941043,  20.8849036281,
      18.3978287982,  15.7818424036,  17.1633843537,  20.7997789116,
      24.5854931973,  29.1763662132,  29.5760090703,  32.5211281179,
      28.6270804989,  25.1400056689,  21.5036111111,  24.2860034014,
      29.3271598639,  34.5414455782,  40.8267630385,  41.0014058957,
      44.7048582766,  39.2274773243,  34.3594501134,  29.3182936508,
      33.7699319728,  40.5753741497,  47.5468027211,  55.8737868481,
      55.3509297052,  59.5918820862,  52.0395011338,  45.4000453515,
      38.5946031746,  46.1602891156,  55.3157312925,  64.6443027211,
      75.7296201814,  74.4642630385,  79.6077154195,  69.3303344671,
      60.348021542,   51.1925793651,  43.5948129252,  52.2026360544,
      60.9597789116,  71.3506519274,  70.0102947846,  74.6954138322,
      65.0013662132,  56.5428628118,  47.9350396825,  40.4193027211,
      48.3740646259,  56.4577380952,  66.0390873016,  64.6987301587,
      68.9267063492,  59.9469444444,  52.1210941043,  44.1663321995,
      36.2672619048,  43.3852891156,  50.6118197279,  59.1693594104,
      57.8932879819,  61.5998356009,  53.5486451247,  46.5391213152,
      39.4210941043,  54.6097619048,  65.1777891156,  75.8543197279,
      88.4368594104,  85.9532879819,  90.8673356009,  78.7911451247,
      68.3316213152,  57.7635941043,  67.5505782313,  80.6084013605,
      93.7951360544,  109.3300566893, 106.2036281179, 112.217675737,
      97.2843424036,  84.355430839,   71.2976077098,  81.4679251701,
      97.1992176871,  113.079829932,  131.7814172336, 127.947845805,
      135.1261791383, 117.1214172336, 101.5394444444, 85.8081519274,
      98.8441156463,  117.9087414966, 137.1464965986, 159.7925283447,
      155.0589569161, 163.6706235828, 141.8325283447, 122.941031746,
      103.8764058957, 105.2519727891, 125.5023129252, 145.9186394558,
      169.9313378685, 164.7027664399, 173.6494331066, 150.4113378685,
      130.326984127,  110.0766439909, 120.7184013605, 143.8973129252,
      167.2493537415, 194.6953854875, 188.521814059,  198.5734807256,
      171.9353854875, 148.9296031746, 125.75069161,   107.8993537415,
      128.6020748299, 149.4541156463, 173.9557029478, 168.3821315193,
      177.3004648526, 153.4957029478, 132.9423015873, 112.2395804989,
      95.9350680272,  114.3316666667, 132.8571768707, 154.6206689342,
      149.6256689342, 157.5082879819, 136.34638322,   118.0786961451,
      99.6820975057,  82.9942517007,  98.9010544218,  114.9163605442,
      133.7274716553, 129.3753287982, 136.1579478458, 117.853185941,
      102.0548866213, 86.1480839002,  101.3367517007, 120.6935544218,
      140.1588605442, 162.9949716553, 157.4353287982, 165.4254478458,
      143.095685941,  123.8473866213, 104.4905839002, 123.0663435374,
      146.5660034014, 170.1945748299, 197.911638322,  191.1305668934,
      200.7992573696, 173.6837811791, 150.3130328798, 126.8133730159,
      145.7724659864, 173.5986564626, 201.5741666667, 234.386468254,
      226.3196825397, 237.7312301587, 205.6157539683, 177.93888322,
      150.1126927438, 173.4022278912, 206.4903231293, 239.751547619,
      278.7582936508, 269.1165079365, 282.6363888889, 244.4375793651,
      211.5226133787, 178.4345181406, 176.7340136054, 210.4292517007,
      244.2904761905, 283.9888888889, 274.0546031746, 287.706984127,
      248.7831746032, 215.2539229025, 181.5586848073, 195.2765136054,
      232.4788945578, 269.8544047619, 313.6611507937, 302.5793650794,
      317.5392460317, 274.5404365079, 237.5111848073, 200.3088038549,
      172.2038945578, 205.0015136054, 237.948452381,  276.5607539683,
      266.753968254,  279.905515873,  241.9900396825, 209.3417403628,
      176.5441213152, 151.4508333333, 180.2892687075, 209.2566156463,
      243.2022505669, 234.5526077098, 246.0898696145, 212.7458219955,
      184.0362981859, 155.1978628118, 129.7212414966, 154.4168197279,
      179.2209013605, 208.2855839002, 200.8573696145, 210.7160600907,
      182.1577267574, 157.5706519274, 132.8750736961};
  const std::array<int, 4> in_shape = {{3, 9, 9, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x9x9x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.0204081633, 0.0612244898, 0.1224489796, 0.1224489796, 0.1224489796,
      0.1224489796, 0.1224489796, 0.1020408163, 0.0612244898, 0.1020408163,
      0.2448979592, 0.4285714286, 0.4285714286, 0.4285714286, 0.4285714286,
      0.4285714286, 0.3265306122, 0.1836734694, 0.2448979592, 0.5510204082,
      0.9183673469, 0.9183673469, 0.9183673469, 0.9183673469, 0.9183673469,
      0.6734693878, 0.3673469388, 0.2448979592, 0.5510204082, 0.9183673469,
      0.9183673469, 0.9183673469, 0.9183673469, 0.9183673469, 0.6734693878,
      0.3673469388, 0.2448979592, 0.5510204082, 0.9183673469, 0.9183673469,
      0.9183673469, 0.9183673469, 0.9183673469, 0.6734693878, 0.3673469388,
      0.2448979592, 0.5510204082, 0.9183673469, 0.9183673469, 0.9183673469,
      0.9183673469, 0.9183673469, 0.6734693878, 0.3673469388, 0.2448979592,
      0.5510204082, 0.9183673469, 0.9183673469, 0.9183673469, 0.9183673469,
      0.9183673469, 0.6734693878, 0.3673469388, 0.2244897959, 0.4897959184,
      0.7959183673, 0.7959183673, 0.7959183673, 0.7959183673, 0.7959183673,
      0.5714285714, 0.306122449,  0.1428571429, 0.306122449,  0.4897959184,
      0.4897959184, 0.4897959184, 0.4897959184, 0.4897959184, 0.3469387755,
      0.1836734694, 0.2040816327, 0.4285714286, 0.6734693878, 0.6734693878,
      0.6734693878, 0.6734693878, 0.6734693878, 0.4693877551, 0.2448979592,
      0.4693877551, 0.9795918367, 1.5306122449, 1.5306122449, 1.5306122449,
      1.5306122449, 1.5306122449, 1.0612244898, 0.5510204082, 0.7959183673,
      1.6530612245, 2.5714285714, 2.5714285714, 2.5714285714, 2.5714285714,
      2.5714285714, 1.7755102041, 0.9183673469, 0.7959183673, 1.6530612245,
      2.5714285714, 2.5714285714, 2.5714285714, 2.5714285714, 2.5714285714,
      1.7755102041, 0.9183673469, 0.7959183673, 1.6530612245, 2.5714285714,
      2.5714285714, 2.5714285714, 2.5714285714, 2.5714285714, 1.7755102041,
      0.9183673469, 0.7959183673, 1.6530612245, 2.5714285714, 2.5714285714,
      2.5714285714, 2.5714285714, 2.5714285714, 1.7755102041, 0.9183673469,
      0.7959183673, 1.6530612245, 2.5714285714, 2.5714285714, 2.5714285714,
      2.5714285714, 2.5714285714, 1.7755102041, 0.9183673469, 0.5918367347,
      1.2244897959, 1.8979591837, 1.8979591837, 1.8979591837, 1.8979591837,
      1.8979591837, 1.306122449,  0.6734693878, 0.3265306122, 0.6734693878,
      1.0408163265, 1.0408163265, 1.0408163265, 1.0408163265, 1.0408163265,
      0.7142857143, 0.3673469388, 0.387755102,  0.7959183673, 1.2244897959,
      1.2244897959, 1.2244897959, 1.2244897959, 1.2244897959, 0.8367346939,
      0.4285714286, 0.8367346939, 1.7142857143, 2.6326530612, 2.6326530612,
      2.6326530612, 2.6326530612, 2.6326530612, 1.7959183673, 0.9183673469,
      1.3469387755, 2.7551020408, 4.2244897959, 4.2244897959, 4.2244897959,
      4.2244897959, 4.2244897959, 2.8775510204, 1.4693877551, 1.3469387755,
      2.7551020408, 4.2244897959, 4.2244897959, 4.2244897959, 4.2244897959,
      4.2244897959, 2.8775510204, 1.4693877551, 1.3469387755, 2.7551020408,
      4.2244897959, 4.2244897959, 4.2244897959, 4.2244897959, 4.2244897959,
      2.8775510204, 1.4693877551, 1.3469387755, 2.7551020408, 4.2244897959,
      4.2244897959, 4.2244897959, 4.2244897959, 4.2244897959, 2.8775510204,
      1.4693877551, 1.3469387755, 2.7551020408, 4.2244897959, 4.2244897959,
      4.2244897959, 4.2244897959, 4.2244897959, 2.8775510204, 1.4693877551,
      0.9591836735, 1.9591836735, 3.,           3.,           3.,
      3.,           3.,           2.0408163265, 1.0408163265, 0.5102040816,
      1.0408163265, 1.5918367347, 1.5918367347, 1.5918367347, 1.5918367347,
      1.5918367347, 1.0816326531, 0.5510204082};
  const std::array<int, 4> in_shape = {{3, 9, 9, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x9x9x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      15.1886678005,  15.7655442177,  18.6386678005,  19.324047619,
      22.3056746032,  23.0995578231,  26.8370238095,  27.7574943311,
      28.06,          28.9424943311,  31.6979761905,  32.618446712,
      28.1793253968,  28.9732086168,  24.9463321995,  25.6317120181,
      21.4963321995,  22.0732086168,  23.3842460317,  24.0696258503,
      28.4873072562,  29.3015986395,  33.84819161,    34.7913945578,
      40.4033503401,  41.4969501134,  41.5048979592,  42.5533786848,
      46.1785884354,  47.2721882086,  40.8266043084,  41.7698072562,
      35.9813662132,  36.7956575964,  30.8783049887,  31.5636848073,
      33.5328854875,  34.3267687075,  40.6563548753,  41.5995578231,
      48.0784637188,  49.1709863946,  57.0860034014,  58.3527324263,
      57.9375510204,  59.1520181406,  63.7755272109,  65.0422562358,
      56.161638322,   57.2541609977,  49.33680839,    50.2800113379,
      42.2133390023,  43.0072222222,  47.6515362812,  48.5720068027,
      57.5607199546,  58.6543197279,  67.8161621315,  69.0828911565,
      80.1848129252,  81.6535260771,  80.5946938776,  82.0028117914,
      87.9410034014,  89.4097165533,  77.1882256236,  78.4549546485,
      67.6253004535,  68.7189002268,  57.71611678,    58.6365873016,
      66.6573696145,  67.5398639456,  80.1022675737,  81.1507482993,
      93.879138322,   95.0936054422,  110.3394557823, 111.7475736961,
      109.3518367347, 110.7018594104, 117.7756462585, 119.1837641723,
      102.8645351474, 104.0790022676, 89.7516099773,  90.8000907029,
      76.3067120181,  77.1892063492,  91.4001077098,  92.3205782313,
      109.5378628118, 110.631462585,  128.0218764172, 129.2886054422,
      149.9905272109, 151.4592403628, 147.5204081633, 148.9285260771,
      157.7467176871, 159.215430839,  137.3939399093, 138.6606689342,
      119.6024433107, 120.6960430839, 101.4646882086, 102.3851587302,
      86.3957426304,  87.1896258503,  103.462069161,  104.4052721088,
      120.8270351474, 121.9195578231, 141.4345748299, 142.7013038549,
      138.806122449,  140.0205895692, 148.1240986395, 149.3908276644,
      128.9102097506, 130.0027324263, 112.1425226757, 113.0857256236,
      95.0761961451,  95.8700793651,  80.1532256236,  80.8386054422,
      95.9338378685,  96.7481292517,  111.9722732426, 112.9154761905,
      130.9845748299, 132.0781746032, 128.3489795918, 129.3974603175,
      136.7598129252, 137.8534126984, 118.950685941,  119.8938888889,
      103.4278968254, 104.2421882086, 87.6472845805,  88.3326643991,
      71.9576473923,  72.5345238095,  86.0851984127,  86.7705782313,
      100.4297562358, 101.2236394558, 117.4182482993, 118.3387188209,
      114.9040816327, 115.7865759637, 122.2792006803, 123.1996712018,
      106.3034070295, 107.0972902494, 92.3928628118,  93.0782426304,
      78.2653117914,  78.8421882086,  108.6426473923, 109.2195238095,
      129.6701984127, 130.3555782313, 150.9147562358, 151.7086394558,
      175.9532482993, 176.8737188209, 171.0240816327, 171.9065759637,
      180.8142006803, 181.7346712018, 156.7884070295, 157.5822902494,
      135.9778628118, 136.6632426304, 114.9503117914, 115.5271882086,
      134.415776644,  135.1011564626, 160.4025113379, 161.2168027211,
      186.647069161,  187.5902721088, 217.5665136054, 218.6601133787,
      211.3587755102, 212.4072562358, 223.3417517007, 224.4353514739,
      193.6254818594, 194.5686848073, 167.8965702948, 168.710861678,
      141.9098356009, 142.5952154195, 162.1419671202, 162.9358503401,
      193.4552324263, 194.3984353741, 225.0671371882, 226.1596598639,
      262.2961054422, 263.5628344671, 254.6812244898, 255.89569161,
      268.9856292517, 270.2523582766, 233.1503117914, 234.2428344671,
      202.135685941,  203.0788888889, 170.8224206349, 171.6163038549,
      196.767760771,  197.6882312925, 234.72388322,   235.8174829932,
      273.0262641723, 274.2929931973, 318.1163435374, 319.5850566893,
      308.7097959184, 310.1179138322, 325.8725340136, 327.3412471655,
      282.3983276644, 283.6650566893, 244.7884637188, 245.8820634921,
      206.8323412698, 207.7528117914, 209.6214512472, 210.5039455782,
      249.9561451247, 251.0046258503, 290.6228117914, 291.8372789116,
      338.4545578231, 339.862675737,  328.0555102041, 329.4055328798,
      345.8907482993, 347.2988662132, 299.6082086168, 300.822675737,
      259.6054875283, 260.653968254,  219.2707936508, 220.1532879819,
      240.5163321995, 241.4368027211, 286.7010260771, 287.7946258503,
      333.231978458,  334.498707483,  387.9220578231, 389.3907709751,
      375.6355102041, 377.0436281179, 395.6782482993, 397.1469614512,
      342.6040419501, 343.8707709751, 296.765606576,  297.8592063492,
      250.5809126984, 251.50138322,   215.004824263,  215.798707483,
      256.260946712,  257.2041496599, 297.8157086168, 298.9082312925,
      346.6446768707, 347.9114058957, 335.5497959184, 336.7642630385,
      353.3342006803, 354.6009297052, 305.89888322,   306.9914058957,
      264.9414002268, 265.8846031746, 223.6852777778, 224.4791609977,
      191.1847562358, 191.8701360544, 227.8490419501, 228.6633333333,
      264.7711507937, 265.7143537415, 308.1477380952, 309.2413378685,
      298.2028571429, 299.2513378685, 313.9229761905, 315.0165759637,
      271.7495634921, 272.6927664399, 235.343100907,  236.1573922902,
      198.6788151927, 199.3641950113, 165.4116269841, 165.9885034014,
      197.1167290249, 197.8021088435, 229.0388378685, 229.8327210884,
      266.5344727891, 267.4549433107, 257.8681632653, 258.7506575964,
      271.3954251701, 272.3158956916, 234.9124886621, 235.7063718821,
      203.424393424,  204.1097732426, 171.7192913832, 172.2961678005,
      202.0966269841, 202.6735034014, 240.7017290249, 241.3871088435,
      279.5238378685, 280.3177210884, 325.0694727891, 325.9899433107,
      313.9881632653, 314.8706575964, 329.9304251701, 330.8508956916,
      285.3974886621, 286.1913718821, 247.009393424,  247.6947732426,
      208.4042913832, 208.9811678005, 245.4473072562, 246.1326870748,
      292.3177154195, 293.1320068027, 339.445946712,  340.3891496599,
      394.7296768707, 395.823276644,  381.2126530612, 382.2611337868,
      400.504914966,  401.5985147392, 346.4243594104, 347.3675623583,
      299.8117743764, 300.6260657596, 252.9413662132, 253.6267460317,
      290.7510487528, 291.5449319728, 346.2541099773, 347.1973129252,
      402.0558106576, 403.1483333333, 467.506207483,  468.7729365079,
      451.4248979592, 452.6393650794, 474.1957312925, 475.4624603175,
      410.1389852608, 411.2315079365, 354.9345634921, 355.8777664399,
      299.4315022676, 300.2253854875, 345.8839852608, 346.8044557823,
      411.8870464853, 412.9806462585, 478.2363662132, 479.5030952381,
      556.0478741497, 557.5165873016, 536.8248979592, 538.233015873,
      563.8040646259, 565.2727777778, 487.6084297052, 488.8751587302,
      421.9516269841, 423.0452267574, 355.9485657596, 356.8690362812,
      352.5855328798, 353.4680272109, 419.8100226757, 420.8585034014,
      487.3664852608, 488.580952381,  566.5696598639, 567.9777777778,
      546.7591836735, 548.1092063492, 574.0058503401, 575.413968254,
      496.3518820862, 497.5663492063, 429.4593650794, 430.507845805,
      362.2348752834, 363.1173696145, 389.6325566893, 390.5530272109,
      463.8641893424, 464.9577891156, 538.4420804989, 539.7088095238,
      625.8535884354, 627.3223015873, 603.7506122449, 605.1587301587,
      633.6097789116, 635.0784920635, 547.8141439909, 549.0808730159,
      473.9287698413, 475.0223696145, 399.6971371882, 400.6176077098,
      343.6139058957, 344.4077891156, 409.059824263,  410.0030272109,
      474.8043820862, 475.8969047619, 551.8547789116, 553.1215079365,
      532.2934693878, 533.5079365079, 558.5443027211, 559.811031746,
      482.8875566893, 483.9800793651, 417.7402777778, 418.6834807256,
      352.2943594104, 353.0882426304, 302.2162868481, 302.9016666667,
      359.7642460317, 360.578537415,  417.5700283447, 418.5132312925,
      485.3109013605, 486.4045011338, 468.0567346939, 469.1052154195,
      491.0861394558, 492.179739229,  424.5484410431, 425.4916439909,
      367.2583049887, 368.0725963719, 309.710345805,  310.3957256236,
      258.865606576,  259.4424829932, 308.1482596372, 308.8336394558,
      357.6479195011, 358.4418027211, 415.6506972789, 416.5711678005,
      400.832244898,  401.714739229,  420.5116496599, 421.4321201814,
      363.5215702948, 364.3154535147, 314.4559240363, 315.1413038549,
      265.1732709751, 265.7501473923};
  const std::array<int, 4> in_shape = {{3, 9, 9, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x9x9x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.0204081633, 0.0408163265, 0.0816326531, 0.1224489796, 0.1836734694,
      0.2448979592, 0.1836734694, 0.2448979592, 0.1836734694, 0.2448979592,
      0.1836734694, 0.2448979592, 0.1836734694, 0.2448979592, 0.1632653061,
      0.2040816327, 0.1020408163, 0.1224489796, 0.1632653061, 0.2040816327,
      0.4081632653, 0.4897959184, 0.7346938776, 0.8571428571, 0.7346938776,
      0.8571428571, 0.7346938776, 0.8571428571, 0.7346938776, 0.8571428571,
      0.7346938776, 0.8571428571, 0.5714285714, 0.6530612245, 0.3265306122,
      0.3673469388, 0.4285714286, 0.4897959184, 0.9795918367, 1.1020408163,
      1.6530612245, 1.8367346939, 1.6530612245, 1.8367346939, 1.6530612245,
      1.8367346939, 1.6530612245, 1.8367346939, 1.6530612245, 1.8367346939,
      1.2244897959, 1.3469387755, 0.6734693878, 0.7346938776, 0.4285714286,
      0.4897959184, 0.9795918367, 1.1020408163, 1.6530612245, 1.8367346939,
      1.6530612245, 1.8367346939, 1.6530612245, 1.8367346939, 1.6530612245,
      1.8367346939, 1.6530612245, 1.8367346939, 1.2244897959, 1.3469387755,
      0.6734693878, 0.7346938776, 0.4285714286, 0.4897959184, 0.9795918367,
      1.1020408163, 1.6530612245, 1.8367346939, 1.6530612245, 1.8367346939,
      1.6530612245, 1.8367346939, 1.6530612245, 1.8367346939, 1.6530612245,
      1.8367346939, 1.2244897959, 1.3469387755, 0.6734693878, 0.7346938776,
      0.4285714286, 0.4897959184, 0.9795918367, 1.1020408163, 1.6530612245,
      1.8367346939, 1.6530612245, 1.8367346939, 1.6530612245, 1.8367346939,
      1.6530612245, 1.8367346939, 1.6530612245, 1.8367346939, 1.2244897959,
      1.3469387755, 0.6734693878, 0.7346938776, 0.4285714286, 0.4897959184,
      0.9795918367, 1.1020408163, 1.6530612245, 1.8367346939, 1.6530612245,
      1.8367346939, 1.6530612245, 1.8367346939, 1.6530612245, 1.8367346939,
      1.6530612245, 1.8367346939, 1.2244897959, 1.3469387755, 0.6734693878,
      0.7346938776, 0.4081632653, 0.4489795918, 0.8979591837, 0.9795918367,
      1.4693877551, 1.5918367347, 1.4693877551, 1.5918367347, 1.4693877551,
      1.5918367347, 1.4693877551, 1.5918367347, 1.4693877551, 1.5918367347,
      1.0612244898, 1.1428571429, 0.5714285714, 0.612244898,  0.2653061224,
      0.2857142857, 0.5714285714, 0.612244898,  0.9183673469, 0.9795918367,
      0.9183673469, 0.9795918367, 0.9183673469, 0.9795918367, 0.9183673469,
      0.9795918367, 0.9183673469, 0.9795918367, 0.6530612245, 0.693877551,
      0.3469387755, 0.3673469388, 0.387755102,  0.4081632653, 0.8163265306,
      0.8571428571, 1.2857142857, 1.3469387755, 1.2857142857, 1.3469387755,
      1.2857142857, 1.3469387755, 1.2857142857, 1.3469387755, 1.2857142857,
      1.3469387755, 0.8979591837, 0.9387755102, 0.4693877551, 0.4897959184,
      0.8979591837, 0.9387755102, 1.8775510204, 1.9591836735, 2.9387755102,
      3.0612244898, 2.9387755102, 3.0612244898, 2.9387755102, 3.0612244898,
      2.9387755102, 3.0612244898, 2.9387755102, 3.0612244898, 2.0408163265,
      2.1224489796, 1.0612244898, 1.1020408163, 1.5306122449, 1.5918367347,
      3.1836734694, 3.306122449,  4.9591836735, 5.1428571429, 4.9591836735,
      5.1428571429, 4.9591836735, 5.1428571429, 4.9591836735, 5.1428571429,
      4.9591836735, 5.1428571429, 3.4285714286, 3.5510204082, 1.7755102041,
      1.8367346939, 1.5306122449, 1.5918367347, 3.1836734694, 3.306122449,
      4.9591836735, 5.1428571429, 4.9591836735, 5.1428571429, 4.9591836735,
      5.1428571429, 4.9591836735, 5.1428571429, 4.9591836735, 5.1428571429,
      3.4285714286, 3.5510204082, 1.7755102041, 1.8367346939, 1.5306122449,
      1.5918367347, 3.1836734694, 3.306122449,  4.9591836735, 5.1428571429,
      4.9591836735, 5.1428571429, 4.9591836735, 5.1428571429, 4.9591836735,
      5.1428571429, 4.9591836735, 5.1428571429, 3.4285714286, 3.5510204082,
      1.7755102041, 1.8367346939, 1.5306122449, 1.5918367347, 3.1836734694,
      3.306122449,  4.9591836735, 5.1428571429, 4.9591836735, 5.1428571429,
      4.9591836735, 5.1428571429, 4.9591836735, 5.1428571429, 4.9591836735,
      5.1428571429, 3.4285714286, 3.5510204082, 1.7755102041, 1.8367346939,
      1.5306122449, 1.5918367347, 3.1836734694, 3.306122449,  4.9591836735,
      5.1428571429, 4.9591836735, 5.1428571429, 4.9591836735, 5.1428571429,
      4.9591836735, 5.1428571429, 4.9591836735, 5.1428571429, 3.4285714286,
      3.5510204082, 1.7755102041, 1.8367346939, 1.1428571429, 1.1836734694,
      2.3673469388, 2.4489795918, 3.6734693878, 3.7959183673, 3.6734693878,
      3.7959183673, 3.6734693878, 3.7959183673, 3.6734693878, 3.7959183673,
      3.6734693878, 3.7959183673, 2.5306122449, 2.612244898,  1.306122449,
      1.3469387755, 0.6326530612, 0.6530612245, 1.306122449,  1.3469387755,
      2.0204081633, 2.0816326531, 2.0204081633, 2.0816326531, 2.0204081633,
      2.0816326531, 2.0204081633, 2.0816326531, 2.0204081633, 2.0816326531,
      1.387755102,  1.4285714286, 0.7142857143, 0.7346938776, 0.7551020408,
      0.7755102041, 1.5510204082, 1.5918367347, 2.387755102,  2.4489795918,
      2.387755102,  2.4489795918, 2.387755102,  2.4489795918, 2.387755102,
      2.4489795918, 2.387755102,  2.4489795918, 1.6326530612, 1.6734693878,
      0.8367346939, 0.8571428571, 1.6326530612, 1.6734693878, 3.3469387755,
      3.4285714286, 5.1428571429, 5.2653061224, 5.1428571429, 5.2653061224,
      5.1428571429, 5.2653061224, 5.1428571429, 5.2653061224, 5.1428571429,
      5.2653061224, 3.5102040816, 3.5918367347, 1.7959183673, 1.8367346939,
      2.6326530612, 2.693877551,  5.387755102,  5.5102040816, 8.2653061224,
      8.4489795918, 8.2653061224, 8.4489795918, 8.2653061224, 8.4489795918,
      8.2653061224, 8.4489795918, 8.2653061224, 8.4489795918, 5.6326530612,
      5.7551020408, 2.8775510204, 2.9387755102, 2.6326530612, 2.693877551,
      5.387755102,  5.5102040816, 8.2653061224, 8.4489795918, 8.2653061224,
      8.4489795918, 8.2653061224, 8.4489795918, 8.2653061224, 8.4489795918,
      8.2653061224, 8.4489795918, 5.6326530612, 5.7551020408, 2.8775510204,
      2.9387755102, 2.6326530612, 2.693877551,  5.387755102,  5.5102040816,
      8.2653061224, 8.4489795918, 8.2653061224, 8.4489795918, 8.2653061224,
      8.4489795918, 8.2653061224, 8.4489795918, 8.2653061224, 8.4489795918,
      5.6326530612, 5.7551020408, 2.8775510204, 2.9387755102, 2.6326530612,
      2.693877551,  5.387755102,  5.5102040816, 8.2653061224, 8.4489795918,
      8.2653061224, 8.4489795918, 8.2653061224, 8.4489795918, 8.2653061224,
      8.4489795918, 8.2653061224, 8.4489795918, 5.6326530612, 5.7551020408,
      2.8775510204, 2.9387755102, 2.6326530612, 2.693877551,  5.387755102,
      5.5102040816, 8.2653061224, 8.4489795918, 8.2653061224, 8.4489795918,
      8.2653061224, 8.4489795918, 8.2653061224, 8.4489795918, 8.2653061224,
      8.4489795918, 5.6326530612, 5.7551020408, 2.8775510204, 2.9387755102,
      1.8775510204, 1.9183673469, 3.8367346939, 3.9183673469, 5.8775510204,
      6.,           5.8775510204, 6.,           5.8775510204, 6.,
      5.8775510204, 6.,           5.8775510204, 6.,           4.,
      4.0816326531, 2.0408163265, 2.0816326531, 1.,           1.0204081633,
      2.0408163265, 2.0816326531, 3.1224489796, 3.1836734694, 3.1224489796,
      3.1836734694, 3.1224489796, 3.1836734694, 3.1224489796, 3.1836734694,
      3.1224489796, 3.1836734694, 2.1224489796, 2.1632653061, 1.0816326531,
      1.1020408163};
  const std::array<int, 4> in_shape = {{3, 9, 9, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x9x9x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      29.8004591837,   30.3773356009,   30.9542120181,   31.5310884354,
      36.5919557823,   37.2773356009,   37.9627154195,   38.6480952381,
      43.8174659864,   44.6113492063,   45.4052324263,   46.1991156463,
      52.7535770975,   53.674047619,    54.5945181406,   55.5149886621,
      55.2375056689,   56.12,           57.0024943311,   57.8849886621,
      62.4754818594,   63.395952381,    64.3164229025,   65.236893424,
      55.5647675737,   56.3586507937,   57.1525340136,   57.9464172336,
      49.2072845805,   49.8926643991,   50.5780442177,   51.2634240363,
      42.4157879819,   42.9926643991,   43.5695408163,   44.1464172336,
      46.0831122449,   46.7684920635,   47.4538718821,   48.1392517007,
      56.1603231293,   56.9746145125,   57.7889058957,   58.6031972789,
      66.7531802721,   67.69638322,     68.6395861678,   69.5827891156,
      79.713100907,    80.8067006803,   81.9003004535,   82.9939002268,
      81.9613151927,   83.0097959184,   84.058276644,    85.1067573696,
      91.2635770975,   92.3571768707,   93.450776644,    94.5443764172,
      80.7100056689,   81.6532086168,   82.5964115646,   83.5396145125,
      71.1484410431,   71.9627324263,   72.7770238095,   73.5913151927,
      61.0712301587,   61.7566099773,   62.4419897959,   63.1273696145,
      66.2718877551,   67.0657709751,   67.859654195,    68.653537415,
      80.3695068027,   81.3127097506,   82.2559126984,   83.1991156463,
      95.0644047619,   96.1569274376,   97.2494501134,   98.3419727891,
      112.9052777778,  114.1720068027,  115.4387358277,  116.7054648526,
      114.6606349206,  115.8751020408,  117.089569161,   118.3040362812,
      126.2843253968,  127.5510544218,  128.8177834467,  130.0845124717,
      111.2307539683,  112.323276644,   113.4157993197,  114.5083219955,
      97.7304138322,   98.67361678,     99.6168197279,   100.5600226757,
      83.6327947846,   84.4266780045,   85.2205612245,   86.0144444444,
      94.3826020408,   95.3030725624,   96.2235430839,   97.1440136054,
      114.0278401361,  115.1214399093,  116.2150396825,  117.3086394558,
      134.3655952381,  135.632324263,   136.899053288,   138.1657823129,
      158.9009126984,  160.3696258503,  161.8383390023,  163.3070521542,
      159.7812698413,  161.1893877551,  162.5975056689,  164.0056235828,
      174.4132936508,  175.8820068027,  177.3507199546,  178.8194331066,
      153.1097222222,  154.3764512472,  155.6431802721,  156.9099092971,
      134.1570011338,  135.250600907,   136.3442006803,  137.4378004535,
      114.5117630385,  115.4322335601,  116.3527040816,  117.2731746032,
      132.432244898,   133.314739229,   134.1972335601,  135.0797278912,
      159.1560544218,  160.2045351474,  161.253015873,   162.3014965986,
      186.5438095238,  187.758276644,   188.9727437642,  190.1872108844,
      219.2707936508,  220.6789115646,  222.0870294785,  223.4951473923,
      217.3536507937,  218.7036734694,  220.0536961451,  221.4037188209,
      234.1431746032,  235.551292517,   236.9594104308,  238.3675283447,
      204.5146031746,  205.7290702948,  206.943537415,   208.1580045351,
      178.454739229,   179.5032199546,  180.5517006803,  181.6001814059,
      151.7309297052,  152.6134240363,  153.4959183673,  154.3784126984,
      181.879744898,   182.8002154195,  183.720685941,   184.6411564626,
      217.9821258503,  219.0757256236,  220.1693253968,  221.2629251701,
      254.7770238095,  256.0437528345,  257.3104818594,  258.5772108844,
      298.5123412698,  299.9810544218,  301.4497675737,  302.9184807256,
      293.6326984127,  295.0408163265,  296.4489342404,  297.8570521542,
      314.0247222222,  315.4934353741,  316.9621485261,  318.430861678,
      273.5211507937,  274.7878798186,  276.0546088435,  277.3213378685,
      238.1112868481,  239.2048866213,  240.2984863946,  241.3920861678,
      202.0089058957,  202.9293764172,  203.8498469388,  204.7703174603,
      171.9976020408,  172.7914852608,  173.5853684807,  174.3792517007,
      205.9809353741,  206.924138322,   207.8673412698,  208.8105442177,
      240.561547619,   241.6540702948,  242.7465929705,  243.8391156463,
      281.6024206349,  282.8691496599,  284.1358786848,  285.4026077098,
      276.3977777778,  277.612244898,   278.8267120181,  280.0411791383,
      294.981468254,   296.2481972789,  297.5149263039,  298.7816553288,
      256.7278968254,  257.8204195011,  258.9129421769,  260.0054648526,
      223.3418424036,  224.2850453515,  225.2282482993,  226.1714512472,
      189.3585090703,  190.1523922902,  190.9462755102,  191.7401587302,
      159.6210714286,  160.3064512472,  160.9918310658,  161.6772108844,
      191.0533843537,  191.867675737,   192.6819671202,  193.4962585034,
      223.0013435374,  223.9445464853,  224.8877494331,  225.830952381,
      260.8755498866,  261.9691496599,  263.0627494331,  264.1563492063,
      255.649478458,   256.6979591837,  257.7464399093,  258.7949206349,
      272.4260260771,  273.5196258503,  274.6132256236,  275.7068253968,
      236.9581689342,  237.9013718821,  238.8445748299,  239.7877777778,
      206.0415022676,  206.8557936508,  207.670085034,   208.4843764172,
      174.6091893424,  175.294569161,   175.9799489796,  176.6653287982,
      143.3384183673,  143.9152947846,  144.4921712018,  145.069047619,
      171.4850170068,  172.1703968254,  172.855776644,   173.5411564626,
      200.0656292517,  200.8595124717,  201.6533956916,  202.4472789116,
      233.9160260771,  234.8364965986,  235.7569671202,  236.6774376417,
      228.9256689342,  229.8081632653,  230.6906575964,  231.5731519274,
      243.637930839,   244.5584013605,  245.4788718821,  246.3993424036,
      211.812930839,   212.606814059,   213.4006972789,  214.1945804989,
      184.100345805,   184.7857256236,  185.4711054422,  186.1564852608,
      155.9537471655,  156.5306235828,  157.1075,        157.6843764172,
      216.7084183673,  217.2852947846,  217.8621712018,  218.439047619,
      258.6550170068,  259.3403968254,  260.025776644,   260.7111564626,
      301.0356292517,  301.8295124717,  302.6233956916,  303.4172789116,
      350.9860260771,  351.9064965986,  352.8269671202,  353.7474376417,
      341.1656689342,  342.0481632653,  342.9306575964,  343.8131519274,
      360.707930839,   361.6284013605,  362.5488718821,  363.4693424036,
      312.782930839,   313.576814059,   314.3706972789,  315.1645804989,
      271.270345805,   271.9557256236,  272.6411054422,  273.3264852608,
      229.3237471655,  229.9006235828,  230.4775,        231.0543764172,
      268.1461734694,  268.831553288,   269.5169331066,  270.2023129252,
      319.9907312925,  320.8050226757,  321.619314059,   322.4336054422,
      372.3509353741,  373.294138322,   374.2373412698,  375.1805442177,
      434.0394274376,  435.1330272109,  436.2266269841,  437.3202267574,
      421.6690702948,  422.7175510204,  423.766031746,   424.8145124717,
      445.5899036281,  446.6835034014,  447.7771031746,  448.8707029478,
      386.307760771,   387.2509637188,  388.1941666667,  389.1373696145,
      334.9788492063,  335.7931405896,  336.6074319728,  337.421723356,
      283.1342913832,  283.8196712018,  284.5050510204,  285.190430839,
      323.4900510204,  324.2839342404,  325.0778174603,  325.8717006803,
      385.9672619048,  386.9104648526,  387.8536678005,  388.7968707483,
      449.0417517007,  450.1342743764,  451.2267970522,  452.3193197279,
      523.3254818594,  524.5922108844,  525.8589399093,  527.1256689342,
      508.1479818594,  509.3624489796,  510.5769160998,  511.79138322,
      536.7045294785,  537.9712585034,  539.2379875283,  540.5047165533,
      465.208100907,   466.3006235828,  467.3931462585,  468.4856689342,
      403.3281689342,  404.2713718821,  405.2145748299,  406.1577777778,
      340.8509580499,  341.6448412698,  342.4387244898,  343.2326077098,
      392.6150510204,  393.535521542,   394.4559920635,  395.376462585,
      468.3541666667,  469.4477664399,  470.5413662132,  471.6349659864,
      544.7857993197,  546.0525283447,  547.3192573696,  548.5859863946,
      634.7639739229,  636.2326870748,  637.7014002268,  639.1701133787,
      616.0114739229,  617.4195918367,  618.8277097506,  620.2358276644,
      650.2763548753,  651.7450680272,  653.2137811791,  654.6824943311,
      563.5299263039,  564.7966553288,  566.0633843537,  567.3301133787,
      488.4833276644,  489.5769274376,  490.6705272109,  491.7641269841,
      412.7442120181,  413.6646825397,  414.5851530612,  415.5056235828,
      418.3604081633,  419.2429024943,  420.1253968254,  421.0078911565,
      498.8638095238,  499.9122902494,  500.9607709751,  502.0092517007,
      580.0311564626,  581.2456235828,  582.4600907029,  583.6745578231,
      675.5009977324,  676.9091156463,  678.3172335601,  679.7253514739,
      654.7609977324,  656.1110204082,  657.4610430839,  658.8110657596,
      690.3733786848,  691.7814965986,  693.1896145125,  694.5977324263,
      598.0019501134,  599.2164172336,  600.4308843537,  601.6453514739,
      518.1624943311,  519.2109750567,  520.2594557823,  521.3079365079,
      437.6590929705,  438.5415873016,  439.4240816327,  440.3065759637,
      480.1121938776,  481.0326643991,  481.9531349206,  482.8736054422,
      572.308452381,   573.4020521542,  574.4956519274,  575.5892517007,
      665.1972278912,  666.4639569161,  667.730685941,   668.997414966,
      774.3754024943,  775.8441156463,  777.3128287982,  778.7815419501,
      749.8629024943,  751.2710204082,  752.679138322,   754.0872562358,
      789.8877834467,  791.3564965986,  792.8252097506,  794.2939229025,
      683.9413548753,  685.2080839002,  686.4748129252,  687.7415419501,
      592.4376133787,  593.5312131519,  594.6248129252,  595.7184126984,
      500.2413548753,  501.1618253968,  502.0822959184,  503.0027664399,
      429.2157653061,  430.0096485261,  430.803531746,   431.597414966,
      511.5786904762,  512.521893424,   513.4650963719,  514.4082993197,
      594.5388945578,  595.6314172336,  596.7239399093,  597.816462585,
      692.0226247166,  693.2893537415,  694.5560827664,  695.8228117914,
      669.8851247166,  671.0995918367,  672.3140589569,  673.5285260771,
      705.4016723356,  706.6684013605,  707.9351303855,  709.2018594104,
      610.7052437642,  611.7977664399,  612.8902891156,  613.9828117914,
      528.9395975057,  529.8828004535,  530.8260034014,  531.7692063492,
      446.5766723356,  447.3705555556,  448.1644387755,  448.9583219955,
      381.6841326531,  382.3695124717,  383.0548922902,  383.7402721088,
      454.883792517,   455.6980839002,  456.5123752834,  457.3266666667,
      528.5990986395,  529.5423015873,  530.4855045351,  531.428707483,
      615.2018764172,  616.2954761905,  617.3890759637,  618.482675737,
      595.3572335601,  596.4057142857,  597.4541950113,  598.502675737,
      626.7523526077,  627.845952381,   628.9395521542,  630.0331519274,
      542.5559240363,  543.4991269841,  544.442329932,   545.3855328798,
      469.8719104308,  470.6862018141,  471.5004931973,  472.3147845805,
      396.6722505669,  397.3576303855,  398.0430102041,  398.7283900227,
      330.246377551,   330.8232539683,  331.4001303855,  331.9770068027,
      393.5480782313,  394.2334580499,  394.9188378685,  395.6042176871,
      457.283792517,   458.077675737,   458.8715589569,  459.6654421769,
      532.1484750567,  533.0689455782,  533.9894160998,  534.9098866213,
      514.8538321995,  515.7363265306,  516.6188208617,  517.5013151927,
      541.8703798186,  542.7908503401,  543.7113208617,  544.6317913832,
      469.0310941043,  469.8249773243,  470.6188605442,  471.4127437642,
      406.1634070295,  406.8487868481,  407.5341666667,  408.2195464853,
      342.8617063492,  343.4385827664,  344.0154591837,  344.5923356009,
      403.616377551,   404.1932539683,  404.7701303855,  405.3470068027,
      480.7180782313,  481.4034580499,  482.0888378685,  482.7742176871,
      558.253792517,   559.047675737,   559.8415589569,  560.6354421769,
      649.2184750567,  650.1389455782,  651.0594160998,  651.9798866213,
      627.0938321995,  627.9763265306,  628.8588208617,  629.7413151927,
      658.9403798186,  659.8608503401,  660.7813208617,  661.7017913832,
      570.0010941043,  570.7949773243,  571.5888605442,  572.3827437642,
      493.3334070295,  494.0187868481,  494.7041666667,  495.3895464853,
      416.2317063492,  416.8085827664,  417.3854591837,  417.9623356009,
      490.2092346939,  490.8946145125,  491.5799943311,  492.2653741497,
      583.8211394558,  584.635430839,   585.4497222222,  586.2640136054,
      677.9486904762,  678.891893424,   679.8350963719,  680.7782993197,
      788.3657539683,  789.4593537415,  790.5529535147,  791.646553288,
      761.3768253968,  762.4253061224,  763.4737868481,  764.5222675737,
      799.9162301587,  801.009829932,   802.1034297052,  803.1970294785,
      691.905515873,   692.8487188209,  693.7919217687,  694.7351247166,
      598.8092573696,  599.6235487528,  600.4378401361,  601.2521315193,
      505.1973526077,  505.8827324263,  506.5681122449,  507.2534920635,
      580.7082142857,  581.5020975057,  582.2959807256,  583.0898639456,
      691.5650170068,  692.5082199546,  693.4514229025,  694.3946258503,
      803.0190986395,  804.1116213152,  805.2041439909,  806.2966666667,
      933.745685941,   935.012414966,   936.2791439909,  937.5458730159,
      901.6353287982,  902.8497959184,  904.0642630385,  905.2787301587,
      947.1247335601,  948.391462585,   949.65819161,    950.9249206349,
      819.1854478458,  820.2779705215,  821.3704931973,  822.463015873,
      708.9259240363,  709.8691269841,  710.812329932,   711.7555328798,
      598.0691213152,  598.8630045351,  599.6568877551,  600.4507709751,
      690.8475,        691.7679705215,  692.6884410431,  693.6089115646,
      822.6804931973,  823.7740929705,  824.8676927438,  825.961292517,
      955.2060034014,  956.4727324263,  957.7394614512,  959.0061904762,
      1110.6270351474, 1112.0957482993, 1113.5644614512, 1115.0331746032,
      1072.2416780045, 1073.6497959184, 1075.0579138322, 1076.466031746,
      1126.1394160998, 1127.6081292517, 1129.0768424036, 1130.5455555556,
      973.9501303855,  975.2168594104,  976.4835884354,  977.7503174603,
      842.809654195,   843.9032539683,  844.9968537415,  846.0904535147,
      710.9766609977,  711.8971315193,  712.8176020408,  713.7380725624,
      704.2885714286,  705.1710657596,  706.0535600907,  706.9360544218,
      838.5715646259,  839.6200453515,  840.6685260771,  841.7170068027,
      973.5185034014,  974.7329705215,  975.9474376417,  977.1619047619,
      1131.7312018141, 1133.1393197279, 1134.5474376417, 1135.9555555556,
      1092.1683446712, 1093.5183673469, 1094.8683900227, 1096.2184126984,
      1146.6035827664, 1148.0117006803, 1149.4198185941, 1150.8279365079,
      991.4892970522,  992.7037641723,  993.9182312925,  995.1326984127,
      857.8702494331,  858.9187301587,  859.9672108844,  861.01569161,
      723.5872562358,  724.4697505669,  725.352244898,   726.234739229,
      778.3446428571,  779.2651133787,  780.1855839002,  781.1060544218,
      926.6347789116,  927.7283786848,  928.821978458,   929.9155782313,
      1075.6174319728, 1076.8841609977, 1078.1508900227, 1079.4176190476,
      1250.2384637188, 1251.7071768707, 1253.1758900227, 1254.6446031746,
      1206.093106576,  1207.5012244898, 1208.9093424036, 1210.3174603175,
      1265.7508446712, 1267.2195578231, 1268.6882709751, 1270.156984127,
      1094.3615589569, 1095.6282879819, 1096.8950170068, 1098.1617460317,
      946.7639399093,  947.8575396825,  948.9511394558,  950.044739229,
      798.4738038549,  799.3942743764,  800.314744898,   801.2352154195,
      686.4339285714,  687.2278117914,  688.0216950113,  688.8155782313,
      817.1764455782,  818.1196485261,  819.0628514739,  820.0060544218,
      948.5162414966,  949.6087641723,  950.7012868481,  951.7938095238,
      1102.4428287982, 1103.7095578231, 1104.9762868481, 1106.243015873,
      1063.3724716553, 1064.5869387755, 1065.8014058957, 1067.0158730159,
      1115.8218764172, 1117.0886054422, 1118.3553344671, 1119.6220634921,
      964.6825907029,  965.7751133787,  966.8676360544,  967.9601587302,
      834.5373526077,  835.4805555556,  836.4237585034,  837.3669614512,
      703.7948356009,  704.5887188209,  705.3826020408,  706.1764852608,
      603.7471938776,  604.4325736961,  605.1179535147,  605.8033333333,
      718.7142006803,  719.5284920635,  720.3427834467,  721.1570748299,
      834.1968537415,  835.1400566893,  836.0832596372,  837.026462585,
      969.5282029478,  970.6218027211,  971.7154024943,  972.8090022676,
      935.0649886621,  936.1134693878,  937.1619501134,  938.210430839,
      981.0786791383,  982.1722789116,  983.2658786848,  984.359478458,
      848.1536791383,  849.0968820862,  850.040085034,   850.9832879819,
      733.7023185941,  734.5166099773,  735.3309013605,  736.1451927438,
      618.7353117914,  619.42069161,    620.1060714286,  620.7914512472,
      517.1543367347,  517.7312131519,  518.3080895692,  518.8849659864,
      615.6111394558,  616.2965192744,  616.981899093,   617.6672789116,
      714.5019557823,  715.2958390023,  716.0897222222,  716.8836054422,
      830.3809240363,  831.3013945578,  832.2218650794,  833.1423356009,
      800.7819954649,  801.6644897959,  802.546984127,   803.429478458,
      840.1028287982,  841.0232993197,  841.9437698413,  842.8642403628,
      726.2492573696,  727.0431405896,  727.8370238095,  728.6309070295,
      628.226468254,   628.9118480726,  629.5972278912,  630.2826077098,
      529.7696655329,  530.3465419501,  530.9234183673,  531.5002947846};
  const std::array<int, 4> in_shape = {{3, 9, 9, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x9x9x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.0204081633,
                                         0.0408163265,
                                         0.0612244898,
                                         0.0816326531,
                                         0.1224489796,
                                         0.1632653061,
                                         0.2040816327,
                                         0.2448979592,
                                         0.306122449,
                                         0.3673469388,
                                         0.4285714286,
                                         0.4897959184,
                                         0.306122449,
                                         0.3673469388,
                                         0.4285714286,
                                         0.4897959184,
                                         0.306122449,
                                         0.3673469388,
                                         0.4285714286,
                                         0.4897959184,
                                         0.306122449,
                                         0.3673469388,
                                         0.4285714286,
                                         0.4897959184,
                                         0.306122449,
                                         0.3673469388,
                                         0.4285714286,
                                         0.4897959184,
                                         0.2857142857,
                                         0.3265306122,
                                         0.3673469388,
                                         0.4081632653,
                                         0.1836734694,
                                         0.2040816327,
                                         0.2244897959,
                                         0.2448979592,
                                         0.2857142857,
                                         0.3265306122,
                                         0.3673469388,
                                         0.4081632653,
                                         0.7346938776,
                                         0.8163265306,
                                         0.8979591837,
                                         0.9795918367,
                                         1.3469387755,
                                         1.4693877551,
                                         1.5918367347,
                                         1.7142857143,
                                         1.3469387755,
                                         1.4693877551,
                                         1.5918367347,
                                         1.7142857143,
                                         1.3469387755,
                                         1.4693877551,
                                         1.5918367347,
                                         1.7142857143,
                                         1.3469387755,
                                         1.4693877551,
                                         1.5918367347,
                                         1.7142857143,
                                         1.3469387755,
                                         1.4693877551,
                                         1.5918367347,
                                         1.7142857143,
                                         1.0612244898,
                                         1.1428571429,
                                         1.2244897959,
                                         1.306122449,
                                         0.612244898,
                                         0.6530612245,
                                         0.693877551,
                                         0.7346938776,
                                         0.7959183673,
                                         0.8571428571,
                                         0.9183673469,
                                         0.9795918367,
                                         1.8367346939,
                                         1.9591836735,
                                         2.0816326531,
                                         2.2040816327,
                                         3.1224489796,
                                         3.306122449,
                                         3.4897959184,
                                         3.6734693878,
                                         3.1224489796,
                                         3.306122449,
                                         3.4897959184,
                                         3.6734693878,
                                         3.1224489796,
                                         3.306122449,
                                         3.4897959184,
                                         3.6734693878,
                                         3.1224489796,
                                         3.306122449,
                                         3.4897959184,
                                         3.6734693878,
                                         3.1224489796,
                                         3.306122449,
                                         3.4897959184,
                                         3.6734693878,
                                         2.3265306122,
                                         2.4489795918,
                                         2.5714285714,
                                         2.693877551,
                                         1.2857142857,
                                         1.3469387755,
                                         1.4081632653,
                                         1.4693877551,
                                         0.7959183673,
                                         0.8571428571,
                                         0.9183673469,
                                         0.9795918367,
                                         1.8367346939,
                                         1.9591836735,
                                         2.0816326531,
                                         2.2040816327,
                                         3.1224489796,
                                         3.306122449,
                                         3.4897959184,
                                         3.6734693878,
                                         3.1224489796,
                                         3.306122449,
                                         3.4897959184,
                                         3.6734693878,
                                         3.1224489796,
                                         3.306122449,
                                         3.4897959184,
                                         3.6734693878,
                                         3.1224489796,
                                         3.306122449,
                                         3.4897959184,
                                         3.6734693878,
                                         3.1224489796,
                                         3.306122449,
                                         3.4897959184,
                                         3.6734693878,
                                         2.3265306122,
                                         2.4489795918,
                                         2.5714285714,
                                         2.693877551,
                                         1.2857142857,
                                         1.3469387755,
                                         1.4081632653,
                                         1.4693877551,
                                         0.7959183673,
                                         0.8571428571,
                                         0.9183673469,
                                         0.9795918367,
                                         1.8367346939,
                                         1.9591836735,
                                         2.0816326531,
                                         2.2040816327,
                                         3.1224489796,
                                         3.306122449,
                                         3.4897959184,
                                         3.6734693878,
                                         3.1224489796,
                                         3.306122449,
                                         3.4897959184,
                                         3.6734693878,
                                         3.1224489796,
                                         3.306122449,
                                         3.4897959184,
                                         3.6734693878,
                                         3.1224489796,
                                         3.306122449,
                                         3.4897959184,
                                         3.6734693878,
                                         3.1224489796,
                                         3.306122449,
                                         3.4897959184,
                                         3.6734693878,
                                         2.3265306122,
                                         2.4489795918,
                                         2.5714285714,
                                         2.693877551,
                                         1.2857142857,
                                         1.3469387755,
                                         1.4081632653,
                                         1.4693877551,
                                         0.7959183673,
                                         0.8571428571,
                                         0.9183673469,
                                         0.9795918367,
                                         1.8367346939,
                                         1.9591836735,
                                         2.0816326531,
                                         2.2040816327,
                                         3.1224489796,
                                         3.306122449,
                                         3.4897959184,
                                         3.6734693878,
                                         3.1224489796,
                                         3.306122449,
                                         3.4897959184,
                                         3.6734693878,
                                         3.1224489796,
                                         3.306122449,
                                         3.4897959184,
                                         3.6734693878,
                                         3.1224489796,
                                         3.306122449,
                                         3.4897959184,
                                         3.6734693878,
                                         3.1224489796,
                                         3.306122449,
                                         3.4897959184,
                                         3.6734693878,
                                         2.3265306122,
                                         2.4489795918,
                                         2.5714285714,
                                         2.693877551,
                                         1.2857142857,
                                         1.3469387755,
                                         1.4081632653,
                                         1.4693877551,
                                         0.7959183673,
                                         0.8571428571,
                                         0.9183673469,
                                         0.9795918367,
                                         1.8367346939,
                                         1.9591836735,
                                         2.0816326531,
                                         2.2040816327,
                                         3.1224489796,
                                         3.306122449,
                                         3.4897959184,
                                         3.6734693878,
                                         3.1224489796,
                                         3.306122449,
                                         3.4897959184,
                                         3.6734693878,
                                         3.1224489796,
                                         3.306122449,
                                         3.4897959184,
                                         3.6734693878,
                                         3.1224489796,
                                         3.306122449,
                                         3.4897959184,
                                         3.6734693878,
                                         3.1224489796,
                                         3.306122449,
                                         3.4897959184,
                                         3.6734693878,
                                         2.3265306122,
                                         2.4489795918,
                                         2.5714285714,
                                         2.693877551,
                                         1.2857142857,
                                         1.3469387755,
                                         1.4081632653,
                                         1.4693877551,
                                         0.7755102041,
                                         0.8163265306,
                                         0.8571428571,
                                         0.8979591837,
                                         1.7142857143,
                                         1.7959183673,
                                         1.8775510204,
                                         1.9591836735,
                                         2.8163265306,
                                         2.9387755102,
                                         3.0612244898,
                                         3.1836734694,
                                         2.8163265306,
                                         2.9387755102,
                                         3.0612244898,
                                         3.1836734694,
                                         2.8163265306,
                                         2.9387755102,
                                         3.0612244898,
                                         3.1836734694,
                                         2.8163265306,
                                         2.9387755102,
                                         3.0612244898,
                                         3.1836734694,
                                         2.8163265306,
                                         2.9387755102,
                                         3.0612244898,
                                         3.1836734694,
                                         2.0408163265,
                                         2.1224489796,
                                         2.2040816327,
                                         2.2857142857,
                                         1.1020408163,
                                         1.1428571429,
                                         1.1836734694,
                                         1.2244897959,
                                         0.5102040816,
                                         0.5306122449,
                                         0.5510204082,
                                         0.5714285714,
                                         1.1020408163,
                                         1.1428571429,
                                         1.1836734694,
                                         1.2244897959,
                                         1.7755102041,
                                         1.8367346939,
                                         1.8979591837,
                                         1.9591836735,
                                         1.7755102041,
                                         1.8367346939,
                                         1.8979591837,
                                         1.9591836735,
                                         1.7755102041,
                                         1.8367346939,
                                         1.8979591837,
                                         1.9591836735,
                                         1.7755102041,
                                         1.8367346939,
                                         1.8979591837,
                                         1.9591836735,
                                         1.7755102041,
                                         1.8367346939,
                                         1.8979591837,
                                         1.9591836735,
                                         1.2653061224,
                                         1.306122449,
                                         1.3469387755,
                                         1.387755102,
                                         0.6734693878,
                                         0.693877551,
                                         0.7142857143,
                                         0.7346938776,
                                         0.7551020408,
                                         0.7755102041,
                                         0.7959183673,
                                         0.8163265306,
                                         1.5918367347,
                                         1.6326530612,
                                         1.6734693878,
                                         1.7142857143,
                                         2.5102040816,
                                         2.5714285714,
                                         2.6326530612,
                                         2.693877551,
                                         2.5102040816,
                                         2.5714285714,
                                         2.6326530612,
                                         2.693877551,
                                         2.5102040816,
                                         2.5714285714,
                                         2.6326530612,
                                         2.693877551,
                                         2.5102040816,
                                         2.5714285714,
                                         2.6326530612,
                                         2.693877551,
                                         2.5102040816,
                                         2.5714285714,
                                         2.6326530612,
                                         2.693877551,
                                         1.7551020408,
                                         1.7959183673,
                                         1.8367346939,
                                         1.8775510204,
                                         0.9183673469,
                                         0.9387755102,
                                         0.9591836735,
                                         0.9795918367,
                                         1.7551020408,
                                         1.7959183673,
                                         1.8367346939,
                                         1.8775510204,
                                         3.6734693878,
                                         3.7551020408,
                                         3.8367346939,
                                         3.9183673469,
                                         5.7551020408,
                                         5.8775510204,
                                         6.,
                                         6.1224489796,
                                         5.7551020408,
                                         5.8775510204,
                                         6.,
                                         6.1224489796,
                                         5.7551020408,
                                         5.8775510204,
                                         6.,
                                         6.1224489796,
                                         5.7551020408,
                                         5.8775510204,
                                         6.,
                                         6.1224489796,
                                         5.7551020408,
                                         5.8775510204,
                                         6.,
                                         6.1224489796,
                                         4.,
                                         4.0816326531,
                                         4.1632653061,
                                         4.2448979592,
                                         2.0816326531,
                                         2.1224489796,
                                         2.1632653061,
                                         2.2040816327,
                                         3.,
                                         3.0612244898,
                                         3.1224489796,
                                         3.1836734694,
                                         6.2448979592,
                                         6.3673469388,
                                         6.4897959184,
                                         6.612244898,
                                         9.7346938776,
                                         9.9183673469,
                                         10.1020408163,
                                         10.2857142857,
                                         9.7346938776,
                                         9.9183673469,
                                         10.1020408163,
                                         10.2857142857,
                                         9.7346938776,
                                         9.9183673469,
                                         10.1020408163,
                                         10.2857142857,
                                         9.7346938776,
                                         9.9183673469,
                                         10.1020408163,
                                         10.2857142857,
                                         9.7346938776,
                                         9.9183673469,
                                         10.1020408163,
                                         10.2857142857,
                                         6.7346938776,
                                         6.8571428571,
                                         6.9795918367,
                                         7.1020408163,
                                         3.4897959184,
                                         3.5510204082,
                                         3.612244898,
                                         3.6734693878,
                                         3.,
                                         3.0612244898,
                                         3.1224489796,
                                         3.1836734694,
                                         6.2448979592,
                                         6.3673469388,
                                         6.4897959184,
                                         6.612244898,
                                         9.7346938776,
                                         9.9183673469,
                                         10.1020408163,
                                         10.2857142857,
                                         9.7346938776,
                                         9.9183673469,
                                         10.1020408163,
                                         10.2857142857,
                                         9.7346938776,
                                         9.9183673469,
                                         10.1020408163,
                                         10.2857142857,
                                         9.7346938776,
                                         9.9183673469,
                                         10.1020408163,
                                         10.2857142857,
                                         9.7346938776,
                                         9.9183673469,
                                         10.1020408163,
                                         10.2857142857,
                                         6.7346938776,
                                         6.8571428571,
                                         6.9795918367,
                                         7.1020408163,
                                         3.4897959184,
                                         3.5510204082,
                                         3.612244898,
                                         3.6734693878,
                                         3.,
                                         3.0612244898,
                                         3.1224489796,
                                         3.1836734694,
                                         6.2448979592,
                                         6.3673469388,
                                         6.4897959184,
                                         6.612244898,
                                         9.7346938776,
                                         9.9183673469,
                                         10.1020408163,
                                         10.2857142857,
                                         9.7346938776,
                                         9.9183673469,
                                         10.1020408163,
                                         10.2857142857,
                                         9.7346938776,
                                         9.9183673469,
                                         10.1020408163,
                                         10.2857142857,
                                         9.7346938776,
                                         9.9183673469,
                                         10.1020408163,
                                         10.2857142857,
                                         9.7346938776,
                                         9.9183673469,
                                         10.1020408163,
                                         10.2857142857,
                                         6.7346938776,
                                         6.8571428571,
                                         6.9795918367,
                                         7.1020408163,
                                         3.4897959184,
                                         3.5510204082,
                                         3.612244898,
                                         3.6734693878,
                                         3.,
                                         3.0612244898,
                                         3.1224489796,
                                         3.1836734694,
                                         6.2448979592,
                                         6.3673469388,
                                         6.4897959184,
                                         6.612244898,
                                         9.7346938776,
                                         9.9183673469,
                                         10.1020408163,
                                         10.2857142857,
                                         9.7346938776,
                                         9.9183673469,
                                         10.1020408163,
                                         10.2857142857,
                                         9.7346938776,
                                         9.9183673469,
                                         10.1020408163,
                                         10.2857142857,
                                         9.7346938776,
                                         9.9183673469,
                                         10.1020408163,
                                         10.2857142857,
                                         9.7346938776,
                                         9.9183673469,
                                         10.1020408163,
                                         10.2857142857,
                                         6.7346938776,
                                         6.8571428571,
                                         6.9795918367,
                                         7.1020408163,
                                         3.4897959184,
                                         3.5510204082,
                                         3.612244898,
                                         3.6734693878,
                                         3.,
                                         3.0612244898,
                                         3.1224489796,
                                         3.1836734694,
                                         6.2448979592,
                                         6.3673469388,
                                         6.4897959184,
                                         6.612244898,
                                         9.7346938776,
                                         9.9183673469,
                                         10.1020408163,
                                         10.2857142857,
                                         9.7346938776,
                                         9.9183673469,
                                         10.1020408163,
                                         10.2857142857,
                                         9.7346938776,
                                         9.9183673469,
                                         10.1020408163,
                                         10.2857142857,
                                         9.7346938776,
                                         9.9183673469,
                                         10.1020408163,
                                         10.2857142857,
                                         9.7346938776,
                                         9.9183673469,
                                         10.1020408163,
                                         10.2857142857,
                                         6.7346938776,
                                         6.8571428571,
                                         6.9795918367,
                                         7.1020408163,
                                         3.4897959184,
                                         3.5510204082,
                                         3.612244898,
                                         3.6734693878,
                                         2.2448979592,
                                         2.2857142857,
                                         2.3265306122,
                                         2.3673469388,
                                         4.6530612245,
                                         4.7346938776,
                                         4.8163265306,
                                         4.8979591837,
                                         7.2244897959,
                                         7.3469387755,
                                         7.4693877551,
                                         7.5918367347,
                                         7.2244897959,
                                         7.3469387755,
                                         7.4693877551,
                                         7.5918367347,
                                         7.2244897959,
                                         7.3469387755,
                                         7.4693877551,
                                         7.5918367347,
                                         7.2244897959,
                                         7.3469387755,
                                         7.4693877551,
                                         7.5918367347,
                                         7.2244897959,
                                         7.3469387755,
                                         7.4693877551,
                                         7.5918367347,
                                         4.9795918367,
                                         5.0612244898,
                                         5.1428571429,
                                         5.2244897959,
                                         2.5714285714,
                                         2.612244898,
                                         2.6530612245,
                                         2.693877551,
                                         1.2448979592,
                                         1.2653061224,
                                         1.2857142857,
                                         1.306122449,
                                         2.5714285714,
                                         2.612244898,
                                         2.6530612245,
                                         2.693877551,
                                         3.9795918367,
                                         4.0408163265,
                                         4.1020408163,
                                         4.1632653061,
                                         3.9795918367,
                                         4.0408163265,
                                         4.1020408163,
                                         4.1632653061,
                                         3.9795918367,
                                         4.0408163265,
                                         4.1020408163,
                                         4.1632653061,
                                         3.9795918367,
                                         4.0408163265,
                                         4.1020408163,
                                         4.1632653061,
                                         3.9795918367,
                                         4.0408163265,
                                         4.1020408163,
                                         4.1632653061,
                                         2.7346938776,
                                         2.7755102041,
                                         2.8163265306,
                                         2.8571428571,
                                         1.4081632653,
                                         1.4285714286,
                                         1.4489795918,
                                         1.4693877551,
                                         1.4897959184,
                                         1.5102040816,
                                         1.5306122449,
                                         1.5510204082,
                                         3.0612244898,
                                         3.1020408163,
                                         3.1428571429,
                                         3.1836734694,
                                         4.7142857143,
                                         4.7755102041,
                                         4.8367346939,
                                         4.8979591837,
                                         4.7142857143,
                                         4.7755102041,
                                         4.8367346939,
                                         4.8979591837,
                                         4.7142857143,
                                         4.7755102041,
                                         4.8367346939,
                                         4.8979591837,
                                         4.7142857143,
                                         4.7755102041,
                                         4.8367346939,
                                         4.8979591837,
                                         4.7142857143,
                                         4.7755102041,
                                         4.8367346939,
                                         4.8979591837,
                                         3.2244897959,
                                         3.2653061224,
                                         3.306122449,
                                         3.3469387755,
                                         1.6530612245,
                                         1.6734693878,
                                         1.693877551,
                                         1.7142857143,
                                         3.2244897959,
                                         3.2653061224,
                                         3.306122449,
                                         3.3469387755,
                                         6.612244898,
                                         6.693877551,
                                         6.7755102041,
                                         6.8571428571,
                                         10.1632653061,
                                         10.2857142857,
                                         10.4081632653,
                                         10.5306122449,
                                         10.1632653061,
                                         10.2857142857,
                                         10.4081632653,
                                         10.5306122449,
                                         10.1632653061,
                                         10.2857142857,
                                         10.4081632653,
                                         10.5306122449,
                                         10.1632653061,
                                         10.2857142857,
                                         10.4081632653,
                                         10.5306122449,
                                         10.1632653061,
                                         10.2857142857,
                                         10.4081632653,
                                         10.5306122449,
                                         6.9387755102,
                                         7.0204081633,
                                         7.1020408163,
                                         7.1836734694,
                                         3.5510204082,
                                         3.5918367347,
                                         3.6326530612,
                                         3.6734693878,
                                         5.2040816327,
                                         5.2653061224,
                                         5.3265306122,
                                         5.387755102,
                                         10.6530612245,
                                         10.7755102041,
                                         10.8979591837,
                                         11.0204081633,
                                         16.3469387755,
                                         16.5306122449,
                                         16.7142857143,
                                         16.8979591837,
                                         16.3469387755,
                                         16.5306122449,
                                         16.7142857143,
                                         16.8979591837,
                                         16.3469387755,
                                         16.5306122449,
                                         16.7142857143,
                                         16.8979591837,
                                         16.3469387755,
                                         16.5306122449,
                                         16.7142857143,
                                         16.8979591837,
                                         16.3469387755,
                                         16.5306122449,
                                         16.7142857143,
                                         16.8979591837,
                                         11.1428571429,
                                         11.2653061224,
                                         11.387755102,
                                         11.5102040816,
                                         5.693877551,
                                         5.7551020408,
                                         5.8163265306,
                                         5.8775510204,
                                         5.2040816327,
                                         5.2653061224,
                                         5.3265306122,
                                         5.387755102,
                                         10.6530612245,
                                         10.7755102041,
                                         10.8979591837,
                                         11.0204081633,
                                         16.3469387755,
                                         16.5306122449,
                                         16.7142857143,
                                         16.8979591837,
                                         16.3469387755,
                                         16.5306122449,
                                         16.7142857143,
                                         16.8979591837,
                                         16.3469387755,
                                         16.5306122449,
                                         16.7142857143,
                                         16.8979591837,
                                         16.3469387755,
                                         16.5306122449,
                                         16.7142857143,
                                         16.8979591837,
                                         16.3469387755,
                                         16.5306122449,
                                         16.7142857143,
                                         16.8979591837,
                                         11.1428571429,
                                         11.2653061224,
                                         11.387755102,
                                         11.5102040816,
                                         5.693877551,
                                         5.7551020408,
                                         5.8163265306,
                                         5.8775510204,
                                         5.2040816327,
                                         5.2653061224,
                                         5.3265306122,
                                         5.387755102,
                                         10.6530612245,
                                         10.7755102041,
                                         10.8979591837,
                                         11.0204081633,
                                         16.3469387755,
                                         16.5306122449,
                                         16.7142857143,
                                         16.8979591837,
                                         16.3469387755,
                                         16.5306122449,
                                         16.7142857143,
                                         16.8979591837,
                                         16.3469387755,
                                         16.5306122449,
                                         16.7142857143,
                                         16.8979591837,
                                         16.3469387755,
                                         16.5306122449,
                                         16.7142857143,
                                         16.8979591837,
                                         16.3469387755,
                                         16.5306122449,
                                         16.7142857143,
                                         16.8979591837,
                                         11.1428571429,
                                         11.2653061224,
                                         11.387755102,
                                         11.5102040816,
                                         5.693877551,
                                         5.7551020408,
                                         5.8163265306,
                                         5.8775510204,
                                         5.2040816327,
                                         5.2653061224,
                                         5.3265306122,
                                         5.387755102,
                                         10.6530612245,
                                         10.7755102041,
                                         10.8979591837,
                                         11.0204081633,
                                         16.3469387755,
                                         16.5306122449,
                                         16.7142857143,
                                         16.8979591837,
                                         16.3469387755,
                                         16.5306122449,
                                         16.7142857143,
                                         16.8979591837,
                                         16.3469387755,
                                         16.5306122449,
                                         16.7142857143,
                                         16.8979591837,
                                         16.3469387755,
                                         16.5306122449,
                                         16.7142857143,
                                         16.8979591837,
                                         16.3469387755,
                                         16.5306122449,
                                         16.7142857143,
                                         16.8979591837,
                                         11.1428571429,
                                         11.2653061224,
                                         11.387755102,
                                         11.5102040816,
                                         5.693877551,
                                         5.7551020408,
                                         5.8163265306,
                                         5.8775510204,
                                         5.2040816327,
                                         5.2653061224,
                                         5.3265306122,
                                         5.387755102,
                                         10.6530612245,
                                         10.7755102041,
                                         10.8979591837,
                                         11.0204081633,
                                         16.3469387755,
                                         16.5306122449,
                                         16.7142857143,
                                         16.8979591837,
                                         16.3469387755,
                                         16.5306122449,
                                         16.7142857143,
                                         16.8979591837,
                                         16.3469387755,
                                         16.5306122449,
                                         16.7142857143,
                                         16.8979591837,
                                         16.3469387755,
                                         16.5306122449,
                                         16.7142857143,
                                         16.8979591837,
                                         16.3469387755,
                                         16.5306122449,
                                         16.7142857143,
                                         16.8979591837,
                                         11.1428571429,
                                         11.2653061224,
                                         11.387755102,
                                         11.5102040816,
                                         5.693877551,
                                         5.7551020408,
                                         5.8163265306,
                                         5.8775510204,
                                         3.7142857143,
                                         3.7551020408,
                                         3.7959183673,
                                         3.8367346939,
                                         7.5918367347,
                                         7.6734693878,
                                         7.7551020408,
                                         7.8367346939,
                                         11.6326530612,
                                         11.7551020408,
                                         11.8775510204,
                                         12.,
                                         11.6326530612,
                                         11.7551020408,
                                         11.8775510204,
                                         12.,
                                         11.6326530612,
                                         11.7551020408,
                                         11.8775510204,
                                         12.,
                                         11.6326530612,
                                         11.7551020408,
                                         11.8775510204,
                                         12.,
                                         11.6326530612,
                                         11.7551020408,
                                         11.8775510204,
                                         12.,
                                         7.9183673469,
                                         8.,
                                         8.0816326531,
                                         8.1632653061,
                                         4.0408163265,
                                         4.0816326531,
                                         4.1224489796,
                                         4.1632653061,
                                         1.9795918367,
                                         2.,
                                         2.0204081633,
                                         2.0408163265,
                                         4.0408163265,
                                         4.0816326531,
                                         4.1224489796,
                                         4.1632653061,
                                         6.1836734694,
                                         6.2448979592,
                                         6.306122449,
                                         6.3673469388,
                                         6.1836734694,
                                         6.2448979592,
                                         6.306122449,
                                         6.3673469388,
                                         6.1836734694,
                                         6.2448979592,
                                         6.306122449,
                                         6.3673469388,
                                         6.1836734694,
                                         6.2448979592,
                                         6.306122449,
                                         6.3673469388,
                                         6.1836734694,
                                         6.2448979592,
                                         6.306122449,
                                         6.3673469388,
                                         4.2040816327,
                                         4.2448979592,
                                         4.2857142857,
                                         4.3265306122,
                                         2.1428571429,
                                         2.1632653061,
                                         2.1836734694,
                                         2.2040816327};
  const std::array<int, 4> in_shape = {{3, 9, 9, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x9x10x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      8.613361678,    10.5300283447,  12.5551984127,  14.6888718821,
      14.7101020408,  15.7734353741,  18.0940702948,  16.2859070295,
      14.3692403628,  12.3440702948,  13.1994160998,  16.0344501134,
      18.9983956916,  22.0912528345,  21.7910544218,  23.0543877551,
      26.1369274376,  23.4308049887,  20.5957709751,  17.6318253968,
      18.8705045351,  22.8279875283,  26.9347902494,  31.1909126984,
      30.4502380952,  31.9135714286,  35.8770634921,  32.0689002268,
      28.1114172336,  24.0046145125,  26.7526473923,  32.2577494331,
      37.9359807256,  43.7873412698,  42.3938888889,  44.0905555556,
      49.2207142857,  43.8887414966,  38.3836394558,  32.7054081633,
      37.2999092971,  44.7692970522,  52.4046712018,  60.206031746,
      57.5917460317,  59.2184126984,  65.4152380952,  58.1118367347,
      50.6424489796,  43.0070748299,  51.0574092971,  61.1339399093,
      71.3835997732,  81.8063888889,  77.7462698413,  79.4429365079,
      87.2397619048,  77.3363605442,  67.259829932,   57.010170068,
      48.2387585034,  57.7200510204,  67.3506632653,  77.1305952381,
      73.1676984127,  74.631031746,   81.8167460317,  72.4847732426,
      63.0034807256,  53.3728684807,  44.7377380952,  53.504744898,
      62.4006632653,  71.4254931973,  67.6649773243,  68.9283106576,
      75.4711678005,  66.8330725624,  58.0660657596,  49.1701473923,
      40.1516836735,  48.0003231293,  55.9574659864,  64.0231122449,
      60.5840249433,  61.6473582766,  67.4283106576,  59.6881746032,
      51.8395351474,  43.8823922902,  60.532239229,   72.2142120181,
      84.0046882086,  95.9036678005,  90.2284693878,  91.2918027211,
      99.3088662132,  87.7353968254,  76.0534240363,  64.2629478458,
      74.8835997732,  89.3206746032,  103.8866609977, 118.5815589569,
      111.5135034014, 112.7768367347, 122.6272335601, 108.3190702948,
      93.8819954649,  79.3160090703,  90.3199943311,  107.7162528345,
      125.2618310658, 142.9567290249, 134.3767687075, 135.8401020408,
      147.6428798186, 130.3959410431, 112.9996825397, 95.4541043084,
      109.5949943311, 130.6817290249, 151.9415929705, 173.3745861678,
      162.8918480726, 164.5885147392, 178.8079591837, 157.8943537415,
      136.8076190476, 115.547755102,  116.724399093,  139.1325623583,
      161.7067120181, 184.4468480726, 173.118276644,  174.7449433107,
      189.6560544218, 167.413877551,  145.0057142857, 122.4315646259,
      133.8997562358, 159.5579195011, 185.3892120181, 211.3936337868,
      198.2442290249, 199.9408956916, 216.8270068027, 191.3419727891,
      165.6838095238, 139.8525170068, 119.6882482993, 142.6083163265,
      165.6777040816, 188.8964115646, 177.0942290249, 178.5575623583,
      193.5825623583, 170.811814059,  147.8917460317, 124.8223582766,
      106.4219217687, 126.7909693878, 147.2889285714, 167.9157993197,
      157.3874263039, 158.6507596372, 171.9614739229, 151.7213378685,
      131.3522902494, 110.8543310658, 92.0705612245,  109.6845068027,
      127.4069557823, 145.2379081633, 136.1023922902, 137.1657256236,
      148.643106576,  131.1376643991, 113.5237188209, 95.8012698413,
      112.45111678,   133.8983956916, 155.4541780045, 177.1184637188,
      165.7468367347, 166.810170068,  180.5236621315, 159.1848866213,
      137.7376077098, 116.1818253968, 136.5677834467, 162.606899093,
      188.7749263039, 215.0718650794, 201.235952381,  202.4992857143,
      219.1175396825, 193.2073356009, 167.1682199546, 141.0001927438,
      161.769484127,  192.6045181406, 223.5888718821, 254.7225453515,
      238.3032993197, 239.7666326531, 259.4086961451, 228.7229818594,
      197.8879478458, 166.9035941043, 192.4373412698, 229.1057086168,
      265.9472052154, 302.9618310658, 283.3898072562, 285.0864739229,
      308.3952040816, 271.8999659864, 235.2315986395, 198.3901020408,
      196.1488888889, 233.4958276644, 271.0087528345, 308.6876643991,
      288.6448072562, 290.2714739229, 313.8968707483, 276.7159183673,
      239.3689795918, 201.8560544218, 216.7421031746, 257.981899093,
      299.394824263,  340.9808786848, 318.7421882086, 320.4388548753,
      346.4142517007, 305.347585034,  264.1077891156, 222.6948639456,
      191.1377380952, 227.4965816327, 264.004744898,  300.6622278912,
      281.0207596372, 282.4840929705, 305.3483786848, 269.1388548753,
      232.7800113379, 196.2718480726, 168.1061054422, 200.0771938776,
      232.1771938776, 264.4061054422, 247.1098752834, 248.3732086168,
      268.4517800454, 236.6096031746, 204.6385147392, 172.5385147392,
      143.9894387755, 171.3686904762, 198.8564455782, 226.4527040816,
      211.6207596372, 212.6840929705, 229.8579024943, 202.587154195,
      175.2079024943, 147.7201473923};
  const std::array<int, 4> in_shape = {{3, 9, 10, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x9x10x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.0204081633, 0.0612244898, 0.1224489796, 0.2040816327, 0.2040816327,
      0.2040816327, 0.2040816327, 0.1836734694, 0.1428571429, 0.0816326531,
      0.1224489796, 0.2857142857, 0.4897959184, 0.7346938776, 0.7346938776,
      0.7346938776, 0.7346938776, 0.612244898,  0.4489795918, 0.2448979592,
      0.306122449,  0.6734693878, 1.1020408163, 1.5918367347, 1.5918367347,
      1.5918367347, 1.5918367347, 1.2857142857, 0.9183673469, 0.4897959184,
      0.306122449,  0.6734693878, 1.1020408163, 1.5918367347, 1.5918367347,
      1.5918367347, 1.5918367347, 1.2857142857, 0.9183673469, 0.4897959184,
      0.306122449,  0.6734693878, 1.1020408163, 1.5918367347, 1.5918367347,
      1.5918367347, 1.5918367347, 1.2857142857, 0.9183673469, 0.4897959184,
      0.306122449,  0.6734693878, 1.1020408163, 1.5918367347, 1.5918367347,
      1.5918367347, 1.5918367347, 1.2857142857, 0.9183673469, 0.4897959184,
      0.306122449,  0.6734693878, 1.1020408163, 1.5918367347, 1.5918367347,
      1.5918367347, 1.5918367347, 1.2857142857, 0.9183673469, 0.4897959184,
      0.2857142857, 0.612244898,  0.9795918367, 1.387755102,  1.387755102,
      1.387755102,  1.387755102,  1.1020408163, 0.7755102041, 0.4081632653,
      0.1836734694, 0.387755102,  0.612244898,  0.8571428571, 0.8571428571,
      0.8571428571, 0.8571428571, 0.6734693878, 0.4693877551, 0.2448979592,
      0.2653061224, 0.5510204082, 0.8571428571, 1.1836734694, 1.1836734694,
      1.1836734694, 1.1836734694, 0.9183673469, 0.6326530612, 0.3265306122,
      0.612244898,  1.2653061224, 1.9591836735, 2.693877551,  2.693877551,
      2.693877551,  2.693877551,  2.0816326531, 1.4285714286, 0.7346938776,
      1.0408163265, 2.1428571429, 3.306122449,  4.5306122449, 4.5306122449,
      4.5306122449, 4.5306122449, 3.4897959184, 2.387755102,  1.2244897959,
      1.0408163265, 2.1428571429, 3.306122449,  4.5306122449, 4.5306122449,
      4.5306122449, 4.5306122449, 3.4897959184, 2.387755102,  1.2244897959,
      1.0408163265, 2.1428571429, 3.306122449,  4.5306122449, 4.5306122449,
      4.5306122449, 4.5306122449, 3.4897959184, 2.387755102,  1.2244897959,
      1.0408163265, 2.1428571429, 3.306122449,  4.5306122449, 4.5306122449,
      4.5306122449, 4.5306122449, 3.4897959184, 2.387755102,  1.2244897959,
      1.0408163265, 2.1428571429, 3.306122449,  4.5306122449, 4.5306122449,
      4.5306122449, 4.5306122449, 3.4897959184, 2.387755102,  1.2244897959,
      0.7755102041, 1.5918367347, 2.4489795918, 3.3469387755, 3.3469387755,
      3.3469387755, 3.3469387755, 2.5714285714, 1.7551020408, 0.8979591837,
      0.4285714286, 0.8775510204, 1.3469387755, 1.8367346939, 1.8367346939,
      1.8367346939, 1.8367346939, 1.4081632653, 0.9591836735, 0.4897959184,
      0.5102040816, 1.0408163265, 1.5918367347, 2.1632653061, 2.1632653061,
      2.1632653061, 2.1632653061, 1.6530612245, 1.1224489796, 0.5714285714,
      1.1020408163, 2.2448979592, 3.4285714286, 4.6530612245, 4.6530612245,
      4.6530612245, 4.6530612245, 3.5510204082, 2.4081632653, 1.2244897959,
      1.7755102041, 3.612244898,  5.5102040816, 7.4693877551, 7.4693877551,
      7.4693877551, 7.4693877551, 5.693877551,  3.8571428571, 1.9591836735,
      1.7755102041, 3.612244898,  5.5102040816, 7.4693877551, 7.4693877551,
      7.4693877551, 7.4693877551, 5.693877551,  3.8571428571, 1.9591836735,
      1.7755102041, 3.612244898,  5.5102040816, 7.4693877551, 7.4693877551,
      7.4693877551, 7.4693877551, 5.693877551,  3.8571428571, 1.9591836735,
      1.7755102041, 3.612244898,  5.5102040816, 7.4693877551, 7.4693877551,
      7.4693877551, 7.4693877551, 5.693877551,  3.8571428571, 1.9591836735,
      1.7755102041, 3.612244898,  5.5102040816, 7.4693877551, 7.4693877551,
      7.4693877551, 7.4693877551, 5.693877551,  3.8571428571, 1.9591836735,
      1.2653061224, 2.5714285714, 3.9183673469, 5.306122449,  5.306122449,
      5.306122449,  5.306122449,  4.0408163265, 2.7346938776, 1.387755102,
      0.6734693878, 1.3673469388, 2.0816326531, 2.8163265306, 2.8163265306,
      2.8163265306, 2.8163265306, 2.1428571429, 1.4489795918, 0.7346938776};
  const std::array<int, 4> in_shape = {{3, 9, 10, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x9x10x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      16.6498469388,  17.226723356,   20.3746768707,  21.0600566893,
      24.3165136054,  25.1103968254,  28.4753571429,  29.3777437642,
      28.5811111111,  29.4202040816,  30.7077777778,  31.5468707483,
      35.2857539683,  36.1881405896,  31.777930839,   32.571814059,
      28.053100907,   28.7384807256,  24.1112641723,  24.6881405896,
      25.713452381,   26.3988321995,  31.2546088435,  32.0689002268,
      37.0535884354,  37.9967913832,  43.1103911565,  44.1825056689,
      42.5851927438,  43.5821088435,  45.1118594104,  46.1087755102,
      51.2017403628,  52.2738548753,  45.9184070295,  46.8616099773,
      40.3772505669,  41.1915419501,  34.5782709751,  35.2636507937,
      36.9471258503,  37.7410090703,  44.7127721088,  45.6559750567,
      52.7770578231,  53.8695804989,  61.1399829932,  62.3818253968,
      59.7457369615,  60.9004761905,  62.6724036281,  63.8271428571,
      70.5122845805,  71.7541269841,  63.0452777778,  64.1378004535,
      55.2796315193,  56.2228344671,  47.215345805,   48.0092290249,
      52.584824263,   53.5052947846,  63.421899093,   64.5154988662,
      74.6052324263,  75.8719614512,  86.134824263,   87.5746825397,
      83.4489115646,  84.7877777778,  86.842244898,   88.1811111111,
      97.0015702948,  98.4414285714,  86.5107539683,  87.7774829932,
      75.6736791383,  76.7672789116,  64.490345805,   65.4108163265,
      73.717324263,   74.5998185941,  88.4901133787,  89.5385941043,
      103.5948752834, 104.8093424036, 119.0316099773, 120.4120634921,
      113.8998639456, 115.1834920635, 117.1531972789, 118.4368253968,
      129.4500226757, 130.8304761905, 115.0092063492, 116.2236734694,
      100.2364172336, 101.2848979592, 85.1316553288,  86.0141496599,
      101.1943480726, 102.1148185941, 121.1742800454, 122.2678798186,
      141.5004705215, 142.7671995465, 162.1729195011, 163.6127777778,
      154.1536734694, 155.4925396825, 157.5470068027, 158.8858730159,
      173.0396655329, 174.4795238095, 153.4059920635, 154.6727210884,
      133.4260600907, 134.5196598639, 113.0998696145, 114.0203401361,
      95.6836337868,  96.4775170068,  114.496899093,  115.4401020408,
      133.6088038549, 134.7013265306, 153.0193480726, 154.2611904762,
      145.1806575964, 146.3353968254, 148.107324263,  149.2620634921,
      162.3916496599, 163.6334920635, 143.8770238095, 144.9695464853,
      125.0637585034, 126.0069614512, 105.9518537415, 106.7457369615,
      88.7900963719,  89.4754761905,  106.1951984127, 107.0094897959,
      123.8581235828, 124.8013265306, 141.7788718821, 142.8509863946,
      134.3330385488, 135.3299546485, 136.8597052154, 137.8566213152,
      149.8702210884, 150.9423356009, 132.7229421769, 133.6661451247,
      115.3178401361, 116.1321315193, 97.654914966,   98.3402947846,
      79.7264909297,  80.3033673469,  95.3152664399,  96.0006462585,
      111.1210487528, 111.9149319728, 127.1438378685, 128.0462244898,
      120.3289569161, 121.1680498866, 122.4556235828, 123.2947165533,
      133.9542346939, 134.8566213152, 118.5824659864, 119.3763492063,
      102.9936904762, 103.6790702948, 87.1879081633,  87.7647845805,
      120.4876020408, 121.064478458,  143.7430442177, 144.4284240363,
      167.2154931973, 168.0093764172, 190.9049489796, 191.8073356009,
      179.617845805,  180.4569387755, 181.7445124717, 182.5836054422,
      197.715345805,  198.6177324263, 174.6769104308, 175.4707936508,
      151.421468254,  152.1068480726, 127.9490192744, 128.5258956916,
      149.0818197279, 149.7671995465, 177.8270578231, 178.6413492063,
      206.8301190476, 207.7733219955, 236.0910034014, 237.1631179138,
      222.0300907029, 223.0270068027, 224.5567573696, 225.5536734694,
      244.1823526077, 245.2544671202, 215.6949376417, 216.6381405896,
      186.9496995465, 187.7639909297, 157.946638322,  158.6320181406,
      179.8461054422, 180.6399886621, 214.4893027211, 215.4325056689,
      249.4311394558, 250.5236621315, 284.6716156463, 285.9134580499,
      267.5987981859, 268.753537415,  270.5254648526, 271.6802040816,
      294.0439172336, 295.2857596372, 259.6993594104, 260.7918820862,
      225.0561621315, 225.9993650794, 190.1143253968, 190.9082086168,
      218.2695181406, 219.1899886621, 260.2698582766, 261.3634580499,
      302.6164569161, 303.883185941,  345.309314059,  346.7491723356,
      324.444829932,  325.7836961451, 327.8381632653, 329.1770294785,
      356.1760600907, 357.6159183673, 314.521978458,  315.788707483,
      272.521638322,  273.6152380952, 230.1750396825, 231.0955102041,
      232.5663038549, 233.4487981859, 277.2166439909, 278.2651247166,
      322.1989569161, 323.4134240363, 367.5132426304, 368.8936961451,
      344.9529251701, 346.236553288,  348.2062585034, 349.4898866213,
      377.9316553288, 379.3121088435, 333.6132879819, 334.827755102,
      288.9629478458, 290.0114285714, 243.9806349206, 244.8631292517,
      266.8790419501, 267.7995124717, 318.022239229,  319.1158390023,
      369.5116950113, 370.7784240363, 421.3474092971, 422.7872675737,
      395.1495918367, 396.4884580499, 398.5429251701, 399.8817913832,
      432.2141553288, 433.6540136054, 381.4172165533, 382.6839455782,
      330.2740192744, 331.3676190476, 278.7845634921, 279.7050340136,
      238.5826133787, 239.3764965986, 284.2734297052, 285.2166326531,
      330.2628854875, 331.3554081633, 376.5509807256, 377.7928231293,
      353.0337188209, 354.1884580499, 355.9603854875, 357.1151247166,
      385.9232823129, 387.1651247166, 340.5311054422, 341.6236281179,
      294.8402891156, 295.7834920635, 248.8508333333, 249.6447165533,
      212.1584637188, 212.8438435374, 252.7676473923, 253.5819387755,
      293.634654195,  294.5778571429, 334.759484127,  335.8315986395,
      313.7779365079, 314.7748526077, 316.3046031746, 317.3015192744,
      342.8508333333, 343.9229478458, 302.4994727891, 303.442675737,
      261.8902891156, 262.7045804989, 221.0232823129, 221.7086621315,
      183.5642460317, 184.141122449,  218.6836337868, 219.3690136054,
      254.0200283447, 254.8139115646, 289.5734297052, 290.4758163265,
      271.36569161,   272.2047845805, 273.4923582766, 274.3314512472,
      296.3838265306, 297.2862131519, 261.4814455782, 262.2753287982,
      226.3620578231, 227.0474376417, 191.0256632653, 191.6025396825,
      224.3253571429, 224.9022335601, 267.1114115646, 267.7967913832,
      310.1144727891, 310.9083560091, 353.3345408163, 354.2369274376,
      330.6545804989, 331.4936734694, 332.7812471655, 333.6203401361,
      360.1449376417, 361.047324263,  317.5758900227, 318.3697732426,
      274.7898356009, 275.4752154195, 231.7867743764, 232.3636507937,
      272.4501870748, 273.1355668934, 324.3995068027, 325.2137981859,
      376.6066496599, 377.5498526077, 429.0716156463, 430.1437301587,
      401.4749886621, 402.4719047619, 404.0016553288, 404.9985714286,
      437.1629648526, 438.2350793651, 385.471468254,  386.4146712018,
      333.5221485261, 334.3364399093, 281.3150056689, 282.0003854875,
      322.745085034,  323.538968254,  384.2658333333, 385.2090362812,
      446.0852210884, 447.1777437642, 508.2032482993, 509.4450907029,
      475.4518594104, 476.6065986395, 478.3785260771, 479.5332653061,
      517.5755498866, 518.8173922902, 456.3534410431, 457.4459637188,
      394.8326927438, 395.7758956916, 333.0133049887, 333.8071882086,
      383.9542120181, 384.8746825397, 457.1178174603, 458.2114172336,
      530.6276814059, 531.8944104308, 604.4838038549, 605.9236621315,
      565.4407482993, 566.7796145125, 568.8340816327, 570.1729478458,
      615.3505498866, 616.7904081633, 542.5332029478, 543.7999319728,
      469.3695975057, 470.4631972789, 395.8597335601, 396.7802040816,
      391.4152834467, 392.2977777778, 465.9431746032, 466.9916553288,
      540.8030385488, 542.0175056689, 615.9948752834, 617.3753287982,
      576.0059863946, 577.2896145125, 579.2593197279, 580.5429478458,
      626.4132879819, 627.7937414966, 552.2173696145, 553.4318367347,
      477.689478458,  478.7379591837, 402.8296145125, 403.7121088435,
      432.5637358277, 433.4842063492, 514.8701984127, 515.9637981859,
      597.5229195011, 598.7896485261, 680.521899093,  681.9617573696,
      636.1455102041, 637.4843764172, 639.5388435374, 640.8777097506,
      691.3886451247, 692.8285034014, 609.4284410431, 610.695170068,
      527.121978458,  528.2155782313, 444.4692573696, 445.3897278912,
      381.4815929705, 382.2754761905, 454.0499603175, 454.9931632653,
      526.9169671202, 528.0094897959, 600.0826133787, 601.3244557823,
      560.8867800454, 562.0415192744, 563.813446712,  564.968185941,
      609.454914966,  610.6967573696, 537.1851870748, 538.2777097506,
      464.6168197279, 465.5600226757, 391.7498129252, 392.5436961451,
      335.5268310658, 336.2122108844, 399.3400963719, 400.1543877551,
      463.4111848073, 464.3543877551, 527.7400963719, 528.8122108844,
      493.2228344671, 494.2197505669, 495.7495011338, 496.7464172336,
      535.8314455782, 536.9035600907, 472.2760034014, 473.2192063492,
      408.4627380952, 409.2770294785, 344.3916496599, 345.0770294785,
      287.4020011338, 287.978877551,  342.0520011338, 342.7373809524,
      396.9190079365, 397.7128911565, 452.003021542,  452.9054081633,
      422.4024263039, 423.2415192744, 424.5290929705, 425.368185941,
      458.8134183673, 459.7158049887, 404.3804251701, 405.17430839,
      349.7304251701, 350.4158049887, 294.8634183673, 295.4402947846};
  const std::array<int, 4> in_shape = {{3, 9, 10, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x9x10x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.0204081633,
                                         0.0408163265,
                                         0.0816326531,
                                         0.1224489796,
                                         0.1836734694,
                                         0.2448979592,
                                         0.3265306122,
                                         0.4081632653,
                                         0.3265306122,
                                         0.4081632653,
                                         0.3265306122,
                                         0.4081632653,
                                         0.3265306122,
                                         0.4081632653,
                                         0.306122449,
                                         0.3673469388,
                                         0.2448979592,
                                         0.2857142857,
                                         0.1428571429,
                                         0.1632653061,
                                         0.2040816327,
                                         0.2448979592,
                                         0.4897959184,
                                         0.5714285714,
                                         0.8571428571,
                                         0.9795918367,
                                         1.306122449,
                                         1.4693877551,
                                         1.306122449,
                                         1.4693877551,
                                         1.306122449,
                                         1.4693877551,
                                         1.306122449,
                                         1.4693877551,
                                         1.1020408163,
                                         1.2244897959,
                                         0.8163265306,
                                         0.8979591837,
                                         0.4489795918,
                                         0.4897959184,
                                         0.5510204082,
                                         0.612244898,
                                         1.2244897959,
                                         1.3469387755,
                                         2.0204081633,
                                         2.2040816327,
                                         2.9387755102,
                                         3.1836734694,
                                         2.9387755102,
                                         3.1836734694,
                                         2.9387755102,
                                         3.1836734694,
                                         2.9387755102,
                                         3.1836734694,
                                         2.387755102,
                                         2.5714285714,
                                         1.7142857143,
                                         1.8367346939,
                                         0.9183673469,
                                         0.9795918367,
                                         0.5510204082,
                                         0.612244898,
                                         1.2244897959,
                                         1.3469387755,
                                         2.0204081633,
                                         2.2040816327,
                                         2.9387755102,
                                         3.1836734694,
                                         2.9387755102,
                                         3.1836734694,
                                         2.9387755102,
                                         3.1836734694,
                                         2.9387755102,
                                         3.1836734694,
                                         2.387755102,
                                         2.5714285714,
                                         1.7142857143,
                                         1.8367346939,
                                         0.9183673469,
                                         0.9795918367,
                                         0.5510204082,
                                         0.612244898,
                                         1.2244897959,
                                         1.3469387755,
                                         2.0204081633,
                                         2.2040816327,
                                         2.9387755102,
                                         3.1836734694,
                                         2.9387755102,
                                         3.1836734694,
                                         2.9387755102,
                                         3.1836734694,
                                         2.9387755102,
                                         3.1836734694,
                                         2.387755102,
                                         2.5714285714,
                                         1.7142857143,
                                         1.8367346939,
                                         0.9183673469,
                                         0.9795918367,
                                         0.5510204082,
                                         0.612244898,
                                         1.2244897959,
                                         1.3469387755,
                                         2.0204081633,
                                         2.2040816327,
                                         2.9387755102,
                                         3.1836734694,
                                         2.9387755102,
                                         3.1836734694,
                                         2.9387755102,
                                         3.1836734694,
                                         2.9387755102,
                                         3.1836734694,
                                         2.387755102,
                                         2.5714285714,
                                         1.7142857143,
                                         1.8367346939,
                                         0.9183673469,
                                         0.9795918367,
                                         0.5510204082,
                                         0.612244898,
                                         1.2244897959,
                                         1.3469387755,
                                         2.0204081633,
                                         2.2040816327,
                                         2.9387755102,
                                         3.1836734694,
                                         2.9387755102,
                                         3.1836734694,
                                         2.9387755102,
                                         3.1836734694,
                                         2.9387755102,
                                         3.1836734694,
                                         2.387755102,
                                         2.5714285714,
                                         1.7142857143,
                                         1.8367346939,
                                         0.9183673469,
                                         0.9795918367,
                                         0.5306122449,
                                         0.5714285714,
                                         1.1428571429,
                                         1.2244897959,
                                         1.8367346939,
                                         1.9591836735,
                                         2.612244898,
                                         2.7755102041,
                                         2.612244898,
                                         2.7755102041,
                                         2.612244898,
                                         2.7755102041,
                                         2.612244898,
                                         2.7755102041,
                                         2.0816326531,
                                         2.2040816327,
                                         1.4693877551,
                                         1.5510204082,
                                         0.7755102041,
                                         0.8163265306,
                                         0.3469387755,
                                         0.3673469388,
                                         0.7346938776,
                                         0.7755102041,
                                         1.1632653061,
                                         1.2244897959,
                                         1.6326530612,
                                         1.7142857143,
                                         1.6326530612,
                                         1.7142857143,
                                         1.6326530612,
                                         1.7142857143,
                                         1.6326530612,
                                         1.7142857143,
                                         1.2857142857,
                                         1.3469387755,
                                         0.8979591837,
                                         0.9387755102,
                                         0.4693877551,
                                         0.4897959184,
                                         0.5102040816,
                                         0.5306122449,
                                         1.0612244898,
                                         1.1020408163,
                                         1.6530612245,
                                         1.7142857143,
                                         2.2857142857,
                                         2.3673469388,
                                         2.2857142857,
                                         2.3673469388,
                                         2.2857142857,
                                         2.3673469388,
                                         2.2857142857,
                                         2.3673469388,
                                         1.7755102041,
                                         1.8367346939,
                                         1.2244897959,
                                         1.2653061224,
                                         0.6326530612,
                                         0.6530612245,
                                         1.1836734694,
                                         1.2244897959,
                                         2.4489795918,
                                         2.5306122449,
                                         3.7959183673,
                                         3.9183673469,
                                         5.2244897959,
                                         5.387755102,
                                         5.2244897959,
                                         5.387755102,
                                         5.2244897959,
                                         5.387755102,
                                         5.2244897959,
                                         5.387755102,
                                         4.0408163265,
                                         4.1632653061,
                                         2.7755102041,
                                         2.8571428571,
                                         1.4285714286,
                                         1.4693877551,
                                         2.0204081633,
                                         2.0816326531,
                                         4.1632653061,
                                         4.2857142857,
                                         6.4285714286,
                                         6.612244898,
                                         8.8163265306,
                                         9.0612244898,
                                         8.8163265306,
                                         9.0612244898,
                                         8.8163265306,
                                         9.0612244898,
                                         8.8163265306,
                                         9.0612244898,
                                         6.7959183673,
                                         6.9795918367,
                                         4.6530612245,
                                         4.7755102041,
                                         2.387755102,
                                         2.4489795918,
                                         2.0204081633,
                                         2.0816326531,
                                         4.1632653061,
                                         4.2857142857,
                                         6.4285714286,
                                         6.612244898,
                                         8.8163265306,
                                         9.0612244898,
                                         8.8163265306,
                                         9.0612244898,
                                         8.8163265306,
                                         9.0612244898,
                                         8.8163265306,
                                         9.0612244898,
                                         6.7959183673,
                                         6.9795918367,
                                         4.6530612245,
                                         4.7755102041,
                                         2.387755102,
                                         2.4489795918,
                                         2.0204081633,
                                         2.0816326531,
                                         4.1632653061,
                                         4.2857142857,
                                         6.4285714286,
                                         6.612244898,
                                         8.8163265306,
                                         9.0612244898,
                                         8.8163265306,
                                         9.0612244898,
                                         8.8163265306,
                                         9.0612244898,
                                         8.8163265306,
                                         9.0612244898,
                                         6.7959183673,
                                         6.9795918367,
                                         4.6530612245,
                                         4.7755102041,
                                         2.387755102,
                                         2.4489795918,
                                         2.0204081633,
                                         2.0816326531,
                                         4.1632653061,
                                         4.2857142857,
                                         6.4285714286,
                                         6.612244898,
                                         8.8163265306,
                                         9.0612244898,
                                         8.8163265306,
                                         9.0612244898,
                                         8.8163265306,
                                         9.0612244898,
                                         8.8163265306,
                                         9.0612244898,
                                         6.7959183673,
                                         6.9795918367,
                                         4.6530612245,
                                         4.7755102041,
                                         2.387755102,
                                         2.4489795918,
                                         2.0204081633,
                                         2.0816326531,
                                         4.1632653061,
                                         4.2857142857,
                                         6.4285714286,
                                         6.612244898,
                                         8.8163265306,
                                         9.0612244898,
                                         8.8163265306,
                                         9.0612244898,
                                         8.8163265306,
                                         9.0612244898,
                                         8.8163265306,
                                         9.0612244898,
                                         6.7959183673,
                                         6.9795918367,
                                         4.6530612245,
                                         4.7755102041,
                                         2.387755102,
                                         2.4489795918,
                                         1.5102040816,
                                         1.5510204082,
                                         3.1020408163,
                                         3.1836734694,
                                         4.7755102041,
                                         4.8979591837,
                                         6.5306122449,
                                         6.693877551,
                                         6.5306122449,
                                         6.693877551,
                                         6.5306122449,
                                         6.693877551,
                                         6.5306122449,
                                         6.693877551,
                                         5.0204081633,
                                         5.1428571429,
                                         3.4285714286,
                                         3.5102040816,
                                         1.7551020408,
                                         1.7959183673,
                                         0.8367346939,
                                         0.8571428571,
                                         1.7142857143,
                                         1.7551020408,
                                         2.6326530612,
                                         2.693877551,
                                         3.5918367347,
                                         3.6734693878,
                                         3.5918367347,
                                         3.6734693878,
                                         3.5918367347,
                                         3.6734693878,
                                         3.5918367347,
                                         3.6734693878,
                                         2.7551020408,
                                         2.8163265306,
                                         1.8775510204,
                                         1.9183673469,
                                         0.9591836735,
                                         0.9795918367,
                                         1.,
                                         1.0204081633,
                                         2.0408163265,
                                         2.0816326531,
                                         3.1224489796,
                                         3.1836734694,
                                         4.2448979592,
                                         4.3265306122,
                                         4.2448979592,
                                         4.3265306122,
                                         4.2448979592,
                                         4.3265306122,
                                         4.2448979592,
                                         4.3265306122,
                                         3.2448979592,
                                         3.306122449,
                                         2.2040816327,
                                         2.2448979592,
                                         1.1224489796,
                                         1.1428571429,
                                         2.1632653061,
                                         2.2040816327,
                                         4.4081632653,
                                         4.4897959184,
                                         6.7346938776,
                                         6.8571428571,
                                         9.1428571429,
                                         9.306122449,
                                         9.1428571429,
                                         9.306122449,
                                         9.1428571429,
                                         9.306122449,
                                         9.1428571429,
                                         9.306122449,
                                         6.9795918367,
                                         7.1020408163,
                                         4.7346938776,
                                         4.8163265306,
                                         2.4081632653,
                                         2.4489795918,
                                         3.4897959184,
                                         3.5510204082,
                                         7.1020408163,
                                         7.2244897959,
                                         10.8367346939,
                                         11.0204081633,
                                         14.693877551,
                                         14.9387755102,
                                         14.693877551,
                                         14.9387755102,
                                         14.693877551,
                                         14.9387755102,
                                         14.693877551,
                                         14.9387755102,
                                         11.2040816327,
                                         11.387755102,
                                         7.5918367347,
                                         7.7142857143,
                                         3.8571428571,
                                         3.9183673469,
                                         3.4897959184,
                                         3.5510204082,
                                         7.1020408163,
                                         7.2244897959,
                                         10.8367346939,
                                         11.0204081633,
                                         14.693877551,
                                         14.9387755102,
                                         14.693877551,
                                         14.9387755102,
                                         14.693877551,
                                         14.9387755102,
                                         14.693877551,
                                         14.9387755102,
                                         11.2040816327,
                                         11.387755102,
                                         7.5918367347,
                                         7.7142857143,
                                         3.8571428571,
                                         3.9183673469,
                                         3.4897959184,
                                         3.5510204082,
                                         7.1020408163,
                                         7.2244897959,
                                         10.8367346939,
                                         11.0204081633,
                                         14.693877551,
                                         14.9387755102,
                                         14.693877551,
                                         14.9387755102,
                                         14.693877551,
                                         14.9387755102,
                                         14.693877551,
                                         14.9387755102,
                                         11.2040816327,
                                         11.387755102,
                                         7.5918367347,
                                         7.7142857143,
                                         3.8571428571,
                                         3.9183673469,
                                         3.4897959184,
                                         3.5510204082,
                                         7.1020408163,
                                         7.2244897959,
                                         10.8367346939,
                                         11.0204081633,
                                         14.693877551,
                                         14.9387755102,
                                         14.693877551,
                                         14.9387755102,
                                         14.693877551,
                                         14.9387755102,
                                         14.693877551,
                                         14.9387755102,
                                         11.2040816327,
                                         11.387755102,
                                         7.5918367347,
                                         7.7142857143,
                                         3.8571428571,
                                         3.9183673469,
                                         3.4897959184,
                                         3.5510204082,
                                         7.1020408163,
                                         7.2244897959,
                                         10.8367346939,
                                         11.0204081633,
                                         14.693877551,
                                         14.9387755102,
                                         14.693877551,
                                         14.9387755102,
                                         14.693877551,
                                         14.9387755102,
                                         14.693877551,
                                         14.9387755102,
                                         11.2040816327,
                                         11.387755102,
                                         7.5918367347,
                                         7.7142857143,
                                         3.8571428571,
                                         3.9183673469,
                                         2.4897959184,
                                         2.5306122449,
                                         5.0612244898,
                                         5.1428571429,
                                         7.7142857143,
                                         7.8367346939,
                                         10.4489795918,
                                         10.612244898,
                                         10.4489795918,
                                         10.612244898,
                                         10.4489795918,
                                         10.612244898,
                                         10.4489795918,
                                         10.612244898,
                                         7.9591836735,
                                         8.0816326531,
                                         5.387755102,
                                         5.4693877551,
                                         2.7346938776,
                                         2.7755102041,
                                         1.3265306122,
                                         1.3469387755,
                                         2.693877551,
                                         2.7346938776,
                                         4.1020408163,
                                         4.1632653061,
                                         5.5510204082,
                                         5.6326530612,
                                         5.5510204082,
                                         5.6326530612,
                                         5.5510204082,
                                         5.6326530612,
                                         5.5510204082,
                                         5.6326530612,
                                         4.2244897959,
                                         4.2857142857,
                                         2.8571428571,
                                         2.8979591837,
                                         1.4489795918,
                                         1.4693877551};
  const std::array<int, 4> in_shape = {{3, 9, 10, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x9x10x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      32.7228174603,   33.2996938776,   33.8765702948,   34.453446712,
      40.0639739229,   40.7493537415,   41.4347335601,   42.1201133787,
      47.8391439909,   48.6330272109,   49.4269104308,   50.2207936508,
      56.0483276644,   56.9507142857,   57.853100907,    58.7554875283,
      56.3231292517,   57.1622222222,   58.0013151927,   58.8404081633,
      60.576462585,    61.4155555556,   62.2546485261,   63.0937414966,
      69.6691213152,   70.5715079365,   71.4738945578,   72.3762811791,
      62.761978458,    63.555861678,    64.349744898,    65.1436281179,
      55.4208219955,   56.1062018141,   56.7915816327,   57.4769614512,
      47.6456519274,   48.2225283447,   48.7994047619,   49.3762811791,
      50.7415249433,   51.4269047619,   52.1122845805,   52.7976643991,
      61.6949263039,   62.5092176871,   63.3235090703,   64.1378004535,
      73.1639739229,   74.1071768707,   75.0503798186,   75.9935827664,
      85.1486678005,   86.2207823129,   87.2928968254,   88.3650113379,
      84.1734693878,   85.1703854875,   86.1673015873,   87.1642176871,
      89.2268027211,   90.2237188209,   91.2206349206,   92.2175510204,
      101.3313662132,  102.4034807256,  103.4755952381,  104.5477097506,
      90.8936111111,   91.836814059,    92.7800170068,   93.7232199546,
      79.9402097506,   80.7545011338,   81.568792517,    82.3830839002,
      68.4711621315,   69.1565419501,   69.8419217687,   70.5273015873,
      73.1003684807,   73.8942517007,   74.6881349206,   75.4820181406,
      88.4823412698,   89.4255442177,   90.3687471655,   91.3119501134,
      104.4615929705,  105.5541156463,  106.646638322,   107.7391609977,
      121.0381235828,  122.2799659864,  123.52180839,    124.7636507937,
      118.3367346939,  119.4914739229,  120.6462131519,  121.800952381,
      124.1900680272,  125.3448072562,  126.4995464853,  127.6542857143,
      139.7827267574,  141.024569161,   142.2664115646,  143.5082539683,
      124.9980328798,  126.0905555556,  127.1830782313,  128.275600907,
      109.6160600907,  110.5592630385,  111.5024659864,  112.4456689342,
      93.63680839,     94.43069161,     95.2245748299,   96.0184580499,
      104.2491780045,  105.1696485261,  106.0901190476,  107.0105895692,
      125.7501984127,  126.8437981859,  127.9373979592,  129.0309977324,
      147.9437358277,  149.2104648526,  150.4771938776,  151.7439229025,
      170.8297902494,  172.2696485261,  173.7095068027,  175.1493650794,
      165.5589569161,  166.8978231293,  168.2366893424,  169.5755555556,
      172.3456235828,  173.6844897959,  175.0233560091,  176.3622222222,
      192.5632823129,  194.0031405896,  195.4429988662,  196.8828571429,
      171.7547789116,  173.0215079365,  174.2882369615,  175.5549659864,
      150.2537585034,  151.3473582766,  152.4409580499,  153.5345578231,
      128.0602210884,  128.98069161,    129.9011621315,  130.8216326531,
      146.552154195,   147.4346485261,  148.3171428571,  149.1996371882,
      175.9317460317,  176.9802267574,  178.028707483,   179.0771882086,
      205.9752834467,  207.1897505669,  208.4042176871,  209.6186848073,
      236.6827664399,  238.0632199546,  239.4436734694,  240.8241269841,
      226.5160997732,  227.7997278912,  229.0833560091,  230.366984127,
      233.0227664399,  234.3063945578,  235.5900226757,  236.8736507937,
      257.5195918367,  258.9000453515,  260.2804988662,  261.660952381,
      228.8039455782,  230.0184126984,  231.2328798186,  232.4473469388,
      199.4243537415,  200.4728344671,  201.5213151927,  202.5697959184,
      169.3808163265,  170.2633106576,  171.1458049887,  172.0282993197,
      201.4682256236,  202.3886961451,  203.3091666667,  204.2296371882,
      241.2549603175,  242.3485600907,  243.4421598639,  244.5357596372,
      281.7342120181,  283.0009410431,  284.267670068,   285.534399093,
      322.9059807256,  324.3458390023,  325.7856972789,  327.2255555556,
      306.9684807256,  308.3073469388,  309.6462131519,  310.9850793651,
      313.7551473923,  315.0940136054,  316.4328798186,  317.7717460317,
      344.6394727891,  346.0793310658,  347.5191893424,  348.959047619,
      305.545255102,   306.811984127,   308.0787131519,  309.3454421769,
      265.7585204082,  266.8521201814,  267.9457199546,  269.0393197279,
      225.2792687075,  226.199739229,   227.1202097506,  228.0406802721,
      190.5733843537,  191.3672675737,  192.1611507937,  192.9550340136,
      228.0505952381,  228.9937981859,  229.9370011338,  230.8802040816,
      266.125085034,   267.2176077098,  268.3101303855,  269.4026530612,
      304.7968537415,  306.0386961451,  307.2805385488,  308.5223809524,
      289.2065759637,  290.3613151927,  291.5160544218,  292.6707936508,
      295.0599092971,  296.2146485261,  297.3693877551,  298.5241269841,
      323.5414569161,  324.7832993197,  326.0251417234,  327.266984127,
      286.6615249433,  287.754047619,   288.8465702948,  289.9390929705,
      249.184314059,   250.1275170068,  251.0707199546,  252.0139229025,
      211.109824263,   211.903707483,   212.6975907029,  213.4914739229,
      176.8948129252,  177.5801927438,  178.2655725624,  178.950952381,
      211.5761054422,  212.3903968254,  213.2046882086,  214.0189795918,
      246.7730442177,  247.7162471655,  248.6594501134,  249.6026530612,
      282.4856292517,  283.5577437642,  284.6298582766,  285.7019727891,
      267.6691609977,  268.6660770975,  269.6629931973,  270.6599092971,
      272.7224943311,  273.7194104308,  274.7163265306,  275.7132426304,
      298.6683276644,  299.7404421769,  300.8125566893,  301.8846712018,
      264.5026814059,  265.4458843537,  266.3890873016,  267.3322902494,
      229.8213888889,  230.6356802721,  231.4499716553,  232.2642630385,
      194.6244501134,  195.309829932,   195.9952097506,  196.6805895692,
      158.8761054422,  159.4529818594,  160.0298582766,  160.6067346939,
      189.9451530612,  190.6305328798,  191.3159126984,  192.001292517,
      221.4482142857,  222.2420975057,  223.0359807256,  223.8298639456,
      253.3852891156,  254.287675737,   255.1900623583,  256.0924489796,
      239.8188208617,  240.6579138322,  241.4970068027,  242.3360997732,
      244.072154195,   244.9112471655,  245.7503401361,  246.5894331066,
      267.0060827664,  267.9084693878,  268.8108560091,  269.7132426304,
      236.3710487528,  237.1649319728,  237.9588151927,  238.7526984127,
      205.3020011338,  205.9873809524,  206.672760771,   207.3581405896,
      173.7989399093,  174.3758163265,  174.9526927438,  175.529569161,
      240.3983276644,  240.9752040816,  241.5520804989,  242.1289569161,
      286.8007086168,  287.4860884354,  288.171468254,   288.8568480726,
      333.6371031746,  334.4309863946,  335.2248696145,  336.0187528345,
      380.9075113379,  381.8098979592,  382.7122845805,  383.6146712018,
      358.3965986395,  359.23569161,    360.0747845805,  360.913877551,
      362.6499319728,  363.4890249433,  364.3281179138,  365.1672108844,
      394.5283049887,  395.43069161,    396.3330782313,  397.2354648526,
      348.5599376417,  349.3538208617,  350.1477040816,  350.9415873016,
      302.1575566893,  302.8429365079,  303.5283163265,  304.2136961451,
      255.3211621315,  255.8980385488,  256.474914966,   257.0517913832,
      297.4782596372,  298.1636394558,  298.8490192744,  299.534399093,
      354.839824263,   355.6541156463,  356.4684070295,  357.2826984127,
      412.7170351474,  413.6602380952,  414.6034410431,  415.5466439909,
      471.1098922902,  472.1820068027,  473.2541213152,  474.3262358277,
      443.0632653061,  444.0601814059,  445.0570975057,  446.0540136054,
      448.1165986395,  449.1135147392,  450.110430839,   451.1073469388,
      487.2925907029,  488.3647052154,  489.4368197279,  490.5089342404,
      430.4466723356,  431.3898752834,  432.3330782313,  433.2762811791,
      373.0851077098,  373.899399093,   374.7136904762,  375.5279818594,
      315.2078968254,  315.893276644,   316.5786564626,  317.2640362812,
      358.8983276644,  359.6922108844,  360.4860941043,  361.2799773243,
      428.0354024943,  428.9786054422,  429.92180839,    430.8650113379,
      497.7697562358,  498.8622789116,  499.9548015873,  501.047324263,
      568.1013888889,  569.3432312925,  570.5850736961,  571.8269160998,
      534.0428571429,  535.1975963719,  536.3523356009,  537.5070748299,
      539.8961904762,  541.0509297052,  542.2056689342,  543.3604081633,
      586.8459920635,  588.0878344671,  589.3296768707,  590.5715192744,
      518.3061961451,  519.3987188209,  520.4912414966,  521.5837641723,
      449.1691213152,  450.112324263,   451.0555272109,  451.9987301587,
      379.4347675737,  380.2286507937,  381.0225340136,  381.8164172336,
      435.6185657596,  436.5390362812,  437.4595068027,  438.3799773243,
      519.44611678,    520.5397165533,  521.6333163265,  522.7269160998,
      603.9661848073,  605.2329138322,  606.4996428571,  607.7663718821,
      689.1787698413,  690.6186281179,  692.0584863946,  693.4983446712,
      647.5507936508,  648.8896598639,  650.2285260771,  651.5673922902,
      654.3374603175,  655.6763265306,  657.0151927438,  658.3540589569,
      710.9122619048,  712.3521201814,  713.791978458,   715.2318367347,
      627.7772278912,  629.0439569161,  630.310685941,   631.577414966,
      543.9496768707,  545.043276644,   546.1368764172,  547.2304761905,
      459.4296088435,  460.3500793651,  461.2705498866,  462.1910204082,
      464.2501133787,  465.1326077098,  466.0151020408,  466.8975963719,
      553.3848072562,  554.4332879819,  555.4817687075,  556.5302494331,
      643.183446712,   644.3979138322,  645.6123809524,  646.8268480726,
      733.646031746,   735.0264852608,  736.4069387755,  737.7873922902,
      688.6222222222,  689.9058503401,  691.189478458,   692.473106576,
      695.1288888889,  696.4125170068,  697.6961451247,  698.9797732426,
      754.4828571429,  755.8633106576,  757.2437641723,  758.6242176871,
      666.0121088435,  667.2265759637,  668.4410430839,  669.6555102041,
      576.877414966,   577.9258956916,  578.9743764172,  580.0228571429,
      487.0787755102,  487.9612698413,  488.8437641723,  489.7262585034,
      532.8376133787,  533.7580839002,  534.6785544218,  535.5990249433,
      634.9508786848,  636.044478458,   637.1380782313,  638.2316780045,
      737.7566609977,  739.0233900227,  740.2901190476,  741.5568480726,
      841.2549603175,  842.6948185941,  844.1346768707,  845.5745351474,
      788.9603174603,  790.2991836735,  791.6380498866,  792.9769160998,
      795.746984127,   797.0858503401,  798.4247165533,  799.7635827664,
      862.988452381,   864.4283106576,  865.8681689342,  867.3080272109,
      761.5677040816,  762.8344331066,  764.1011621315,  765.3678911565,
      659.4544387755,  660.5480385488,  661.641638322,   662.7352380952,
      556.6486564626,  557.5691269841,  558.4895975057,  559.4100680272,
      476.3713435374,  477.1652267574,  477.9591099773,  478.7529931973,
      567.6036564626,  568.5468594104,  569.4900623583,  570.4332653061,
      659.4332482993,  660.5257709751,  661.6182936508,  662.7108163265,
      751.8601190476,  753.1019614512,  754.3438038549,  755.5856462585,
      704.9126984127,  706.0674376417,  707.2221768707,  708.3769160998,
      710.766031746,   711.9207709751,  713.0755102041,  714.2302494331,
      770.6047222222,  771.8465646259,  773.0884070295,  774.3302494331,
      679.9696882086,  681.0622108844,  682.1547335601,  683.2472562358,
      588.7373752834,  589.6805782313,  590.6237811791,  591.566984127,
      496.9077834467,  497.7016666667,  498.4955498866,  499.2894331066,
      423.631547619,   424.3169274376,  425.0023072562,  425.6876870748,
      504.7210034014,  505.5352947846,  506.3495861678,  507.163877551,
      586.3261054422,  587.26930839,    588.2125113379,  589.1557142857,
      668.4468537415,  669.518968254,   670.5910827664,  671.6631972789,
      626.5589569161,  627.5558730159,  628.5527891156,  629.5497052154,
      631.6122902494,  632.6092063492,  633.606122449,   634.6030385488,
      684.6295521542,  685.7016666667,  686.7737811791,  687.8458956916,
      604.0557426304,  604.9989455782,  605.9421485261,  606.8853514739,
      522.9662868481,  523.7805782313,  524.5948696145,  525.4091609977,
      441.3611848073,  442.0465646259,  442.7319444444,  443.417324263,
      366.5516156463,  367.1284920635,  367.7053684807,  368.282244898,
      436.6818877551,  437.3672675737,  438.0526473923,  438.7380272109,
      507.2461734694,  508.0400566893,  508.8339399093,  509.6278231293,
      578.2444727891,  579.1468594104,  580.0492460317,  580.9516326531,
      541.8922902494,  542.73138322,    543.5704761905,  544.409569161,
      546.1456235828,  546.9847165533,  547.8238095238,  548.6629024943,
      591.8652664399,  592.7676530612,  593.6700396825,  594.5724263039,
      522.1690079365,  522.9628911565,  523.7567743764,  524.5506575964,
      452.0387358277,  452.7241156463,  453.4094954649,  454.0948752834,
      381.4744501134,  382.0513265306,  382.6282029478,  383.2050793651,
      448.0738378685,  448.6507142857,  449.2275907029,  449.8044671202,
      533.5374433107,  534.2228231293,  534.9082029478,  535.5935827664,
      619.4350623583,  620.2289455782,  621.0228287982,  621.8167120181,
      705.7666950113,  706.6690816327,  707.571468254,   708.4738548753,
      660.4700680272,  661.3091609977,  662.1482539683,  662.9873469388,
      664.7234013605,  665.5624943311,  666.4015873016,  667.2406802721,
      719.3874886621,  720.2898752834,  721.1922619048,  722.0946485261,
      634.3578968254,  635.1517800454,  635.9456632653,  636.7395464853,
      548.8942913832,  549.5796712018,  550.2650510204,  550.950430839,
      462.9966723356,  463.5735487528,  464.1504251701,  464.7273015873,
      544.2149943311,  544.9003741497,  545.5857539683,  546.2711337868,
      647.9847222222,  648.7990136054,  649.6133049887,  650.4275963719,
      752.2700963719,  753.2132993197,  754.1565022676,  755.0997052154,
      857.07111678,    858.1432312925,  859.215345805,   860.2874603175,
      801.9530612245,  802.9499773243,  803.946893424,   804.9438095238,
      807.0063945578,  808.0033106576,  809.0002267574,  809.9971428571,
      873.2538151927,  874.3259297052,  875.3980442177,  876.4701587302,
      769.9997335601,  770.9429365079,  771.8861394558,  772.8293424036,
      666.2300056689,  667.0442970522,  667.8585884354,  668.6728798186,
      561.9446315193,  562.6300113379,  563.3153911565,  564.0007709751,
      644.6962868481,  645.490170068,   646.284053288,   647.0779365079,
      767.5884637188,  768.5316666667,  769.4748696145,  770.4180725624,
      891.0779195011,  892.1704421769,  893.2629648526,  894.3554875283,
      1015.164654195,  1016.4064965986, 1017.6483390023, 1018.8901814059,
      949.7489795918,  950.9037188209,  952.0584580499,  953.2131972789,
      955.6023129252,  956.7570521542,  957.9117913832,  959.0665306122,
      1033.9092573696, 1035.1510997732, 1036.3929421769, 1037.6347845805,
      911.6143594104,  912.7068820862,  913.7994047619,  914.8919274376,
      788.7221825397,  789.6653854875,  790.6085884354,  791.5517913832,
      665.2327267574,  666.0266099773,  666.8204931973,  667.6143764172,
      766.9879535147,  767.9084240363,  768.8288945578,  769.7493650794,
      913.1420351474,  914.2356349206,  915.3292346939,  916.4228344671,
      1059.9886337868, 1061.2553628118, 1062.5220918367, 1063.7888208617,
      1207.5277494331, 1208.9676077097, 1210.4074659864, 1211.847324263,
      1129.5426303855, 1130.8814965986, 1132.2203628118, 1133.5592290249,
      1136.3292970522, 1137.6681632653, 1139.0070294785, 1140.3458956916,
      1229.2612414966, 1230.7010997732, 1232.1409580499, 1233.5808163265,
      1083.7996768707, 1085.0664058957, 1086.3331349206, 1087.5998639456,
      937.6455952381,  938.7391950113,  939.8327947846,  940.9263945578,
      790.7989965986,  791.7194671202,  792.6399376417,  793.5604081633,
      781.9480725624,  782.8305668934,  783.7130612245,  784.5955555556,
      930.8378684807,  931.8863492063,  932.934829932,   933.9833106576,
      1080.3916099773, 1081.6060770975, 1082.8205442177, 1084.0350113379,
      1230.6092970522, 1231.9897505669, 1233.3702040816, 1234.7506575964,
      1150.7283446712, 1152.0119727891, 1153.295600907,  1154.5792290249,
      1157.2350113379, 1158.5186394558, 1159.8022675737, 1161.0858956916,
      1251.446122449,  1252.8265759637, 1254.2070294785, 1255.5874829932,
      1103.2202721088, 1104.434739229,  1105.6492063492, 1106.8636734694,
      954.3304761905,  955.3789569161,  956.4274376417,  957.4759183673,
      804.7767346939,  805.6592290249,  806.541723356,   807.4242176871,
      864.2070011338,  865.1274716553,  866.0479421769,  866.9684126984,
      1028.6467970522, 1029.7403968254, 1030.8339965986, 1031.9275963719,
      1193.7791099773, 1195.0458390023, 1196.3125680272, 1197.5792970522,
      1359.6039399093, 1361.0437981859, 1362.4836564626, 1363.9235147392,
      1270.952154195,  1272.2910204082, 1273.6298866213, 1274.9687528345,
      1277.7388208617, 1279.0776870748, 1280.416553288,  1281.7554195011,
      1381.3374319728, 1382.7772902494, 1384.2171485261, 1385.6570068027,
      1217.5901530612, 1218.8568820862, 1220.1236111111, 1221.3903401361,
      1053.1503571429, 1054.2439569161, 1055.3375566893, 1056.4311564626,
      888.0180442177,  888.9385147392,  889.8589852608,  890.7794557823,
      762.1693027211,  762.963185941,   763.757069161,   764.550952381,
      907.1567176871,  908.0999206349,  909.0431235828,  909.9863265306,
      1052.7414115646, 1053.8339342404, 1054.9264569161, 1056.0189795918,
      1198.9233843537, 1200.1652267574, 1201.407069161,  1202.6489115646,
      1120.6188208617, 1121.7735600907, 1122.9282993197, 1124.0830385488,
      1126.472154195,  1127.626893424,  1128.7816326531, 1129.9363718821,
      1217.6679875283, 1218.909829932,  1220.1516723356, 1221.3935147392,
      1073.2778514739, 1074.3703741497, 1075.4628968254, 1076.5554195011,
      928.2904365079,  929.2336394558,  930.1768424036,  931.1200453515,
      782.7057426304,  783.4996258503,  784.2935090703,  785.0873922902,
      670.3682823129,  671.0536621315,  671.7390419501,  672.4244217687,
      797.8659013605,  798.6801927438,  799.494484127,   800.3087755102,
      925.8791666667,  926.8223696145,  927.7655725624,  928.7087755102,
      1054.4080782313, 1055.4801927438, 1056.5523072562, 1057.6244217687,
      985.4487528345,  986.4456689342,  987.442585034,   988.4395011338,
      990.5020861678,  991.4990022676,  992.4959183673,  993.4928344671,
      1070.590776644,  1071.6628911565, 1072.7350056689, 1073.8071201814,
      943.6088038549,  944.5520068027,  945.4952097506,  946.4384126984,
      816.1111848073,  816.9254761905,  817.7397675737,  818.5540589569,
      688.0979195011,  688.7832993197,  689.4686791383,  690.1540589569,
      574.2271258503,  574.8040022676,  575.3808786848,  575.957755102,
      683.418622449,   684.1040022676,  684.7893820862,  685.4747619048,
      793.0441326531,  793.838015873,   794.631899093,   795.4257823129,
      903.1036564626,  904.0060430839,  904.9084297052,  905.8108163265,
      843.9657596372,  844.8048526077,  845.6439455782,  846.4830385488,
      848.2190929705,  849.058185941,   849.8972789116,  850.7363718821,
      916.7244501134,  917.6268367347,  918.529223356,   919.4316099773,
      807.9669671202,  808.7608503401,  809.5547335601,  810.34861678,
      698.7754705215,  699.4608503401,  700.1462301587,  700.8316099773,
      589.1499603175,  589.7268367347,  590.3037131519,  590.8805895692};
  const std::array<int, 4> in_shape = {{3, 9, 10, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x9x10x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.0204081633,
                                         0.0408163265,
                                         0.0612244898,
                                         0.0816326531,
                                         0.1224489796,
                                         0.1632653061,
                                         0.2040816327,
                                         0.2448979592,
                                         0.306122449,
                                         0.3673469388,
                                         0.4285714286,
                                         0.4897959184,
                                         0.5714285714,
                                         0.6530612245,
                                         0.7346938776,
                                         0.8163265306,
                                         0.5714285714,
                                         0.6530612245,
                                         0.7346938776,
                                         0.8163265306,
                                         0.5714285714,
                                         0.6530612245,
                                         0.7346938776,
                                         0.8163265306,
                                         0.5714285714,
                                         0.6530612245,
                                         0.7346938776,
                                         0.8163265306,
                                         0.5510204082,
                                         0.612244898,
                                         0.6734693878,
                                         0.7346938776,
                                         0.4489795918,
                                         0.4897959184,
                                         0.5306122449,
                                         0.5714285714,
                                         0.2653061224,
                                         0.2857142857,
                                         0.306122449,
                                         0.3265306122,
                                         0.3673469388,
                                         0.4081632653,
                                         0.4489795918,
                                         0.4897959184,
                                         0.8979591837,
                                         0.9795918367,
                                         1.0612244898,
                                         1.1428571429,
                                         1.5918367347,
                                         1.7142857143,
                                         1.8367346939,
                                         1.9591836735,
                                         2.4489795918,
                                         2.612244898,
                                         2.7755102041,
                                         2.9387755102,
                                         2.4489795918,
                                         2.612244898,
                                         2.7755102041,
                                         2.9387755102,
                                         2.4489795918,
                                         2.612244898,
                                         2.7755102041,
                                         2.9387755102,
                                         2.4489795918,
                                         2.612244898,
                                         2.7755102041,
                                         2.9387755102,
                                         2.0816326531,
                                         2.2040816327,
                                         2.3265306122,
                                         2.4489795918,
                                         1.5510204082,
                                         1.6326530612,
                                         1.7142857143,
                                         1.7959183673,
                                         0.8571428571,
                                         0.8979591837,
                                         0.9387755102,
                                         0.9795918367,
                                         1.0408163265,
                                         1.1020408163,
                                         1.1632653061,
                                         1.2244897959,
                                         2.3265306122,
                                         2.4489795918,
                                         2.5714285714,
                                         2.693877551,
                                         3.8571428571,
                                         4.0408163265,
                                         4.2244897959,
                                         4.4081632653,
                                         5.6326530612,
                                         5.8775510204,
                                         6.1224489796,
                                         6.3673469388,
                                         5.6326530612,
                                         5.8775510204,
                                         6.1224489796,
                                         6.3673469388,
                                         5.6326530612,
                                         5.8775510204,
                                         6.1224489796,
                                         6.3673469388,
                                         5.6326530612,
                                         5.8775510204,
                                         6.1224489796,
                                         6.3673469388,
                                         4.5918367347,
                                         4.7755102041,
                                         4.9591836735,
                                         5.1428571429,
                                         3.306122449,
                                         3.4285714286,
                                         3.5510204082,
                                         3.6734693878,
                                         1.7755102041,
                                         1.8367346939,
                                         1.8979591837,
                                         1.9591836735,
                                         1.0408163265,
                                         1.1020408163,
                                         1.1632653061,
                                         1.2244897959,
                                         2.3265306122,
                                         2.4489795918,
                                         2.5714285714,
                                         2.693877551,
                                         3.8571428571,
                                         4.0408163265,
                                         4.2244897959,
                                         4.4081632653,
                                         5.6326530612,
                                         5.8775510204,
                                         6.1224489796,
                                         6.3673469388,
                                         5.6326530612,
                                         5.8775510204,
                                         6.1224489796,
                                         6.3673469388,
                                         5.6326530612,
                                         5.8775510204,
                                         6.1224489796,
                                         6.3673469388,
                                         5.6326530612,
                                         5.8775510204,
                                         6.1224489796,
                                         6.3673469388,
                                         4.5918367347,
                                         4.7755102041,
                                         4.9591836735,
                                         5.1428571429,
                                         3.306122449,
                                         3.4285714286,
                                         3.5510204082,
                                         3.6734693878,
                                         1.7755102041,
                                         1.8367346939,
                                         1.8979591837,
                                         1.9591836735,
                                         1.0408163265,
                                         1.1020408163,
                                         1.1632653061,
                                         1.2244897959,
                                         2.3265306122,
                                         2.4489795918,
                                         2.5714285714,
                                         2.693877551,
                                         3.8571428571,
                                         4.0408163265,
                                         4.2244897959,
                                         4.4081632653,
                                         5.6326530612,
                                         5.8775510204,
                                         6.1224489796,
                                         6.3673469388,
                                         5.6326530612,
                                         5.8775510204,
                                         6.1224489796,
                                         6.3673469388,
                                         5.6326530612,
                                         5.8775510204,
                                         6.1224489796,
                                         6.3673469388,
                                         5.6326530612,
                                         5.8775510204,
                                         6.1224489796,
                                         6.3673469388,
                                         4.5918367347,
                                         4.7755102041,
                                         4.9591836735,
                                         5.1428571429,
                                         3.306122449,
                                         3.4285714286,
                                         3.5510204082,
                                         3.6734693878,
                                         1.7755102041,
                                         1.8367346939,
                                         1.8979591837,
                                         1.9591836735,
                                         1.0408163265,
                                         1.1020408163,
                                         1.1632653061,
                                         1.2244897959,
                                         2.3265306122,
                                         2.4489795918,
                                         2.5714285714,
                                         2.693877551,
                                         3.8571428571,
                                         4.0408163265,
                                         4.2244897959,
                                         4.4081632653,
                                         5.6326530612,
                                         5.8775510204,
                                         6.1224489796,
                                         6.3673469388,
                                         5.6326530612,
                                         5.8775510204,
                                         6.1224489796,
                                         6.3673469388,
                                         5.6326530612,
                                         5.8775510204,
                                         6.1224489796,
                                         6.3673469388,
                                         5.6326530612,
                                         5.8775510204,
                                         6.1224489796,
                                         6.3673469388,
                                         4.5918367347,
                                         4.7755102041,
                                         4.9591836735,
                                         5.1428571429,
                                         3.306122449,
                                         3.4285714286,
                                         3.5510204082,
                                         3.6734693878,
                                         1.7755102041,
                                         1.8367346939,
                                         1.8979591837,
                                         1.9591836735,
                                         1.0408163265,
                                         1.1020408163,
                                         1.1632653061,
                                         1.2244897959,
                                         2.3265306122,
                                         2.4489795918,
                                         2.5714285714,
                                         2.693877551,
                                         3.8571428571,
                                         4.0408163265,
                                         4.2244897959,
                                         4.4081632653,
                                         5.6326530612,
                                         5.8775510204,
                                         6.1224489796,
                                         6.3673469388,
                                         5.6326530612,
                                         5.8775510204,
                                         6.1224489796,
                                         6.3673469388,
                                         5.6326530612,
                                         5.8775510204,
                                         6.1224489796,
                                         6.3673469388,
                                         5.6326530612,
                                         5.8775510204,
                                         6.1224489796,
                                         6.3673469388,
                                         4.5918367347,
                                         4.7755102041,
                                         4.9591836735,
                                         5.1428571429,
                                         3.306122449,
                                         3.4285714286,
                                         3.5510204082,
                                         3.6734693878,
                                         1.7755102041,
                                         1.8367346939,
                                         1.8979591837,
                                         1.9591836735,
                                         1.0204081633,
                                         1.0612244898,
                                         1.1020408163,
                                         1.1428571429,
                                         2.2040816327,
                                         2.2857142857,
                                         2.3673469388,
                                         2.4489795918,
                                         3.5510204082,
                                         3.6734693878,
                                         3.7959183673,
                                         3.9183673469,
                                         5.0612244898,
                                         5.2244897959,
                                         5.387755102,
                                         5.5510204082,
                                         5.0612244898,
                                         5.2244897959,
                                         5.387755102,
                                         5.5510204082,
                                         5.0612244898,
                                         5.2244897959,
                                         5.387755102,
                                         5.5510204082,
                                         5.0612244898,
                                         5.2244897959,
                                         5.387755102,
                                         5.5510204082,
                                         4.0408163265,
                                         4.1632653061,
                                         4.2857142857,
                                         4.4081632653,
                                         2.8571428571,
                                         2.9387755102,
                                         3.0204081633,
                                         3.1020408163,
                                         1.5102040816,
                                         1.5510204082,
                                         1.5918367347,
                                         1.6326530612,
                                         0.6734693878,
                                         0.693877551,
                                         0.7142857143,
                                         0.7346938776,
                                         1.4285714286,
                                         1.4693877551,
                                         1.5102040816,
                                         1.5510204082,
                                         2.2653061224,
                                         2.3265306122,
                                         2.387755102,
                                         2.4489795918,
                                         3.1836734694,
                                         3.2653061224,
                                         3.3469387755,
                                         3.4285714286,
                                         3.1836734694,
                                         3.2653061224,
                                         3.3469387755,
                                         3.4285714286,
                                         3.1836734694,
                                         3.2653061224,
                                         3.3469387755,
                                         3.4285714286,
                                         3.1836734694,
                                         3.2653061224,
                                         3.3469387755,
                                         3.4285714286,
                                         2.5102040816,
                                         2.5714285714,
                                         2.6326530612,
                                         2.693877551,
                                         1.7551020408,
                                         1.7959183673,
                                         1.8367346939,
                                         1.8775510204,
                                         0.9183673469,
                                         0.9387755102,
                                         0.9591836735,
                                         0.9795918367,
                                         1.,
                                         1.0204081633,
                                         1.0408163265,
                                         1.0612244898,
                                         2.0816326531,
                                         2.1224489796,
                                         2.1632653061,
                                         2.2040816327,
                                         3.2448979592,
                                         3.306122449,
                                         3.3673469388,
                                         3.4285714286,
                                         4.4897959184,
                                         4.5714285714,
                                         4.6530612245,
                                         4.7346938776,
                                         4.4897959184,
                                         4.5714285714,
                                         4.6530612245,
                                         4.7346938776,
                                         4.4897959184,
                                         4.5714285714,
                                         4.6530612245,
                                         4.7346938776,
                                         4.4897959184,
                                         4.5714285714,
                                         4.6530612245,
                                         4.7346938776,
                                         3.4897959184,
                                         3.5510204082,
                                         3.612244898,
                                         3.6734693878,
                                         2.4081632653,
                                         2.4489795918,
                                         2.4897959184,
                                         2.5306122449,
                                         1.2448979592,
                                         1.2653061224,
                                         1.2857142857,
                                         1.306122449,
                                         2.3265306122,
                                         2.3673469388,
                                         2.4081632653,
                                         2.4489795918,
                                         4.8163265306,
                                         4.8979591837,
                                         4.9795918367,
                                         5.0612244898,
                                         7.4693877551,
                                         7.5918367347,
                                         7.7142857143,
                                         7.8367346939,
                                         10.2857142857,
                                         10.4489795918,
                                         10.612244898,
                                         10.7755102041,
                                         10.2857142857,
                                         10.4489795918,
                                         10.612244898,
                                         10.7755102041,
                                         10.2857142857,
                                         10.4489795918,
                                         10.612244898,
                                         10.7755102041,
                                         10.2857142857,
                                         10.4489795918,
                                         10.612244898,
                                         10.7755102041,
                                         7.9591836735,
                                         8.0816326531,
                                         8.2040816327,
                                         8.3265306122,
                                         5.4693877551,
                                         5.5510204082,
                                         5.6326530612,
                                         5.7142857143,
                                         2.8163265306,
                                         2.8571428571,
                                         2.8979591837,
                                         2.9387755102,
                                         3.9795918367,
                                         4.0408163265,
                                         4.1020408163,
                                         4.1632653061,
                                         8.2040816327,
                                         8.3265306122,
                                         8.4489795918,
                                         8.5714285714,
                                         12.6734693878,
                                         12.8571428571,
                                         13.0408163265,
                                         13.2244897959,
                                         17.387755102,
                                         17.6326530612,
                                         17.8775510204,
                                         18.1224489796,
                                         17.387755102,
                                         17.6326530612,
                                         17.8775510204,
                                         18.1224489796,
                                         17.387755102,
                                         17.6326530612,
                                         17.8775510204,
                                         18.1224489796,
                                         17.387755102,
                                         17.6326530612,
                                         17.8775510204,
                                         18.1224489796,
                                         13.4081632653,
                                         13.5918367347,
                                         13.7755102041,
                                         13.9591836735,
                                         9.1836734694,
                                         9.306122449,
                                         9.4285714286,
                                         9.5510204082,
                                         4.7142857143,
                                         4.7755102041,
                                         4.8367346939,
                                         4.8979591837,
                                         3.9795918367,
                                         4.0408163265,
                                         4.1020408163,
                                         4.1632653061,
                                         8.2040816327,
                                         8.3265306122,
                                         8.4489795918,
                                         8.5714285714,
                                         12.6734693878,
                                         12.8571428571,
                                         13.0408163265,
                                         13.2244897959,
                                         17.387755102,
                                         17.6326530612,
                                         17.8775510204,
                                         18.1224489796,
                                         17.387755102,
                                         17.6326530612,
                                         17.8775510204,
                                         18.1224489796,
                                         17.387755102,
                                         17.6326530612,
                                         17.8775510204,
                                         18.1224489796,
                                         17.387755102,
                                         17.6326530612,
                                         17.8775510204,
                                         18.1224489796,
                                         13.4081632653,
                                         13.5918367347,
                                         13.7755102041,
                                         13.9591836735,
                                         9.1836734694,
                                         9.306122449,
                                         9.4285714286,
                                         9.5510204082,
                                         4.7142857143,
                                         4.7755102041,
                                         4.8367346939,
                                         4.8979591837,
                                         3.9795918367,
                                         4.0408163265,
                                         4.1020408163,
                                         4.1632653061,
                                         8.2040816327,
                                         8.3265306122,
                                         8.4489795918,
                                         8.5714285714,
                                         12.6734693878,
                                         12.8571428571,
                                         13.0408163265,
                                         13.2244897959,
                                         17.387755102,
                                         17.6326530612,
                                         17.8775510204,
                                         18.1224489796,
                                         17.387755102,
                                         17.6326530612,
                                         17.8775510204,
                                         18.1224489796,
                                         17.387755102,
                                         17.6326530612,
                                         17.8775510204,
                                         18.1224489796,
                                         17.387755102,
                                         17.6326530612,
                                         17.8775510204,
                                         18.1224489796,
                                         13.4081632653,
                                         13.5918367347,
                                         13.7755102041,
                                         13.9591836735,
                                         9.1836734694,
                                         9.306122449,
                                         9.4285714286,
                                         9.5510204082,
                                         4.7142857143,
                                         4.7755102041,
                                         4.8367346939,
                                         4.8979591837,
                                         3.9795918367,
                                         4.0408163265,
                                         4.1020408163,
                                         4.1632653061,
                                         8.2040816327,
                                         8.3265306122,
                                         8.4489795918,
                                         8.5714285714,
                                         12.6734693878,
                                         12.8571428571,
                                         13.0408163265,
                                         13.2244897959,
                                         17.387755102,
                                         17.6326530612,
                                         17.8775510204,
                                         18.1224489796,
                                         17.387755102,
                                         17.6326530612,
                                         17.8775510204,
                                         18.1224489796,
                                         17.387755102,
                                         17.6326530612,
                                         17.8775510204,
                                         18.1224489796,
                                         17.387755102,
                                         17.6326530612,
                                         17.8775510204,
                                         18.1224489796,
                                         13.4081632653,
                                         13.5918367347,
                                         13.7755102041,
                                         13.9591836735,
                                         9.1836734694,
                                         9.306122449,
                                         9.4285714286,
                                         9.5510204082,
                                         4.7142857143,
                                         4.7755102041,
                                         4.8367346939,
                                         4.8979591837,
                                         3.9795918367,
                                         4.0408163265,
                                         4.1020408163,
                                         4.1632653061,
                                         8.2040816327,
                                         8.3265306122,
                                         8.4489795918,
                                         8.5714285714,
                                         12.6734693878,
                                         12.8571428571,
                                         13.0408163265,
                                         13.2244897959,
                                         17.387755102,
                                         17.6326530612,
                                         17.8775510204,
                                         18.1224489796,
                                         17.387755102,
                                         17.6326530612,
                                         17.8775510204,
                                         18.1224489796,
                                         17.387755102,
                                         17.6326530612,
                                         17.8775510204,
                                         18.1224489796,
                                         17.387755102,
                                         17.6326530612,
                                         17.8775510204,
                                         18.1224489796,
                                         13.4081632653,
                                         13.5918367347,
                                         13.7755102041,
                                         13.9591836735,
                                         9.1836734694,
                                         9.306122449,
                                         9.4285714286,
                                         9.5510204082,
                                         4.7142857143,
                                         4.7755102041,
                                         4.8367346939,
                                         4.8979591837,
                                         2.9795918367,
                                         3.0204081633,
                                         3.0612244898,
                                         3.1020408163,
                                         6.1224489796,
                                         6.2040816327,
                                         6.2857142857,
                                         6.3673469388,
                                         9.4285714286,
                                         9.5510204082,
                                         9.6734693878,
                                         9.7959183673,
                                         12.8979591837,
                                         13.0612244898,
                                         13.2244897959,
                                         13.387755102,
                                         12.8979591837,
                                         13.0612244898,
                                         13.2244897959,
                                         13.387755102,
                                         12.8979591837,
                                         13.0612244898,
                                         13.2244897959,
                                         13.387755102,
                                         12.8979591837,
                                         13.0612244898,
                                         13.2244897959,
                                         13.387755102,
                                         9.9183673469,
                                         10.0408163265,
                                         10.1632653061,
                                         10.2857142857,
                                         6.7755102041,
                                         6.8571428571,
                                         6.9387755102,
                                         7.0204081633,
                                         3.4693877551,
                                         3.5102040816,
                                         3.5510204082,
                                         3.5918367347,
                                         1.6530612245,
                                         1.6734693878,
                                         1.693877551,
                                         1.7142857143,
                                         3.387755102,
                                         3.4285714286,
                                         3.4693877551,
                                         3.5102040816,
                                         5.2040816327,
                                         5.2653061224,
                                         5.3265306122,
                                         5.387755102,
                                         7.1020408163,
                                         7.1836734694,
                                         7.2653061224,
                                         7.3469387755,
                                         7.1020408163,
                                         7.1836734694,
                                         7.2653061224,
                                         7.3469387755,
                                         7.1020408163,
                                         7.1836734694,
                                         7.2653061224,
                                         7.3469387755,
                                         7.1020408163,
                                         7.1836734694,
                                         7.2653061224,
                                         7.3469387755,
                                         5.4489795918,
                                         5.5102040816,
                                         5.5714285714,
                                         5.6326530612,
                                         3.7142857143,
                                         3.7551020408,
                                         3.7959183673,
                                         3.8367346939,
                                         1.8979591837,
                                         1.9183673469,
                                         1.9387755102,
                                         1.9591836735,
                                         1.9795918367,
                                         2.,
                                         2.0204081633,
                                         2.0408163265,
                                         4.0408163265,
                                         4.0816326531,
                                         4.1224489796,
                                         4.1632653061,
                                         6.1836734694,
                                         6.2448979592,
                                         6.306122449,
                                         6.3673469388,
                                         8.4081632653,
                                         8.4897959184,
                                         8.5714285714,
                                         8.6530612245,
                                         8.4081632653,
                                         8.4897959184,
                                         8.5714285714,
                                         8.6530612245,
                                         8.4081632653,
                                         8.4897959184,
                                         8.5714285714,
                                         8.6530612245,
                                         8.4081632653,
                                         8.4897959184,
                                         8.5714285714,
                                         8.6530612245,
                                         6.4285714286,
                                         6.4897959184,
                                         6.5510204082,
                                         6.612244898,
                                         4.3673469388,
                                         4.4081632653,
                                         4.4489795918,
                                         4.4897959184,
                                         2.2244897959,
                                         2.2448979592,
                                         2.2653061224,
                                         2.2857142857,
                                         4.2857142857,
                                         4.3265306122,
                                         4.3673469388,
                                         4.4081632653,
                                         8.7346938776,
                                         8.8163265306,
                                         8.8979591837,
                                         8.9795918367,
                                         13.3469387755,
                                         13.4693877551,
                                         13.5918367347,
                                         13.7142857143,
                                         18.1224489796,
                                         18.2857142857,
                                         18.4489795918,
                                         18.612244898,
                                         18.1224489796,
                                         18.2857142857,
                                         18.4489795918,
                                         18.612244898,
                                         18.1224489796,
                                         18.2857142857,
                                         18.4489795918,
                                         18.612244898,
                                         18.1224489796,
                                         18.2857142857,
                                         18.4489795918,
                                         18.612244898,
                                         13.8367346939,
                                         13.9591836735,
                                         14.0816326531,
                                         14.2040816327,
                                         9.387755102,
                                         9.4693877551,
                                         9.5510204082,
                                         9.6326530612,
                                         4.7755102041,
                                         4.8163265306,
                                         4.8571428571,
                                         4.8979591837,
                                         6.9183673469,
                                         6.9795918367,
                                         7.0408163265,
                                         7.1020408163,
                                         14.0816326531,
                                         14.2040816327,
                                         14.3265306122,
                                         14.4489795918,
                                         21.4897959184,
                                         21.6734693878,
                                         21.8571428571,
                                         22.0408163265,
                                         29.1428571429,
                                         29.387755102,
                                         29.6326530612,
                                         29.8775510204,
                                         29.1428571429,
                                         29.387755102,
                                         29.6326530612,
                                         29.8775510204,
                                         29.1428571429,
                                         29.387755102,
                                         29.6326530612,
                                         29.8775510204,
                                         29.1428571429,
                                         29.387755102,
                                         29.6326530612,
                                         29.8775510204,
                                         22.2244897959,
                                         22.4081632653,
                                         22.5918367347,
                                         22.7755102041,
                                         15.0612244898,
                                         15.1836734694,
                                         15.306122449,
                                         15.4285714286,
                                         7.6530612245,
                                         7.7142857143,
                                         7.7755102041,
                                         7.8367346939,
                                         6.9183673469,
                                         6.9795918367,
                                         7.0408163265,
                                         7.1020408163,
                                         14.0816326531,
                                         14.2040816327,
                                         14.3265306122,
                                         14.4489795918,
                                         21.4897959184,
                                         21.6734693878,
                                         21.8571428571,
                                         22.0408163265,
                                         29.1428571429,
                                         29.387755102,
                                         29.6326530612,
                                         29.8775510204,
                                         29.1428571429,
                                         29.387755102,
                                         29.6326530612,
                                         29.8775510204,
                                         29.1428571429,
                                         29.387755102,
                                         29.6326530612,
                                         29.8775510204,
                                         29.1428571429,
                                         29.387755102,
                                         29.6326530612,
                                         29.8775510204,
                                         22.2244897959,
                                         22.4081632653,
                                         22.5918367347,
                                         22.7755102041,
                                         15.0612244898,
                                         15.1836734694,
                                         15.306122449,
                                         15.4285714286,
                                         7.6530612245,
                                         7.7142857143,
                                         7.7755102041,
                                         7.8367346939,
                                         6.9183673469,
                                         6.9795918367,
                                         7.0408163265,
                                         7.1020408163,
                                         14.0816326531,
                                         14.2040816327,
                                         14.3265306122,
                                         14.4489795918,
                                         21.4897959184,
                                         21.6734693878,
                                         21.8571428571,
                                         22.0408163265,
                                         29.1428571429,
                                         29.387755102,
                                         29.6326530612,
                                         29.8775510204,
                                         29.1428571429,
                                         29.387755102,
                                         29.6326530612,
                                         29.8775510204,
                                         29.1428571429,
                                         29.387755102,
                                         29.6326530612,
                                         29.8775510204,
                                         29.1428571429,
                                         29.387755102,
                                         29.6326530612,
                                         29.8775510204,
                                         22.2244897959,
                                         22.4081632653,
                                         22.5918367347,
                                         22.7755102041,
                                         15.0612244898,
                                         15.1836734694,
                                         15.306122449,
                                         15.4285714286,
                                         7.6530612245,
                                         7.7142857143,
                                         7.7755102041,
                                         7.8367346939,
                                         6.9183673469,
                                         6.9795918367,
                                         7.0408163265,
                                         7.1020408163,
                                         14.0816326531,
                                         14.2040816327,
                                         14.3265306122,
                                         14.4489795918,
                                         21.4897959184,
                                         21.6734693878,
                                         21.8571428571,
                                         22.0408163265,
                                         29.1428571429,
                                         29.387755102,
                                         29.6326530612,
                                         29.8775510204,
                                         29.1428571429,
                                         29.387755102,
                                         29.6326530612,
                                         29.8775510204,
                                         29.1428571429,
                                         29.387755102,
                                         29.6326530612,
                                         29.8775510204,
                                         29.1428571429,
                                         29.387755102,
                                         29.6326530612,
                                         29.8775510204,
                                         22.2244897959,
                                         22.4081632653,
                                         22.5918367347,
                                         22.7755102041,
                                         15.0612244898,
                                         15.1836734694,
                                         15.306122449,
                                         15.4285714286,
                                         7.6530612245,
                                         7.7142857143,
                                         7.7755102041,
                                         7.8367346939,
                                         6.9183673469,
                                         6.9795918367,
                                         7.0408163265,
                                         7.1020408163,
                                         14.0816326531,
                                         14.2040816327,
                                         14.3265306122,
                                         14.4489795918,
                                         21.4897959184,
                                         21.6734693878,
                                         21.8571428571,
                                         22.0408163265,
                                         29.1428571429,
                                         29.387755102,
                                         29.6326530612,
                                         29.8775510204,
                                         29.1428571429,
                                         29.387755102,
                                         29.6326530612,
                                         29.8775510204,
                                         29.1428571429,
                                         29.387755102,
                                         29.6326530612,
                                         29.8775510204,
                                         29.1428571429,
                                         29.387755102,
                                         29.6326530612,
                                         29.8775510204,
                                         22.2244897959,
                                         22.4081632653,
                                         22.5918367347,
                                         22.7755102041,
                                         15.0612244898,
                                         15.1836734694,
                                         15.306122449,
                                         15.4285714286,
                                         7.6530612245,
                                         7.7142857143,
                                         7.7755102041,
                                         7.8367346939,
                                         4.9387755102,
                                         4.9795918367,
                                         5.0204081633,
                                         5.0612244898,
                                         10.0408163265,
                                         10.1224489796,
                                         10.2040816327,
                                         10.2857142857,
                                         15.306122449,
                                         15.4285714286,
                                         15.5510204082,
                                         15.6734693878,
                                         20.7346938776,
                                         20.8979591837,
                                         21.0612244898,
                                         21.2244897959,
                                         20.7346938776,
                                         20.8979591837,
                                         21.0612244898,
                                         21.2244897959,
                                         20.7346938776,
                                         20.8979591837,
                                         21.0612244898,
                                         21.2244897959,
                                         20.7346938776,
                                         20.8979591837,
                                         21.0612244898,
                                         21.2244897959,
                                         15.7959183673,
                                         15.9183673469,
                                         16.0408163265,
                                         16.1632653061,
                                         10.693877551,
                                         10.7755102041,
                                         10.8571428571,
                                         10.9387755102,
                                         5.4285714286,
                                         5.4693877551,
                                         5.5102040816,
                                         5.5510204082,
                                         2.6326530612,
                                         2.6530612245,
                                         2.6734693878,
                                         2.693877551,
                                         5.3469387755,
                                         5.387755102,
                                         5.4285714286,
                                         5.4693877551,
                                         8.1428571429,
                                         8.2040816327,
                                         8.2653061224,
                                         8.3265306122,
                                         11.0204081633,
                                         11.1020408163,
                                         11.1836734694,
                                         11.2653061224,
                                         11.0204081633,
                                         11.1020408163,
                                         11.1836734694,
                                         11.2653061224,
                                         11.0204081633,
                                         11.1020408163,
                                         11.1836734694,
                                         11.2653061224,
                                         11.0204081633,
                                         11.1020408163,
                                         11.1836734694,
                                         11.2653061224,
                                         8.387755102,
                                         8.4489795918,
                                         8.5102040816,
                                         8.5714285714,
                                         5.6734693878,
                                         5.7142857143,
                                         5.7551020408,
                                         5.7959183673,
                                         2.8775510204,
                                         2.8979591837,
                                         2.9183673469,
                                         2.9387755102};
  const std::array<int, 4> in_shape = {{3, 9, 10, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x10x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      7.1521825397,   8.7940192744,   10.8360827664,  13.4384637188,
      14.7676303855,  12.9247732426,  11.2624716553,  9.729138322,
      10.8702097506,  13.2671485261,  16.2139739229,  19.9306405896,
      21.5098072562,  18.695521542,   16.1998866213,  13.9318594104,
      15.4562641723,  18.7715702948,  22.8136337868,  27.8731575964,
      29.702324263,   25.6880385488,  22.1685941043,  19.0026077098,
      20.910345805,   25.3072845805,  30.6350623583,  37.2660147392,
      39.3451814059,  33.902324263,   29.1685941043,  24.94138322,
      27.8557823129,  33.5265306122,  40.3265306122,  48.7074829932,
      50.6408163265,  43.3646258503,  37.1170068027,  31.6040816327,
      36.3624489796,  43.6331972789,  52.2998639456,  62.9208163265,
      64.8541496599,  55.3379591837,  47.2236734694,  40.1107482993,
      48.1519331066,  57.6726814059,  68.9782369615,  82.7825226757,
      84.8616893424,  72.2454988662,  61.5339909297,  52.1829705215,
      45.3019331066,  54.2308446712,  64.8221145125,  77.740685941,
      79.5698526077,  67.6965192744,  57.6278684807,  48.848276644,
      41.5839058957,  49.7577154195,  59.444223356,   71.2485090703,
      72.827675737,   61.9257709751,  52.6904535147,  44.6455555556,
      36.9978514739,  44.2532936508,  52.8445634921,  63.3059920635,
      64.6351587302,  54.9332539683,  46.7217460317,  39.5748072562,
      53.3022959184,  63.6244047619,  75.793452381,   90.5482142857,
      91.8773809524,  77.8821428571,  66.0928571429,  55.8792517007,
      65.7005952381,  78.4104591837,  93.3890306122,  111.543792517,
      113.1229591837, 95.8705782313,  81.3431972789,  68.762244898,
      78.9669217687,  94.2278061224,  112.206377551,  133.9897108844,
      135.818877551,  115.0807823129, 97.624829932,   82.5132653061,
      93.1012755102,  111.0764455782, 132.2454931973, 157.8859693878,
      159.9651360544, 135.512755102,  114.937755102,  97.1323129252,
      94.9832199546,  113.2798185941, 134.8099773243, 160.8671201814,
      162.8004535147, 137.8480725624, 116.8702947846, 98.7315192744,
      103.4898866213, 123.3864852608, 146.7833106576, 175.0804535147,
      177.0137868481, 149.8214058957, 126.9769614512, 107.238185941,
      120.3428628118, 143.4418424036, 170.5886678005, 203.4024773243,
      205.4816439909, 173.8559297052, 147.3031519274, 124.3739002268,
      108.8125907029, 129.6870804989, 154.2148582766, 183.857239229,
      185.6864058957, 157.0892630385, 133.0841043084, 112.3589342404,
      96.4142913832,  114.9010260771, 136.6192800454, 162.8616609977,
      164.4408276644, 139.1008276644, 117.8337641723, 99.4759410431,
      83.1479648526,  99.0836791383,  117.8019331066, 140.4157426304,
      141.7449092971, 119.8906235828, 101.5521315193, 85.7249206349,
      99.4524092971,  118.4547902494, 140.7508219955, 167.6579648526,
      168.9871315193, 142.8395124717, 120.9232426304, 102.0293650794,
      120.5309807256, 143.5537698413, 170.5640873016, 203.1569444444,
      204.7361111111, 173.0456349206, 146.4865079365, 123.5926303855,
      142.4775793651, 169.6840419501, 201.5991213152, 240.1062641723,
      241.935430839,  204.4735260771, 173.0810657596, 146.0239229025,
      165.2922052154, 196.845606576,  233.8559240363, 278.5059240363,
      280.5850907029, 237.123185941,  200.7069160998, 169.3232426304,
      162.1106575964, 193.033106576,  229.2934240363, 273.0267573696,
      274.9600907029, 232.3315192744, 196.6235827664, 165.8589569161,
      170.617324263,  203.1397732426, 241.2667573696, 287.2400907029,
      289.1734240363, 244.3048526077, 206.7302494331, 174.3656235828,
      192.533792517,  229.2110034014, 272.1990986395, 324.0224319728,
      326.1015986395, 275.4663605442, 233.0723129252, 196.564829932,
      172.3232482993, 205.1433163265, 243.6076020408, 289.973792517,
      291.8029591837, 246.4820068027, 208.5403401361, 175.8695918367,
      151.2446768707, 180.0443367347, 213.7943367347, 254.4748129252,
      256.0539795918, 216.2758843537, 182.9770748299, 154.3063265306,
      129.2980782313, 153.9140646259, 182.7593027211, 217.5254931973,
      218.8546598639, 184.8479931973, 156.3825170068, 131.8750340136};
  const std::array<int, 4> in_shape = {{3, 10, 8, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x10x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.0204081633, 0.0612244898, 0.0612244898, 0.0612244898, 0.0612244898,
      0.0612244898, 0.0612244898, 0.0408163265, 0.0816326531, 0.2040816327,
      0.2040816327, 0.2040816327, 0.2040816327, 0.2040816327, 0.2040816327,
      0.1224489796, 0.1836734694, 0.4285714286, 0.4285714286, 0.4285714286,
      0.4285714286, 0.4285714286, 0.4285714286, 0.2448979592, 0.3265306122,
      0.7346938776, 0.7346938776, 0.7346938776, 0.7346938776, 0.7346938776,
      0.7346938776, 0.4081632653, 0.3265306122, 0.7346938776, 0.7346938776,
      0.7346938776, 0.7346938776, 0.7346938776, 0.7346938776, 0.4081632653,
      0.3265306122, 0.7346938776, 0.7346938776, 0.7346938776, 0.7346938776,
      0.7346938776, 0.7346938776, 0.4081632653, 0.3265306122, 0.7346938776,
      0.7346938776, 0.7346938776, 0.7346938776, 0.7346938776, 0.7346938776,
      0.4081632653, 0.306122449,  0.6734693878, 0.6734693878, 0.6734693878,
      0.6734693878, 0.6734693878, 0.6734693878, 0.3673469388, 0.2448979592,
      0.5306122449, 0.5306122449, 0.5306122449, 0.5306122449, 0.5306122449,
      0.5306122449, 0.2857142857, 0.1428571429, 0.306122449,  0.306122449,
      0.306122449,  0.306122449,  0.306122449,  0.306122449,  0.1632653061,
      0.1836734694, 0.387755102,  0.387755102,  0.387755102,  0.387755102,
      0.387755102,  0.387755102,  0.2040816327, 0.4081632653, 0.8571428571,
      0.8571428571, 0.8571428571, 0.8571428571, 0.8571428571, 0.8571428571,
      0.4489795918, 0.6734693878, 1.4081632653, 1.4081632653, 1.4081632653,
      1.4081632653, 1.4081632653, 1.4081632653, 0.7346938776, 0.9795918367,
      2.0408163265, 2.0408163265, 2.0408163265, 2.0408163265, 2.0408163265,
      2.0408163265, 1.0612244898, 0.9795918367, 2.0408163265, 2.0408163265,
      2.0408163265, 2.0408163265, 2.0408163265, 2.0408163265, 1.0612244898,
      0.9795918367, 2.0408163265, 2.0408163265, 2.0408163265, 2.0408163265,
      2.0408163265, 2.0408163265, 1.0612244898, 0.9795918367, 2.0408163265,
      2.0408163265, 2.0408163265, 2.0408163265, 2.0408163265, 2.0408163265,
      1.0612244898, 0.7959183673, 1.6530612245, 1.6530612245, 1.6530612245,
      1.6530612245, 1.6530612245, 1.6530612245, 0.8571428571, 0.5714285714,
      1.1836734694, 1.1836734694, 1.1836734694, 1.1836734694, 1.1836734694,
      1.1836734694, 0.612244898,  0.306122449,  0.6326530612, 0.6326530612,
      0.6326530612, 0.6326530612, 0.6326530612, 0.6326530612, 0.3265306122,
      0.3469387755, 0.7142857143, 0.7142857143, 0.7142857143, 0.7142857143,
      0.7142857143, 0.7142857143, 0.3673469388, 0.7346938776, 1.5102040816,
      1.5102040816, 1.5102040816, 1.5102040816, 1.5102040816, 1.5102040816,
      0.7755102041, 1.1632653061, 2.387755102,  2.387755102,  2.387755102,
      2.387755102,  2.387755102,  2.387755102,  1.2244897959, 1.6326530612,
      3.3469387755, 3.3469387755, 3.3469387755, 3.3469387755, 3.3469387755,
      3.3469387755, 1.7142857143, 1.6326530612, 3.3469387755, 3.3469387755,
      3.3469387755, 3.3469387755, 3.3469387755, 3.3469387755, 1.7142857143,
      1.6326530612, 3.3469387755, 3.3469387755, 3.3469387755, 3.3469387755,
      3.3469387755, 3.3469387755, 1.7142857143, 1.6326530612, 3.3469387755,
      3.3469387755, 3.3469387755, 3.3469387755, 3.3469387755, 3.3469387755,
      1.7142857143, 1.2857142857, 2.6326530612, 2.6326530612, 2.6326530612,
      2.6326530612, 2.6326530612, 2.6326530612, 1.3469387755, 0.8979591837,
      1.8367346939, 1.8367346939, 1.8367346939, 1.8367346939, 1.8367346939,
      1.8367346939, 0.9387755102, 0.4693877551, 0.9591836735, 0.9591836735,
      0.9591836735, 0.9591836735, 0.9591836735, 0.9591836735, 0.4897959184};
  const std::array<int, 4> in_shape = {{3, 10, 8, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x10x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      13.7274886621,  14.3043650794,  16.9026587302,  17.5880385488,
      20.8601984127,  21.6721655329,  25.9130555556,  26.8769274376,
      28.5713888889,  29.535260771,   25.0375793651,  25.8495464853,
      21.8395634921,  22.5249433107,  18.8814002268,  19.458276644,
      21.0550396825,  21.7404195011,  25.7200056689,  26.5342970522,
      31.4632596372,  32.4279478458,  38.71611678,    39.8612811791,
      41.8744501134,  43.0196145125,  36.4263548753,  37.3910430839,
      31.5854818594,  32.3997732426,  27.1783390023,  27.8637188209,
      30.1186451247,  30.9125283447,  36.5999376417,  37.5431405896,
      44.5098582766,  45.6272675737,  54.4198582766,  55.7463151927,
      58.07819161,    59.4046485261,  50.2586678005,  51.3760770975,
      43.3939852608,  44.3371882086,  37.2113321995,  38.0052154195,
      40.9183049887,  41.82069161,    49.5424546485,  50.614569161,
      59.9999943311,  61.2701247166,  73.0242800454,  74.5320294785,
      77.1826133787,  78.6903628118,  66.5345181406,  67.8046485261,
      57.2650736961,  58.3371882086,  48.9803798186,  49.8827664399,
      54.8724716553,  55.7115646259,  66.0561451247,  67.0530612245,
      79.4720181406,  80.6530612245,  96.0129705215,  97.4149659864,
      99.8796371882,  101.2816326531, 85.5482086168,  86.7292517007,
      73.2370975057,  74.2340136054,  62.3690702948,  63.2081632653,
      71.8858049887,  72.7248979592,  86.269478458,   87.2663945578,
      103.4186848073, 104.5997278912, 124.4396371882, 125.8416326531,
      128.3063038549, 129.7082993197, 109.4948752834, 110.6759183673,
      93.450430839,   94.4473469388,  79.3824036281,  80.2214965986,
      95.4014795918,  96.3038662132,  114.2732482993, 115.3453628118,
      136.6863435374, 137.9564739229, 164.0572959184, 165.5650453515,
      168.2156292517, 169.7233786848, 143.2208673469, 144.4909977324,
      121.9958673469, 123.0679818594, 103.4635544218, 104.3659410431,
      89.8099829932,  90.6038662132,  107.5184863946, 108.4616893424,
      128.5268197279, 129.6442290249, 154.154914966,  155.4813718821,
      157.8132482993, 159.1397052154, 134.2756292517, 135.3930385488,
      114.3125340136, 115.2557369615, 96.902670068,   97.696553288,
      82.4824319728,  83.1678117914,  98.7011394558,  99.515430839,
      117.9237585034, 118.888446712,  141.3518537415, 142.4970181406,
      144.5101870748, 145.6553514739, 122.8868537415, 123.8515419501,
      104.5666156463, 105.3809070295, 88.6057312925,  89.2911111111,
      73.4188265306,  73.9957029478,  87.821207483,   88.5065873016,
      104.8771598639, 105.6891269841, 125.6481122449, 126.611984127,
      128.3064455782, 129.2703174603, 109.0545408163, 109.8665079365,
      92.7581122449,  93.4434920635,  78.5727380952,  79.1496145125,
      106.0277154195, 106.6045918367, 126.5634297052, 127.2488095238,
      150.7749376417, 151.5869047619, 180.1325566893, 181.0964285714,
      182.7908900227, 183.7547619048, 154.9523185941, 155.7642857143,
      131.5003344671, 132.1857142857, 111.1816269841, 111.7585034014,
      130.7158106576, 131.4011904762, 156.0066269841, 156.8209183673,
      185.8133730159, 186.7780612245, 221.9424206349, 223.087585034,
      225.1007539683, 226.2459183673, 190.776468254,  191.7411564626,
      161.8721031746, 162.6863945578, 136.8391099773, 137.5244897959,
      157.1399603175, 157.9338435374, 187.5124092971, 188.4556122449,
      223.295345805,  224.412755102,  266.6529648526, 267.9794217687,
      270.3112981859, 271.637755102,  229.0441553288, 230.1615646259,
      194.3064569161, 195.2496598639, 164.2326473923, 165.0265306122,
      185.3001643991, 186.2025510204, 221.080776644,  222.1528911565,
      263.2208560091, 264.4909863946, 314.2641893424, 315.7719387755,
      318.4225226757, 319.9302721088, 269.7553798186, 271.0255102041,
      228.8033956916, 229.8755102041, 193.362239229,  194.2646258503,
      189.1273469388, 189.9664399093, 225.5627210884, 226.5596371882,
      268.4389115646, 269.6199546485, 320.332244898,  321.7342403628,
      324.1989115646, 325.6009070295, 274.5151020408, 275.6961451247,
      232.7436734694, 233.7405895692, 196.6239455782, 197.4630385488,
      206.1406802721, 206.9797732426, 245.7760544218, 246.7729705215,
      292.3855782313, 293.5666213152, 348.7589115646, 350.1609070295,
      352.6255782313, 354.0275736961, 298.4617687075, 299.6428117914,
      252.9570068027, 253.9539229025, 213.6372789116, 214.4763718821,
      239.7833390023, 240.6857256236, 285.8115702948, 286.8836848073,
      339.9072052154, 341.1773356009, 405.2972052154, 406.8049546485,
      409.4555385488, 410.9632879819, 346.4417290249, 347.7118594104,
      293.5341893424, 294.6063038549, 247.8454138322, 248.7478004535,
      216.8312981859, 217.6251814059, 258.4309580499, 259.3741609977,
      307.3123072562, 308.4297165533, 366.388021542,  367.714478458,
      370.0463548753, 371.3728117914, 313.06111678,   314.1785260771,
      265.2250056689, 266.1682086168, 223.9239852608, 224.7178684807,
      192.1432029478, 192.8285827664, 228.987760771,  229.8020521542,
      272.2738718821, 273.2385600907, 324.5781575964, 325.7233219955,
      327.7364909297, 328.8816553288, 277.2369671202, 278.2016553288,
      234.8532369615, 235.6675283447, 198.2665022676, 198.9518820862,
      165.719053288,  166.2959297052, 197.481978458,  198.1673582766,
      234.791899093,  235.6038662132, 279.8676133787, 280.8314852608,
      282.525946712,  283.4898185941, 238.9692800454, 239.7812471655,
      202.41888322,   203.1042630385, 170.8729648526, 171.4498412698,
      198.3279421769, 198.9048185941, 236.2242006803, 236.9095804989,
      280.6896768707, 281.5016439909, 334.3520578231, 335.3159297052,
      337.0103911565, 337.9742630385, 284.8670578231, 285.6790249433,
      241.1611054422, 241.8464852608, 203.4818537415, 204.0587301587,
      240.3765816327, 241.0619614512, 286.2932482993, 287.1075396825,
      340.1634863946, 341.1281746032, 405.1687244898, 406.3138888889,
      408.3270578231, 409.4722222222, 345.1265816327, 346.0912698413,
      292.1587244898, 292.973015873,  246.4998809524, 247.185260771,
      284.1612755102, 284.9551587302, 338.4248809524, 339.3680839002,
      402.0808333333, 403.1982426304, 478.8860714286, 480.2125283447,
      482.5444047619, 483.870861678,  407.8296428571, 408.9470521542,
      345.2189285714, 346.1621315193, 291.253962585,  292.047845805,
      329.6820238095, 330.5844104308, 392.6190986395, 393.6912131519,
      466.4417176871, 467.7118480726, 555.5040986395, 557.0118480726,
      559.6624319728, 561.1701814059, 472.9762414966, 474.2463718821,
      400.3417176871, 401.4138321995, 337.7440986395, 338.6464852608,
      323.3822222222, 324.2213151927, 385.0692970522, 386.0662131519,
      457.4058049887, 458.5868480726, 544.6515192744, 546.0535147392,
      548.518185941,  549.9201814059, 463.4819954649, 464.6630385488,
      392.2502494331, 393.2471655329, 330.8788208617, 331.7179138322,
      340.3955555556, 341.2346485261, 405.2826303855, 406.2795464853,
      481.3524716553, 482.5335147392, 573.078185941,  574.4801814059,
      576.9448526077, 578.3468480726, 487.4286621315, 488.6097052154,
      412.4635827664, 413.4604988662, 347.892154195,  348.7312471655,
      384.1651984127, 385.067585034,  457.3498922902, 458.4220068027,
      543.1280668934, 544.3981972789, 646.5371145125, 648.0448639456,
      650.6954478458, 652.2031972789, 549.6625907029, 550.9327210884,
      465.0725113379, 466.1446258503, 392.2272732426, 393.1296598639,
      343.8526133787, 344.6464965986, 409.3434297052, 410.2866326531,
      486.0977947846, 487.2152040816, 578.6211281179, 579.947585034,
      582.2794614512, 583.6059183673, 491.8466043084, 492.9640136054,
      416.1374773243, 417.0806802721, 350.9453004535, 351.7391836735,
      301.8039739229, 302.4893537415, 359.2743820862, 360.0886734694,
      426.6239852608, 427.5886734694, 507.8044614512, 508.9496258503,
      510.9627947846, 512.1079591837, 431.5870804989, 432.5517687075,
      365.1398582766, 365.9541496599, 307.9272732426, 308.6126530612,
      258.0192800454, 258.5961564626, 307.1427494331, 307.8281292517,
      364.706638322,  365.5186054422, 434.0871145125, 435.0509863946,
      436.7454478458, 437.7093197279, 368.8840192744, 369.6959863946,
      312.079654195,  312.7650340136, 263.17319161,   263.7500680272};
  const std::array<int, 4> in_shape = {{3, 10, 8, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x10x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.0204081633, 0.0408163265, 0.0816326531, 0.1224489796, 0.0816326531,
      0.1224489796, 0.0816326531, 0.1224489796, 0.0816326531, 0.1224489796,
      0.0816326531, 0.1224489796, 0.0816326531, 0.1224489796, 0.0612244898,
      0.0816326531, 0.1224489796, 0.1632653061, 0.3265306122, 0.4081632653,
      0.3265306122, 0.4081632653, 0.3265306122, 0.4081632653, 0.3265306122,
      0.4081632653, 0.3265306122, 0.4081632653, 0.3265306122, 0.4081632653,
      0.2040816327, 0.2448979592, 0.306122449,  0.3673469388, 0.7346938776,
      0.8571428571, 0.7346938776, 0.8571428571, 0.7346938776, 0.8571428571,
      0.7346938776, 0.8571428571, 0.7346938776, 0.8571428571, 0.7346938776,
      0.8571428571, 0.4285714286, 0.4897959184, 0.5714285714, 0.6530612245,
      1.306122449,  1.4693877551, 1.306122449,  1.4693877551, 1.306122449,
      1.4693877551, 1.306122449,  1.4693877551, 1.306122449,  1.4693877551,
      1.306122449,  1.4693877551, 0.7346938776, 0.8163265306, 0.5714285714,
      0.6530612245, 1.306122449,  1.4693877551, 1.306122449,  1.4693877551,
      1.306122449,  1.4693877551, 1.306122449,  1.4693877551, 1.306122449,
      1.4693877551, 1.306122449,  1.4693877551, 0.7346938776, 0.8163265306,
      0.5714285714, 0.6530612245, 1.306122449,  1.4693877551, 1.306122449,
      1.4693877551, 1.306122449,  1.4693877551, 1.306122449,  1.4693877551,
      1.306122449,  1.4693877551, 1.306122449,  1.4693877551, 0.7346938776,
      0.8163265306, 0.5714285714, 0.6530612245, 1.306122449,  1.4693877551,
      1.306122449,  1.4693877551, 1.306122449,  1.4693877551, 1.306122449,
      1.4693877551, 1.306122449,  1.4693877551, 1.306122449,  1.4693877551,
      0.7346938776, 0.8163265306, 0.5510204082, 0.612244898,  1.2244897959,
      1.3469387755, 1.2244897959, 1.3469387755, 1.2244897959, 1.3469387755,
      1.2244897959, 1.3469387755, 1.2244897959, 1.3469387755, 1.2244897959,
      1.3469387755, 0.6734693878, 0.7346938776, 0.4489795918, 0.4897959184,
      0.9795918367, 1.0612244898, 0.9795918367, 1.0612244898, 0.9795918367,
      1.0612244898, 0.9795918367, 1.0612244898, 0.9795918367, 1.0612244898,
      0.9795918367, 1.0612244898, 0.5306122449, 0.5714285714, 0.2653061224,
      0.2857142857, 0.5714285714, 0.612244898,  0.5714285714, 0.612244898,
      0.5714285714, 0.612244898,  0.5714285714, 0.612244898,  0.5714285714,
      0.612244898,  0.5714285714, 0.612244898,  0.306122449,  0.3265306122,
      0.3469387755, 0.3673469388, 0.7346938776, 0.7755102041, 0.7346938776,
      0.7755102041, 0.7346938776, 0.7755102041, 0.7346938776, 0.7755102041,
      0.7346938776, 0.7755102041, 0.7346938776, 0.7755102041, 0.387755102,
      0.4081632653, 0.7755102041, 0.8163265306, 1.6326530612, 1.7142857143,
      1.6326530612, 1.7142857143, 1.6326530612, 1.7142857143, 1.6326530612,
      1.7142857143, 1.6326530612, 1.7142857143, 1.6326530612, 1.7142857143,
      0.8571428571, 0.8979591837, 1.2857142857, 1.3469387755, 2.693877551,
      2.8163265306, 2.693877551,  2.8163265306, 2.693877551,  2.8163265306,
      2.693877551,  2.8163265306, 2.693877551,  2.8163265306, 2.693877551,
      2.8163265306, 1.4081632653, 1.4693877551, 1.8775510204, 1.9591836735,
      3.9183673469, 4.0816326531, 3.9183673469, 4.0816326531, 3.9183673469,
      4.0816326531, 3.9183673469, 4.0816326531, 3.9183673469, 4.0816326531,
      3.9183673469, 4.0816326531, 2.0408163265, 2.1224489796, 1.8775510204,
      1.9591836735, 3.9183673469, 4.0816326531, 3.9183673469, 4.0816326531,
      3.9183673469, 4.0816326531, 3.9183673469, 4.0816326531, 3.9183673469,
      4.0816326531, 3.9183673469, 4.0816326531, 2.0408163265, 2.1224489796,
      1.8775510204, 1.9591836735, 3.9183673469, 4.0816326531, 3.9183673469,
      4.0816326531, 3.9183673469, 4.0816326531, 3.9183673469, 4.0816326531,
      3.9183673469, 4.0816326531, 3.9183673469, 4.0816326531, 2.0408163265,
      2.1224489796, 1.8775510204, 1.9591836735, 3.9183673469, 4.0816326531,
      3.9183673469, 4.0816326531, 3.9183673469, 4.0816326531, 3.9183673469,
      4.0816326531, 3.9183673469, 4.0816326531, 3.9183673469, 4.0816326531,
      2.0408163265, 2.1224489796, 1.5306122449, 1.5918367347, 3.1836734694,
      3.306122449,  3.1836734694, 3.306122449,  3.1836734694, 3.306122449,
      3.1836734694, 3.306122449,  3.1836734694, 3.306122449,  3.1836734694,
      3.306122449,  1.6530612245, 1.7142857143, 1.1020408163, 1.1428571429,
      2.2857142857, 2.3673469388, 2.2857142857, 2.3673469388, 2.2857142857,
      2.3673469388, 2.2857142857, 2.3673469388, 2.2857142857, 2.3673469388,
      2.2857142857, 2.3673469388, 1.1836734694, 1.2244897959, 0.5918367347,
      0.612244898,  1.2244897959, 1.2653061224, 1.2244897959, 1.2653061224,
      1.2244897959, 1.2653061224, 1.2244897959, 1.2653061224, 1.2244897959,
      1.2653061224, 1.2244897959, 1.2653061224, 0.6326530612, 0.6530612245,
      0.6734693878, 0.693877551,  1.387755102,  1.4285714286, 1.387755102,
      1.4285714286, 1.387755102,  1.4285714286, 1.387755102,  1.4285714286,
      1.387755102,  1.4285714286, 1.387755102,  1.4285714286, 0.7142857143,
      0.7346938776, 1.4285714286, 1.4693877551, 2.9387755102, 3.0204081633,
      2.9387755102, 3.0204081633, 2.9387755102, 3.0204081633, 2.9387755102,
      3.0204081633, 2.9387755102, 3.0204081633, 2.9387755102, 3.0204081633,
      1.5102040816, 1.5510204082, 2.2653061224, 2.3265306122, 4.6530612245,
      4.7755102041, 4.6530612245, 4.7755102041, 4.6530612245, 4.7755102041,
      4.6530612245, 4.7755102041, 4.6530612245, 4.7755102041, 4.6530612245,
      4.7755102041, 2.387755102,  2.4489795918, 3.1836734694, 3.2653061224,
      6.5306122449, 6.693877551,  6.5306122449, 6.693877551,  6.5306122449,
      6.693877551,  6.5306122449, 6.693877551,  6.5306122449, 6.693877551,
      6.5306122449, 6.693877551,  3.3469387755, 3.4285714286, 3.1836734694,
      3.2653061224, 6.5306122449, 6.693877551,  6.5306122449, 6.693877551,
      6.5306122449, 6.693877551,  6.5306122449, 6.693877551,  6.5306122449,
      6.693877551,  6.5306122449, 6.693877551,  3.3469387755, 3.4285714286,
      3.1836734694, 3.2653061224, 6.5306122449, 6.693877551,  6.5306122449,
      6.693877551,  6.5306122449, 6.693877551,  6.5306122449, 6.693877551,
      6.5306122449, 6.693877551,  6.5306122449, 6.693877551,  3.3469387755,
      3.4285714286, 3.1836734694, 3.2653061224, 6.5306122449, 6.693877551,
      6.5306122449, 6.693877551,  6.5306122449, 6.693877551,  6.5306122449,
      6.693877551,  6.5306122449, 6.693877551,  6.5306122449, 6.693877551,
      3.3469387755, 3.4285714286, 2.5102040816, 2.5714285714, 5.1428571429,
      5.2653061224, 5.1428571429, 5.2653061224, 5.1428571429, 5.2653061224,
      5.1428571429, 5.2653061224, 5.1428571429, 5.2653061224, 5.1428571429,
      5.2653061224, 2.6326530612, 2.693877551,  1.7551020408, 1.7959183673,
      3.5918367347, 3.6734693878, 3.5918367347, 3.6734693878, 3.5918367347,
      3.6734693878, 3.5918367347, 3.6734693878, 3.5918367347, 3.6734693878,
      3.5918367347, 3.6734693878, 1.8367346939, 1.8775510204, 0.9183673469,
      0.9387755102, 1.8775510204, 1.9183673469, 1.8775510204, 1.9183673469,
      1.8775510204, 1.9183673469, 1.8775510204, 1.9183673469, 1.8775510204,
      1.9183673469, 1.8775510204, 1.9183673469, 0.9591836735, 0.9795918367};
  const std::array<int, 4> in_shape = {{3, 10, 8, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x10x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      26.878100907,    27.4549773243,   28.0318537415,   28.6087301587,
      33.1199376417,   33.8053174603,   34.4906972789,   35.1760770975,
      40.9084297052,   41.7203968254,   42.5323639456,   43.3443310658,
      50.862239229,    51.8261111111,   52.7899829932,   53.7538548753,
      56.1789058957,   57.1427777778,   58.1066496599,   59.070521542,
      49.26319161,     50.0751587302,   50.8871258503,   51.6990929705,
      42.9937471655,   43.6791269841,   44.3645068027,   45.0498866213,
      37.1859240363,   37.7628004535,   38.3396768707,   38.916553288,
      41.4246995465,   42.1100793651,   42.7954591837,   43.4808390023,
      50.6257199546,   51.4400113379,   52.2543027211,   53.0685941043,
      61.9618310658,   62.9265192744,   63.891207483,    64.8558956916,
      76.287069161,    77.4322335601,   78.5773979592,   79.7225623583,
      82.6037358277,   83.7489002268,   84.8940646259,   86.0392290249,
      71.888021542,    72.8527097506,   73.8173979592,   74.7820861678,
      62.3566723356,   63.1709637188,   63.985255102,    64.7995464853,
      53.6712981859,   54.3566780045,   55.0420578231,   55.7274376417,
      59.4434070295,   60.2372902494,   61.0311734694,   61.8250566893,
      72.2566723356,   73.1998752834,   74.1430782313,   75.0862811791,
      87.9023072562,   89.0197165533,   90.1371258503,   91.2545351474,
      107.5132596372,  108.8397165533,  110.1661734694,  111.4926303855,
      114.8299263039,  116.15638322,    117.4828401361,  118.8092970522,
      99.3999263039,   100.5173356009,  101.634744898,   102.752154195,
      85.8447675737,   86.7879705215,   87.7311734694,   88.6743764172,
      73.6287811791,   74.4226643991,   75.216547619,    76.010430839,
      80.934223356,    81.8366099773,   82.7389965986,   83.64138322,
      98.0127947846,   99.0849092971,   100.1570238095,  101.229138322,
      118.7298582766,  119.9999886621,  121.2701190476,  122.5402494331,
      144.5408106576,  146.0485600907,  147.5563095238,  149.0640589569,
      152.8574773243,  154.3652267574,  155.8729761905,  157.3807256236,
      131.7989058957,  133.0690362812,  134.3391666667,  135.6092970522,
      113.4580328798,  114.5301473923,  115.6022619048,  116.6743764172,
      97.0583730159,   97.9607596372,   98.8631462585,   99.7655328798,
      108.9058503401,  109.7449433107,  110.5840362812,  111.4231292517,
      131.1153741497,  132.1122902494,  133.1092063492,  134.106122449,
      157.7629931973,  158.9440362812,  160.1250793651,  161.306122449,
      190.6239455782,  192.0259410431,  193.4279365079,  194.8299319728,
      198.3572789116,  199.7592743764,  201.1612698413,  202.5632653061,
      169.9153741497,  171.0964172336,  172.2774603175,  173.4585034014,
      145.4772789116,  146.4741950113,  147.4711111111,  148.4680272109,
      123.899047619,   124.7381405896,  125.5772335601,  126.4163265306,
      142.9325170068,  143.7716099773,  144.6107029478,  145.4497959184,
      171.5420408163,  172.5389569161,  173.5358730159,  174.5327891156,
      205.6563265306,  206.8373696145,  208.0184126984,  209.1994557823,
      247.4772789116,  248.8792743764,  250.2812698413,  251.6832653061,
      255.2106122449,  256.6126077098,  258.0146031746,  259.4165986395,
      217.808707483,   218.9897505669,  220.1707936508,  221.3518367347,
      185.9039455782,  186.900861678,   187.8977777778,  188.8946938776,
      157.9257142857,  158.7648072562,  159.6039002268,  160.4429931973,
      189.9005725624,  190.8029591837,  191.705345805,   192.6077324263,
      227.4743820862,  228.5464965986,  229.6186111111,  230.6907256236,
      272.1025566893,  273.3726870748,  274.6428174603,  275.9129478458,
      326.6068424036,  328.1145918367,  329.6223412698,  331.1300907029,
      334.9235090703,  336.4312585034,  337.9390079365,  339.4467573696,
      285.1716043084,  286.4417346939,  287.7118650794,  288.9819954649,
      242.9196201814,  243.9917346939,  245.0638492063,  246.1359637188,
      206.0247222222,  206.9271088435,  207.8294954649,  208.7318820862,
      178.8260827664,  179.6199659864,  180.4138492063,  181.2077324263,
      214.0937698413,  215.0369727891,  215.980175737,   216.9233786848,
      255.9362301587,  257.0536394558,  258.1710487528,  259.2884580499,
      306.9833730159,  308.309829932,   309.6362868481,  310.9627437642,
      314.3000396825,  315.6264965986,  316.9529535147,  318.2794104308,
      267.4338492063,  268.5512585034,  269.6686678005,  270.7860770975,
      227.6818650794,  228.6250680272,  229.5682709751,  230.5114739229,
      193.0114569161,  193.8053401361,  194.599223356,   195.393106576,
      164.279484127,   164.9648639456,  165.6502437642,  166.3356235828,
      196.5879875283,  197.4022789116,  198.2165702948,  199.030861678,
      234.8828287982,  235.8475170068,  236.8122052154,  237.776893424,
      281.5585430839,  282.703707483,   283.8488718821,  284.9940362812,
      287.8752097506,  289.0203741497,  290.1655385488,  291.3107029478,
      244.8090192744,  245.773707483,   246.7383956916,  247.7030839002,
      208.3189399093,  209.1332312925,  209.9475226757,  210.761814059,
      176.5260827664,  177.211462585,   177.8968424036,  178.5822222222,
      146.260776644,   146.8376530612,  147.4145294785,  147.9914058957,
      174.9570351474,  175.642414966,   176.3277947846,  177.0131746032,
      208.9423526077,  209.7543197279,  210.5662868481,  211.3782539683,
      250.3323526077,  251.2962244898,  252.2600963719,  253.223968254,
      255.6490192744,  256.6128911565,  257.5767630385,  258.5406349206,
      217.2971145125,  218.1090816327,  218.9210487528,  219.733015873,
      184.8308446712,  185.5162244898,  186.2016043084,  186.886984127,
      156.5685997732,  157.1454761905,  157.7223526077,  158.2992290249,
      211.4785544218,  212.055430839,   212.6323072562,  213.2091836735,
      252.4414795918,  253.1268594104,  253.812239229,   254.4976190476,
      300.7379081633,  301.5498752834,  302.3618424036,  303.1738095238,
      359.3012414966,  360.2651133787,  361.2289852608,  362.1928571429,
      364.6179081633,  365.5817800454,  366.5456519274,  367.5095238095,
      309.092670068,   309.9046371882,  310.7166043084,  311.5285714286,
      262.3152891156,  263.0006689342,  263.6860487528,  264.3714285714,
      221.786377551,   222.3632539683,  222.9401303855,  223.5170068027,
      260.7462414966,  261.4316213152,  262.1170011338,  262.8023809524,
      311.198962585,   312.0132539683,  312.8275453515,  313.6418367347,
      370.6620578231,  371.6267460317,  372.5914342404,  373.556122449,
      442.7396768707,  443.8848412698,  445.0300056689,  446.175170068,
      449.0563435374,  450.2015079365,  451.3466723356,  452.4918367347,
      380.5882482993,  381.5529365079,  382.5176247166,  383.4823129252,
      322.929914966,   323.7442063492,  324.5584977324,  325.3727891156,
      272.9928401361,  273.6782199546,  274.3635997732,  275.0489795918,
      313.486037415,   314.2799206349,  315.0738038549,  315.8676870748,
      374.0816156463,  375.0248185941,  375.968021542,   376.9112244898,
      445.4732823129,  446.59069161,    447.708100907,   448.8255102041,
      531.9794727891,  533.3059297052,  534.6323866213,  535.9588435374,
      539.2961394558,  540.6225963719,  541.949053288,   543.2755102041,
      456.9709013605,  458.0883106576,  459.2057199546,  460.3231292517,
      387.6697108844,  388.6129138322,  389.55611678,    390.4993197279,
      327.6714115646,  328.4652947846,  329.2591780045,  330.0530612245,
      369.6979421769,  370.6003287982,  371.5027154195,  372.4051020408,
      441.0894387755,  442.161553288,   443.2336678005,  444.3057823129,
      525.1715816327,  526.4417120181,  527.7118424036,  528.9819727891,
      627.0206292517,  628.5283786848,  630.0361281179,  631.543877551,
      635.3372959184,  636.8450453515,  638.3527947846,  639.8605442177,
      538.2406292517,  539.5107596372,  540.7808900227,  542.0510204082,
      456.5346768707,  457.6067913832,  458.6789058957,  459.7510204082,
      385.8220918367,  386.724478458,   387.6268650794,  388.5292517007,
      377.415600907,   378.2546938776,  379.0937868481,  379.9328798186,
      450.1285260771,  451.1254421769,  452.1223582766,  453.1192743764,
      535.6967800454,  536.8778231293,  538.0588662132,  539.2399092971,
      639.2624943311,  640.6644897959,  642.0664852608,  643.4684807256,
      646.9958276644,  648.3978231293,  649.7998185941,  651.201814059,
      547.8491609977,  549.0302040816,  550.2112471655,  551.3922902494,
      464.490430839,   465.4873469388,  466.4842630385,  467.4811791383,
      392.4087981859,  393.2478911565,  394.086984127,   394.9260770975,
      411.4422675737,  412.2813605442,  413.1204535147,  413.9595464853,
      490.5551927438,  491.5521088435,  492.5490249433,  493.5459410431,
      583.5901133787,  584.7711564626,  585.9521995465,  587.1332426304,
      696.1158276644,  697.5178231293,  698.9198185941,  700.321814059,
      703.8491609977,  705.2511564626,  706.6531519274,  708.0551473923,
      595.7424943311,  596.923537415,   598.1045804989,  599.2856235828,
      504.9170975057,  505.9140136054,  506.9109297052,  507.907845805,
      426.4354648526,  427.2745578231,  428.1136507937,  428.9527437642,
      478.6642913832,  479.5666780045,  480.4690646259,  481.3714512472,
      570.5510260771,  571.6231405896,  572.695255102,   573.7673696145,
      678.5442800454,  679.8144104308,  681.0845408163,  682.3546712018,
      809.0866609977,  810.5944104308,  812.1021598639,  813.6099092971,
      817.4033276644,  818.9110770975,  820.4188265306,  821.9265759637,
      691.6133276644,  692.8834580499,  694.1535884354,  695.4237188209,
      585.9962641723,  587.0683786848,  588.1404931973,  589.2126077098,
      494.7884410431,  495.6908276644,  496.5932142857,  497.495600907,
      432.8687131519,  433.6625963719,  434.4564795918,  435.2503628118,
      515.9187131519,  516.8619160998,  517.8051190476,  518.7483219955,
      613.5072052154,  614.6246145125,  615.7420238095,  616.8594331066,
      731.4495861678,  732.7760430839,  734.1025,        735.4289569161,
      738.7662528345,  740.0927097506,  741.4191666667,  742.7456235828,
      625.004824263,   626.1222335601,  627.2396428571,  628.3570521542,
      529.50680839,    530.4500113379,  531.3932142857,  532.3364172336,
      447.0540873016,  447.8479705215,  448.6418537415,  449.4357369615,
      383.6010260771,  384.2864058957,  384.9717857143,  385.6571655329,
      457.1612301587,  457.975521542,   458.7898129252,  459.6041043084,
      543.5830555556,  544.5477437642,  545.5124319728,  546.4771201814,
      648.0111507937,  649.1563151927,  650.3014795918,  651.4466439909,
      654.3278174603,  655.4729818594,  656.6181462585,  657.7633106576,
      553.5092460317,  554.4739342404,  555.438622449,   556.4033106576,
      468.8921825397,  469.7064739229,  470.5207653061,  471.3350566893,
      395.8476247166,  396.5330045351,  397.2183843537,  397.9037641723,
      330.8612301587,  331.438106576,   332.0149829932,  332.5918594104,
      394.2785770975,  394.9639569161,  395.6493367347,  396.3347165533,
      468.7718310658,  469.5837981859,  470.3957653061,  471.2077324263,
      558.7713548753,  559.7352267574,  560.6990986395,  561.6629705215,
      564.0880215419,  565.051893424,   566.0157653061,  566.9796371882,
      477.1265929705,  477.9385600907,  478.7505272109,  479.5624943311,
      404.1523866213,  404.8377664399,  405.5231462585,  406.2085260771,
      341.169053288,   341.7459297052,  342.3228061224,  342.8996825397,
      396.0790079365,  396.6558843537,  397.232760771,   397.8096371882,
      471.763021542,   472.4484013605,  473.1337811791,  473.8191609977,
      560.5673866213,  561.3793537415,  562.1913208617,  563.0032879819,
      667.7402437642,  668.7041156463,  669.6679875283,  670.6318594104,
      673.0569104308,  674.0207823129,  674.984654195,   675.9485260771,
      568.9221485261,  569.7341156463,  570.5460827664,  571.3580498866,
      481.6368310658,  482.3222108844,  483.0075907029,  483.6929705215,
      406.3868310658,  406.963707483,   407.5405839002,  408.1174603175,
      480.0677834467,  480.7531632653,  481.4385430839,  482.1239229025,
      571.7722052154,  572.5864965986,  573.4007879819,  574.2150793651,
      679.3622845805,  680.3269727891,  681.2916609977,  682.2563492063,
      809.1922845805,  810.3374489796,  811.4826133787,  812.6277777778,
      815.5089512472,  816.6541156463,  817.7992800454,  818.9444444444,
      689.2884750567,  690.2531632653,  691.2178514739,  692.1825396825,
      583.5031575964,  584.3174489796,  585.1317403628,  585.946031746,
      492.3143820862,  492.9997619048,  493.6851417234,  494.370521542,
      567.5286678005,  568.3225510204,  569.1164342404,  569.9103174603,
      675.9065589569,  676.8497619048,  677.7929648526,  678.7361678005,
      803.0442573696,  804.1616666667,  805.2790759637,  806.3964852608,
      956.445685941,   957.7721428571,  959.0985997732,  960.4250566893,
      963.7623526077,  965.0888095238,  966.4152664399,  967.741723356,
      814.5418764172,  815.6592857143,  816.7766950113,  817.8941043084,
      689.494654195,   690.4378571429,  691.3810600907,  692.3242630385,
      581.7140419501,  582.5079251701,  583.30180839,    584.09569161,
      658.4616609977,  659.364047619,   660.2664342404,  661.1688208617,
      784.1660827664,  785.2381972789,  786.3103117914,  787.3824263039,
      931.6133049887,  932.8834353742,  934.1535657596,  935.4236961451,
      1109.5004478458, 1111.0081972789, 1112.515946712,  1114.0236961451,
      1117.8171145125, 1119.3248639456, 1120.8326133787, 1122.3403628118,
      944.6823526077,  945.9524829932,  947.2226133787,  948.4927437642,
      799.6113208617,  800.6834353741,  801.7555498866,  802.8276643991,
      674.5858106576,  675.4881972789,  676.3905839002,  677.2929705215,
      645.9253514739,  646.7644444444,  647.603537415,   648.4426303855,
      769.1416780045,  770.1385941043,  771.1355102041,  772.1324263039,
      913.6305668934,  914.8116099773,  915.9926530612,  917.1736961451,
      1087.9010430839, 1089.3030385488, 1090.7050340136, 1092.1070294785,
      1095.6343764172, 1097.0363718821, 1098.4383673469, 1099.8403628118,
      925.7829478458,  926.9639909297,  928.1450340136,  929.3260770975,
      783.5035827664,  784.5004988662,  785.497414966,   786.4943310658,
      660.9185487528,  661.7576417234,  662.5967346939,  663.4358276644,
      679.9520181406,  680.7911111111,  681.6302040816,  682.4692970522,
      809.5683446712,  810.565260771,   811.5621768707,  812.5590929705,
      961.5239002268,  962.7049433107,  963.8859863946,  965.0670294785,
      1144.7543764172, 1146.1563718821, 1147.5583673469, 1148.9603628118,
      1152.4877097506, 1153.8897052154, 1155.2917006803, 1156.6936961451,
      973.6762811791,  974.857324263,   976.0383673469,  977.2194104308,
      823.9302494331,  824.9271655329,  825.9240816327,  826.9209977324,
      694.9452154195,  695.78430839,    696.6234013605,  697.4624943311,
      767.4280102041,  768.3303968254,  769.2327834467,  770.135170068,
      913.627670068,   914.6997845805,  915.771899093,   916.8440136054,
      1084.9860034014, 1086.2561337868, 1087.5262641723, 1088.7963945578,
      1291.5664795918, 1293.0742290249, 1294.581978458,  1296.0897278912,
      1299.8831462585, 1301.3908956916, 1302.8986451247, 1304.4063945578,
      1098.0550510204, 1099.3251814059, 1100.5953117914, 1101.8654421769,
      929.0729081633,  930.1450226757,  931.2171371882,  932.2892517007,
      783.5521598639,  784.4545464853,  785.3569331066,  786.2593197279,
      686.9113435374,  687.7052267574,  688.4991099773,  689.2929931973,
      817.7436564626,  818.6868594104,  819.6300623583,  820.5732653061,
      971.0781802721,  972.1955895692,  973.3129988662,  974.4304081633,
      1155.9157993197, 1157.2422562358, 1158.5687131519, 1159.895170068,
      1163.2324659864, 1164.5589229025, 1165.8853798186, 1167.2118367347,
      982.5757993197,  983.6932086168,  984.8106179138,  985.9280272109,
      831.3317517007,  832.2749546485,  833.2181575964,  834.1613605442,
      701.0967176871,  701.890600907,   702.684484127,   703.4783673469,
      602.9225680272,  603.6079478458,  604.2933276644,  604.978707483,
      717.7344727891,  718.5487641723,  719.3630555556,  720.1773469388,
      852.2832823129,  853.2479705215,  854.2126587302,  855.1773469388,
      1014.4637585034, 1015.6089229025, 1016.7540873016, 1017.8992517007,
      1020.7804251701, 1021.9255895692, 1023.0707539683, 1024.2159183673,
      862.2094727891,  863.1741609977,  864.1388492063,  865.103537415,
      729.4654251701,  730.2797165533,  731.0940079365,  731.9082993197,
      615.1691666667,  615.8545464853,  616.5399263039,  617.2253061224,
      515.4616836735,  516.0385600907,  516.6154365079,  517.1923129252,
      613.6001190476,  614.2854988662,  614.9708786848,  615.6562585034,
      728.6013095238,  729.413276644,   730.2252437642,  731.0372108844,
      867.2103571429,  868.1742290249,  869.138100907,   870.1019727891,
      872.5270238095,  873.4908956916,  874.4547675737,  875.4186394558,
      736.9560714286,  737.7680385488,  738.5800056689,  739.3919727891,
      623.4739285714,  624.15930839,    624.8446882086,  625.5300680272,
      525.7695068027,  526.34638322,    526.9232596372,  527.5001360544};
  const std::array<int, 4> in_shape = {{3, 10, 8, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x10x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.0204081633,
                                         0.0408163265,
                                         0.0612244898,
                                         0.0816326531,
                                         0.1224489796,
                                         0.1632653061,
                                         0.2040816327,
                                         0.2448979592,
                                         0.1224489796,
                                         0.1632653061,
                                         0.2040816327,
                                         0.2448979592,
                                         0.1224489796,
                                         0.1632653061,
                                         0.2040816327,
                                         0.2448979592,
                                         0.1224489796,
                                         0.1632653061,
                                         0.2040816327,
                                         0.2448979592,
                                         0.1224489796,
                                         0.1632653061,
                                         0.2040816327,
                                         0.2448979592,
                                         0.1224489796,
                                         0.1632653061,
                                         0.2040816327,
                                         0.2448979592,
                                         0.1020408163,
                                         0.1224489796,
                                         0.1428571429,
                                         0.1632653061,
                                         0.2040816327,
                                         0.2448979592,
                                         0.2857142857,
                                         0.3265306122,
                                         0.5714285714,
                                         0.6530612245,
                                         0.7346938776,
                                         0.8163265306,
                                         0.5714285714,
                                         0.6530612245,
                                         0.7346938776,
                                         0.8163265306,
                                         0.5714285714,
                                         0.6530612245,
                                         0.7346938776,
                                         0.8163265306,
                                         0.5714285714,
                                         0.6530612245,
                                         0.7346938776,
                                         0.8163265306,
                                         0.5714285714,
                                         0.6530612245,
                                         0.7346938776,
                                         0.8163265306,
                                         0.5714285714,
                                         0.6530612245,
                                         0.7346938776,
                                         0.8163265306,
                                         0.3673469388,
                                         0.4081632653,
                                         0.4489795918,
                                         0.4897959184,
                                         0.5510204082,
                                         0.612244898,
                                         0.6734693878,
                                         0.7346938776,
                                         1.3469387755,
                                         1.4693877551,
                                         1.5918367347,
                                         1.7142857143,
                                         1.3469387755,
                                         1.4693877551,
                                         1.5918367347,
                                         1.7142857143,
                                         1.3469387755,
                                         1.4693877551,
                                         1.5918367347,
                                         1.7142857143,
                                         1.3469387755,
                                         1.4693877551,
                                         1.5918367347,
                                         1.7142857143,
                                         1.3469387755,
                                         1.4693877551,
                                         1.5918367347,
                                         1.7142857143,
                                         1.3469387755,
                                         1.4693877551,
                                         1.5918367347,
                                         1.7142857143,
                                         0.7959183673,
                                         0.8571428571,
                                         0.9183673469,
                                         0.9795918367,
                                         1.0612244898,
                                         1.1428571429,
                                         1.2244897959,
                                         1.306122449,
                                         2.4489795918,
                                         2.612244898,
                                         2.7755102041,
                                         2.9387755102,
                                         2.4489795918,
                                         2.612244898,
                                         2.7755102041,
                                         2.9387755102,
                                         2.4489795918,
                                         2.612244898,
                                         2.7755102041,
                                         2.9387755102,
                                         2.4489795918,
                                         2.612244898,
                                         2.7755102041,
                                         2.9387755102,
                                         2.4489795918,
                                         2.612244898,
                                         2.7755102041,
                                         2.9387755102,
                                         2.4489795918,
                                         2.612244898,
                                         2.7755102041,
                                         2.9387755102,
                                         1.387755102,
                                         1.4693877551,
                                         1.5510204082,
                                         1.6326530612,
                                         1.0612244898,
                                         1.1428571429,
                                         1.2244897959,
                                         1.306122449,
                                         2.4489795918,
                                         2.612244898,
                                         2.7755102041,
                                         2.9387755102,
                                         2.4489795918,
                                         2.612244898,
                                         2.7755102041,
                                         2.9387755102,
                                         2.4489795918,
                                         2.612244898,
                                         2.7755102041,
                                         2.9387755102,
                                         2.4489795918,
                                         2.612244898,
                                         2.7755102041,
                                         2.9387755102,
                                         2.4489795918,
                                         2.612244898,
                                         2.7755102041,
                                         2.9387755102,
                                         2.4489795918,
                                         2.612244898,
                                         2.7755102041,
                                         2.9387755102,
                                         1.387755102,
                                         1.4693877551,
                                         1.5510204082,
                                         1.6326530612,
                                         1.0612244898,
                                         1.1428571429,
                                         1.2244897959,
                                         1.306122449,
                                         2.4489795918,
                                         2.612244898,
                                         2.7755102041,
                                         2.9387755102,
                                         2.4489795918,
                                         2.612244898,
                                         2.7755102041,
                                         2.9387755102,
                                         2.4489795918,
                                         2.612244898,
                                         2.7755102041,
                                         2.9387755102,
                                         2.4489795918,
                                         2.612244898,
                                         2.7755102041,
                                         2.9387755102,
                                         2.4489795918,
                                         2.612244898,
                                         2.7755102041,
                                         2.9387755102,
                                         2.4489795918,
                                         2.612244898,
                                         2.7755102041,
                                         2.9387755102,
                                         1.387755102,
                                         1.4693877551,
                                         1.5510204082,
                                         1.6326530612,
                                         1.0612244898,
                                         1.1428571429,
                                         1.2244897959,
                                         1.306122449,
                                         2.4489795918,
                                         2.612244898,
                                         2.7755102041,
                                         2.9387755102,
                                         2.4489795918,
                                         2.612244898,
                                         2.7755102041,
                                         2.9387755102,
                                         2.4489795918,
                                         2.612244898,
                                         2.7755102041,
                                         2.9387755102,
                                         2.4489795918,
                                         2.612244898,
                                         2.7755102041,
                                         2.9387755102,
                                         2.4489795918,
                                         2.612244898,
                                         2.7755102041,
                                         2.9387755102,
                                         2.4489795918,
                                         2.612244898,
                                         2.7755102041,
                                         2.9387755102,
                                         1.387755102,
                                         1.4693877551,
                                         1.5510204082,
                                         1.6326530612,
                                         1.0408163265,
                                         1.1020408163,
                                         1.1632653061,
                                         1.2244897959,
                                         2.3265306122,
                                         2.4489795918,
                                         2.5714285714,
                                         2.693877551,
                                         2.3265306122,
                                         2.4489795918,
                                         2.5714285714,
                                         2.693877551,
                                         2.3265306122,
                                         2.4489795918,
                                         2.5714285714,
                                         2.693877551,
                                         2.3265306122,
                                         2.4489795918,
                                         2.5714285714,
                                         2.693877551,
                                         2.3265306122,
                                         2.4489795918,
                                         2.5714285714,
                                         2.693877551,
                                         2.3265306122,
                                         2.4489795918,
                                         2.5714285714,
                                         2.693877551,
                                         1.2857142857,
                                         1.3469387755,
                                         1.4081632653,
                                         1.4693877551,
                                         0.8571428571,
                                         0.8979591837,
                                         0.9387755102,
                                         0.9795918367,
                                         1.8775510204,
                                         1.9591836735,
                                         2.0408163265,
                                         2.1224489796,
                                         1.8775510204,
                                         1.9591836735,
                                         2.0408163265,
                                         2.1224489796,
                                         1.8775510204,
                                         1.9591836735,
                                         2.0408163265,
                                         2.1224489796,
                                         1.8775510204,
                                         1.9591836735,
                                         2.0408163265,
                                         2.1224489796,
                                         1.8775510204,
                                         1.9591836735,
                                         2.0408163265,
                                         2.1224489796,
                                         1.8775510204,
                                         1.9591836735,
                                         2.0408163265,
                                         2.1224489796,
                                         1.0204081633,
                                         1.0612244898,
                                         1.1020408163,
                                         1.1428571429,
                                         0.5102040816,
                                         0.5306122449,
                                         0.5510204082,
                                         0.5714285714,
                                         1.1020408163,
                                         1.1428571429,
                                         1.1836734694,
                                         1.2244897959,
                                         1.1020408163,
                                         1.1428571429,
                                         1.1836734694,
                                         1.2244897959,
                                         1.1020408163,
                                         1.1428571429,
                                         1.1836734694,
                                         1.2244897959,
                                         1.1020408163,
                                         1.1428571429,
                                         1.1836734694,
                                         1.2244897959,
                                         1.1020408163,
                                         1.1428571429,
                                         1.1836734694,
                                         1.2244897959,
                                         1.1020408163,
                                         1.1428571429,
                                         1.1836734694,
                                         1.2244897959,
                                         0.5918367347,
                                         0.612244898,
                                         0.6326530612,
                                         0.6530612245,
                                         0.6734693878,
                                         0.693877551,
                                         0.7142857143,
                                         0.7346938776,
                                         1.4285714286,
                                         1.4693877551,
                                         1.5102040816,
                                         1.5510204082,
                                         1.4285714286,
                                         1.4693877551,
                                         1.5102040816,
                                         1.5510204082,
                                         1.4285714286,
                                         1.4693877551,
                                         1.5102040816,
                                         1.5510204082,
                                         1.4285714286,
                                         1.4693877551,
                                         1.5102040816,
                                         1.5510204082,
                                         1.4285714286,
                                         1.4693877551,
                                         1.5102040816,
                                         1.5510204082,
                                         1.4285714286,
                                         1.4693877551,
                                         1.5102040816,
                                         1.5510204082,
                                         0.7551020408,
                                         0.7755102041,
                                         0.7959183673,
                                         0.8163265306,
                                         1.5102040816,
                                         1.5510204082,
                                         1.5918367347,
                                         1.6326530612,
                                         3.1836734694,
                                         3.2653061224,
                                         3.3469387755,
                                         3.4285714286,
                                         3.1836734694,
                                         3.2653061224,
                                         3.3469387755,
                                         3.4285714286,
                                         3.1836734694,
                                         3.2653061224,
                                         3.3469387755,
                                         3.4285714286,
                                         3.1836734694,
                                         3.2653061224,
                                         3.3469387755,
                                         3.4285714286,
                                         3.1836734694,
                                         3.2653061224,
                                         3.3469387755,
                                         3.4285714286,
                                         3.1836734694,
                                         3.2653061224,
                                         3.3469387755,
                                         3.4285714286,
                                         1.6734693878,
                                         1.7142857143,
                                         1.7551020408,
                                         1.7959183673,
                                         2.5102040816,
                                         2.5714285714,
                                         2.6326530612,
                                         2.693877551,
                                         5.2653061224,
                                         5.387755102,
                                         5.5102040816,
                                         5.6326530612,
                                         5.2653061224,
                                         5.387755102,
                                         5.5102040816,
                                         5.6326530612,
                                         5.2653061224,
                                         5.387755102,
                                         5.5102040816,
                                         5.6326530612,
                                         5.2653061224,
                                         5.387755102,
                                         5.5102040816,
                                         5.6326530612,
                                         5.2653061224,
                                         5.387755102,
                                         5.5102040816,
                                         5.6326530612,
                                         5.2653061224,
                                         5.387755102,
                                         5.5102040816,
                                         5.6326530612,
                                         2.7551020408,
                                         2.8163265306,
                                         2.8775510204,
                                         2.9387755102,
                                         3.6734693878,
                                         3.7551020408,
                                         3.8367346939,
                                         3.9183673469,
                                         7.6734693878,
                                         7.8367346939,
                                         8.,
                                         8.1632653061,
                                         7.6734693878,
                                         7.8367346939,
                                         8.,
                                         8.1632653061,
                                         7.6734693878,
                                         7.8367346939,
                                         8.,
                                         8.1632653061,
                                         7.6734693878,
                                         7.8367346939,
                                         8.,
                                         8.1632653061,
                                         7.6734693878,
                                         7.8367346939,
                                         8.,
                                         8.1632653061,
                                         7.6734693878,
                                         7.8367346939,
                                         8.,
                                         8.1632653061,
                                         4.,
                                         4.0816326531,
                                         4.1632653061,
                                         4.2448979592,
                                         3.6734693878,
                                         3.7551020408,
                                         3.8367346939,
                                         3.9183673469,
                                         7.6734693878,
                                         7.8367346939,
                                         8.,
                                         8.1632653061,
                                         7.6734693878,
                                         7.8367346939,
                                         8.,
                                         8.1632653061,
                                         7.6734693878,
                                         7.8367346939,
                                         8.,
                                         8.1632653061,
                                         7.6734693878,
                                         7.8367346939,
                                         8.,
                                         8.1632653061,
                                         7.6734693878,
                                         7.8367346939,
                                         8.,
                                         8.1632653061,
                                         7.6734693878,
                                         7.8367346939,
                                         8.,
                                         8.1632653061,
                                         4.,
                                         4.0816326531,
                                         4.1632653061,
                                         4.2448979592,
                                         3.6734693878,
                                         3.7551020408,
                                         3.8367346939,
                                         3.9183673469,
                                         7.6734693878,
                                         7.8367346939,
                                         8.,
                                         8.1632653061,
                                         7.6734693878,
                                         7.8367346939,
                                         8.,
                                         8.1632653061,
                                         7.6734693878,
                                         7.8367346939,
                                         8.,
                                         8.1632653061,
                                         7.6734693878,
                                         7.8367346939,
                                         8.,
                                         8.1632653061,
                                         7.6734693878,
                                         7.8367346939,
                                         8.,
                                         8.1632653061,
                                         7.6734693878,
                                         7.8367346939,
                                         8.,
                                         8.1632653061,
                                         4.,
                                         4.0816326531,
                                         4.1632653061,
                                         4.2448979592,
                                         3.6734693878,
                                         3.7551020408,
                                         3.8367346939,
                                         3.9183673469,
                                         7.6734693878,
                                         7.8367346939,
                                         8.,
                                         8.1632653061,
                                         7.6734693878,
                                         7.8367346939,
                                         8.,
                                         8.1632653061,
                                         7.6734693878,
                                         7.8367346939,
                                         8.,
                                         8.1632653061,
                                         7.6734693878,
                                         7.8367346939,
                                         8.,
                                         8.1632653061,
                                         7.6734693878,
                                         7.8367346939,
                                         8.,
                                         8.1632653061,
                                         7.6734693878,
                                         7.8367346939,
                                         8.,
                                         8.1632653061,
                                         4.,
                                         4.0816326531,
                                         4.1632653061,
                                         4.2448979592,
                                         3.,
                                         3.0612244898,
                                         3.1224489796,
                                         3.1836734694,
                                         6.2448979592,
                                         6.3673469388,
                                         6.4897959184,
                                         6.612244898,
                                         6.2448979592,
                                         6.3673469388,
                                         6.4897959184,
                                         6.612244898,
                                         6.2448979592,
                                         6.3673469388,
                                         6.4897959184,
                                         6.612244898,
                                         6.2448979592,
                                         6.3673469388,
                                         6.4897959184,
                                         6.612244898,
                                         6.2448979592,
                                         6.3673469388,
                                         6.4897959184,
                                         6.612244898,
                                         6.2448979592,
                                         6.3673469388,
                                         6.4897959184,
                                         6.612244898,
                                         3.2448979592,
                                         3.306122449,
                                         3.3673469388,
                                         3.4285714286,
                                         2.1632653061,
                                         2.2040816327,
                                         2.2448979592,
                                         2.2857142857,
                                         4.4897959184,
                                         4.5714285714,
                                         4.6530612245,
                                         4.7346938776,
                                         4.4897959184,
                                         4.5714285714,
                                         4.6530612245,
                                         4.7346938776,
                                         4.4897959184,
                                         4.5714285714,
                                         4.6530612245,
                                         4.7346938776,
                                         4.4897959184,
                                         4.5714285714,
                                         4.6530612245,
                                         4.7346938776,
                                         4.4897959184,
                                         4.5714285714,
                                         4.6530612245,
                                         4.7346938776,
                                         4.4897959184,
                                         4.5714285714,
                                         4.6530612245,
                                         4.7346938776,
                                         2.3265306122,
                                         2.3673469388,
                                         2.4081632653,
                                         2.4489795918,
                                         1.1632653061,
                                         1.1836734694,
                                         1.2040816327,
                                         1.2244897959,
                                         2.4081632653,
                                         2.4489795918,
                                         2.4897959184,
                                         2.5306122449,
                                         2.4081632653,
                                         2.4489795918,
                                         2.4897959184,
                                         2.5306122449,
                                         2.4081632653,
                                         2.4489795918,
                                         2.4897959184,
                                         2.5306122449,
                                         2.4081632653,
                                         2.4489795918,
                                         2.4897959184,
                                         2.5306122449,
                                         2.4081632653,
                                         2.4489795918,
                                         2.4897959184,
                                         2.5306122449,
                                         2.4081632653,
                                         2.4489795918,
                                         2.4897959184,
                                         2.5306122449,
                                         1.2448979592,
                                         1.2653061224,
                                         1.2857142857,
                                         1.306122449,
                                         1.3265306122,
                                         1.3469387755,
                                         1.3673469388,
                                         1.387755102,
                                         2.7346938776,
                                         2.7755102041,
                                         2.8163265306,
                                         2.8571428571,
                                         2.7346938776,
                                         2.7755102041,
                                         2.8163265306,
                                         2.8571428571,
                                         2.7346938776,
                                         2.7755102041,
                                         2.8163265306,
                                         2.8571428571,
                                         2.7346938776,
                                         2.7755102041,
                                         2.8163265306,
                                         2.8571428571,
                                         2.7346938776,
                                         2.7755102041,
                                         2.8163265306,
                                         2.8571428571,
                                         2.7346938776,
                                         2.7755102041,
                                         2.8163265306,
                                         2.8571428571,
                                         1.4081632653,
                                         1.4285714286,
                                         1.4489795918,
                                         1.4693877551,
                                         2.8163265306,
                                         2.8571428571,
                                         2.8979591837,
                                         2.9387755102,
                                         5.7959183673,
                                         5.8775510204,
                                         5.9591836735,
                                         6.0408163265,
                                         5.7959183673,
                                         5.8775510204,
                                         5.9591836735,
                                         6.0408163265,
                                         5.7959183673,
                                         5.8775510204,
                                         5.9591836735,
                                         6.0408163265,
                                         5.7959183673,
                                         5.8775510204,
                                         5.9591836735,
                                         6.0408163265,
                                         5.7959183673,
                                         5.8775510204,
                                         5.9591836735,
                                         6.0408163265,
                                         5.7959183673,
                                         5.8775510204,
                                         5.9591836735,
                                         6.0408163265,
                                         2.9795918367,
                                         3.0204081633,
                                         3.0612244898,
                                         3.1020408163,
                                         4.4693877551,
                                         4.5306122449,
                                         4.5918367347,
                                         4.6530612245,
                                         9.1836734694,
                                         9.306122449,
                                         9.4285714286,
                                         9.5510204082,
                                         9.1836734694,
                                         9.306122449,
                                         9.4285714286,
                                         9.5510204082,
                                         9.1836734694,
                                         9.306122449,
                                         9.4285714286,
                                         9.5510204082,
                                         9.1836734694,
                                         9.306122449,
                                         9.4285714286,
                                         9.5510204082,
                                         9.1836734694,
                                         9.306122449,
                                         9.4285714286,
                                         9.5510204082,
                                         9.1836734694,
                                         9.306122449,
                                         9.4285714286,
                                         9.5510204082,
                                         4.7142857143,
                                         4.7755102041,
                                         4.8367346939,
                                         4.8979591837,
                                         6.2857142857,
                                         6.3673469388,
                                         6.4489795918,
                                         6.5306122449,
                                         12.8979591837,
                                         13.0612244898,
                                         13.2244897959,
                                         13.387755102,
                                         12.8979591837,
                                         13.0612244898,
                                         13.2244897959,
                                         13.387755102,
                                         12.8979591837,
                                         13.0612244898,
                                         13.2244897959,
                                         13.387755102,
                                         12.8979591837,
                                         13.0612244898,
                                         13.2244897959,
                                         13.387755102,
                                         12.8979591837,
                                         13.0612244898,
                                         13.2244897959,
                                         13.387755102,
                                         12.8979591837,
                                         13.0612244898,
                                         13.2244897959,
                                         13.387755102,
                                         6.612244898,
                                         6.693877551,
                                         6.7755102041,
                                         6.8571428571,
                                         6.2857142857,
                                         6.3673469388,
                                         6.4489795918,
                                         6.5306122449,
                                         12.8979591837,
                                         13.0612244898,
                                         13.2244897959,
                                         13.387755102,
                                         12.8979591837,
                                         13.0612244898,
                                         13.2244897959,
                                         13.387755102,
                                         12.8979591837,
                                         13.0612244898,
                                         13.2244897959,
                                         13.387755102,
                                         12.8979591837,
                                         13.0612244898,
                                         13.2244897959,
                                         13.387755102,
                                         12.8979591837,
                                         13.0612244898,
                                         13.2244897959,
                                         13.387755102,
                                         12.8979591837,
                                         13.0612244898,
                                         13.2244897959,
                                         13.387755102,
                                         6.612244898,
                                         6.693877551,
                                         6.7755102041,
                                         6.8571428571,
                                         6.2857142857,
                                         6.3673469388,
                                         6.4489795918,
                                         6.5306122449,
                                         12.8979591837,
                                         13.0612244898,
                                         13.2244897959,
                                         13.387755102,
                                         12.8979591837,
                                         13.0612244898,
                                         13.2244897959,
                                         13.387755102,
                                         12.8979591837,
                                         13.0612244898,
                                         13.2244897959,
                                         13.387755102,
                                         12.8979591837,
                                         13.0612244898,
                                         13.2244897959,
                                         13.387755102,
                                         12.8979591837,
                                         13.0612244898,
                                         13.2244897959,
                                         13.387755102,
                                         12.8979591837,
                                         13.0612244898,
                                         13.2244897959,
                                         13.387755102,
                                         6.612244898,
                                         6.693877551,
                                         6.7755102041,
                                         6.8571428571,
                                         6.2857142857,
                                         6.3673469388,
                                         6.4489795918,
                                         6.5306122449,
                                         12.8979591837,
                                         13.0612244898,
                                         13.2244897959,
                                         13.387755102,
                                         12.8979591837,
                                         13.0612244898,
                                         13.2244897959,
                                         13.387755102,
                                         12.8979591837,
                                         13.0612244898,
                                         13.2244897959,
                                         13.387755102,
                                         12.8979591837,
                                         13.0612244898,
                                         13.2244897959,
                                         13.387755102,
                                         12.8979591837,
                                         13.0612244898,
                                         13.2244897959,
                                         13.387755102,
                                         12.8979591837,
                                         13.0612244898,
                                         13.2244897959,
                                         13.387755102,
                                         6.612244898,
                                         6.693877551,
                                         6.7755102041,
                                         6.8571428571,
                                         4.9591836735,
                                         5.0204081633,
                                         5.0816326531,
                                         5.1428571429,
                                         10.1632653061,
                                         10.2857142857,
                                         10.4081632653,
                                         10.5306122449,
                                         10.1632653061,
                                         10.2857142857,
                                         10.4081632653,
                                         10.5306122449,
                                         10.1632653061,
                                         10.2857142857,
                                         10.4081632653,
                                         10.5306122449,
                                         10.1632653061,
                                         10.2857142857,
                                         10.4081632653,
                                         10.5306122449,
                                         10.1632653061,
                                         10.2857142857,
                                         10.4081632653,
                                         10.5306122449,
                                         10.1632653061,
                                         10.2857142857,
                                         10.4081632653,
                                         10.5306122449,
                                         5.2040816327,
                                         5.2653061224,
                                         5.3265306122,
                                         5.387755102,
                                         3.4693877551,
                                         3.5102040816,
                                         3.5510204082,
                                         3.5918367347,
                                         7.1020408163,
                                         7.1836734694,
                                         7.2653061224,
                                         7.3469387755,
                                         7.1020408163,
                                         7.1836734694,
                                         7.2653061224,
                                         7.3469387755,
                                         7.1020408163,
                                         7.1836734694,
                                         7.2653061224,
                                         7.3469387755,
                                         7.1020408163,
                                         7.1836734694,
                                         7.2653061224,
                                         7.3469387755,
                                         7.1020408163,
                                         7.1836734694,
                                         7.2653061224,
                                         7.3469387755,
                                         7.1020408163,
                                         7.1836734694,
                                         7.2653061224,
                                         7.3469387755,
                                         3.6326530612,
                                         3.6734693878,
                                         3.7142857143,
                                         3.7551020408,
                                         1.8163265306,
                                         1.8367346939,
                                         1.8571428571,
                                         1.8775510204,
                                         3.7142857143,
                                         3.7551020408,
                                         3.7959183673,
                                         3.8367346939,
                                         3.7142857143,
                                         3.7551020408,
                                         3.7959183673,
                                         3.8367346939,
                                         3.7142857143,
                                         3.7551020408,
                                         3.7959183673,
                                         3.8367346939,
                                         3.7142857143,
                                         3.7551020408,
                                         3.7959183673,
                                         3.8367346939,
                                         3.7142857143,
                                         3.7551020408,
                                         3.7959183673,
                                         3.8367346939,
                                         3.7142857143,
                                         3.7551020408,
                                         3.7959183673,
                                         3.8367346939,
                                         1.8979591837,
                                         1.9183673469,
                                         1.9387755102,
                                         1.9591836735};
  const std::array<int, 4> in_shape = {{3, 10, 8, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x10x9x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      7.8827721088,   9.6620238095,   11.5497789116,  13.8787471655,
      14.4712471655,  16.309223356,   14.4866043084,  12.8158560091,
      11.0366043084,  12.0348129252,  14.6507993197,  17.3956972789,
      20.7484750567,  21.2766893424,  23.6360941043,  20.8849036281,
      18.3978287982,  15.7818424036,  17.1633843537,  20.7997789116,
      24.5854931973,  29.1763662132,  29.5760090703,  32.5211281179,
      28.6270804989,  25.1400056689,  21.5036111111,  23.2684863946,
      28.108962585,   33.1191666667,  39.1624206349,  39.3692063492,
      42.9643253968,  37.7131349206,  33.0423866213,  28.2019104308,
      31.1000340136,  37.3809863946,  43.8197619048,  51.5157936508,
      51.0850793651,  55.051031746,   48.0915079365,  41.9683786848,
      35.6874263039,  40.6700340136,  48.7509863946,  56.9897619048,
      66.7857936508,  65.7250793651,  70.321031746,   61.2615079365,
      53.3383786848,  45.2574263039,  53.9152721088,  64.5200340136,
      75.2945238095,  88.0627777778,  86.2520634921,  91.8646825397,
      79.8884920635,  69.4534580499,  58.8486961451,  50.7397619048,
      60.691462585,   70.7924829932,  82.7512131519,  80.9404988662,
      86.0959750567,  74.8340702948,  65.0316893424,  55.0799886621,
      46.5877210884,  55.7026870748,  64.9465646259,  75.8814852608,
      74.1350566893,  78.7691043084,  68.4357709751,  59.4497165533,
      50.3347505669,  41.4591496599,  49.553707483,   57.7567687075,
      67.4535941043,  65.8357369615,  69.8840702948,  60.6935941043,
      52.7075396825,  44.6129818594,  59.8016496599,  71.346207483,
      82.9992687075,  96.7210941043,  93.8957369615,  99.1515702948,
      85.9360941043,  74.5000396825,  62.9554818594,  73.7189965986,
      87.9370238095,  102.283962585,  119.1724546485, 115.6399546485,
      122.0600736961, 105.7731689342, 91.684053288,   77.4660260771,
      88.6128741497,  105.6880442177, 122.9125340136, 143.181978458,
      138.8780498866, 146.5267403628, 126.9541213152, 110.0282709751,
      92.953100907,   104.4832823129, 124.5992687075, 144.8849829932,
      168.7496655329, 163.6100226757, 172.5515702948, 149.4789512472,
      129.5326927438, 109.4167063492, 106.6184013605, 127.1034353741,
      147.746292517,  172.0137528345, 166.6116099773, 175.5489909297,
      152.0180385488, 131.6908276644, 111.2057936508, 116.1884013605,
      138.4734353741, 160.916292517,  187.2837528345, 181.2516099773,
      190.8189909297, 165.1880385488, 143.0608276644, 120.7757936508,
      135.1300680272, 161.0103401361, 187.0603401361, 217.6500226757,
      210.4928798186, 221.4519274376, 191.65430839,   165.9437641723,
      140.0634920635, 122.1892517007, 145.5797278912, 169.1195238095,
      196.7568253968, 190.2425396825, 200.1015873016, 173.1611111111,
      149.9199546485, 126.529478458,  108.2719047619, 128.9889115646,
      149.834829932,  174.3054648526, 168.4983219955, 177.1930839002,
      153.3240362812, 132.7359410431, 112.0189342404, 93.3780272109,
      111.2378911565, 129.2062585034, 150.2959410431, 145.2602267574,
      152.7264172336, 132.1430839002, 114.391723356,  96.5318594104,
      111.7205272109, 133.0303911565, 154.4487585034, 179.5634410431,
      173.3202267574, 181.9939172336, 157.3855839002, 136.184223356,
      114.8743594104, 135.4031802721, 161.2232482993, 187.1722278912,
      217.5964342404, 210.0032199546, 220.484053288,  190.6614342404,
      164.9702777778, 139.1502097506, 160.0623639456, 190.5763095238,
      221.2395748299, 257.1875907029, 248.1800907029, 260.5323526077,
      225.2811621315, 194.9165362812, 164.4025907029, 185.6980782313,
      221.0895748299, 256.6507993197, 298.3369104308, 287.8508390023,
      302.1388151927, 261.2447675737, 226.0229988662, 190.6315022676,
      182.1367687075, 216.8258843537, 251.6728231293, 292.5117120181,
      282.1381405896, 296.0469501134, 255.944569161,  221.413276644,
      186.7241609977, 191.7067687075, 228.1958843537, 264.8428231293,
      307.7817120181, 296.7781405896, 311.3169501134, 269.114569161,
      232.783276644,  196.2941609977, 216.3448639456, 257.5006462585,
      298.8261564626, 347.2372675737, 334.7336961451, 351.0391723356,
      303.4201247166, 262.4340702948, 221.2782879819, 193.6387414966,
      230.4679931973, 267.4465646259, 310.7624376417, 299.5445804989,
      314.1071995465, 271.4881519274, 234.8082199546, 197.978968254,
      169.9560884354, 202.2751360544, 234.7230952381, 272.7294444444,
      262.8615873016, 275.6170634921, 238.2123015873, 206.0221655329,
      173.7031179138, 145.2969047619, 172.9220748299, 200.6557482993,
      233.1382879819, 224.6847165533, 235.5687641723, 203.5925736961,
      176.0759070295, 148.4507369615};
  const std::array<int, 4> in_shape = {{3, 10, 9, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x10x9x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.0204081633, 0.0612244898, 0.1224489796, 0.1224489796, 0.1224489796,
      0.1224489796, 0.1224489796, 0.1020408163, 0.0612244898, 0.1020408163,
      0.2448979592, 0.4285714286, 0.4285714286, 0.4285714286, 0.4285714286,
      0.4285714286, 0.3265306122, 0.1836734694, 0.2448979592, 0.5510204082,
      0.9183673469, 0.9183673469, 0.9183673469, 0.9183673469, 0.9183673469,
      0.6734693878, 0.3673469388, 0.4489795918, 0.9795918367, 1.5918367347,
      1.5918367347, 1.5918367347, 1.5918367347, 1.5918367347, 1.1428571429,
      0.612244898,  0.4489795918, 0.9795918367, 1.5918367347, 1.5918367347,
      1.5918367347, 1.5918367347, 1.5918367347, 1.1428571429, 0.612244898,
      0.4489795918, 0.9795918367, 1.5918367347, 1.5918367347, 1.5918367347,
      1.5918367347, 1.5918367347, 1.1428571429, 0.612244898,  0.4489795918,
      0.9795918367, 1.5918367347, 1.5918367347, 1.5918367347, 1.5918367347,
      1.5918367347, 1.1428571429, 0.612244898,  0.4285714286, 0.9183673469,
      1.4693877551, 1.4693877551, 1.4693877551, 1.4693877551, 1.4693877551,
      1.0408163265, 0.5510204082, 0.3469387755, 0.7346938776, 1.1632653061,
      1.1632653061, 1.1632653061, 1.1632653061, 1.1632653061, 0.8163265306,
      0.4285714286, 0.2040816327, 0.4285714286, 0.6734693878, 0.6734693878,
      0.6734693878, 0.6734693878, 0.6734693878, 0.4693877551, 0.2448979592,
      0.2653061224, 0.5510204082, 0.8571428571, 0.8571428571, 0.8571428571,
      0.8571428571, 0.8571428571, 0.5918367347, 0.306122449,  0.5918367347,
      1.2244897959, 1.8979591837, 1.8979591837, 1.8979591837, 1.8979591837,
      1.8979591837, 1.306122449,  0.6734693878, 0.9795918367, 2.0204081633,
      3.1224489796, 3.1224489796, 3.1224489796, 3.1224489796, 3.1224489796,
      2.1428571429, 1.1020408163, 1.4285714286, 2.9387755102, 4.5306122449,
      4.5306122449, 4.5306122449, 4.5306122449, 4.5306122449, 3.1020408163,
      1.5918367347, 1.4285714286, 2.9387755102, 4.5306122449, 4.5306122449,
      4.5306122449, 4.5306122449, 4.5306122449, 3.1020408163, 1.5918367347,
      1.4285714286, 2.9387755102, 4.5306122449, 4.5306122449, 4.5306122449,
      4.5306122449, 4.5306122449, 3.1020408163, 1.5918367347, 1.4285714286,
      2.9387755102, 4.5306122449, 4.5306122449, 4.5306122449, 4.5306122449,
      4.5306122449, 3.1020408163, 1.5918367347, 1.1632653061, 2.387755102,
      3.6734693878, 3.6734693878, 3.6734693878, 3.6734693878, 3.6734693878,
      2.5102040816, 1.2857142857, 0.8367346939, 1.7142857143, 2.6326530612,
      2.6326530612, 2.6326530612, 2.6326530612, 2.6326530612, 1.7959183673,
      0.9183673469, 0.4489795918, 0.9183673469, 1.4081632653, 1.4081632653,
      1.4081632653, 1.4081632653, 1.4081632653, 0.9591836735, 0.4897959184,
      0.5102040816, 1.0408163265, 1.5918367347, 1.5918367347, 1.5918367347,
      1.5918367347, 1.5918367347, 1.0816326531, 0.5510204082, 1.0816326531,
      2.2040816327, 3.3673469388, 3.3673469388, 3.3673469388, 3.3673469388,
      3.3673469388, 2.2857142857, 1.1632653061, 1.7142857143, 3.4897959184,
      5.3265306122, 5.3265306122, 5.3265306122, 5.3265306122, 5.3265306122,
      3.612244898,  1.8367346939, 2.4081632653, 4.8979591837, 7.4693877551,
      7.4693877551, 7.4693877551, 7.4693877551, 7.4693877551, 5.0612244898,
      2.5714285714, 2.4081632653, 4.8979591837, 7.4693877551, 7.4693877551,
      7.4693877551, 7.4693877551, 7.4693877551, 5.0612244898, 2.5714285714,
      2.4081632653, 4.8979591837, 7.4693877551, 7.4693877551, 7.4693877551,
      7.4693877551, 7.4693877551, 5.0612244898, 2.5714285714, 2.4081632653,
      4.8979591837, 7.4693877551, 7.4693877551, 7.4693877551, 7.4693877551,
      7.4693877551, 5.0612244898, 2.5714285714, 1.8979591837, 3.8571428571,
      5.8775510204, 5.8775510204, 5.8775510204, 5.8775510204, 5.8775510204,
      3.9795918367, 2.0204081633, 1.3265306122, 2.693877551,  4.1020408163,
      4.1020408163, 4.1020408163, 4.1020408163, 4.1020408163, 2.7755102041,
      1.4081632653, 0.693877551,  1.4081632653, 2.1428571429, 2.1428571429,
      2.1428571429, 2.1428571429, 2.1428571429, 1.4489795918, 0.7346938776};
  const std::array<int, 4> in_shape = {{3, 10, 9, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x10x9x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      15.1886678005,  15.7655442177,  18.6386678005,  19.324047619,
      22.3056746032,  23.0995578231,  26.8370238095,  27.7574943311,
      28.06,          28.9424943311,  31.6979761905,  32.618446712,
      28.1793253968,  28.9732086168,  24.9463321995,  25.6317120181,
      21.4963321995,  22.0732086168,  23.3842460317,  24.0696258503,
      28.4873072562,  29.3015986395,  33.84819161,    34.7913945578,
      40.4033503401,  41.4969501134,  41.5048979592,  42.5533786848,
      46.1785884354,  47.2721882086,  40.8266043084,  41.7698072562,
      35.9813662132,  36.7956575964,  30.8783049887,  31.5636848073,
      33.5328854875,  34.3267687075,  40.6563548753,  41.5995578231,
      48.0784637188,  49.1709863946,  57.0860034014,  58.3527324263,
      57.9375510204,  59.1520181406,  63.7755272109,  65.0422562358,
      56.161638322,   57.2541609977,  49.33680839,    50.2800113379,
      42.2133390023,  43.0072222222,  45.6345861678,  46.5369727891,
      55.1458106576,  56.2179251701,  64.9964909297,  66.2383333333,
      76.8849829932,  78.3248412698,  77.3579591837,  78.7384126984,
      84.488792517,   85.9286507937,  74.1844274376,  75.4262698413,
      65.0126587302,  66.0847732426,  55.5014342404,  56.4038208617,
      61.3609750567,  62.2000680272,  73.7650566893,  74.7619727891,
      86.4847845805,  87.6395238095,  101.6927210884, 103.0315873016,
      100.8865306122, 102.1701587302, 108.7631972789, 110.1020634921,
      95.028276644,   96.183015873,   82.9398412698,  83.9367573696,
      70.5357596372,  71.3748526077,  80.5009750567,  81.3400680272,
      96.5050566893,  97.5019727891,  112.8247845805, 113.9795238095,
      132.2327210884, 133.5715873016, 130.1665306122, 131.4501587302,
      139.3031972789, 140.6420634921, 121.368276644,  122.523015873,
      105.6798412698, 106.6767573696, 89.6757596372,  90.5148526077,
      106.9281575964, 107.8305442177, 127.9679535147, 129.0400680272,
      149.3472052154, 150.589047619,  174.6856972789, 176.1255555556,
      171.1236734694, 172.5041269841, 182.2895068027, 183.7293650794,
      158.5351417234, 159.776984127,  137.8348015873, 138.9069160998,
      116.7950056689, 117.6973922902, 100.6856405896, 101.4795238095,
      120.4397222222, 121.3829251701, 140.4924433107, 141.5849659864,
      164.2356972789, 165.5024263039, 160.6665306122, 161.8809977324,
      170.9252210884, 172.1919501134, 148.5756179138, 149.6681405896,
      129.120175737,  130.0633786848, 109.3660941043, 110.1599773243,
      92.4900623583,  93.1754421769,  110.5910827664, 111.4053741497,
      128.9499263039, 129.8931292517, 150.6693707483, 151.7629705215,
      147.2216326531, 148.2701133787, 156.4446088435, 157.5382086168,
      135.9283390023, 136.8715419501, 118.0851417234, 118.8994331066,
      99.9841213152,  100.6695011338, 82.3414229025,  82.9182993197,
      98.4220351474,  99.107414966,   114.719654195,  115.513537415,
      133.9867176871, 134.9071882086, 130.7889795918, 131.6714739229,
      138.847670068,  139.7681405896, 120.5933049887, 121.3871882086,
      104.7296995465, 105.4150793651, 88.6490873016,  89.2259637188,
      119.0264229025, 119.6032993197, 142.0070351474, 142.692414966,
      165.204654195,  165.998537415,  192.5217176871, 193.4421882086,
      186.9089795918, 187.7914739229, 197.382670068,  198.3031405896,
      171.0783049887, 171.8721882086, 148.3146995465, 149.0000793651,
      125.3340873016, 125.9109637188, 146.7526133787, 147.4379931973,
      175.0597562358, 175.874047619,  203.6247222222, 204.5679251701,
      237.2513095238, 238.3449092971, 230.2314285714, 231.2799092971,
      243.026547619,  244.1201473923, 210.6031349206, 211.5463378685,
      182.5538151927, 183.368106576,  154.2466723356, 154.9320521542,
      176.4318650794, 177.2257482993, 210.4328854875, 211.3760884354,
      244.7325453515, 245.8250680272, 285.0972278912, 286.3639569161,
      276.5416326531, 277.7560997732, 291.7867517007, 293.0534807256,
      252.8157199546, 253.9082426304, 219.1133390023, 220.0565419501,
      185.1123185941, 185.9062018141, 208.0641780045, 208.9665646259,
      248.1264229025, 249.198537415,  288.5281235828, 289.7699659864,
      336.0594727891, 337.4993310658, 325.8395918367, 327.2200453515,
      343.6632823129, 345.1031405896, 297.7160600907, 298.9579024943,
      257.9932709751, 259.0653854875, 217.9310260771, 218.8334126984,
      212.3977097506, 213.2368027211, 253.2099546485, 254.2068707483,
      294.337845805,  295.492585034,  342.6886394558, 344.0275056689,
      331.9395918367, 333.2232199546, 349.7591156463, 351.0979818594,
      302.8813378685, 304.0360770975, 262.384739229,  263.3816553288,
      221.5724943311, 222.4115873016, 231.5377097506, 232.3768027211,
      275.9499546485, 276.9468707483, 320.677845805,  321.832585034,
      373.2286394558, 374.5675056689, 361.2195918367, 362.5032199546,
      380.2991156463, 381.6379818594, 329.2213378685, 330.3760770975,
      285.124739229,  286.1216553288, 240.7124943311, 241.5515873016,
      269.3577494331, 270.2601360544, 320.9485657596, 322.0206802721,
      372.8788378685, 374.1206802721, 433.8601870748, 435.3000453515,
      419.6053061224, 420.9857596372, 441.4639965986, 442.9038548753,
      382.0667743764, 383.30861678,   330.8154138322, 331.8875283447,
      279.2245975057, 280.126984127,  243.5846201814, 244.3785034014,
      290.2162528345, 291.1594557823, 337.1465249433, 338.239047619,
      392.2469217687, 393.5136507937, 379.2706122449, 380.4850793651,
      398.9364455782, 400.2031746032, 345.2296995465, 346.3222222222,
      298.8967063492, 299.8399092971, 252.2650736961, 253.0589569161,
      215.8584297052, 216.5438095238, 257.163531746,  257.9778231293,
      298.7264569161, 299.6696598639, 347.517329932,  348.6109297052,
      335.9481632653, 336.9966439909, 353.2925680272, 354.3861678005,
      305.7048696145, 306.6480725624, 264.6575907029, 265.4718820862,
      223.3524886621, 224.0378684807, 186.1791780045, 186.7560544218,
      221.7904024943, 222.4757823129, 257.6186337868, 258.4125170068,
      299.6714115646, 300.5918820862, 289.6379591837, 290.5204535147,
      304.5323639456, 305.4528344671, 263.4922845805, 264.2861678005,
      228.0980668934, 228.783446712,  192.4868424036, 193.0637188209,
      222.8641780045, 223.4410544218, 265.3754024943, 266.0607823129,
      308.1036337868, 308.8975170068, 358.2064115646, 359.1268820862,
      345.7579591837, 346.6404535147, 363.0673639456, 363.9878344671,
      313.9772845805, 314.7711678005, 271.6830668934, 272.368446712,
      229.1718424036, 229.7487188209, 270.1209807256, 270.8063605442,
      321.6322052154, 322.4464965986, 373.4012528345, 374.3444557823,
      434.0992687075, 435.1928684807, 418.9579591837, 420.0064399093,
      439.8745068027, 440.968106576,  380.3796655329, 381.3228684807,
      329.1262641723, 329.9405555556, 277.6150396825, 278.3004195011,
      319.3308446712, 320.1247278912, 380.2094160998, 381.1526190476,
      441.3866269841, 442.4791496599, 513.108452381,  514.3751814059,
      495.1457142857, 496.3601814059, 519.7979761905, 521.0647052154,
      449.4698015873, 450.562324263,  388.8898696145, 389.8330725624,
      328.0112981859, 328.8051814059, 370.4937698413, 371.3961564626,
      441.1070351474, 442.1791496599, 512.0597562358, 513.3015986395,
      595.233962585,  596.6738208617, 574.3212244898, 575.7016780045,
      602.8377721088, 604.2776303855, 521.2476927438, 522.4895351474,
      450.97388322,   452.0459977324, 380.3606179138, 381.2630045351,
      363.4344444444, 364.273537415,  432.6548526077, 433.6517687075,
      502.1909070295, 503.3456462585, 583.6845578231, 585.0234240363,
      562.9926530612, 564.2762811791, 590.7550340136, 592.0939002268,
      510.734399093,  511.889138322,  441.8296371882, 442.826553288,
      372.6092290249, 373.4483219955, 382.5744444444, 383.413537415,
      455.3948526077, 456.3917687075, 528.5309070295, 529.6856462585,
      614.2245578231, 615.5634240363, 592.2726530612, 593.5562811791,
      621.2950340136, 622.6339002268, 537.074399093,  538.229138322,
      464.5696371882, 465.566553288,  391.7492290249, 392.5883219955,
      431.7873412698, 432.6897278912, 513.9291780045, 515.001292517,
      596.4104705215, 597.6523129252, 693.0346768707, 694.4745351474,
      668.0869387755, 669.4673922902, 700.6384863946, 702.0783446712,
      605.5984070295, 606.8402494331, 523.7960260771, 524.8681405896,
      441.6541893424, 442.5565759637, 386.4835997732, 387.2774829932,
      459.9927834467, 460.9359863946, 533.800606576,  534.8931292517,
      620.2581462585, 621.5248752834, 597.8746938776, 599.0891609977,
      626.947670068,  628.214399093,  541.8837811791, 542.9763038549,
      468.6732369615, 469.6164399093, 395.164053288,  395.9579365079,
      339.2267970522, 339.9121768707, 403.7359807256, 404.5502721088,
      468.5029875283, 469.4461904762, 544.3652891156, 545.4588888889,
      524.6746938776, 525.7231746032, 550.1405272109, 551.2341269841,
      475.4814002268, 476.4246031746, 411.2300396825, 412.0443310658,
      346.7208560091, 347.4062358277, 290.0169331066, 290.5938095238,
      345.1587698413, 345.8441496599, 400.5176133787, 401.3114965986,
      465.3561054422, 466.2765759637, 448.4869387755, 449.3694331066,
      470.2170578231, 471.1375283447, 406.3912641723, 407.1851473923,
      351.4664342404, 352.151814059,  296.3245975057, 296.9014739229};
  const std::array<int, 4> in_shape = {{3, 10, 9, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x10x9x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.0204081633,
                                         0.0408163265,
                                         0.0816326531,
                                         0.1224489796,
                                         0.1836734694,
                                         0.2448979592,
                                         0.1836734694,
                                         0.2448979592,
                                         0.1836734694,
                                         0.2448979592,
                                         0.1836734694,
                                         0.2448979592,
                                         0.1836734694,
                                         0.2448979592,
                                         0.1632653061,
                                         0.2040816327,
                                         0.1020408163,
                                         0.1224489796,
                                         0.1632653061,
                                         0.2040816327,
                                         0.4081632653,
                                         0.4897959184,
                                         0.7346938776,
                                         0.8571428571,
                                         0.7346938776,
                                         0.8571428571,
                                         0.7346938776,
                                         0.8571428571,
                                         0.7346938776,
                                         0.8571428571,
                                         0.7346938776,
                                         0.8571428571,
                                         0.5714285714,
                                         0.6530612245,
                                         0.3265306122,
                                         0.3673469388,
                                         0.4285714286,
                                         0.4897959184,
                                         0.9795918367,
                                         1.1020408163,
                                         1.6530612245,
                                         1.8367346939,
                                         1.6530612245,
                                         1.8367346939,
                                         1.6530612245,
                                         1.8367346939,
                                         1.6530612245,
                                         1.8367346939,
                                         1.6530612245,
                                         1.8367346939,
                                         1.2244897959,
                                         1.3469387755,
                                         0.6734693878,
                                         0.7346938776,
                                         0.8163265306,
                                         0.8979591837,
                                         1.7959183673,
                                         1.9591836735,
                                         2.9387755102,
                                         3.1836734694,
                                         2.9387755102,
                                         3.1836734694,
                                         2.9387755102,
                                         3.1836734694,
                                         2.9387755102,
                                         3.1836734694,
                                         2.9387755102,
                                         3.1836734694,
                                         2.1224489796,
                                         2.2857142857,
                                         1.1428571429,
                                         1.2244897959,
                                         0.8163265306,
                                         0.8979591837,
                                         1.7959183673,
                                         1.9591836735,
                                         2.9387755102,
                                         3.1836734694,
                                         2.9387755102,
                                         3.1836734694,
                                         2.9387755102,
                                         3.1836734694,
                                         2.9387755102,
                                         3.1836734694,
                                         2.9387755102,
                                         3.1836734694,
                                         2.1224489796,
                                         2.2857142857,
                                         1.1428571429,
                                         1.2244897959,
                                         0.8163265306,
                                         0.8979591837,
                                         1.7959183673,
                                         1.9591836735,
                                         2.9387755102,
                                         3.1836734694,
                                         2.9387755102,
                                         3.1836734694,
                                         2.9387755102,
                                         3.1836734694,
                                         2.9387755102,
                                         3.1836734694,
                                         2.9387755102,
                                         3.1836734694,
                                         2.1224489796,
                                         2.2857142857,
                                         1.1428571429,
                                         1.2244897959,
                                         0.8163265306,
                                         0.8979591837,
                                         1.7959183673,
                                         1.9591836735,
                                         2.9387755102,
                                         3.1836734694,
                                         2.9387755102,
                                         3.1836734694,
                                         2.9387755102,
                                         3.1836734694,
                                         2.9387755102,
                                         3.1836734694,
                                         2.9387755102,
                                         3.1836734694,
                                         2.1224489796,
                                         2.2857142857,
                                         1.1428571429,
                                         1.2244897959,
                                         0.7959183673,
                                         0.8571428571,
                                         1.7142857143,
                                         1.8367346939,
                                         2.7551020408,
                                         2.9387755102,
                                         2.7551020408,
                                         2.9387755102,
                                         2.7551020408,
                                         2.9387755102,
                                         2.7551020408,
                                         2.9387755102,
                                         2.7551020408,
                                         2.9387755102,
                                         1.9591836735,
                                         2.0816326531,
                                         1.0408163265,
                                         1.1020408163,
                                         0.6530612245,
                                         0.693877551,
                                         1.387755102,
                                         1.4693877551,
                                         2.2040816327,
                                         2.3265306122,
                                         2.2040816327,
                                         2.3265306122,
                                         2.2040816327,
                                         2.3265306122,
                                         2.2040816327,
                                         2.3265306122,
                                         2.2040816327,
                                         2.3265306122,
                                         1.5510204082,
                                         1.6326530612,
                                         0.8163265306,
                                         0.8571428571,
                                         0.387755102,
                                         0.4081632653,
                                         0.8163265306,
                                         0.8571428571,
                                         1.2857142857,
                                         1.3469387755,
                                         1.2857142857,
                                         1.3469387755,
                                         1.2857142857,
                                         1.3469387755,
                                         1.2857142857,
                                         1.3469387755,
                                         1.2857142857,
                                         1.3469387755,
                                         0.8979591837,
                                         0.9387755102,
                                         0.4693877551,
                                         0.4897959184,
                                         0.5102040816,
                                         0.5306122449,
                                         1.0612244898,
                                         1.1020408163,
                                         1.6530612245,
                                         1.7142857143,
                                         1.6530612245,
                                         1.7142857143,
                                         1.6530612245,
                                         1.7142857143,
                                         1.6530612245,
                                         1.7142857143,
                                         1.6530612245,
                                         1.7142857143,
                                         1.1428571429,
                                         1.1836734694,
                                         0.5918367347,
                                         0.612244898,
                                         1.1428571429,
                                         1.1836734694,
                                         2.3673469388,
                                         2.4489795918,
                                         3.6734693878,
                                         3.7959183673,
                                         3.6734693878,
                                         3.7959183673,
                                         3.6734693878,
                                         3.7959183673,
                                         3.6734693878,
                                         3.7959183673,
                                         3.6734693878,
                                         3.7959183673,
                                         2.5306122449,
                                         2.612244898,
                                         1.306122449,
                                         1.3469387755,
                                         1.8979591837,
                                         1.9591836735,
                                         3.9183673469,
                                         4.0408163265,
                                         6.0612244898,
                                         6.2448979592,
                                         6.0612244898,
                                         6.2448979592,
                                         6.0612244898,
                                         6.2448979592,
                                         6.0612244898,
                                         6.2448979592,
                                         6.0612244898,
                                         6.2448979592,
                                         4.1632653061,
                                         4.2857142857,
                                         2.1428571429,
                                         2.2040816327,
                                         2.7755102041,
                                         2.8571428571,
                                         5.7142857143,
                                         5.8775510204,
                                         8.8163265306,
                                         9.0612244898,
                                         8.8163265306,
                                         9.0612244898,
                                         8.8163265306,
                                         9.0612244898,
                                         8.8163265306,
                                         9.0612244898,
                                         8.8163265306,
                                         9.0612244898,
                                         6.0408163265,
                                         6.2040816327,
                                         3.1020408163,
                                         3.1836734694,
                                         2.7755102041,
                                         2.8571428571,
                                         5.7142857143,
                                         5.8775510204,
                                         8.8163265306,
                                         9.0612244898,
                                         8.8163265306,
                                         9.0612244898,
                                         8.8163265306,
                                         9.0612244898,
                                         8.8163265306,
                                         9.0612244898,
                                         8.8163265306,
                                         9.0612244898,
                                         6.0408163265,
                                         6.2040816327,
                                         3.1020408163,
                                         3.1836734694,
                                         2.7755102041,
                                         2.8571428571,
                                         5.7142857143,
                                         5.8775510204,
                                         8.8163265306,
                                         9.0612244898,
                                         8.8163265306,
                                         9.0612244898,
                                         8.8163265306,
                                         9.0612244898,
                                         8.8163265306,
                                         9.0612244898,
                                         8.8163265306,
                                         9.0612244898,
                                         6.0408163265,
                                         6.2040816327,
                                         3.1020408163,
                                         3.1836734694,
                                         2.7755102041,
                                         2.8571428571,
                                         5.7142857143,
                                         5.8775510204,
                                         8.8163265306,
                                         9.0612244898,
                                         8.8163265306,
                                         9.0612244898,
                                         8.8163265306,
                                         9.0612244898,
                                         8.8163265306,
                                         9.0612244898,
                                         8.8163265306,
                                         9.0612244898,
                                         6.0408163265,
                                         6.2040816327,
                                         3.1020408163,
                                         3.1836734694,
                                         2.2653061224,
                                         2.3265306122,
                                         4.6530612245,
                                         4.7755102041,
                                         7.1632653061,
                                         7.3469387755,
                                         7.1632653061,
                                         7.3469387755,
                                         7.1632653061,
                                         7.3469387755,
                                         7.1632653061,
                                         7.3469387755,
                                         7.1632653061,
                                         7.3469387755,
                                         4.8979591837,
                                         5.0204081633,
                                         2.5102040816,
                                         2.5714285714,
                                         1.6326530612,
                                         1.6734693878,
                                         3.3469387755,
                                         3.4285714286,
                                         5.1428571429,
                                         5.2653061224,
                                         5.1428571429,
                                         5.2653061224,
                                         5.1428571429,
                                         5.2653061224,
                                         5.1428571429,
                                         5.2653061224,
                                         5.1428571429,
                                         5.2653061224,
                                         3.5102040816,
                                         3.5918367347,
                                         1.7959183673,
                                         1.8367346939,
                                         0.8775510204,
                                         0.8979591837,
                                         1.7959183673,
                                         1.8367346939,
                                         2.7551020408,
                                         2.8163265306,
                                         2.7551020408,
                                         2.8163265306,
                                         2.7551020408,
                                         2.8163265306,
                                         2.7551020408,
                                         2.8163265306,
                                         2.7551020408,
                                         2.8163265306,
                                         1.8775510204,
                                         1.9183673469,
                                         0.9591836735,
                                         0.9795918367,
                                         1.,
                                         1.0204081633,
                                         2.0408163265,
                                         2.0816326531,
                                         3.1224489796,
                                         3.1836734694,
                                         3.1224489796,
                                         3.1836734694,
                                         3.1224489796,
                                         3.1836734694,
                                         3.1224489796,
                                         3.1836734694,
                                         3.1224489796,
                                         3.1836734694,
                                         2.1224489796,
                                         2.1632653061,
                                         1.0816326531,
                                         1.1020408163,
                                         2.1224489796,
                                         2.1632653061,
                                         4.3265306122,
                                         4.4081632653,
                                         6.612244898,
                                         6.7346938776,
                                         6.612244898,
                                         6.7346938776,
                                         6.612244898,
                                         6.7346938776,
                                         6.612244898,
                                         6.7346938776,
                                         6.612244898,
                                         6.7346938776,
                                         4.4897959184,
                                         4.5714285714,
                                         2.2857142857,
                                         2.3265306122,
                                         3.3673469388,
                                         3.4285714286,
                                         6.8571428571,
                                         6.9795918367,
                                         10.4693877551,
                                         10.6530612245,
                                         10.4693877551,
                                         10.6530612245,
                                         10.4693877551,
                                         10.6530612245,
                                         10.4693877551,
                                         10.6530612245,
                                         10.4693877551,
                                         10.6530612245,
                                         7.1020408163,
                                         7.2244897959,
                                         3.612244898,
                                         3.6734693878,
                                         4.7346938776,
                                         4.8163265306,
                                         9.6326530612,
                                         9.7959183673,
                                         14.693877551,
                                         14.9387755102,
                                         14.693877551,
                                         14.9387755102,
                                         14.693877551,
                                         14.9387755102,
                                         14.693877551,
                                         14.9387755102,
                                         14.693877551,
                                         14.9387755102,
                                         9.9591836735,
                                         10.1224489796,
                                         5.0612244898,
                                         5.1428571429,
                                         4.7346938776,
                                         4.8163265306,
                                         9.6326530612,
                                         9.7959183673,
                                         14.693877551,
                                         14.9387755102,
                                         14.693877551,
                                         14.9387755102,
                                         14.693877551,
                                         14.9387755102,
                                         14.693877551,
                                         14.9387755102,
                                         14.693877551,
                                         14.9387755102,
                                         9.9591836735,
                                         10.1224489796,
                                         5.0612244898,
                                         5.1428571429,
                                         4.7346938776,
                                         4.8163265306,
                                         9.6326530612,
                                         9.7959183673,
                                         14.693877551,
                                         14.9387755102,
                                         14.693877551,
                                         14.9387755102,
                                         14.693877551,
                                         14.9387755102,
                                         14.693877551,
                                         14.9387755102,
                                         14.693877551,
                                         14.9387755102,
                                         9.9591836735,
                                         10.1224489796,
                                         5.0612244898,
                                         5.1428571429,
                                         4.7346938776,
                                         4.8163265306,
                                         9.6326530612,
                                         9.7959183673,
                                         14.693877551,
                                         14.9387755102,
                                         14.693877551,
                                         14.9387755102,
                                         14.693877551,
                                         14.9387755102,
                                         14.693877551,
                                         14.9387755102,
                                         14.693877551,
                                         14.9387755102,
                                         9.9591836735,
                                         10.1224489796,
                                         5.0612244898,
                                         5.1428571429,
                                         3.7346938776,
                                         3.7959183673,
                                         7.5918367347,
                                         7.7142857143,
                                         11.5714285714,
                                         11.7551020408,
                                         11.5714285714,
                                         11.7551020408,
                                         11.5714285714,
                                         11.7551020408,
                                         11.5714285714,
                                         11.7551020408,
                                         11.5714285714,
                                         11.7551020408,
                                         7.8367346939,
                                         7.9591836735,
                                         3.9795918367,
                                         4.0408163265,
                                         2.612244898,
                                         2.6530612245,
                                         5.306122449,
                                         5.387755102,
                                         8.0816326531,
                                         8.2040816327,
                                         8.0816326531,
                                         8.2040816327,
                                         8.0816326531,
                                         8.2040816327,
                                         8.0816326531,
                                         8.2040816327,
                                         8.0816326531,
                                         8.2040816327,
                                         5.4693877551,
                                         5.5510204082,
                                         2.7755102041,
                                         2.8163265306,
                                         1.3673469388,
                                         1.387755102,
                                         2.7755102041,
                                         2.8163265306,
                                         4.2244897959,
                                         4.2857142857,
                                         4.2244897959,
                                         4.2857142857,
                                         4.2244897959,
                                         4.2857142857,
                                         4.2244897959,
                                         4.2857142857,
                                         4.2244897959,
                                         4.2857142857,
                                         2.8571428571,
                                         2.8979591837,
                                         1.4489795918,
                                         1.4693877551};
  const std::array<int, 4> in_shape = {{3, 10, 9, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x10x9x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      29.8004591837,   30.3773356009,   30.9542120181,   31.5310884354,
      36.5919557823,   37.2773356009,   37.9627154195,   38.6480952381,
      43.8174659864,   44.6113492063,   45.4052324263,   46.1991156463,
      52.7535770975,   53.674047619,    54.5945181406,   55.5149886621,
      55.2375056689,   56.12,           57.0024943311,   57.8849886621,
      62.4754818594,   63.395952381,    64.3164229025,   65.236893424,
      55.5647675737,   56.3586507937,   57.1525340136,   57.9464172336,
      49.2072845805,   49.8926643991,   50.5780442177,   51.2634240363,
      42.4157879819,   42.9926643991,   43.5695408163,   44.1464172336,
      46.0831122449,   46.7684920635,   47.4538718821,   48.1392517007,
      56.1603231293,   56.9746145125,   57.7889058957,   58.6031972789,
      66.7531802721,   67.69638322,     68.6395861678,   69.5827891156,
      79.713100907,    80.8067006803,   81.9003004535,   82.9939002268,
      81.9613151927,   83.0097959184,   84.058276644,    85.1067573696,
      91.2635770975,   92.3571768707,   93.450776644,    94.5443764172,
      80.7100056689,   81.6532086168,   82.5964115646,   83.5396145125,
      71.1484410431,   71.9627324263,   72.7770238095,   73.5913151927,
      61.0712301587,   61.7566099773,   62.4419897959,   63.1273696145,
      66.2718877551,   67.0657709751,   67.859654195,    68.653537415,
      80.3695068027,   81.3127097506,   82.2559126984,   83.1991156463,
      95.0644047619,   96.1569274376,   97.2494501134,   98.3419727891,
      112.9052777778,  114.1720068027,  115.4387358277,  116.7054648526,
      114.6606349206,  115.8751020408,  117.089569161,   118.3040362812,
      126.2843253968,  127.5510544218,  128.8177834467,  130.0845124717,
      111.2307539683,  112.323276644,   113.4157993197,  114.5083219955,
      97.7304138322,   98.67361678,     99.6168197279,   100.5600226757,
      83.6327947846,   84.4266780045,   85.2205612245,   86.0144444444,
      90.3667857143,   91.2691723356,   92.1715589569,   93.0739455782,
      109.2195068027,  110.2916213152,  111.3637358277,  112.4358503401,
      128.7511394558,  129.9929818594,  131.234824263,   132.4766666667,
      152.3301077098,  153.7699659864,  155.209824263,   156.6496825397,
      153.3354648526,  154.7159183673,  156.0963718821,  157.4768253968,
      167.5377267574,  168.977585034,   170.4174433107,  171.8573015873,
      147.1270124717,  148.3688548753,  149.6106972789,  150.8525396825,
      128.9532029478,  130.0253174603,  131.0974319728,  132.1695464853,
      110.1004818594,  111.0028684807,  111.905255102,   112.8076417234,
      121.8828571429,  122.7219501134,  123.5610430839,  124.4001360544,
      146.5331972789,  147.5301133787,  148.5270294785,  149.5239455782,
      171.814829932,   172.969569161,   174.12430839,    175.279047619,
      202.0465759637,  203.3854421769,  204.72430839,    206.0631746032,
      200.4894331066,  201.7730612245,  203.0566893424,  204.3403174603,
      216.1875283447,  217.5263945578,  218.865260771,   220.2041269841,
      188.901814059,   190.056553288,   191.211292517,   192.366031746,
      164.8827664399,  165.8796825397,  166.8765986395,  167.8735147392,
      140.2324263039,  141.0715192744,  141.9106122449,  142.7497052154,
      160.1628571429,  161.0019501134,  161.8410430839,  162.6801360544,
      192.0131972789,  193.0101133787,  194.0070294785,  195.0039455782,
      224.494829932,   225.649569161,   226.80430839,    227.959047619,
      263.1265759637,  264.4654421769,  265.80430839,    267.1431746032,
      259.0494331066,  260.3330612245,  261.6166893424,  262.9003174603,
      277.2675283447,  278.6063945578,  279.945260771,   281.2841269841,
      241.581814059,   242.736553288,   243.891292517,   245.046031746,
      210.3627664399,  211.3596825397,  212.3565986395,  213.3535147392,
      178.5124263039,  179.3515192744,  180.1906122449,  181.0297052154,
      212.9539285714,  213.8563151927,  214.7587018141,  215.6610884354,
      254.863792517,   255.9359070295,  257.008021542,   258.0801360544,
      297.4525680272,  298.6944104308,  299.9362528345,  301.1780952381,
      347.9315362812,  349.3713945578,  350.8112528345,  352.2511111111,
      340.866893424,   342.2473469388,  343.6278004535,  345.0082539683,
      363.1391553288,  364.5790136054,  366.0188718821,  367.4587301587,
      315.8284410431,  317.0702834467,  318.3121258503,  319.553968254,
      274.5974886621,  275.6696031746,  276.7417176871,  277.8138321995,
      232.6876247166,  233.5900113379,  234.4923979592,  235.3947845805,
      200.5773979592,  201.3712811791,  202.1651643991,  202.959047619,
      239.9362414966,  240.8794444444,  241.8226473923,  242.7658503401,
      279.8923639456,  280.9848866213,  282.0774092971,  283.1699319728,
      327.2046655329,  328.4713945578,  329.7381235828,  331.0048526077,
      320.1185941043,  321.3330612245,  322.5475283447,  323.7619954649,
      340.5837131519,  341.8504421769,  343.1171712018,  344.3839002268,
      296.0587131519,  297.1512358277,  298.2437585034,  299.3362811791,
      257.2971485261,  258.2403514739,  259.1835544218,  260.1267573696,
      217.9383049887,  218.7321882086,  219.5260714286,  220.3199546485,
      184.294744898,   184.9801247166,  185.6655045351,  186.3508843537,
      220.3678741497,  221.1821655329,  221.9964569161,  222.8107482993,
      256.9566496599,  257.8998526077,  258.8430555556,  259.7862585034,
      300.2451417234,  301.3387414966,  302.4323412698,  303.5259410431,
      293.3947845805,  294.4432653061,  295.4917460317,  296.5402267574,
      311.7956179138,  312.8892176871,  313.9828174603,  315.0764172336,
      270.9134750567,  271.8566780045,  272.7998809524,  273.7430839002,
      235.3559920635,  236.1702834467,  236.9845748299,  237.7988662132,
      199.2828628118,  199.9682426304,  200.653622449,   201.3390022676,
      164.1059693878,  164.682845805,   165.2597222222,  165.8365986395,
      196.1586904762,  196.8440702948,  197.5294501134,  198.214829932,
      228.6454251701,  229.43930839,    230.23319161,    231.0270748299,
      267.0529648526,  267.9734353741,  268.8939058957,  269.8143764172,
      260.6954648526,  261.5779591837,  262.4604535147,  263.3429478458,
      276.7748696145,  277.6953401361,  278.6158106576,  279.5362811791,
      240.3927267574,  241.1866099773,  241.9804931973,  242.7743764172,
      208.7740192744,  209.459399093,   210.1447789116,  210.8301587302,
      176.7212981859,  177.2981746032,  177.8750510204,  178.4519274376,
      237.4759693878,  238.052845805,   238.6297222222,  239.2065986395,
      283.3286904762,  284.0140702948,  284.6994501134,  285.384829932,
      329.6154251701,  330.40930839,    331.20319161,    331.9970748299,
      384.1229648526,  385.0434353741,  385.9639058957,  386.8843764172,
      372.9354648526,  373.8179591837,  374.7004535147,  375.5829478458,
      393.8448696145,  394.7653401361,  395.6858106576,  396.6062811791,
      341.3627267574,  342.1566099773,  342.9504931973,  343.7443764172,
      295.9440192744,  296.629399093,   297.3147789116,  298.0001587302,
      250.0912981859,  250.6681746032,  251.2450510204,  251.8219274376,
      292.8198469388,  293.5052267574,  294.190606576,   294.8759863946,
      349.3052210884,  350.1195124717,  350.9338038549,  351.7480952381,
      406.3062414966,  407.2494444444,  408.1926473923,  409.1358503401,
      473.4090192744,  474.5026190476,  475.5962188209,  476.6898185941,
      459.4143764172,  460.4628571429,  461.5113378685,  462.5598185941,
      484.9594954649,  486.0530952381,  487.1466950113,  488.2402947846,
      420.2630668934,  421.2062698413,  422.1494727891,  423.092675737,
      364.2933390023,  365.1076303855,  365.9219217687,  366.7362131519,
      307.8079648526,  308.4933446712,  309.1787244898,  309.8641043084,
      352.0698469388,  352.8637301587,  353.6576133787,  354.4514965986,
      419.9225680272,  420.8657709751,  421.8089739229,  422.7521768707,
      488.3725680272,  489.4650907029,  490.5576133787,  491.6501360544,
      568.9277267574,  570.1944557823,  571.4611848073,  572.7279138322,
      551.8687981859,  553.0832653061,  554.2977324263,  555.5121995465,
      582.3067743764,  583.5735034014,  584.8402324263,  586.1069614512,
      504.5389172336,  505.6314399093,  506.723962585,   507.8164852608,
      437.2834750567,  438.2266780045,  439.1698809524,  440.1130839002,
      369.4307539683,  370.2246371882,  371.0185204082,  371.8124036281,
      415.2259693878,  416.1283560091,  417.0307426304,  417.9331292517,
      495.1807312925,  496.252845805,   497.3249603175,  498.3970748299,
      575.8144047619,  577.0562471655,  578.2980895692,  579.5399319728,
      670.6790873016,  672.1189455782,  673.5588038549,  674.9986621315,
      650.2987301587,  651.6791836735,  653.0596371882,  654.4400907029,
      685.8867063492,  687.3265646259,  688.7664229025,  690.2062811791,
      594.1902777778,  595.4321201814,  596.673962585,   597.9158049887,
      514.9144274376,  515.9865419501,  517.0586564626,  518.1307709751,
      434.9596655329,  435.8620521542,  436.7644387755,  437.6668253968,
      423.9563265306,  424.7954195011,  425.6345124717,  426.4736054422,
      505.4229931973,  506.4199092971,  507.4168253968,  508.4137414966,
      587.520952381,   588.67569161,    589.830430839,   590.985170068,
      684.0384126984,  685.3772789116,  686.7161451247,  688.0550113379,
      662.5955555556,  663.8791836735,  665.1628117914,  666.4464399093,
      698.1793650794,  699.5182312925,  700.8570975057,  702.1959637188,
      604.6079365079,  605.762675737,   606.917414966,   608.072154195,
      523.7725623583,  524.769478458,   525.7663945578,  526.7633106576,
      442.3058956916,  443.1449886621,  443.9840816327,  444.8231746032,
      462.2363265306,  463.0754195011,  463.9145124717,  464.7536054422,
      550.9029931973,  551.8999092971,  552.8968253968,  553.8937414966,
      640.200952381,   641.35569161,    642.510430839,   643.665170068,
      745.1184126984,  746.4572789116,  747.7961451247,  749.1350113379,
      721.1555555556,  722.4391836735,  723.7228117914,  725.0064399093,
      759.2593650794,  760.5982312925,  761.9370975057,  763.2759637188,
      657.2879365079,  658.442675737,   659.597414966,   660.752154195,
      569.2525623583,  570.249478458,   571.2463945578,  572.2433106576,
      480.5858956916,  481.4249886621,  482.2640816327,  483.1031746032,
      537.8131122449,  538.7154988662,  539.6178854875,  540.5202721088,
      640.8250170068,  641.8971315193,  642.9692460317,  644.0413605442,
      744.5158333333,  745.757675737,   746.9995181406,  748.2413605442,
      866.280515873,   867.7203741497,  869.1602324263,  870.6000907029,
      837.8301587302,  839.2106122449,  840.5910657596,  841.9715192744,
      881.4881349206,  882.9279931973,  884.3678514739,  885.8077097506,
      762.8917063492,  764.1335487528,  765.3753911565,  766.6172335601,
      660.5587131519,  661.6308276644,  662.7029421769,  663.7750566893,
      557.54680839,    558.4491950113,  559.3515816327,  560.253968254,
      486.3753571429,  487.1692403628,  487.9631235828,  488.7570068027,
      579.4893027211,  580.4325056689,  581.3757086168,  582.3189115646,
      673.2005272109,  674.2930498866,  675.3855725624,  676.4780952381,
      783.2271145125,  784.4938435374,  785.7605725624,  787.0273015873,
      757.3267573696,  758.5412244898,  759.75569161,    760.9701587302,
      796.6061621315,  797.8728911565,  799.1396201814,  800.4063492063,
      689.3668764172,  690.459399093,   691.5519217687,  692.6444444444,
      596.8502097506,  597.7934126984,  598.7366156463,  599.6798185941,
      503.7362641723,  504.5301473923,  505.3240306122,  506.1179138322,
      431.0314795918,  431.7168594104,  432.402239229,   433.0876190476,
      513.5127721088,  514.3270634921,  515.1413548753,  515.9556462585,
      596.5097108844,  597.4529138322,  598.39611678,    599.3393197279,
      693.9410600907,  695.0346598639,  696.1282596372,  697.2218594104,
      670.847845805,   671.8963265306,  672.9448072562,  673.9932879819,
      705.4915362812,  706.5851360544,  707.6787358277,  708.7723356009,
      610.4665362812,  611.409739229,   612.3529421769,  613.2961451247,
      528.5008900227,  529.3151814059,  530.1294727891,  530.9437641723,
      446.0195975057,  446.7049773243,  447.3903571429,  448.0757369615,
      371.7814795918,  372.3583560091,  372.9352324263,  373.5121088435,
      442.8954251701,  443.5808049887,  444.2661848073,  444.9515646259,
      514.4433843537,  515.2372675737,  516.0311507937,  516.8250340136,
      598.4223526077,  599.3428231293,  600.2632936508,  601.1837641723,
      578.3934240363,  579.2759183673,  580.1584126984,  581.0409070295,
      608.1442573696,  609.0647278912,  609.9851984127,  610.9056689342,
      526.190685941,   526.984569161,   527.778452381,   528.5723356009,
      455.5107539683,  456.1961337868,  456.8815136054,  457.566893424,
      384.39680839,    384.9736848073,  385.5505612245,  386.1274376417,
      445.1514795918,  445.7283560091,  446.3052324263,  446.8821088435,
      530.0654251701,  530.7508049887,  531.4361848073,  532.1215646259,
      615.4133843537,  616.2072675737,  617.0011507937,  617.7950340136,
      715.4923526077,  716.4128231293,  717.3332936508,  718.2537641723,
      690.6334240363,  691.5159183673,  692.3984126984,  693.2809070295,
      725.2142573696,  726.1347278912,  727.0551984127,  727.9756689342,
      627.160685941,   627.954569161,   628.748452381,   629.5423356009,
      542.6807539683,  543.3661337868,  544.0515136054,  544.736893424,
      457.76680839,    458.3436848073,  458.9205612245,  459.4974376417,
      539.5565816327,  540.2419614512,  540.9273412698,  541.6127210884,
      642.4501190476,  643.2644104308,  644.0787018141,  644.8929931973,
      745.8593027211,  746.8025056689,  747.7457086168,  748.6889115646,
      867.1049376417,  868.198537415,   869.2921371882,  870.3857369615,
      836.8674376417,  837.9159183673,  838.964399093,   840.0128798186,
      878.6554138322,  879.7490136054,  880.8426133787,  881.9362131519,
      759.8161281179,  760.7593310658,  761.7025340136,  762.6457369615,
      657.4382369615,  658.2525283447,  659.0668197279,  659.8811111111,
      554.5446995465,  555.2300793651,  555.9154591837,  556.6008390023,
      637.8678061224,  638.6616893424,  639.4555725624,  640.2494557823,
      759.4756292517,  760.4188321995,  761.3620351474,  762.3052380952,
      881.6807312925,  882.7732539683,  883.865776644,   884.9582993197,
      1024.950175737,  1026.2169047619, 1027.4836337868, 1028.7503628118,
      989.0769614512,  990.2914285714,  991.5058956916,  992.7203628118,
      1038.329223356,  1039.595952381,  1040.8626814059, 1042.1294104308,
      897.8470804989,  898.9396031746,  900.0321258503,  901.1246485261,
      776.8365362812,  777.779739229,   778.7229421769,  779.6661451247,
      655.2287131519,  656.0225963719,  656.8164795918,  657.6103628118,
      740.0851530612,  740.9875396825,  741.8899263039,  742.7923129252,
      881.1419557823,  882.2140702948,  883.2861848073,  884.3582993197,
      1022.877670068,  1024.1195124717, 1025.3613548753, 1026.6031972789,
      1189.0280668934, 1190.4679251701, 1191.9077834467, 1193.3476417234,
      1147.2619954649, 1148.6424489796, 1150.0229024943, 1151.4033560091,
      1204.235685941,  1205.6755442177, 1207.1154024943, 1208.555260771,
      1041.2535430839, 1042.4953854875, 1043.7372278912, 1044.9790702948,
      900.8756519274,  901.9477664399,  903.0198809524,  904.0919954649,
      759.8188492063,  760.7212358277,  761.623622449,   762.5260090703,
      726.0297959184,  726.8688888889,  727.7079818594,  728.5470748299,
      864.3127891156,  865.3097052154,  866.3066213152,  867.303537415,
      1003.2270748299, 1004.381814059,  1005.536553288,  1006.691292517,
      1166.0302494331, 1167.3691156463, 1168.7079818594, 1170.0468480726,
      1124.7016780045, 1125.9853061224, 1127.2689342404, 1128.5525623583,
      1180.1712018141, 1181.5100680272, 1182.8489342404, 1184.1878004535,
      1020.3140589569, 1021.4687981859, 1022.623537415,  1023.778276644,
      882.6623582766,  883.6592743764,  884.6561904762,  885.653106576,
      744.3793650794,  745.2184580499,  746.0575510204,  746.8966439909,
      764.3097959184,  765.1488888889,  765.9879818594,  766.8270748299,
      909.7927891156,  910.7897052154,  911.7866213152,  912.783537415,
      1055.9070748299, 1057.061814059,  1058.216553288,  1059.371292517,
      1227.1102494331, 1228.4491156463, 1229.7879818594, 1231.1268480726,
      1183.2616780045, 1184.5453061224, 1185.8289342404, 1187.1125623583,
      1241.2512018141, 1242.5900680272, 1243.9289342404, 1245.2678004535,
      1072.9940589569, 1074.1487981859, 1075.303537415,  1076.458276644,
      928.1423582766,  929.1392743764,  930.1361904762,  931.133106576,
      782.6593650794,  783.4984580499,  784.3375510204,  785.1766439909,
      862.6722959184,  863.5746825397,  864.477069161,   865.3794557823,
      1026.7862414966, 1027.8583560091, 1028.9304705215, 1030.002585034,
      1191.5790986395, 1192.8209410431, 1194.0627834467, 1195.3046258503,
      1384.6294954649, 1386.0693537415, 1387.5092120181, 1388.9490702948,
      1334.7934240363, 1336.173877551,  1337.5543310658, 1338.9347845805,
      1399.8371145125, 1401.2769727891, 1402.7168310658, 1404.1566893424,
      1209.9549716553, 1211.196814059,  1212.4386564626, 1213.6804988662,
      1046.5199376417, 1047.5920521542, 1048.6641666667, 1049.7362811791,
      882.4059920635,  883.3083786848,  884.2107653061,  885.1131519274,
      772.1733163265,  772.9671995465,  773.7610827664,  774.5549659864,
      919.0423639456,  919.9855668934,  920.9287698413,  921.8719727891,
      1066.5086904762, 1067.6012131519, 1068.6937358277, 1069.7862585034,
      1239.2495634921, 1240.516292517,  1241.7830215419, 1243.0497505669,
      1194.5349206349, 1195.7493877551, 1196.9638548753, 1198.1783219955,
      1252.6286111111, 1253.8953401361, 1255.162069161,  1256.4287981859,
      1082.6750396825, 1083.7675623583, 1084.860085034,  1085.9526077098,
      936.4032709751,  937.3464739229,  938.2896768707,  939.2328798186,
      789.534223356,   790.328106576,   791.1219897959,  791.9158730159,
      677.7682142857,  678.4535941043,  679.1389739229,  679.8243537415,
      806.657670068,   807.4719614512,  808.2862528345,  809.1005442177,
      936.0627721088,  937.0059750567,  937.9491780045,  938.8923809524,
      1087.636978458,  1088.7305782313, 1089.8241780045, 1090.9177777778,
      1048.3009070295, 1049.3493877551, 1050.3978684807, 1051.4463492063,
      1099.1874546485, 1100.2810544218, 1101.374654195,  1102.4682539683,
      950.0195975057,  950.9628004535,  951.9060034014,  952.8492063492,
      821.6457879819,  822.4600793651,  823.2743707483,  824.0886621315,
      692.7563321995,  693.4417120181,  694.1270918367,  694.8124716553,
      579.4569897959,  580.0338662132,  580.6107426304,  581.1876190476,
      689.6321598639,  690.3175396825,  691.0029195011,  691.6882993197,
      800.2413435374,  801.0352267574,  801.8291099773,  802.6229931973,
      929.7917403628,  930.7122108844,  931.6326814059,  932.5531519274,
      896.09138322,    896.973877551,   897.8563718821,  898.7388662132,
      939.5136451247,  940.4341156463,  941.3545861678,  942.2750566893,
      811.9886451247,  812.7825283447,  813.5764115646,  814.3702947846,
      702.2474886621,  702.9328684807,  703.6182482993,  704.3036281179,
      592.0723185941,  592.6491950113,  593.2260714286,  593.8029478458};
  const std::array<int, 4> in_shape = {{3, 10, 9, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x10x9x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.0204081633,
                                         0.0408163265,
                                         0.0612244898,
                                         0.0816326531,
                                         0.1224489796,
                                         0.1632653061,
                                         0.2040816327,
                                         0.2448979592,
                                         0.306122449,
                                         0.3673469388,
                                         0.4285714286,
                                         0.4897959184,
                                         0.306122449,
                                         0.3673469388,
                                         0.4285714286,
                                         0.4897959184,
                                         0.306122449,
                                         0.3673469388,
                                         0.4285714286,
                                         0.4897959184,
                                         0.306122449,
                                         0.3673469388,
                                         0.4285714286,
                                         0.4897959184,
                                         0.306122449,
                                         0.3673469388,
                                         0.4285714286,
                                         0.4897959184,
                                         0.2857142857,
                                         0.3265306122,
                                         0.3673469388,
                                         0.4081632653,
                                         0.1836734694,
                                         0.2040816327,
                                         0.2244897959,
                                         0.2448979592,
                                         0.2857142857,
                                         0.3265306122,
                                         0.3673469388,
                                         0.4081632653,
                                         0.7346938776,
                                         0.8163265306,
                                         0.8979591837,
                                         0.9795918367,
                                         1.3469387755,
                                         1.4693877551,
                                         1.5918367347,
                                         1.7142857143,
                                         1.3469387755,
                                         1.4693877551,
                                         1.5918367347,
                                         1.7142857143,
                                         1.3469387755,
                                         1.4693877551,
                                         1.5918367347,
                                         1.7142857143,
                                         1.3469387755,
                                         1.4693877551,
                                         1.5918367347,
                                         1.7142857143,
                                         1.3469387755,
                                         1.4693877551,
                                         1.5918367347,
                                         1.7142857143,
                                         1.0612244898,
                                         1.1428571429,
                                         1.2244897959,
                                         1.306122449,
                                         0.612244898,
                                         0.6530612245,
                                         0.693877551,
                                         0.7346938776,
                                         0.7959183673,
                                         0.8571428571,
                                         0.9183673469,
                                         0.9795918367,
                                         1.8367346939,
                                         1.9591836735,
                                         2.0816326531,
                                         2.2040816327,
                                         3.1224489796,
                                         3.306122449,
                                         3.4897959184,
                                         3.6734693878,
                                         3.1224489796,
                                         3.306122449,
                                         3.4897959184,
                                         3.6734693878,
                                         3.1224489796,
                                         3.306122449,
                                         3.4897959184,
                                         3.6734693878,
                                         3.1224489796,
                                         3.306122449,
                                         3.4897959184,
                                         3.6734693878,
                                         3.1224489796,
                                         3.306122449,
                                         3.4897959184,
                                         3.6734693878,
                                         2.3265306122,
                                         2.4489795918,
                                         2.5714285714,
                                         2.693877551,
                                         1.2857142857,
                                         1.3469387755,
                                         1.4081632653,
                                         1.4693877551,
                                         1.5510204082,
                                         1.6326530612,
                                         1.7142857143,
                                         1.7959183673,
                                         3.4285714286,
                                         3.5918367347,
                                         3.7551020408,
                                         3.9183673469,
                                         5.6326530612,
                                         5.8775510204,
                                         6.1224489796,
                                         6.3673469388,
                                         5.6326530612,
                                         5.8775510204,
                                         6.1224489796,
                                         6.3673469388,
                                         5.6326530612,
                                         5.8775510204,
                                         6.1224489796,
                                         6.3673469388,
                                         5.6326530612,
                                         5.8775510204,
                                         6.1224489796,
                                         6.3673469388,
                                         5.6326530612,
                                         5.8775510204,
                                         6.1224489796,
                                         6.3673469388,
                                         4.0816326531,
                                         4.2448979592,
                                         4.4081632653,
                                         4.5714285714,
                                         2.2040816327,
                                         2.2857142857,
                                         2.3673469388,
                                         2.4489795918,
                                         1.5510204082,
                                         1.6326530612,
                                         1.7142857143,
                                         1.7959183673,
                                         3.4285714286,
                                         3.5918367347,
                                         3.7551020408,
                                         3.9183673469,
                                         5.6326530612,
                                         5.8775510204,
                                         6.1224489796,
                                         6.3673469388,
                                         5.6326530612,
                                         5.8775510204,
                                         6.1224489796,
                                         6.3673469388,
                                         5.6326530612,
                                         5.8775510204,
                                         6.1224489796,
                                         6.3673469388,
                                         5.6326530612,
                                         5.8775510204,
                                         6.1224489796,
                                         6.3673469388,
                                         5.6326530612,
                                         5.8775510204,
                                         6.1224489796,
                                         6.3673469388,
                                         4.0816326531,
                                         4.2448979592,
                                         4.4081632653,
                                         4.5714285714,
                                         2.2040816327,
                                         2.2857142857,
                                         2.3673469388,
                                         2.4489795918,
                                         1.5510204082,
                                         1.6326530612,
                                         1.7142857143,
                                         1.7959183673,
                                         3.4285714286,
                                         3.5918367347,
                                         3.7551020408,
                                         3.9183673469,
                                         5.6326530612,
                                         5.8775510204,
                                         6.1224489796,
                                         6.3673469388,
                                         5.6326530612,
                                         5.8775510204,
                                         6.1224489796,
                                         6.3673469388,
                                         5.6326530612,
                                         5.8775510204,
                                         6.1224489796,
                                         6.3673469388,
                                         5.6326530612,
                                         5.8775510204,
                                         6.1224489796,
                                         6.3673469388,
                                         5.6326530612,
                                         5.8775510204,
                                         6.1224489796,
                                         6.3673469388,
                                         4.0816326531,
                                         4.2448979592,
                                         4.4081632653,
                                         4.5714285714,
                                         2.2040816327,
                                         2.2857142857,
                                         2.3673469388,
                                         2.4489795918,
                                         1.5510204082,
                                         1.6326530612,
                                         1.7142857143,
                                         1.7959183673,
                                         3.4285714286,
                                         3.5918367347,
                                         3.7551020408,
                                         3.9183673469,
                                         5.6326530612,
                                         5.8775510204,
                                         6.1224489796,
                                         6.3673469388,
                                         5.6326530612,
                                         5.8775510204,
                                         6.1224489796,
                                         6.3673469388,
                                         5.6326530612,
                                         5.8775510204,
                                         6.1224489796,
                                         6.3673469388,
                                         5.6326530612,
                                         5.8775510204,
                                         6.1224489796,
                                         6.3673469388,
                                         5.6326530612,
                                         5.8775510204,
                                         6.1224489796,
                                         6.3673469388,
                                         4.0816326531,
                                         4.2448979592,
                                         4.4081632653,
                                         4.5714285714,
                                         2.2040816327,
                                         2.2857142857,
                                         2.3673469388,
                                         2.4489795918,
                                         1.5306122449,
                                         1.5918367347,
                                         1.6530612245,
                                         1.7142857143,
                                         3.306122449,
                                         3.4285714286,
                                         3.5510204082,
                                         3.6734693878,
                                         5.3265306122,
                                         5.5102040816,
                                         5.693877551,
                                         5.8775510204,
                                         5.3265306122,
                                         5.5102040816,
                                         5.693877551,
                                         5.8775510204,
                                         5.3265306122,
                                         5.5102040816,
                                         5.693877551,
                                         5.8775510204,
                                         5.3265306122,
                                         5.5102040816,
                                         5.693877551,
                                         5.8775510204,
                                         5.3265306122,
                                         5.5102040816,
                                         5.693877551,
                                         5.8775510204,
                                         3.7959183673,
                                         3.9183673469,
                                         4.0408163265,
                                         4.1632653061,
                                         2.0204081633,
                                         2.0816326531,
                                         2.1428571429,
                                         2.2040816327,
                                         1.2653061224,
                                         1.306122449,
                                         1.3469387755,
                                         1.387755102,
                                         2.693877551,
                                         2.7755102041,
                                         2.8571428571,
                                         2.9387755102,
                                         4.2857142857,
                                         4.4081632653,
                                         4.5306122449,
                                         4.6530612245,
                                         4.2857142857,
                                         4.4081632653,
                                         4.5306122449,
                                         4.6530612245,
                                         4.2857142857,
                                         4.4081632653,
                                         4.5306122449,
                                         4.6530612245,
                                         4.2857142857,
                                         4.4081632653,
                                         4.5306122449,
                                         4.6530612245,
                                         4.2857142857,
                                         4.4081632653,
                                         4.5306122449,
                                         4.6530612245,
                                         3.0204081633,
                                         3.1020408163,
                                         3.1836734694,
                                         3.2653061224,
                                         1.5918367347,
                                         1.6326530612,
                                         1.6734693878,
                                         1.7142857143,
                                         0.7551020408,
                                         0.7755102041,
                                         0.7959183673,
                                         0.8163265306,
                                         1.5918367347,
                                         1.6326530612,
                                         1.6734693878,
                                         1.7142857143,
                                         2.5102040816,
                                         2.5714285714,
                                         2.6326530612,
                                         2.693877551,
                                         2.5102040816,
                                         2.5714285714,
                                         2.6326530612,
                                         2.693877551,
                                         2.5102040816,
                                         2.5714285714,
                                         2.6326530612,
                                         2.693877551,
                                         2.5102040816,
                                         2.5714285714,
                                         2.6326530612,
                                         2.693877551,
                                         2.5102040816,
                                         2.5714285714,
                                         2.6326530612,
                                         2.693877551,
                                         1.7551020408,
                                         1.7959183673,
                                         1.8367346939,
                                         1.8775510204,
                                         0.9183673469,
                                         0.9387755102,
                                         0.9591836735,
                                         0.9795918367,
                                         1.,
                                         1.0204081633,
                                         1.0408163265,
                                         1.0612244898,
                                         2.0816326531,
                                         2.1224489796,
                                         2.1632653061,
                                         2.2040816327,
                                         3.2448979592,
                                         3.306122449,
                                         3.3673469388,
                                         3.4285714286,
                                         3.2448979592,
                                         3.306122449,
                                         3.3673469388,
                                         3.4285714286,
                                         3.2448979592,
                                         3.306122449,
                                         3.3673469388,
                                         3.4285714286,
                                         3.2448979592,
                                         3.306122449,
                                         3.3673469388,
                                         3.4285714286,
                                         3.2448979592,
                                         3.306122449,
                                         3.3673469388,
                                         3.4285714286,
                                         2.2448979592,
                                         2.2857142857,
                                         2.3265306122,
                                         2.3673469388,
                                         1.1632653061,
                                         1.1836734694,
                                         1.2040816327,
                                         1.2244897959,
                                         2.2448979592,
                                         2.2857142857,
                                         2.3265306122,
                                         2.3673469388,
                                         4.6530612245,
                                         4.7346938776,
                                         4.8163265306,
                                         4.8979591837,
                                         7.2244897959,
                                         7.3469387755,
                                         7.4693877551,
                                         7.5918367347,
                                         7.2244897959,
                                         7.3469387755,
                                         7.4693877551,
                                         7.5918367347,
                                         7.2244897959,
                                         7.3469387755,
                                         7.4693877551,
                                         7.5918367347,
                                         7.2244897959,
                                         7.3469387755,
                                         7.4693877551,
                                         7.5918367347,
                                         7.2244897959,
                                         7.3469387755,
                                         7.4693877551,
                                         7.5918367347,
                                         4.9795918367,
                                         5.0612244898,
                                         5.1428571429,
                                         5.2244897959,
                                         2.5714285714,
                                         2.612244898,
                                         2.6530612245,
                                         2.693877551,
                                         3.7346938776,
                                         3.7959183673,
                                         3.8571428571,
                                         3.9183673469,
                                         7.7142857143,
                                         7.8367346939,
                                         7.9591836735,
                                         8.0816326531,
                                         11.9387755102,
                                         12.1224489796,
                                         12.306122449,
                                         12.4897959184,
                                         11.9387755102,
                                         12.1224489796,
                                         12.306122449,
                                         12.4897959184,
                                         11.9387755102,
                                         12.1224489796,
                                         12.306122449,
                                         12.4897959184,
                                         11.9387755102,
                                         12.1224489796,
                                         12.306122449,
                                         12.4897959184,
                                         11.9387755102,
                                         12.1224489796,
                                         12.306122449,
                                         12.4897959184,
                                         8.2040816327,
                                         8.3265306122,
                                         8.4489795918,
                                         8.5714285714,
                                         4.2244897959,
                                         4.2857142857,
                                         4.3469387755,
                                         4.4081632653,
                                         5.4693877551,
                                         5.5510204082,
                                         5.6326530612,
                                         5.7142857143,
                                         11.2653061224,
                                         11.4285714286,
                                         11.5918367347,
                                         11.7551020408,
                                         17.387755102,
                                         17.6326530612,
                                         17.8775510204,
                                         18.1224489796,
                                         17.387755102,
                                         17.6326530612,
                                         17.8775510204,
                                         18.1224489796,
                                         17.387755102,
                                         17.6326530612,
                                         17.8775510204,
                                         18.1224489796,
                                         17.387755102,
                                         17.6326530612,
                                         17.8775510204,
                                         18.1224489796,
                                         17.387755102,
                                         17.6326530612,
                                         17.8775510204,
                                         18.1224489796,
                                         11.9183673469,
                                         12.0816326531,
                                         12.2448979592,
                                         12.4081632653,
                                         6.1224489796,
                                         6.2040816327,
                                         6.2857142857,
                                         6.3673469388,
                                         5.4693877551,
                                         5.5510204082,
                                         5.6326530612,
                                         5.7142857143,
                                         11.2653061224,
                                         11.4285714286,
                                         11.5918367347,
                                         11.7551020408,
                                         17.387755102,
                                         17.6326530612,
                                         17.8775510204,
                                         18.1224489796,
                                         17.387755102,
                                         17.6326530612,
                                         17.8775510204,
                                         18.1224489796,
                                         17.387755102,
                                         17.6326530612,
                                         17.8775510204,
                                         18.1224489796,
                                         17.387755102,
                                         17.6326530612,
                                         17.8775510204,
                                         18.1224489796,
                                         17.387755102,
                                         17.6326530612,
                                         17.8775510204,
                                         18.1224489796,
                                         11.9183673469,
                                         12.0816326531,
                                         12.2448979592,
                                         12.4081632653,
                                         6.1224489796,
                                         6.2040816327,
                                         6.2857142857,
                                         6.3673469388,
                                         5.4693877551,
                                         5.5510204082,
                                         5.6326530612,
                                         5.7142857143,
                                         11.2653061224,
                                         11.4285714286,
                                         11.5918367347,
                                         11.7551020408,
                                         17.387755102,
                                         17.6326530612,
                                         17.8775510204,
                                         18.1224489796,
                                         17.387755102,
                                         17.6326530612,
                                         17.8775510204,
                                         18.1224489796,
                                         17.387755102,
                                         17.6326530612,
                                         17.8775510204,
                                         18.1224489796,
                                         17.387755102,
                                         17.6326530612,
                                         17.8775510204,
                                         18.1224489796,
                                         17.387755102,
                                         17.6326530612,
                                         17.8775510204,
                                         18.1224489796,
                                         11.9183673469,
                                         12.0816326531,
                                         12.2448979592,
                                         12.4081632653,
                                         6.1224489796,
                                         6.2040816327,
                                         6.2857142857,
                                         6.3673469388,
                                         5.4693877551,
                                         5.5510204082,
                                         5.6326530612,
                                         5.7142857143,
                                         11.2653061224,
                                         11.4285714286,
                                         11.5918367347,
                                         11.7551020408,
                                         17.387755102,
                                         17.6326530612,
                                         17.8775510204,
                                         18.1224489796,
                                         17.387755102,
                                         17.6326530612,
                                         17.8775510204,
                                         18.1224489796,
                                         17.387755102,
                                         17.6326530612,
                                         17.8775510204,
                                         18.1224489796,
                                         17.387755102,
                                         17.6326530612,
                                         17.8775510204,
                                         18.1224489796,
                                         17.387755102,
                                         17.6326530612,
                                         17.8775510204,
                                         18.1224489796,
                                         11.9183673469,
                                         12.0816326531,
                                         12.2448979592,
                                         12.4081632653,
                                         6.1224489796,
                                         6.2040816327,
                                         6.2857142857,
                                         6.3673469388,
                                         4.4693877551,
                                         4.5306122449,
                                         4.5918367347,
                                         4.6530612245,
                                         9.1836734694,
                                         9.306122449,
                                         9.4285714286,
                                         9.5510204082,
                                         14.1428571429,
                                         14.3265306122,
                                         14.5102040816,
                                         14.693877551,
                                         14.1428571429,
                                         14.3265306122,
                                         14.5102040816,
                                         14.693877551,
                                         14.1428571429,
                                         14.3265306122,
                                         14.5102040816,
                                         14.693877551,
                                         14.1428571429,
                                         14.3265306122,
                                         14.5102040816,
                                         14.693877551,
                                         14.1428571429,
                                         14.3265306122,
                                         14.5102040816,
                                         14.693877551,
                                         9.6734693878,
                                         9.7959183673,
                                         9.9183673469,
                                         10.0408163265,
                                         4.9591836735,
                                         5.0204081633,
                                         5.0816326531,
                                         5.1428571429,
                                         3.2244897959,
                                         3.2653061224,
                                         3.306122449,
                                         3.3469387755,
                                         6.612244898,
                                         6.693877551,
                                         6.7755102041,
                                         6.8571428571,
                                         10.1632653061,
                                         10.2857142857,
                                         10.4081632653,
                                         10.5306122449,
                                         10.1632653061,
                                         10.2857142857,
                                         10.4081632653,
                                         10.5306122449,
                                         10.1632653061,
                                         10.2857142857,
                                         10.4081632653,
                                         10.5306122449,
                                         10.1632653061,
                                         10.2857142857,
                                         10.4081632653,
                                         10.5306122449,
                                         10.1632653061,
                                         10.2857142857,
                                         10.4081632653,
                                         10.5306122449,
                                         6.9387755102,
                                         7.0204081633,
                                         7.1020408163,
                                         7.1836734694,
                                         3.5510204082,
                                         3.5918367347,
                                         3.6326530612,
                                         3.6734693878,
                                         1.7346938776,
                                         1.7551020408,
                                         1.7755102041,
                                         1.7959183673,
                                         3.5510204082,
                                         3.5918367347,
                                         3.6326530612,
                                         3.6734693878,
                                         5.4489795918,
                                         5.5102040816,
                                         5.5714285714,
                                         5.6326530612,
                                         5.4489795918,
                                         5.5102040816,
                                         5.5714285714,
                                         5.6326530612,
                                         5.4489795918,
                                         5.5102040816,
                                         5.5714285714,
                                         5.6326530612,
                                         5.4489795918,
                                         5.5102040816,
                                         5.5714285714,
                                         5.6326530612,
                                         5.4489795918,
                                         5.5102040816,
                                         5.5714285714,
                                         5.6326530612,
                                         3.7142857143,
                                         3.7551020408,
                                         3.7959183673,
                                         3.8367346939,
                                         1.8979591837,
                                         1.9183673469,
                                         1.9387755102,
                                         1.9591836735,
                                         1.9795918367,
                                         2.,
                                         2.0204081633,
                                         2.0408163265,
                                         4.0408163265,
                                         4.0816326531,
                                         4.1224489796,
                                         4.1632653061,
                                         6.1836734694,
                                         6.2448979592,
                                         6.306122449,
                                         6.3673469388,
                                         6.1836734694,
                                         6.2448979592,
                                         6.306122449,
                                         6.3673469388,
                                         6.1836734694,
                                         6.2448979592,
                                         6.306122449,
                                         6.3673469388,
                                         6.1836734694,
                                         6.2448979592,
                                         6.306122449,
                                         6.3673469388,
                                         6.1836734694,
                                         6.2448979592,
                                         6.306122449,
                                         6.3673469388,
                                         4.2040816327,
                                         4.2448979592,
                                         4.2857142857,
                                         4.3265306122,
                                         2.1428571429,
                                         2.1632653061,
                                         2.1836734694,
                                         2.2040816327,
                                         4.2040816327,
                                         4.2448979592,
                                         4.2857142857,
                                         4.3265306122,
                                         8.5714285714,
                                         8.6530612245,
                                         8.7346938776,
                                         8.8163265306,
                                         13.1020408163,
                                         13.2244897959,
                                         13.3469387755,
                                         13.4693877551,
                                         13.1020408163,
                                         13.2244897959,
                                         13.3469387755,
                                         13.4693877551,
                                         13.1020408163,
                                         13.2244897959,
                                         13.3469387755,
                                         13.4693877551,
                                         13.1020408163,
                                         13.2244897959,
                                         13.3469387755,
                                         13.4693877551,
                                         13.1020408163,
                                         13.2244897959,
                                         13.3469387755,
                                         13.4693877551,
                                         8.8979591837,
                                         8.9795918367,
                                         9.0612244898,
                                         9.1428571429,
                                         4.5306122449,
                                         4.5714285714,
                                         4.612244898,
                                         4.6530612245,
                                         6.6734693878,
                                         6.7346938776,
                                         6.7959183673,
                                         6.8571428571,
                                         13.5918367347,
                                         13.7142857143,
                                         13.8367346939,
                                         13.9591836735,
                                         20.7551020408,
                                         20.9387755102,
                                         21.1224489796,
                                         21.306122449,
                                         20.7551020408,
                                         20.9387755102,
                                         21.1224489796,
                                         21.306122449,
                                         20.7551020408,
                                         20.9387755102,
                                         21.1224489796,
                                         21.306122449,
                                         20.7551020408,
                                         20.9387755102,
                                         21.1224489796,
                                         21.306122449,
                                         20.7551020408,
                                         20.9387755102,
                                         21.1224489796,
                                         21.306122449,
                                         14.0816326531,
                                         14.2040816327,
                                         14.3265306122,
                                         14.4489795918,
                                         7.1632653061,
                                         7.2244897959,
                                         7.2857142857,
                                         7.3469387755,
                                         9.387755102,
                                         9.4693877551,
                                         9.5510204082,
                                         9.6326530612,
                                         19.1020408163,
                                         19.2653061224,
                                         19.4285714286,
                                         19.5918367347,
                                         29.1428571429,
                                         29.387755102,
                                         29.6326530612,
                                         29.8775510204,
                                         29.1428571429,
                                         29.387755102,
                                         29.6326530612,
                                         29.8775510204,
                                         29.1428571429,
                                         29.387755102,
                                         29.6326530612,
                                         29.8775510204,
                                         29.1428571429,
                                         29.387755102,
                                         29.6326530612,
                                         29.8775510204,
                                         29.1428571429,
                                         29.387755102,
                                         29.6326530612,
                                         29.8775510204,
                                         19.7551020408,
                                         19.9183673469,
                                         20.0816326531,
                                         20.2448979592,
                                         10.0408163265,
                                         10.1224489796,
                                         10.2040816327,
                                         10.2857142857,
                                         9.387755102,
                                         9.4693877551,
                                         9.5510204082,
                                         9.6326530612,
                                         19.1020408163,
                                         19.2653061224,
                                         19.4285714286,
                                         19.5918367347,
                                         29.1428571429,
                                         29.387755102,
                                         29.6326530612,
                                         29.8775510204,
                                         29.1428571429,
                                         29.387755102,
                                         29.6326530612,
                                         29.8775510204,
                                         29.1428571429,
                                         29.387755102,
                                         29.6326530612,
                                         29.8775510204,
                                         29.1428571429,
                                         29.387755102,
                                         29.6326530612,
                                         29.8775510204,
                                         29.1428571429,
                                         29.387755102,
                                         29.6326530612,
                                         29.8775510204,
                                         19.7551020408,
                                         19.9183673469,
                                         20.0816326531,
                                         20.2448979592,
                                         10.0408163265,
                                         10.1224489796,
                                         10.2040816327,
                                         10.2857142857,
                                         9.387755102,
                                         9.4693877551,
                                         9.5510204082,
                                         9.6326530612,
                                         19.1020408163,
                                         19.2653061224,
                                         19.4285714286,
                                         19.5918367347,
                                         29.1428571429,
                                         29.387755102,
                                         29.6326530612,
                                         29.8775510204,
                                         29.1428571429,
                                         29.387755102,
                                         29.6326530612,
                                         29.8775510204,
                                         29.1428571429,
                                         29.387755102,
                                         29.6326530612,
                                         29.8775510204,
                                         29.1428571429,
                                         29.387755102,
                                         29.6326530612,
                                         29.8775510204,
                                         29.1428571429,
                                         29.387755102,
                                         29.6326530612,
                                         29.8775510204,
                                         19.7551020408,
                                         19.9183673469,
                                         20.0816326531,
                                         20.2448979592,
                                         10.0408163265,
                                         10.1224489796,
                                         10.2040816327,
                                         10.2857142857,
                                         9.387755102,
                                         9.4693877551,
                                         9.5510204082,
                                         9.6326530612,
                                         19.1020408163,
                                         19.2653061224,
                                         19.4285714286,
                                         19.5918367347,
                                         29.1428571429,
                                         29.387755102,
                                         29.6326530612,
                                         29.8775510204,
                                         29.1428571429,
                                         29.387755102,
                                         29.6326530612,
                                         29.8775510204,
                                         29.1428571429,
                                         29.387755102,
                                         29.6326530612,
                                         29.8775510204,
                                         29.1428571429,
                                         29.387755102,
                                         29.6326530612,
                                         29.8775510204,
                                         29.1428571429,
                                         29.387755102,
                                         29.6326530612,
                                         29.8775510204,
                                         19.7551020408,
                                         19.9183673469,
                                         20.0816326531,
                                         20.2448979592,
                                         10.0408163265,
                                         10.1224489796,
                                         10.2040816327,
                                         10.2857142857,
                                         7.4081632653,
                                         7.4693877551,
                                         7.5306122449,
                                         7.5918367347,
                                         15.0612244898,
                                         15.1836734694,
                                         15.306122449,
                                         15.4285714286,
                                         22.9591836735,
                                         23.1428571429,
                                         23.3265306122,
                                         23.5102040816,
                                         22.9591836735,
                                         23.1428571429,
                                         23.3265306122,
                                         23.5102040816,
                                         22.9591836735,
                                         23.1428571429,
                                         23.3265306122,
                                         23.5102040816,
                                         22.9591836735,
                                         23.1428571429,
                                         23.3265306122,
                                         23.5102040816,
                                         22.9591836735,
                                         23.1428571429,
                                         23.3265306122,
                                         23.5102040816,
                                         15.5510204082,
                                         15.6734693878,
                                         15.7959183673,
                                         15.9183673469,
                                         7.8979591837,
                                         7.9591836735,
                                         8.0204081633,
                                         8.0816326531,
                                         5.1836734694,
                                         5.2244897959,
                                         5.2653061224,
                                         5.306122449,
                                         10.5306122449,
                                         10.612244898,
                                         10.693877551,
                                         10.7755102041,
                                         16.0408163265,
                                         16.1632653061,
                                         16.2857142857,
                                         16.4081632653,
                                         16.0408163265,
                                         16.1632653061,
                                         16.2857142857,
                                         16.4081632653,
                                         16.0408163265,
                                         16.1632653061,
                                         16.2857142857,
                                         16.4081632653,
                                         16.0408163265,
                                         16.1632653061,
                                         16.2857142857,
                                         16.4081632653,
                                         16.0408163265,
                                         16.1632653061,
                                         16.2857142857,
                                         16.4081632653,
                                         10.8571428571,
                                         10.9387755102,
                                         11.0204081633,
                                         11.1020408163,
                                         5.5102040816,
                                         5.5510204082,
                                         5.5918367347,
                                         5.6326530612,
                                         2.7142857143,
                                         2.7346938776,
                                         2.7551020408,
                                         2.7755102041,
                                         5.5102040816,
                                         5.5510204082,
                                         5.5918367347,
                                         5.6326530612,
                                         8.387755102,
                                         8.4489795918,
                                         8.5102040816,
                                         8.5714285714,
                                         8.387755102,
                                         8.4489795918,
                                         8.5102040816,
                                         8.5714285714,
                                         8.387755102,
                                         8.4489795918,
                                         8.5102040816,
                                         8.5714285714,
                                         8.387755102,
                                         8.4489795918,
                                         8.5102040816,
                                         8.5714285714,
                                         8.387755102,
                                         8.4489795918,
                                         8.5102040816,
                                         8.5714285714,
                                         5.6734693878,
                                         5.7142857143,
                                         5.7551020408,
                                         5.7959183673,
                                         2.8775510204,
                                         2.8979591837,
                                         2.9183673469,
                                         2.9387755102};
  const std::array<int, 4> in_shape = {{3, 10, 9, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x10x10x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      8.613361678,    10.5300283447,  12.5551984127,  14.6888718821,
      14.7101020408,  15.7734353741,  18.0940702948,  16.2859070295,
      14.3692403628,  12.3440702948,  13.1994160998,  16.0344501134,
      18.9983956916,  22.0912528345,  21.7910544218,  23.0543877551,
      26.1369274376,  23.4308049887,  20.5957709751,  17.6318253968,
      18.8705045351,  22.8279875283,  26.9347902494,  31.1909126984,
      30.4502380952,  31.9135714286,  35.8770634921,  32.0689002268,
      28.1114172336,  24.0046145125,  25.6266269841,  30.9106405896,
      36.3643820862,  41.9878514739,  40.6876530612,  42.3509863946,
      47.314478458,   42.2001927438,  36.9161791383,  31.4624376417,
      34.3442857143,  41.2354421769,  48.2844217687,  55.4912244898,
      53.1285260771,  54.6751927438,  60.4442403628,  53.7109070295,
      46.8197505669,  39.7707709751,  44.9776190476,  53.8687755102,
      62.917755102,   72.1245578231,  68.5951927438,  70.1418594104,
      77.0775736961,  68.3442403628,  59.4530839002,  50.4041043084,
      59.6786111111,  71.3673866213,  83.2258900227,  95.2541213152,
      90.2178117914,  91.8811451247,  100.5807482993, 89.0617006803,
      77.3729251701,  65.5144217687,  56.1775907029,  67.1520804989,
      78.2758900227,  89.5490192744,  84.7150907029,  86.1784240363,
      94.235170068,   83.41,          72.4355102041,  61.3117006803,
      51.5915362812,  61.6476587302,  71.8326927438,  82.146638322,
      77.634138322,   78.8974716553,  86.1923129252,  76.2651020408,
      66.2089795918,  56.0239455782,  45.9204478458,  54.8541213152,
      63.8962981859,  73.046978458,   68.9749546485,  70.0382879819,
      76.4521768707,  67.6270068027,  58.6933333333,  49.6511564626,
      66.3010034014,  79.0680102041,  91.9435204082,  104.9275340136,
      98.619399093,   99.6827324263,  108.3327324263, 95.6742290249,
      82.9072222222,  70.0317120181,  81.7373979592,  97.4635884354,
      113.3186904762, 129.3027040816, 121.4826643991, 122.7459977324,
      133.3483786848, 117.7510997732, 102.0249092971, 86.1698072562,
      98.2588265306,  117.1482823129, 136.1870578231, 155.3751530612,
      145.9241609977, 147.3874943311, 160.0613038549, 141.3211678005,
      122.4317120181, 103.3929365079, 115.8652891156, 138.1220918367,
      160.548622449,  183.1448809524, 171.9438888889, 173.6072222222,
      188.4715079365, 166.3844331066, 144.1276303855, 121.7010997732,
      118.2535827664, 140.9270521542, 163.7583446712, 186.7474603175,
      175.1784126984, 176.7250793651, 191.7004761905, 169.184829932,
      146.5113605442, 123.6800680272, 128.8869160998, 153.5603854875,
      178.3916780045, 203.3807936508, 190.6450793651, 192.1917460317,
      208.3338095238, 183.8181632653, 159.1446938776, 134.3134013605,
      149.9172732426, 178.5788378685, 207.4101303855, 236.4111507937,
      221.474047619,  223.1373809524, 241.7377777778, 213.2459410431,
      184.5843764172, 155.7530839002, 135.5659126984, 161.4723752834,
      187.5281575964, 213.7332596372, 200.1890136054, 201.6523469388,
      218.4194104308, 192.6622675737, 166.7558049887, 140.7000226757,
      120.1295181406, 143.0767970522, 166.1529875283, 189.3580895692,
      177.3257482993, 178.5890816327, 193.4037641723, 170.5853968254,
      147.6381179138, 124.5619274376, 103.6080895692, 123.3921031746,
      143.2846201814, 163.2856405896, 152.8842517007, 153.947585034,
      166.6908390023, 147.0153287982, 127.2313151927, 107.3387981859,
      123.9886451247, 147.6059920635, 171.3318424036, 195.1661961451,
      182.5286961451, 183.5920294785, 198.5713945578, 175.0625510204,
      151.4452040816, 127.7193537415, 150.2753798186, 178.8927267574,
      207.6389852608, 236.5141553288, 221.1742743764, 222.4376077098,
      240.559829932,  212.0713945578, 183.454047619,  154.7077891156,
      177.6471485261, 211.4685770975, 245.4393253968, 279.559393424,
      261.3980839002, 262.8614172336, 284.2455442177, 250.5734353741,
      216.7520068027, 182.7812585034, 206.1039512472, 245.3335430839,
      284.7328628118, 324.3019104308, 303.2001247166, 304.8634580499,
      329.628537415,  290.5686734694, 251.3390816327, 211.9397619048,
      202.1628798186, 240.6186621315, 279.2322675737, 318.0036961451,
      297.2282993197, 298.7749659864, 322.9567120181, 284.6587528345,
      246.2029705215, 207.5893650794, 212.7962131519, 253.2519954649,
      293.865600907,  334.6370294785, 312.6949659864, 314.2416326531,
      339.5900453515, 299.2920861678, 258.8363038549, 218.2226984127,
      240.1559353741, 285.7902891156, 331.5943707483, 377.5681802721,
      352.7302834467, 354.39361678,   382.8948072562, 337.4301814059,
      291.7958276644, 245.9917460317, 214.9542346939, 255.792670068,
      296.7804251701, 337.9175,       315.6629365079, 317.1262698413,
      342.6036507937, 301.9145351474, 261.0760997732, 220.0883446712,
      188.6675,       224.5059353741, 260.4732823129, 296.5695408163,
      277.0173582766, 278.28069161,   300.6152154195, 264.90569161,
      229.0672562358, 193.0999092971, 161.2957312925, 191.930085034,
      222.6729421769, 253.5243027211, 236.7935487528, 237.8568820862,
      256.9295011338, 226.4036507937, 195.7692970522, 165.0264399093};
  const std::array<int, 4> in_shape = {{3, 10, 10, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x10x10x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.0204081633,
                                         0.0612244898,
                                         0.1224489796,
                                         0.2040816327,
                                         0.2040816327,
                                         0.2040816327,
                                         0.2040816327,
                                         0.1836734694,
                                         0.1428571429,
                                         0.0816326531,
                                         0.1224489796,
                                         0.2857142857,
                                         0.4897959184,
                                         0.7346938776,
                                         0.7346938776,
                                         0.7346938776,
                                         0.7346938776,
                                         0.612244898,
                                         0.4489795918,
                                         0.2448979592,
                                         0.306122449,
                                         0.6734693878,
                                         1.1020408163,
                                         1.5918367347,
                                         1.5918367347,
                                         1.5918367347,
                                         1.5918367347,
                                         1.2857142857,
                                         0.9183673469,
                                         0.4897959184,
                                         0.5714285714,
                                         1.2244897959,
                                         1.9591836735,
                                         2.7755102041,
                                         2.7755102041,
                                         2.7755102041,
                                         2.7755102041,
                                         2.2040816327,
                                         1.5510204082,
                                         0.8163265306,
                                         0.5714285714,
                                         1.2244897959,
                                         1.9591836735,
                                         2.7755102041,
                                         2.7755102041,
                                         2.7755102041,
                                         2.7755102041,
                                         2.2040816327,
                                         1.5510204082,
                                         0.8163265306,
                                         0.5714285714,
                                         1.2244897959,
                                         1.9591836735,
                                         2.7755102041,
                                         2.7755102041,
                                         2.7755102041,
                                         2.7755102041,
                                         2.2040816327,
                                         1.5510204082,
                                         0.8163265306,
                                         0.5714285714,
                                         1.2244897959,
                                         1.9591836735,
                                         2.7755102041,
                                         2.7755102041,
                                         2.7755102041,
                                         2.7755102041,
                                         2.2040816327,
                                         1.5510204082,
                                         0.8163265306,
                                         0.5510204082,
                                         1.1632653061,
                                         1.8367346939,
                                         2.5714285714,
                                         2.5714285714,
                                         2.5714285714,
                                         2.5714285714,
                                         2.0204081633,
                                         1.4081632653,
                                         0.7346938776,
                                         0.4489795918,
                                         0.9387755102,
                                         1.4693877551,
                                         2.0408163265,
                                         2.0408163265,
                                         2.0408163265,
                                         2.0408163265,
                                         1.5918367347,
                                         1.1020408163,
                                         0.5714285714,
                                         0.2653061224,
                                         0.5510204082,
                                         0.8571428571,
                                         1.1836734694,
                                         1.1836734694,
                                         1.1836734694,
                                         1.1836734694,
                                         0.9183673469,
                                         0.6326530612,
                                         0.3265306122,
                                         0.3469387755,
                                         0.7142857143,
                                         1.1020408163,
                                         1.5102040816,
                                         1.5102040816,
                                         1.5102040816,
                                         1.5102040816,
                                         1.1632653061,
                                         0.7959183673,
                                         0.4081632653,
                                         0.7755102041,
                                         1.5918367347,
                                         2.4489795918,
                                         3.3469387755,
                                         3.3469387755,
                                         3.3469387755,
                                         3.3469387755,
                                         2.5714285714,
                                         1.7551020408,
                                         0.8979591837,
                                         1.2857142857,
                                         2.6326530612,
                                         4.0408163265,
                                         5.5102040816,
                                         5.5102040816,
                                         5.5102040816,
                                         5.5102040816,
                                         4.2244897959,
                                         2.8775510204,
                                         1.4693877551,
                                         1.8775510204,
                                         3.8367346939,
                                         5.8775510204,
                                         8.,
                                         8.,
                                         8.,
                                         8.,
                                         6.1224489796,
                                         4.1632653061,
                                         2.1224489796,
                                         1.8775510204,
                                         3.8367346939,
                                         5.8775510204,
                                         8.,
                                         8.,
                                         8.,
                                         8.,
                                         6.1224489796,
                                         4.1632653061,
                                         2.1224489796,
                                         1.8775510204,
                                         3.8367346939,
                                         5.8775510204,
                                         8.,
                                         8.,
                                         8.,
                                         8.,
                                         6.1224489796,
                                         4.1632653061,
                                         2.1224489796,
                                         1.8775510204,
                                         3.8367346939,
                                         5.8775510204,
                                         8.,
                                         8.,
                                         8.,
                                         8.,
                                         6.1224489796,
                                         4.1632653061,
                                         2.1224489796,
                                         1.5306122449,
                                         3.1224489796,
                                         4.7755102041,
                                         6.4897959184,
                                         6.4897959184,
                                         6.4897959184,
                                         6.4897959184,
                                         4.9591836735,
                                         3.3673469388,
                                         1.7142857143,
                                         1.1020408163,
                                         2.2448979592,
                                         3.4285714286,
                                         4.6530612245,
                                         4.6530612245,
                                         4.6530612245,
                                         4.6530612245,
                                         3.5510204082,
                                         2.4081632653,
                                         1.2244897959,
                                         0.5918367347,
                                         1.2040816327,
                                         1.8367346939,
                                         2.4897959184,
                                         2.4897959184,
                                         2.4897959184,
                                         2.4897959184,
                                         1.8979591837,
                                         1.2857142857,
                                         0.6530612245,
                                         0.6734693878,
                                         1.3673469388,
                                         2.0816326531,
                                         2.8163265306,
                                         2.8163265306,
                                         2.8163265306,
                                         2.8163265306,
                                         2.1428571429,
                                         1.4489795918,
                                         0.7346938776,
                                         1.4285714286,
                                         2.8979591837,
                                         4.4081632653,
                                         5.9591836735,
                                         5.9591836735,
                                         5.9591836735,
                                         5.9591836735,
                                         4.5306122449,
                                         3.0612244898,
                                         1.5510204082,
                                         2.2653061224,
                                         4.5918367347,
                                         6.9795918367,
                                         9.4285714286,
                                         9.4285714286,
                                         9.4285714286,
                                         9.4285714286,
                                         7.1632653061,
                                         4.8367346939,
                                         2.4489795918,
                                         3.1836734694,
                                         6.4489795918,
                                         9.7959183673,
                                         13.2244897959,
                                         13.2244897959,
                                         13.2244897959,
                                         13.2244897959,
                                         10.0408163265,
                                         6.7755102041,
                                         3.4285714286,
                                         3.1836734694,
                                         6.4489795918,
                                         9.7959183673,
                                         13.2244897959,
                                         13.2244897959,
                                         13.2244897959,
                                         13.2244897959,
                                         10.0408163265,
                                         6.7755102041,
                                         3.4285714286,
                                         3.1836734694,
                                         6.4489795918,
                                         9.7959183673,
                                         13.2244897959,
                                         13.2244897959,
                                         13.2244897959,
                                         13.2244897959,
                                         10.0408163265,
                                         6.7755102041,
                                         3.4285714286,
                                         3.1836734694,
                                         6.4489795918,
                                         9.7959183673,
                                         13.2244897959,
                                         13.2244897959,
                                         13.2244897959,
                                         13.2244897959,
                                         10.0408163265,
                                         6.7755102041,
                                         3.4285714286,
                                         2.5102040816,
                                         5.0816326531,
                                         7.7142857143,
                                         10.4081632653,
                                         10.4081632653,
                                         10.4081632653,
                                         10.4081632653,
                                         7.8979591837,
                                         5.3265306122,
                                         2.693877551,
                                         1.7551020408,
                                         3.5510204082,
                                         5.387755102,
                                         7.2653061224,
                                         7.2653061224,
                                         7.2653061224,
                                         7.2653061224,
                                         5.5102040816,
                                         3.7142857143,
                                         1.8775510204,
                                         0.9183673469,
                                         1.8571428571,
                                         2.8163265306,
                                         3.7959183673,
                                         3.7959183673,
                                         3.7959183673,
                                         3.7959183673,
                                         2.8775510204,
                                         1.9387755102,
                                         0.9795918367};
  const std::array<int, 4> in_shape = {{3, 10, 10, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x10x10x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      16.6498469388,  17.226723356,   20.3746768707,  21.0600566893,
      24.3165136054,  25.1103968254,  28.4753571429,  29.3777437642,
      28.5811111111,  29.4202040816,  30.7077777778,  31.5468707483,
      35.2857539683,  36.1881405896,  31.777930839,   32.571814059,
      28.053100907,   28.7384807256,  24.1112641723,  24.6881405896,
      25.713452381,   26.3988321995,  31.2546088435,  32.0689002268,
      37.0535884354,  37.9967913832,  43.1103911565,  44.1825056689,
      42.5851927438,  43.5821088435,  45.1118594104,  46.1087755102,
      51.2017403628,  52.2738548753,  45.9184070295,  46.8616099773,
      40.3772505669,  41.1915419501,  34.5782709751,  35.2636507937,
      36.9471258503,  37.7410090703,  44.7127721088,  45.6559750567,
      52.7770578231,  53.8695804989,  61.1399829932,  62.3818253968,
      59.7457369615,  60.9004761905,  62.6724036281,  63.8271428571,
      70.5122845805,  71.7541269841,  63.0452777778,  64.1378004535,
      55.2796315193,  56.2228344671,  47.215345805,   48.0092290249,
      50.3508673469,  51.2532539683,  60.7491666667,  61.8212811791,
      71.4869217687,  72.7287641723,  82.5641326531,  83.9757029478,
      80.0627437642,  81.3753061224,  83.3894104308,  84.7019727891,
      93.2173866213,  94.6289569161,  83.1585430839,  84.4003854875,
      72.7602437642,  73.8323582766,  62.0224886621,  62.9248752834,
      67.849478458,   68.6885714286,  81.473968254,   82.4708843537,
      95.4141043084,  96.5688435374,  109.6698866213, 110.9824489796,
      105.036553288,  106.2570521542, 108.1298866213, 109.3503854875,
      119.5759183673, 120.8884807256, 106.2670748299, 107.421814059,
      92.642585034,   93.6395011338,  78.7024489796,  79.5415419501,
      89.1161451247,  89.9552380952,  106.7406349206, 107.7375510204,
      124.6807709751, 125.8355102041, 142.936553288,  144.2491156463,
      135.9698866213, 137.1903854875, 139.0632199546, 140.2837188209,
      152.842585034,  154.1551473923, 135.5337414966, 136.6884807256,
      117.9092517007, 118.9061678005, 99.9691156463,  100.8082086168,
      118.4548356009, 119.3572222222, 141.6626587302, 142.7347732426,
      165.2099376417, 166.4517800454, 189.0966723356, 190.5082426304,
      179.1230612245, 180.4356235828, 182.4497278912, 183.7622902494,
      199.7499263039, 201.1614965986, 176.8815589569, 178.1234013605,
      153.6737358277, 154.7458503401, 130.1264569161, 131.0288435374,
      111.5612981859, 112.3551814059, 133.3609580499, 134.3041609977,
      155.4592573696, 156.5517800454, 177.8561961451, 179.0980385488,
      168.2754421769, 169.4301814059, 171.2021088435, 172.3568480726,
      187.2284977324, 188.4703401361, 165.7274773243, 166.82,
      143.9278174603, 144.8710204082, 121.8295181406, 122.6234013605,
      102.4976927438, 103.1830725624, 122.4810260771, 123.2953174603,
      142.7221825397, 143.6653854875, 163.2211621315, 164.293276644,
      154.2713605442, 155.268276644,  156.7980272109, 157.7949433107,
      171.3125113379, 172.3846258503, 151.5870011338, 152.5302040816,
      131.6036678005, 132.4179591837, 111.3625113379, 112.0478911565,
      91.2640192744,  91.8408956916,  109.0228628118, 109.7082426304,
      126.9987131519, 127.7925963719, 145.1915702948, 146.0939569161,
      137.1108163265, 137.9499092971, 139.2374829932, 140.0765759637,
      152.0019671202, 152.9043537415, 134.4601303855, 135.2540136054,
      116.7012868481, 117.3866666667, 98.7254365079,  99.3023129252,
      132.0251303855, 132.6020068027, 157.4506405896, 158.1360204082,
      183.0931575964, 183.8870408163, 208.9526814059, 209.8550680272,
      196.3997052154, 197.2387981859, 198.5263718821, 199.3654648526,
      215.7630782313, 216.6654648526, 190.5545748299, 191.3484580499,
      165.1290646259, 165.8144444444, 139.486547619,  140.0634240363,
      162.7894160998, 163.4747959184, 194.1128854875, 194.9271768707,
      225.6941780045, 226.6373809524, 257.5332936508, 258.6054081633,
      241.9684126984, 242.9653287982, 244.4950793651, 245.4919954649,
      265.6246428571, 266.6967573696, 234.5589965986, 235.5021995465,
      203.2355272109, 204.0498185941, 171.6542346939, 172.3396145125,
      195.7237698413, 196.5176530612, 233.353361678,  234.2965646259,
      271.2815929705, 272.3741156463, 309.5084637188, 310.7503061224,
      290.6935827664, 291.8483219955, 293.6202494331, 294.7749886621,
      318.8807653061, 320.1226077098, 281.5498129252, 282.6423356009,
      243.9202210884, 244.8634240363, 205.9919897959, 206.7858730159,
      230.82819161,   231.7305782313, 275.172069161,  276.2441836735,
      319.8554024943, 321.097244898,  364.87819161,   366.2897619048,
      342.5752154195, 343.8877777778, 345.9018820862, 347.2144444444,
      375.5314455782, 376.943015873,  331.5270238095, 332.7688662132,
      287.1831462585, 288.255260771,  242.4998129252, 243.4021995465,
      235.6680725624, 236.5071655329, 280.8571882086, 281.8541043084,
      326.3619501134, 327.5166893424, 372.1823582766, 373.4949206349,
      349.1363265306, 350.3568253968, 352.2296598639, 353.4501587302,
      382.0883900227, 383.400952381,  337.2149206349, 338.3696598639,
      292.0258049887, 293.0227210884, 246.5210430839, 247.3601360544,
      256.934739229,  257.7738321995, 306.1238548753, 307.1207709751,
      355.62861678,   356.7833560091, 405.4490249433, 406.7615873016,
      380.0696598639, 381.2901587302, 383.1629931973, 384.3834920635,
      415.3550566893, 416.6676190476, 366.4815873016, 367.6363265306,
      317.2924716553, 318.2893877551, 267.7877097506, 268.6268027211,
      298.9321598639, 299.8345464853, 356.0855612245, 357.157675737,
      413.5784183673, 414.820260771,  471.4107312925, 472.8223015873,
      441.6355328798, 442.9480952381, 444.9621995465, 446.2747619048,
      482.0639852608, 483.4755555556, 425.2500396825, 426.4918820862,
      368.096638322,  369.1687528345, 310.6037811791, 311.5061678005,
      270.3379421769, 271.1318253968, 322.001547619,  322.9447505669,
      373.963792517,  375.0563151927, 426.2246768707, 427.4665192744,
      399.2232879819, 400.3780272109, 402.1499546485, 403.3046938776,
      435.596978458,  436.8388208617, 384.2320124717, 385.3245351474,
      332.5684070295, 333.5116099773, 280.6061621315, 281.4000453515,
      239.5736564626, 240.2590362812, 285.3393027211, 286.1535941043,
      331.3627721088, 332.3059750567, 377.6440646259, 378.7161791383,
      353.6545804989, 354.6514965986, 356.1812471655, 357.1781632653,
      385.7354138322, 386.8075283447, 340.2275907029, 341.1707936508,
      294.4619444444, 295.2762358277, 248.4384750567, 249.1238548753,
      206.6393027211, 207.2161791383, 246.0988265306, 246.7842063492,
      285.7753571429, 286.5692403628, 325.6688945578, 326.5712811791,
      304.9294104308, 305.7685034014, 307.0560770975, 307.895170068,
      332.4792913832, 333.3816780045, 293.2367743764, 294.0306575964,
      253.7772505669, 254.4626303855, 214.1007199546, 214.6775963719,
      247.4004138322, 247.9772902494, 294.5266043084, 295.211984127,
      341.8698015873, 342.6636848073, 389.4300056689, 390.3323922902,
      364.2182993197, 365.0573922902, 366.3449659864, 367.1840589569,
      396.2404024943, 397.1427891156, 349.3312188209, 350.1251020408,
      302.2050283447, 302.8904081633, 254.8618310658, 255.438707483,
      299.8653798186, 300.5507596372, 356.9711621315, 357.7854535147,
      414.3347675737, 415.2779705215, 471.9561961451, 473.0283106576,
      441.3516326531, 442.3485487528, 443.8782993197, 444.8752154195,
      480.0475453515, 481.1196598639, 423.1995861678, 424.1427891156,
      366.0938038549, 366.9080952381, 308.7301984127, 309.4155782313,
      354.5004138322, 355.2942970522, 421.9939512472, 422.937154195,
      489.7861281179, 490.8786507937, 557.8769444444, 559.1187868481,
      521.6414285714, 522.7961678005, 524.5680952381, 525.7228344671,
      567.2492460317, 568.4910884354, 500.0543480726, 501.1468707483,
      432.5608106576, 433.5040136054, 364.7686337868, 365.5625170068,
      411.305515873,  412.2079024943, 489.5949716553, 490.6670861678,
      568.22388322,   569.4657256236, 647.1922505669, 648.6038208617,
      605.0876870748, 606.4002494331, 608.4143537415, 609.7269160998,
      657.8455045351, 659.2570748299, 579.8955045351, 581.1373469388,
      501.6060487528, 502.6781632653, 422.9771371882, 423.8795238095,
      403.4866666667, 404.3257596372, 480.2404081633, 481.237324263,
      557.3097959184, 558.4645351474, 634.694829932,  636.0073922902,
      593.2360997732, 594.4565986395, 596.3294331066, 597.5499319728,
      644.600861678,  645.9134240363, 568.1627664399, 569.3175056689,
      491.4090249433, 492.4059410431, 414.3396371882, 415.1787301587,
      424.7533333333, 425.5924263039, 505.5070748299, 506.5039909297,
      586.576462585,  587.7312018141, 667.9614965986, 669.2740589569,
      624.1694331066, 625.3899319728, 627.2627664399, 628.4832653061,
      677.8675283447, 679.1800907029, 597.4294331066, 598.5841723356,
      516.67569161,   517.6726077098, 435.6063038549, 436.4453968254,
      479.409484127,  480.3118707483, 570.5084637188, 571.5805782313,
      661.946899093,  663.1887414966, 753.7247902494, 755.1363605442,
      704.1480045351, 705.4605668934, 707.4746712018, 708.7872335601,
      764.3780442177, 765.7896145125, 673.6185204082, 674.8603628118,
      582.5195408163, 583.5916553288, 491.0811054422, 491.9834920635,
      429.1145861678, 429.9084693878, 510.6421371882, 511.5853401361,
      592.4683276644, 593.5608503401, 674.5931575964, 675.835,
      630.1711337868, 631.3258730159, 633.0978004535, 634.2525396825,
      683.9654591837, 685.2073015873, 602.736547619,  603.8290702948,
      521.2089965986, 522.1521995465, 439.3828061224, 440.1766893424,
      376.6496201814, 377.335,        448.1975793651, 449.0118707483,
      520.003361678,  520.9465646259, 592.0669671202, 593.1390816327,
      553.0378004535, 554.0347165533, 555.5644671202, 556.56138322,
      600.1583163265, 601.230430839,  528.8681802721, 529.81138322,
      457.3202210884, 458.1345124717, 385.5144387755, 386.1998185941,
      322.0145861678, 322.591462585,  383.1747902494, 383.860170068,
      444.5520011338, 445.3458843537, 506.1462188209, 507.0486054422,
      472.7480045351, 473.5870975057, 474.8746712018, 475.7137641723,
      512.9566156463, 513.8590022676, 452.0134183673, 452.8073015873,
      390.8532142857, 391.5385941043, 329.4760034014, 330.0528798186};
  const std::array<int, 4> in_shape = {{3, 10, 10, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x10x10x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.0204081633,
                                         0.0408163265,
                                         0.0816326531,
                                         0.1224489796,
                                         0.1836734694,
                                         0.2448979592,
                                         0.3265306122,
                                         0.4081632653,
                                         0.3265306122,
                                         0.4081632653,
                                         0.3265306122,
                                         0.4081632653,
                                         0.3265306122,
                                         0.4081632653,
                                         0.306122449,
                                         0.3673469388,
                                         0.2448979592,
                                         0.2857142857,
                                         0.1428571429,
                                         0.1632653061,
                                         0.2040816327,
                                         0.2448979592,
                                         0.4897959184,
                                         0.5714285714,
                                         0.8571428571,
                                         0.9795918367,
                                         1.306122449,
                                         1.4693877551,
                                         1.306122449,
                                         1.4693877551,
                                         1.306122449,
                                         1.4693877551,
                                         1.306122449,
                                         1.4693877551,
                                         1.1020408163,
                                         1.2244897959,
                                         0.8163265306,
                                         0.8979591837,
                                         0.4489795918,
                                         0.4897959184,
                                         0.5510204082,
                                         0.612244898,
                                         1.2244897959,
                                         1.3469387755,
                                         2.0204081633,
                                         2.2040816327,
                                         2.9387755102,
                                         3.1836734694,
                                         2.9387755102,
                                         3.1836734694,
                                         2.9387755102,
                                         3.1836734694,
                                         2.9387755102,
                                         3.1836734694,
                                         2.387755102,
                                         2.5714285714,
                                         1.7142857143,
                                         1.8367346939,
                                         0.9183673469,
                                         0.9795918367,
                                         1.0612244898,
                                         1.1428571429,
                                         2.2857142857,
                                         2.4489795918,
                                         3.6734693878,
                                         3.9183673469,
                                         5.2244897959,
                                         5.5510204082,
                                         5.2244897959,
                                         5.5510204082,
                                         5.2244897959,
                                         5.5510204082,
                                         5.2244897959,
                                         5.5510204082,
                                         4.1632653061,
                                         4.4081632653,
                                         2.9387755102,
                                         3.1020408163,
                                         1.5510204082,
                                         1.6326530612,
                                         1.0612244898,
                                         1.1428571429,
                                         2.2857142857,
                                         2.4489795918,
                                         3.6734693878,
                                         3.9183673469,
                                         5.2244897959,
                                         5.5510204082,
                                         5.2244897959,
                                         5.5510204082,
                                         5.2244897959,
                                         5.5510204082,
                                         5.2244897959,
                                         5.5510204082,
                                         4.1632653061,
                                         4.4081632653,
                                         2.9387755102,
                                         3.1020408163,
                                         1.5510204082,
                                         1.6326530612,
                                         1.0612244898,
                                         1.1428571429,
                                         2.2857142857,
                                         2.4489795918,
                                         3.6734693878,
                                         3.9183673469,
                                         5.2244897959,
                                         5.5510204082,
                                         5.2244897959,
                                         5.5510204082,
                                         5.2244897959,
                                         5.5510204082,
                                         5.2244897959,
                                         5.5510204082,
                                         4.1632653061,
                                         4.4081632653,
                                         2.9387755102,
                                         3.1020408163,
                                         1.5510204082,
                                         1.6326530612,
                                         1.0612244898,
                                         1.1428571429,
                                         2.2857142857,
                                         2.4489795918,
                                         3.6734693878,
                                         3.9183673469,
                                         5.2244897959,
                                         5.5510204082,
                                         5.2244897959,
                                         5.5510204082,
                                         5.2244897959,
                                         5.5510204082,
                                         5.2244897959,
                                         5.5510204082,
                                         4.1632653061,
                                         4.4081632653,
                                         2.9387755102,
                                         3.1020408163,
                                         1.5510204082,
                                         1.6326530612,
                                         1.0408163265,
                                         1.1020408163,
                                         2.2040816327,
                                         2.3265306122,
                                         3.4897959184,
                                         3.6734693878,
                                         4.8979591837,
                                         5.1428571429,
                                         4.8979591837,
                                         5.1428571429,
                                         4.8979591837,
                                         5.1428571429,
                                         4.8979591837,
                                         5.1428571429,
                                         3.8571428571,
                                         4.0408163265,
                                         2.693877551,
                                         2.8163265306,
                                         1.4081632653,
                                         1.4693877551,
                                         0.8571428571,
                                         0.8979591837,
                                         1.7959183673,
                                         1.8775510204,
                                         2.8163265306,
                                         2.9387755102,
                                         3.9183673469,
                                         4.0816326531,
                                         3.9183673469,
                                         4.0816326531,
                                         3.9183673469,
                                         4.0816326531,
                                         3.9183673469,
                                         4.0816326531,
                                         3.0612244898,
                                         3.1836734694,
                                         2.1224489796,
                                         2.2040816327,
                                         1.1020408163,
                                         1.1428571429,
                                         0.5102040816,
                                         0.5306122449,
                                         1.0612244898,
                                         1.1020408163,
                                         1.6530612245,
                                         1.7142857143,
                                         2.2857142857,
                                         2.3673469388,
                                         2.2857142857,
                                         2.3673469388,
                                         2.2857142857,
                                         2.3673469388,
                                         2.2857142857,
                                         2.3673469388,
                                         1.7755102041,
                                         1.8367346939,
                                         1.2244897959,
                                         1.2653061224,
                                         0.6326530612,
                                         0.6530612245,
                                         0.6734693878,
                                         0.693877551,
                                         1.387755102,
                                         1.4285714286,
                                         2.1428571429,
                                         2.2040816327,
                                         2.9387755102,
                                         3.0204081633,
                                         2.9387755102,
                                         3.0204081633,
                                         2.9387755102,
                                         3.0204081633,
                                         2.9387755102,
                                         3.0204081633,
                                         2.2653061224,
                                         2.3265306122,
                                         1.5510204082,
                                         1.5918367347,
                                         0.7959183673,
                                         0.8163265306,
                                         1.5102040816,
                                         1.5510204082,
                                         3.1020408163,
                                         3.1836734694,
                                         4.7755102041,
                                         4.8979591837,
                                         6.5306122449,
                                         6.693877551,
                                         6.5306122449,
                                         6.693877551,
                                         6.5306122449,
                                         6.693877551,
                                         6.5306122449,
                                         6.693877551,
                                         5.0204081633,
                                         5.1428571429,
                                         3.4285714286,
                                         3.5102040816,
                                         1.7551020408,
                                         1.7959183673,
                                         2.5102040816,
                                         2.5714285714,
                                         5.1428571429,
                                         5.2653061224,
                                         7.8979591837,
                                         8.0816326531,
                                         10.7755102041,
                                         11.0204081633,
                                         10.7755102041,
                                         11.0204081633,
                                         10.7755102041,
                                         11.0204081633,
                                         10.7755102041,
                                         11.0204081633,
                                         8.2653061224,
                                         8.4489795918,
                                         5.6326530612,
                                         5.7551020408,
                                         2.8775510204,
                                         2.9387755102,
                                         3.6734693878,
                                         3.7551020408,
                                         7.5102040816,
                                         7.6734693878,
                                         11.5102040816,
                                         11.7551020408,
                                         15.6734693878,
                                         16.,
                                         15.6734693878,
                                         16.,
                                         15.6734693878,
                                         16.,
                                         15.6734693878,
                                         16.,
                                         12.,
                                         12.2448979592,
                                         8.1632653061,
                                         8.3265306122,
                                         4.1632653061,
                                         4.2448979592,
                                         3.6734693878,
                                         3.7551020408,
                                         7.5102040816,
                                         7.6734693878,
                                         11.5102040816,
                                         11.7551020408,
                                         15.6734693878,
                                         16.,
                                         15.6734693878,
                                         16.,
                                         15.6734693878,
                                         16.,
                                         15.6734693878,
                                         16.,
                                         12.,
                                         12.2448979592,
                                         8.1632653061,
                                         8.3265306122,
                                         4.1632653061,
                                         4.2448979592,
                                         3.6734693878,
                                         3.7551020408,
                                         7.5102040816,
                                         7.6734693878,
                                         11.5102040816,
                                         11.7551020408,
                                         15.6734693878,
                                         16.,
                                         15.6734693878,
                                         16.,
                                         15.6734693878,
                                         16.,
                                         15.6734693878,
                                         16.,
                                         12.,
                                         12.2448979592,
                                         8.1632653061,
                                         8.3265306122,
                                         4.1632653061,
                                         4.2448979592,
                                         3.6734693878,
                                         3.7551020408,
                                         7.5102040816,
                                         7.6734693878,
                                         11.5102040816,
                                         11.7551020408,
                                         15.6734693878,
                                         16.,
                                         15.6734693878,
                                         16.,
                                         15.6734693878,
                                         16.,
                                         15.6734693878,
                                         16.,
                                         12.,
                                         12.2448979592,
                                         8.1632653061,
                                         8.3265306122,
                                         4.1632653061,
                                         4.2448979592,
                                         3.,
                                         3.0612244898,
                                         6.1224489796,
                                         6.2448979592,
                                         9.3673469388,
                                         9.5510204082,
                                         12.7346938776,
                                         12.9795918367,
                                         12.7346938776,
                                         12.9795918367,
                                         12.7346938776,
                                         12.9795918367,
                                         12.7346938776,
                                         12.9795918367,
                                         9.7346938776,
                                         9.9183673469,
                                         6.612244898,
                                         6.7346938776,
                                         3.3673469388,
                                         3.4285714286,
                                         2.1632653061,
                                         2.2040816327,
                                         4.4081632653,
                                         4.4897959184,
                                         6.7346938776,
                                         6.8571428571,
                                         9.1428571429,
                                         9.306122449,
                                         9.1428571429,
                                         9.306122449,
                                         9.1428571429,
                                         9.306122449,
                                         9.1428571429,
                                         9.306122449,
                                         6.9795918367,
                                         7.1020408163,
                                         4.7346938776,
                                         4.8163265306,
                                         2.4081632653,
                                         2.4489795918,
                                         1.1632653061,
                                         1.1836734694,
                                         2.3673469388,
                                         2.4081632653,
                                         3.612244898,
                                         3.6734693878,
                                         4.8979591837,
                                         4.9795918367,
                                         4.8979591837,
                                         4.9795918367,
                                         4.8979591837,
                                         4.9795918367,
                                         4.8979591837,
                                         4.9795918367,
                                         3.7346938776,
                                         3.7959183673,
                                         2.5306122449,
                                         2.5714285714,
                                         1.2857142857,
                                         1.306122449,
                                         1.3265306122,
                                         1.3469387755,
                                         2.693877551,
                                         2.7346938776,
                                         4.1020408163,
                                         4.1632653061,
                                         5.5510204082,
                                         5.6326530612,
                                         5.5510204082,
                                         5.6326530612,
                                         5.5510204082,
                                         5.6326530612,
                                         5.5510204082,
                                         5.6326530612,
                                         4.2244897959,
                                         4.2857142857,
                                         2.8571428571,
                                         2.8979591837,
                                         1.4489795918,
                                         1.4693877551,
                                         2.8163265306,
                                         2.8571428571,
                                         5.7142857143,
                                         5.7959183673,
                                         8.693877551,
                                         8.8163265306,
                                         11.7551020408,
                                         11.9183673469,
                                         11.7551020408,
                                         11.9183673469,
                                         11.7551020408,
                                         11.9183673469,
                                         11.7551020408,
                                         11.9183673469,
                                         8.9387755102,
                                         9.0612244898,
                                         6.0408163265,
                                         6.1224489796,
                                         3.0612244898,
                                         3.1020408163,
                                         4.4693877551,
                                         4.5306122449,
                                         9.0612244898,
                                         9.1836734694,
                                         13.7755102041,
                                         13.9591836735,
                                         18.612244898,
                                         18.8571428571,
                                         18.612244898,
                                         18.8571428571,
                                         18.612244898,
                                         18.8571428571,
                                         18.612244898,
                                         18.8571428571,
                                         14.1428571429,
                                         14.3265306122,
                                         9.5510204082,
                                         9.6734693878,
                                         4.8367346939,
                                         4.8979591837,
                                         6.2857142857,
                                         6.3673469388,
                                         12.7346938776,
                                         12.8979591837,
                                         19.3469387755,
                                         19.5918367347,
                                         26.1224489796,
                                         26.4489795918,
                                         26.1224489796,
                                         26.4489795918,
                                         26.1224489796,
                                         26.4489795918,
                                         26.1224489796,
                                         26.4489795918,
                                         19.8367346939,
                                         20.0816326531,
                                         13.387755102,
                                         13.5510204082,
                                         6.7755102041,
                                         6.8571428571,
                                         6.2857142857,
                                         6.3673469388,
                                         12.7346938776,
                                         12.8979591837,
                                         19.3469387755,
                                         19.5918367347,
                                         26.1224489796,
                                         26.4489795918,
                                         26.1224489796,
                                         26.4489795918,
                                         26.1224489796,
                                         26.4489795918,
                                         26.1224489796,
                                         26.4489795918,
                                         19.8367346939,
                                         20.0816326531,
                                         13.387755102,
                                         13.5510204082,
                                         6.7755102041,
                                         6.8571428571,
                                         6.2857142857,
                                         6.3673469388,
                                         12.7346938776,
                                         12.8979591837,
                                         19.3469387755,
                                         19.5918367347,
                                         26.1224489796,
                                         26.4489795918,
                                         26.1224489796,
                                         26.4489795918,
                                         26.1224489796,
                                         26.4489795918,
                                         26.1224489796,
                                         26.4489795918,
                                         19.8367346939,
                                         20.0816326531,
                                         13.387755102,
                                         13.5510204082,
                                         6.7755102041,
                                         6.8571428571,
                                         6.2857142857,
                                         6.3673469388,
                                         12.7346938776,
                                         12.8979591837,
                                         19.3469387755,
                                         19.5918367347,
                                         26.1224489796,
                                         26.4489795918,
                                         26.1224489796,
                                         26.4489795918,
                                         26.1224489796,
                                         26.4489795918,
                                         26.1224489796,
                                         26.4489795918,
                                         19.8367346939,
                                         20.0816326531,
                                         13.387755102,
                                         13.5510204082,
                                         6.7755102041,
                                         6.8571428571,
                                         4.9591836735,
                                         5.0204081633,
                                         10.0408163265,
                                         10.1632653061,
                                         15.2448979592,
                                         15.4285714286,
                                         20.5714285714,
                                         20.8163265306,
                                         20.5714285714,
                                         20.8163265306,
                                         20.5714285714,
                                         20.8163265306,
                                         20.5714285714,
                                         20.8163265306,
                                         15.612244898,
                                         15.7959183673,
                                         10.5306122449,
                                         10.6530612245,
                                         5.3265306122,
                                         5.387755102,
                                         3.4693877551,
                                         3.5102040816,
                                         7.0204081633,
                                         7.1020408163,
                                         10.6530612245,
                                         10.7755102041,
                                         14.3673469388,
                                         14.5306122449,
                                         14.3673469388,
                                         14.5306122449,
                                         14.3673469388,
                                         14.5306122449,
                                         14.3673469388,
                                         14.5306122449,
                                         10.8979591837,
                                         11.0204081633,
                                         7.3469387755,
                                         7.4285714286,
                                         3.7142857143,
                                         3.7551020408,
                                         1.8163265306,
                                         1.8367346939,
                                         3.6734693878,
                                         3.7142857143,
                                         5.5714285714,
                                         5.6326530612,
                                         7.5102040816,
                                         7.5918367347,
                                         7.5102040816,
                                         7.5918367347,
                                         7.5102040816,
                                         7.5918367347,
                                         7.5102040816,
                                         7.5918367347,
                                         5.693877551,
                                         5.7551020408,
                                         3.8367346939,
                                         3.8775510204,
                                         1.9387755102,
                                         1.9591836735};
  const std::array<int, 4> in_shape = {{3, 10, 10, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x10x10x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      32.7228174603,   33.2996938776,   33.8765702948,   34.453446712,
      40.0639739229,   40.7493537415,   41.4347335601,   42.1201133787,
      47.8391439909,   48.6330272109,   49.4269104308,   50.2207936508,
      56.0483276644,   56.9507142857,   57.853100907,    58.7554875283,
      56.3231292517,   57.1622222222,   58.0013151927,   58.8404081633,
      60.576462585,    61.4155555556,   62.2546485261,   63.0937414966,
      69.6691213152,   70.5715079365,   71.4738945578,   72.3762811791,
      62.761978458,    63.555861678,    64.349744898,    65.1436281179,
      55.4208219955,   56.1062018141,   56.7915816327,   57.4769614512,
      47.6456519274,   48.2225283447,   48.7994047619,   49.3762811791,
      50.7415249433,   51.4269047619,   52.1122845805,   52.7976643991,
      61.6949263039,   62.5092176871,   63.3235090703,   64.1378004535,
      73.1639739229,   74.1071768707,   75.0503798186,   75.9935827664,
      85.1486678005,   86.2207823129,   87.2928968254,   88.3650113379,
      84.1734693878,   85.1703854875,   86.1673015873,   87.1642176871,
      89.2268027211,   90.2237188209,   91.2206349206,   92.2175510204,
      101.3313662132,  102.4034807256,  103.4755952381,  104.5477097506,
      90.8936111111,   91.836814059,    92.7800170068,   93.7232199546,
      79.9402097506,   80.7545011338,   81.568792517,    82.3830839002,
      68.4711621315,   69.1565419501,   69.8419217687,   70.5273015873,
      73.1003684807,   73.8942517007,   74.6881349206,   75.4820181406,
      88.4823412698,   89.4255442177,   90.3687471655,   91.3119501134,
      104.4615929705,  105.5541156463,  106.646638322,   107.7391609977,
      121.0381235828,  122.2799659864,  123.52180839,    124.7636507937,
      118.3367346939,  119.4914739229,  120.6462131519,  121.800952381,
      124.1900680272,  125.3448072562,  126.4995464853,  127.6542857143,
      139.7827267574,  141.024569161,   142.2664115646,  143.5082539683,
      124.9980328798,  126.0905555556,  127.1830782313,  128.275600907,
      109.6160600907,  110.5592630385,  111.5024659864,  112.4456689342,
      93.63680839,     94.43069161,     95.2245748299,   96.0184580499,
      99.7993480726,   100.7017346939,  101.6041213152,  102.5065079365,
      120.4262188209,  121.4983333333,  122.5704478458,  123.6425623583,
      141.7320011338,  142.9738435374,  144.215685941,   145.4575283447,
      163.7166950113,  165.1282653061,  166.5398356009,  167.9514058957,
      158.8129251701,  160.1254875283,  161.4380498866,  162.7506122449,
      165.4662585034,  166.7788208617,  168.09138322,    169.4039455782,
      185.0232029478,  186.4347732426,  187.8463435374,  189.2579138322,
      165.0752437642,  166.3170861678,  167.5589285714,  168.8007709751,
      144.4483730159,  145.5204875283,  146.5926020408,  147.6647165533,
      123.1425907029,  124.0449773243,  124.9473639456,  125.8497505669,
      134.8598639456,  135.6989569161,  136.5380498866,  137.3771428571,
      161.9510204082,  162.9479365079,  163.9448526077,  164.9417687075,
      189.6734693878,  190.8282086168,  191.9829478458,  193.1376870748,
      218.0272108844,  219.3397732426,  220.6523356009,  221.9648979592,
      208.8526077098,  210.073106576,   211.2936054422,  212.5141043084,
      215.0392743764,  216.2597732426,  217.4802721088,  218.7007709751,
      237.8392743764,  239.1518367347,  240.464399093,   241.7769614512,
      211.3794104308,  212.5341496599,  213.6888888889,  214.8436281179,
      184.2882539683,  185.285170068,   186.2820861678,  187.2790022676,
      156.5658049887,  157.4048979592,  158.2439909297,  159.0830839002,
      177.3931972789,  178.2322902494,  179.07138322,    179.9104761905,
      212.4843537415,  213.4812698413,  214.478185941,   215.4751020408,
      248.2068027211,  249.3615419501,  250.5162811791,  251.6710204082,
      284.5605442177,  285.873106576,   287.1856689342,  288.4982312925,
      270.7192743764,  271.9397732426,  273.1602721088,  274.3807709751,
      276.9059410431,  278.1264399093,  279.3469387755,  280.5674376417,
      304.3726077098,  305.685170068,   306.9977324263,  308.3102947846,
      269.9127437642,  271.0674829932,  272.2222222222,  273.3769614512,
      234.8215873016,  235.8185034014,  236.8154195011,  237.8123356009,
      199.099138322,   199.9382312925,  200.777324263,   201.6164172336,
      236.0072845805,  236.9096712018,  237.8120578231,  238.7144444444,
      282.2532029478,  283.3253174603,  284.3974319728,  285.4695464853,
      329.1780328798,  330.4198752834,  331.6617176871,  332.9035600907,
      376.7817743764,  378.1933446712,  379.604914966,   381.0164852608,
      356.9335600907,  358.246122449,   359.5586848073,  360.8712471655,
      363.586893424,   364.8994557823,  366.2120181406,  367.5245804989,
      398.0882823129,  399.4998526077,  400.9114229025,  402.3229931973,
      352.5212755102,  353.7631179138,  355.0049603175,  356.2468027211,
      306.2753571429,  307.3474716553,  308.4195861678,  309.4917006803,
      259.3505272109,  260.2529138322,  261.1553004535,  262.0576870748,
      222.3287131519,  223.1225963719,  223.9164795918,  224.7103628118,
      265.7787131519,  266.7219160998,  267.6651190476,  268.6083219955,
      309.8259920635,  310.9185147392,  312.011037415,   313.1035600907,
      354.4705498866,  355.7123922902,  356.9542346939,  358.1960770975,
      335.3961451247,  336.5508843537,  337.7056235828,  338.8603628118,
      341.249478458,   342.4042176871,  343.5589569161,  344.7136961451,
      373.2151530612,  374.4569954649,  375.6988378685,  376.9406802721,
      330.3624319728,  331.4549546485,  332.5474773243,  333.64,
      286.9124319728,  287.8556349206,  288.7988378685,  289.7420408163,
      242.8651530612,  243.6590362812,  244.4529195011,  245.2468027211,
      204.3100056689,  204.9953854875,  205.6807653061,  206.3661451247,
      244.147760771,   244.9620521542,  245.7763435374,  246.5906349206,
      284.5011621315,  285.4443650794,  286.3875680272,  287.3307709751,
      325.3702097506,  326.442324263,   327.5144387755,  328.586553288,
      307.5458049887,  308.5427210884,  309.5396371882,  310.536553288,
      312.599138322,   313.5960544218,  314.5929705215,  315.5898866213,
      341.5529081633,  342.6250226757,  343.6971371882,  344.7692517007,
      302.2307993197,  303.1740022676,  304.1172052154,  305.0604081633,
      262.3930442177,  263.2073356009,  264.0216269841,  264.8359183673,
      222.0396428571,  222.7250226757,  223.4104024943,  224.0957823129,
      181.9511621315,  182.5280385488,  183.104914966,   183.6817913832,
      217.360345805,   218.0457256236,  218.7311054422,  219.4164852608,
      253.2035430839,  253.9974263039,  254.7913095238,  255.5851927438,
      289.4807539683,  290.3831405896,  291.2855272109,  292.1879138322,
      273.3825396825,  274.2216326531,  275.0607256236,  275.8998185941,
      277.6358730159,  278.4749659864,  279.3140589569,  280.1531519274,
      303.101547619,   304.0039342404,  304.9063208617,  305.808707483,
      268.126377551,   268.920260771,   269.7141439909,  270.5080272109,
      232.7171938776,  233.4025736961,  234.0879535147,  234.7733333333,
      196.8739965986,  197.4508730159,  198.0277494331,  198.6046258503,
      263.4733843537,  264.050260771,   264.6271371882,  265.2040136054,
      314.2159013605,  314.9012811791,  315.5866609977,  316.2720408163,
      365.3924319728,  366.1863151927,  366.9801984127,  367.7740816327,
      417.0029761905,  417.9053628118,  418.8077494331,  419.7101360544,
      391.9603174603,  392.7994104308,  393.6385034014,  394.4775963719,
      396.2136507937,  397.0527437642,  397.8918367347,  398.7309297052,
      430.6237698413,  431.5261564626,  432.4285430839,  433.3309297052,
      380.3152664399,  381.1091496599,  381.9030328798,  382.6969160998,
      329.5727494331,  330.2581292517,  330.9435090703,  331.6288888889,
      278.3962188209,  278.9730952381,  279.5499716553,  280.1268480726,
      324.893452381,   325.5788321995,  326.2642120181,  326.9495918367,
      387.4114795918,  388.2257709751,  389.0400623583,  389.8543537415,
      450.4451530612,  451.3883560091,  452.3315589569,  453.2747619048,
      513.9944727891,  515.0665873016,  516.1387018141,  517.2108163265,
      482.9399092971,  483.9368253968,  484.9337414966,  485.9306575964,
      487.9932426304,  488.9901587302,  489.9870748299,  490.9839909297,
      530.1771712018,  531.2492857143,  532.3214002268,  533.3935147392,
      468.1747902494,  469.1179931973,  470.0611961451,  471.004399093,
      405.6567630385,  406.4710544218,  407.285345805,   408.0996371882,
      342.6230895692,  343.3084693878,  343.9938492063,  344.6792290249,
      390.6536564626,  391.4475396825,  392.2414229025,  393.0353061224,
      465.7635204082,  466.706723356,   467.6499263039,  468.5931292517,
      541.4706632653,  542.563185941,   543.6557086168,  544.7482312925,
      617.775085034,   619.0169274376,  620.2587698413,  621.5006122449,
      580.2324263039,  581.3871655329,  582.5419047619,  583.6966439909,
      586.0857596372,  587.2404988662,  588.3952380952,  589.5499773243,
      636.5196882086,  637.7615306122,  639.0033730159,  640.2452154195,
      562.0071031746,  563.0996258503,  564.1921485261,  565.2846712018,
      486.897239229,   487.8404421769,  488.7836451247,  489.7268480726,
      411.1900963719,  411.9839795918,  412.7778628118,  413.5717460317,
      460.7539965986,  461.65638322,    462.5587698413,  463.4611564626,
      549.2720238095,  550.344138322,   551.4162528345,  552.4883673469,
      638.468962585,   639.7108049887,  640.9526473923,  642.1944897959,
      728.3448129252,  729.75638322,    731.1679535147,  732.5795238095,
      683.8378684807,  685.150430839,   686.4629931973,  687.7755555556,
      690.4912018141,  691.8037641723,  693.1163265306,  694.4288888889,
      749.6513208617,  751.0628911565,  752.4744614512,  753.886031746,
      661.8122052154,  663.054047619,   664.2958900227,  665.5377324263,
      573.2941780045,  574.366292517,   575.4384070295,  576.510521542,
      484.097239229,   484.9996258503,  485.9020124717,  486.804399093,
      470.4970521542,  471.3361451247,  472.1752380952,  473.0143310658,
      560.7174603175,  561.7143764172,  562.711292517,   563.7082086168,
      651.5691609977,  652.7239002268,  653.8786394558,  655.0333786848,
      743.052154195,   744.3647165533,  745.6772789116,  746.9898412698,
      697.052154195,   698.2726530612,  699.4931519274,  700.7136507937,
      703.2388208617,  704.4593197279,  705.6798185941,  706.9003174603,
      762.8642176871,  764.1767800454,  765.4893424036,  766.8019047619,
      673.2751020408,  674.4298412698,  675.5845804989,  676.7393197279,
      583.0546938776,  584.0516099773,  585.0485260771,  586.0454421769,
      492.2029931973,  493.0420861678,  493.8811791383,  494.7202721088,
      513.0303854875,  513.869478458,   514.7085714286,  515.5476643991,
      611.2507936508,  612.2477097506,  613.2446258503,  614.2415419501,
      710.1024943311,  711.2572335601,  712.4119727891,  713.5667120181,
      809.5854875283,  810.8980498866,  812.2106122449,  813.5231746032,
      758.9188208617,  760.1393197279,  761.3598185941,  762.5803174603,
      765.1054875283,  766.3259863946,  767.5464852608,  768.766984127,
      829.3975510204,  830.7101133787,  832.022675737,   833.3352380952,
      731.8084353741,  732.9631746032,  734.1179138322,  735.2726530612,
      633.5880272109,  634.5849433107,  635.5818594104,  636.5787755102,
      534.7363265306,  535.5754195011,  536.4145124717,  537.2536054422,
      596.9619331066,  597.8643197279,  598.7667063492,  599.6690929705,
      711.0990079365,  712.171122449,   713.2432369615,  714.3153514739,
      825.9149943311,  827.1568367347,  828.3986791383,  829.6405215419,
      941.4098922902,  942.821462585,   944.2330328798,  945.6446031746,
      881.9585034014,  883.2710657596,  884.5836281179,  885.8961904762,
      888.6118367347,  889.924399093,   891.2369614512,  892.5495238095,
      962.7164002268,  964.1279705215,  965.5395408163,  966.9511111111,
      849.2582369615,  850.5000793651,  851.7419217687,  852.9837641723,
      735.1211621315,  736.193276644,   737.2653911565,  738.3375056689,
      620.305175737,   621.2075623583,  622.1099489796,  623.0123356009,
      539.8820011338,  540.6758843537,  541.4697675737,  542.2636507937,
      643.0598922902,  644.0030952381,  644.9462981859,  645.8895011338,
      746.8350623583,  747.927585034,   749.0201077098,  750.1126303855,
      851.2075113379,  852.4493537415,  853.6911961451,  854.9330385488,
      797.2918367347,  798.4465759637,  799.6013151927,  800.7560544218,
      803.145170068,   804.2999092971,  805.4546485261,  806.6093877551,
      869.9521145125,  871.1939569161,  872.4357993197,  873.6776417234,
      767.3715022676,  768.4640249433,  769.556547619,   770.6490702948,
      664.1936111111,  665.136814059,   666.0800170068,  667.0232199546,
      560.4184410431,  561.212324263,   562.006207483,   562.8000907029,
      478.4619331066,  479.1473129252,  479.8326927438,  480.5180725624,
      569.864314059,   570.6786054422,  571.4928968254,  572.3071882086,
      661.7823412698,  662.7255442177,  663.6687471655,  664.6119501134,
      754.2160147392,  755.2881292517,  756.3602437642,  757.4323582766,
      706.312244898,   707.3091609977,  708.3060770975,  709.3029931973,
      711.3655782313,  712.3624943311,  713.3594104308,  714.3563265306,
      770.3987131519,  771.4708276644,  772.5429421769,  773.6150566893,
      679.511978458,   680.4551814059,  681.3983843537,  682.3415873016,
      588.1095975057,  588.9238888889,  589.7381802721,  590.5524716553,
      496.1915702948,  496.8769501134,  497.562329932,   498.2477097506,
      412.7017290249,  413.2786054422,  413.8554818594,  414.4323582766,
      491.5122732426,  492.1976530612,  492.8830328798,  493.5684126984,
      570.7568310658,  571.5507142857,  572.3445975057,  573.1384807256,
      650.4354024943,  651.3377891156,  652.240175737,   653.1425623583,
      609.0197278912,  609.8588208617,  610.6979138322,  611.5370068027,
      613.2730612245,  614.112154195,   614.9512471655,  615.7903401361,
      664.0561961451,  664.9585827664,  665.8609693878,  666.7633560091,
      585.6796655329,  586.4735487528,  587.2674319728,  588.0613151927,
      506.8691213152,  507.5545011338,  508.2398809524,  508.925260771,
      427.6245634921,  428.2014399093,  428.7783163265,  429.3551927438,
      494.2239512472,  494.8008276644,  495.3777040816,  495.9545804989,
      588.3678287982,  589.0532086168,  589.7385884354,  590.423968254,
      682.9457199546,  683.7396031746,  684.5334863946,  685.3273696145,
      777.9576247166,  778.8600113379,  779.7623979592,  780.6647845805,
      727.5975056689,  728.4365986395,  729.27569161,    730.1147845805,
      731.8508390023,  732.6899319728,  733.5290249433,  734.3681179138,
      791.5784183673,  792.4808049887,  793.38319161,    794.2855782313,
      697.8685544218,  698.6624376417,  699.4563208617,  700.2502040816,
      603.7246768707,  604.4100566893,  605.0954365079,  605.7808163265,
      509.1467857143,  509.7236621315,  510.3005385488,  510.877414966,
      599.0453798186,  599.7307596372,  600.4161394558,  601.1015192744,
      713.1280328798,  713.942324263,   714.7566156463,  715.5709070295,
      827.7263321995,  828.6695351474,  829.6127380952,  830.5559410431,
      942.8402777778,  943.9123922902,  944.9845068027,  946.0566213152,
      881.7063492063,  882.7032653061,  883.7001814059,  884.6970975057,
      886.7596825397,  887.7565986395,  888.7535147392,  889.750430839,
      959.0229761905,  960.0950907029,  961.1672052154,  962.2393197279,
      845.4559693878,  846.3991723356,  847.3423752834,  848.2855782313,
      731.3733163265,  732.1876077098,  733.001899093,   733.8161904762,
      616.7750170068,  617.4603968254,  618.145776644,   618.8311564626,
      708.2069444444,  709.0008276644,  709.7947108844,  710.5885941043,
      843.0446995465,  843.9879024943,  844.9311054422,  845.87430839,
      978.4797335601,  979.5722562358,  980.6647789116,  981.7573015873,
      1114.5120464853, 1115.7538888889, 1116.9957312925, 1118.2375736961,
      1042.1281179138, 1043.2828571429, 1044.4375963719, 1045.5923356009,
      1047.9814512472, 1049.1361904762, 1050.2909297052, 1051.4456689342,
      1133.2566496599, 1134.4984920635, 1135.7403344671, 1136.9821768707,
      999.0161734694,  1000.1086961451, 1001.2012188209, 1002.2937414966,
      864.1784183673,  865.1216213152,  866.064824263,   867.0080272109,
      728.7433843537,  729.5372675737,  730.3311507937,  731.1250340136,
      821.7086451247,  822.611031746,   823.5134183673,  824.4158049887,
      978.1178287982,  979.1899433107,  980.2620578231,  981.3341723356,
      1135.2059240363, 1136.4477664399, 1137.6896088435, 1138.9314512472,
      1292.972930839,  1294.3845011338, 1295.7960714286, 1297.2076417234,
      1208.8628117914, 1210.1753741497, 1211.4879365079, 1212.8004988662,
      1215.5161451247, 1216.828707483,  1218.1412698413, 1219.4538321995,
      1314.2794387755, 1315.6910090703, 1317.1025793651, 1318.5141496599,
      1158.5491666667, 1159.7910090703, 1161.0328514739, 1162.2746938776,
      1002.1399829932, 1003.2120975057, 1004.2842120181, 1005.3563265306,
      845.0518877551,  845.9542743764,  846.8566609977,  847.759047619,
      806.1342403628,  806.9733333333,  807.8124263039,  808.6515192744,
      959.4839002268,  960.4808163265,  961.4777324263,  962.4746485261,
      1113.4648526077, 1114.6195918367, 1115.7743310658, 1116.9290702948,
      1268.0770975057, 1269.3896598639, 1270.7022222222, 1272.0147845805,
      1185.2517006803, 1186.4721995465, 1187.6926984127, 1188.9131972789,
      1191.4383673469, 1192.6588662132, 1193.8793650794, 1195.0998639456,
      1287.8891609977, 1289.201723356,  1290.5142857143, 1291.8268480726,
      1135.1707936508, 1136.3255328798, 1137.4802721088, 1138.6350113379,
      981.8211337868,  982.8180498866,  983.8149659864,  984.8118820862,
      827.8401814059,  828.6792743764,  829.5183673469,  830.3574603175,
      848.6675736961,  849.5066666667,  850.3457596372,  851.1848526077,
      1010.0172335601, 1011.0141496599, 1012.0110657596, 1013.0079818594,
      1171.998185941,  1173.1529251701, 1174.3076643991, 1175.4624036281,
      1334.610430839,  1335.9229931973, 1337.2355555556, 1338.5481179138,
      1247.1183673469, 1248.3388662132, 1249.5593650794, 1250.7798639456,
      1253.3050340136, 1254.5255328798, 1255.746031746,  1256.9665306122,
      1354.4224943311, 1355.7350566893, 1357.0476190476, 1358.3601814059,
      1193.7041269841, 1194.8588662132, 1196.0136054422, 1197.1683446712,
      1032.3544671202, 1033.35138322,   1034.3482993197, 1035.3452154195,
      870.3735147392,  871.2126077098,  872.0517006803,  872.8907936508,
      957.9165816327,  958.818968254,   959.7213548753,  960.6237414966,
      1139.9448129252, 1141.0169274376, 1142.0890419501, 1143.1611564626,
      1322.6519557823, 1323.8937981859, 1325.1356405896, 1326.3774829932,
      1506.0380102041, 1507.4495804989, 1508.8611507937, 1510.2727210884,
      1406.983446712,  1408.2960090703, 1409.6085714286, 1410.9211337868,
      1413.6367800454, 1414.9493424036, 1416.2619047619, 1417.5744671202,
      1527.3445181406, 1528.7560884354, 1530.1676587302, 1531.5792290249,
      1345.9951984127, 1347.2370408163, 1348.47888322,   1349.7207256236,
      1163.9669671202, 1165.0390816327, 1166.1111961451, 1167.1833106576,
      981.259824263,   982.1622108844,  983.0645975057,  983.966984127,
      857.4352891156,  858.2291723356,  859.0230555556,  859.8169387755,
      1020.3410714286, 1021.2842743764, 1022.2274773243, 1023.1706802721,
      1183.8441326531, 1184.9366553288, 1186.0291780045, 1187.1217006803,
      1347.9444727891, 1349.1863151927, 1350.4281575964, 1351.67,
      1259.1875283447, 1260.3422675737, 1261.4970068027, 1262.6517460317,
      1265.040861678,  1266.195600907,  1267.3503401361, 1268.5050793651,
      1366.6890759637, 1367.9309183673, 1369.172760771,  1370.4146031746,
      1204.3805725624, 1205.4730952381, 1206.5656179138, 1207.6581405896,
      1041.4747902494, 1042.4179931973, 1043.3611961451, 1044.304399093,
      877.9717290249,  878.7656122449,  879.5594954649,  880.3533786848,
      752.6138605442,  753.2992403628,  753.9846201814,  754.67,
      895.5808673469,  896.3951587302,  897.2094501134,  898.0237414966,
      1039.0635204082, 1040.006723356,  1040.9499263039, 1041.8931292517,
      1183.0618197279, 1184.1339342404, 1185.2060487528, 1186.2781632653,
      1105.0786848073, 1106.075600907,  1107.0725170068, 1108.0694331066,
      1110.1320181406, 1111.1289342404, 1112.1258503401, 1113.1227664399,
      1199.2445181406, 1200.3166326531, 1201.3887471655, 1202.460861678,
      1056.7931575964, 1057.7363605442, 1058.6795634921, 1059.6227664399,
      913.8261507937,  914.6404421769,  915.4547335601,  916.2690249433,
      770.3434977324,  771.028877551,   771.7142573696,  772.3996371882,
      643.4522959184,  644.0291723356,  644.6060487528,  645.1829251701,
      765.6642006803,  766.3495804989,  767.0349603175,  767.7203401361,
      888.3101190476,  889.1040022676,  889.8978854875,  890.6917687075,
      1011.3900510204, 1012.2924376417, 1013.194824263,  1014.0972108844,
      944.6569160998,  945.4960090703,  946.3351020408,  947.1741950113,
      948.9102494331,  949.7493424036,  950.5884353741,  951.4275283447,
      1025.0108446712, 1025.9132312925, 1026.8156179138, 1027.7180045351,
      903.2329535147,  904.0268367347,  904.8207199546,  905.6146031746,
      781.0210487528,  781.7064285714,  782.39180839,    783.0771882086,
      658.3751303855,  658.9520068027,  659.52888322,    660.1057596372};
  const std::array<int, 4> in_shape = {{3, 10, 10, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x10x10x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.0204081633,
                                         0.0408163265,
                                         0.0612244898,
                                         0.0816326531,
                                         0.1224489796,
                                         0.1632653061,
                                         0.2040816327,
                                         0.2448979592,
                                         0.306122449,
                                         0.3673469388,
                                         0.4285714286,
                                         0.4897959184,
                                         0.5714285714,
                                         0.6530612245,
                                         0.7346938776,
                                         0.8163265306,
                                         0.5714285714,
                                         0.6530612245,
                                         0.7346938776,
                                         0.8163265306,
                                         0.5714285714,
                                         0.6530612245,
                                         0.7346938776,
                                         0.8163265306,
                                         0.5714285714,
                                         0.6530612245,
                                         0.7346938776,
                                         0.8163265306,
                                         0.5510204082,
                                         0.612244898,
                                         0.6734693878,
                                         0.7346938776,
                                         0.4489795918,
                                         0.4897959184,
                                         0.5306122449,
                                         0.5714285714,
                                         0.2653061224,
                                         0.2857142857,
                                         0.306122449,
                                         0.3265306122,
                                         0.3673469388,
                                         0.4081632653,
                                         0.4489795918,
                                         0.4897959184,
                                         0.8979591837,
                                         0.9795918367,
                                         1.0612244898,
                                         1.1428571429,
                                         1.5918367347,
                                         1.7142857143,
                                         1.8367346939,
                                         1.9591836735,
                                         2.4489795918,
                                         2.612244898,
                                         2.7755102041,
                                         2.9387755102,
                                         2.4489795918,
                                         2.612244898,
                                         2.7755102041,
                                         2.9387755102,
                                         2.4489795918,
                                         2.612244898,
                                         2.7755102041,
                                         2.9387755102,
                                         2.4489795918,
                                         2.612244898,
                                         2.7755102041,
                                         2.9387755102,
                                         2.0816326531,
                                         2.2040816327,
                                         2.3265306122,
                                         2.4489795918,
                                         1.5510204082,
                                         1.6326530612,
                                         1.7142857143,
                                         1.7959183673,
                                         0.8571428571,
                                         0.8979591837,
                                         0.9387755102,
                                         0.9795918367,
                                         1.0408163265,
                                         1.1020408163,
                                         1.1632653061,
                                         1.2244897959,
                                         2.3265306122,
                                         2.4489795918,
                                         2.5714285714,
                                         2.693877551,
                                         3.8571428571,
                                         4.0408163265,
                                         4.2244897959,
                                         4.4081632653,
                                         5.6326530612,
                                         5.8775510204,
                                         6.1224489796,
                                         6.3673469388,
                                         5.6326530612,
                                         5.8775510204,
                                         6.1224489796,
                                         6.3673469388,
                                         5.6326530612,
                                         5.8775510204,
                                         6.1224489796,
                                         6.3673469388,
                                         5.6326530612,
                                         5.8775510204,
                                         6.1224489796,
                                         6.3673469388,
                                         4.5918367347,
                                         4.7755102041,
                                         4.9591836735,
                                         5.1428571429,
                                         3.306122449,
                                         3.4285714286,
                                         3.5510204082,
                                         3.6734693878,
                                         1.7755102041,
                                         1.8367346939,
                                         1.8979591837,
                                         1.9591836735,
                                         2.0408163265,
                                         2.1224489796,
                                         2.2040816327,
                                         2.2857142857,
                                         4.4081632653,
                                         4.5714285714,
                                         4.7346938776,
                                         4.8979591837,
                                         7.1020408163,
                                         7.3469387755,
                                         7.5918367347,
                                         7.8367346939,
                                         10.1224489796,
                                         10.4489795918,
                                         10.7755102041,
                                         11.1020408163,
                                         10.1224489796,
                                         10.4489795918,
                                         10.7755102041,
                                         11.1020408163,
                                         10.1224489796,
                                         10.4489795918,
                                         10.7755102041,
                                         11.1020408163,
                                         10.1224489796,
                                         10.4489795918,
                                         10.7755102041,
                                         11.1020408163,
                                         8.0816326531,
                                         8.3265306122,
                                         8.5714285714,
                                         8.8163265306,
                                         5.7142857143,
                                         5.8775510204,
                                         6.0408163265,
                                         6.2040816327,
                                         3.0204081633,
                                         3.1020408163,
                                         3.1836734694,
                                         3.2653061224,
                                         2.0408163265,
                                         2.1224489796,
                                         2.2040816327,
                                         2.2857142857,
                                         4.4081632653,
                                         4.5714285714,
                                         4.7346938776,
                                         4.8979591837,
                                         7.1020408163,
                                         7.3469387755,
                                         7.5918367347,
                                         7.8367346939,
                                         10.1224489796,
                                         10.4489795918,
                                         10.7755102041,
                                         11.1020408163,
                                         10.1224489796,
                                         10.4489795918,
                                         10.7755102041,
                                         11.1020408163,
                                         10.1224489796,
                                         10.4489795918,
                                         10.7755102041,
                                         11.1020408163,
                                         10.1224489796,
                                         10.4489795918,
                                         10.7755102041,
                                         11.1020408163,
                                         8.0816326531,
                                         8.3265306122,
                                         8.5714285714,
                                         8.8163265306,
                                         5.7142857143,
                                         5.8775510204,
                                         6.0408163265,
                                         6.2040816327,
                                         3.0204081633,
                                         3.1020408163,
                                         3.1836734694,
                                         3.2653061224,
                                         2.0408163265,
                                         2.1224489796,
                                         2.2040816327,
                                         2.2857142857,
                                         4.4081632653,
                                         4.5714285714,
                                         4.7346938776,
                                         4.8979591837,
                                         7.1020408163,
                                         7.3469387755,
                                         7.5918367347,
                                         7.8367346939,
                                         10.1224489796,
                                         10.4489795918,
                                         10.7755102041,
                                         11.1020408163,
                                         10.1224489796,
                                         10.4489795918,
                                         10.7755102041,
                                         11.1020408163,
                                         10.1224489796,
                                         10.4489795918,
                                         10.7755102041,
                                         11.1020408163,
                                         10.1224489796,
                                         10.4489795918,
                                         10.7755102041,
                                         11.1020408163,
                                         8.0816326531,
                                         8.3265306122,
                                         8.5714285714,
                                         8.8163265306,
                                         5.7142857143,
                                         5.8775510204,
                                         6.0408163265,
                                         6.2040816327,
                                         3.0204081633,
                                         3.1020408163,
                                         3.1836734694,
                                         3.2653061224,
                                         2.0408163265,
                                         2.1224489796,
                                         2.2040816327,
                                         2.2857142857,
                                         4.4081632653,
                                         4.5714285714,
                                         4.7346938776,
                                         4.8979591837,
                                         7.1020408163,
                                         7.3469387755,
                                         7.5918367347,
                                         7.8367346939,
                                         10.1224489796,
                                         10.4489795918,
                                         10.7755102041,
                                         11.1020408163,
                                         10.1224489796,
                                         10.4489795918,
                                         10.7755102041,
                                         11.1020408163,
                                         10.1224489796,
                                         10.4489795918,
                                         10.7755102041,
                                         11.1020408163,
                                         10.1224489796,
                                         10.4489795918,
                                         10.7755102041,
                                         11.1020408163,
                                         8.0816326531,
                                         8.3265306122,
                                         8.5714285714,
                                         8.8163265306,
                                         5.7142857143,
                                         5.8775510204,
                                         6.0408163265,
                                         6.2040816327,
                                         3.0204081633,
                                         3.1020408163,
                                         3.1836734694,
                                         3.2653061224,
                                         2.0204081633,
                                         2.0816326531,
                                         2.1428571429,
                                         2.2040816327,
                                         4.2857142857,
                                         4.4081632653,
                                         4.5306122449,
                                         4.6530612245,
                                         6.7959183673,
                                         6.9795918367,
                                         7.1632653061,
                                         7.3469387755,
                                         9.5510204082,
                                         9.7959183673,
                                         10.0408163265,
                                         10.2857142857,
                                         9.5510204082,
                                         9.7959183673,
                                         10.0408163265,
                                         10.2857142857,
                                         9.5510204082,
                                         9.7959183673,
                                         10.0408163265,
                                         10.2857142857,
                                         9.5510204082,
                                         9.7959183673,
                                         10.0408163265,
                                         10.2857142857,
                                         7.5306122449,
                                         7.7142857143,
                                         7.8979591837,
                                         8.0816326531,
                                         5.2653061224,
                                         5.387755102,
                                         5.5102040816,
                                         5.6326530612,
                                         2.7551020408,
                                         2.8163265306,
                                         2.8775510204,
                                         2.9387755102,
                                         1.6734693878,
                                         1.7142857143,
                                         1.7551020408,
                                         1.7959183673,
                                         3.5102040816,
                                         3.5918367347,
                                         3.6734693878,
                                         3.7551020408,
                                         5.5102040816,
                                         5.6326530612,
                                         5.7551020408,
                                         5.8775510204,
                                         7.6734693878,
                                         7.8367346939,
                                         8.,
                                         8.1632653061,
                                         7.6734693878,
                                         7.8367346939,
                                         8.,
                                         8.1632653061,
                                         7.6734693878,
                                         7.8367346939,
                                         8.,
                                         8.1632653061,
                                         7.6734693878,
                                         7.8367346939,
                                         8.,
                                         8.1632653061,
                                         6.,
                                         6.1224489796,
                                         6.2448979592,
                                         6.3673469388,
                                         4.1632653061,
                                         4.2448979592,
                                         4.3265306122,
                                         4.4081632653,
                                         2.1632653061,
                                         2.2040816327,
                                         2.2448979592,
                                         2.2857142857,
                                         1.,
                                         1.0204081633,
                                         1.0408163265,
                                         1.0612244898,
                                         2.0816326531,
                                         2.1224489796,
                                         2.1632653061,
                                         2.2040816327,
                                         3.2448979592,
                                         3.306122449,
                                         3.3673469388,
                                         3.4285714286,
                                         4.4897959184,
                                         4.5714285714,
                                         4.6530612245,
                                         4.7346938776,
                                         4.4897959184,
                                         4.5714285714,
                                         4.6530612245,
                                         4.7346938776,
                                         4.4897959184,
                                         4.5714285714,
                                         4.6530612245,
                                         4.7346938776,
                                         4.4897959184,
                                         4.5714285714,
                                         4.6530612245,
                                         4.7346938776,
                                         3.4897959184,
                                         3.5510204082,
                                         3.612244898,
                                         3.6734693878,
                                         2.4081632653,
                                         2.4489795918,
                                         2.4897959184,
                                         2.5306122449,
                                         1.2448979592,
                                         1.2653061224,
                                         1.2857142857,
                                         1.306122449,
                                         1.3265306122,
                                         1.3469387755,
                                         1.3673469388,
                                         1.387755102,
                                         2.7346938776,
                                         2.7755102041,
                                         2.8163265306,
                                         2.8571428571,
                                         4.2244897959,
                                         4.2857142857,
                                         4.3469387755,
                                         4.4081632653,
                                         5.7959183673,
                                         5.8775510204,
                                         5.9591836735,
                                         6.0408163265,
                                         5.7959183673,
                                         5.8775510204,
                                         5.9591836735,
                                         6.0408163265,
                                         5.7959183673,
                                         5.8775510204,
                                         5.9591836735,
                                         6.0408163265,
                                         5.7959183673,
                                         5.8775510204,
                                         5.9591836735,
                                         6.0408163265,
                                         4.4693877551,
                                         4.5306122449,
                                         4.5918367347,
                                         4.6530612245,
                                         3.0612244898,
                                         3.1020408163,
                                         3.1428571429,
                                         3.1836734694,
                                         1.5714285714,
                                         1.5918367347,
                                         1.612244898,
                                         1.6326530612,
                                         2.9795918367,
                                         3.0204081633,
                                         3.0612244898,
                                         3.1020408163,
                                         6.1224489796,
                                         6.2040816327,
                                         6.2857142857,
                                         6.3673469388,
                                         9.4285714286,
                                         9.5510204082,
                                         9.6734693878,
                                         9.7959183673,
                                         12.8979591837,
                                         13.0612244898,
                                         13.2244897959,
                                         13.387755102,
                                         12.8979591837,
                                         13.0612244898,
                                         13.2244897959,
                                         13.387755102,
                                         12.8979591837,
                                         13.0612244898,
                                         13.2244897959,
                                         13.387755102,
                                         12.8979591837,
                                         13.0612244898,
                                         13.2244897959,
                                         13.387755102,
                                         9.9183673469,
                                         10.0408163265,
                                         10.1632653061,
                                         10.2857142857,
                                         6.7755102041,
                                         6.8571428571,
                                         6.9387755102,
                                         7.0204081633,
                                         3.4693877551,
                                         3.5102040816,
                                         3.5510204082,
                                         3.5918367347,
                                         4.9591836735,
                                         5.0204081633,
                                         5.0816326531,
                                         5.1428571429,
                                         10.1632653061,
                                         10.2857142857,
                                         10.4081632653,
                                         10.5306122449,
                                         15.612244898,
                                         15.7959183673,
                                         15.9795918367,
                                         16.1632653061,
                                         21.306122449,
                                         21.5510204082,
                                         21.7959183673,
                                         22.0408163265,
                                         21.306122449,
                                         21.5510204082,
                                         21.7959183673,
                                         22.0408163265,
                                         21.306122449,
                                         21.5510204082,
                                         21.7959183673,
                                         22.0408163265,
                                         21.306122449,
                                         21.5510204082,
                                         21.7959183673,
                                         22.0408163265,
                                         16.3469387755,
                                         16.5306122449,
                                         16.7142857143,
                                         16.8979591837,
                                         11.1428571429,
                                         11.2653061224,
                                         11.387755102,
                                         11.5102040816,
                                         5.693877551,
                                         5.7551020408,
                                         5.8163265306,
                                         5.8775510204,
                                         7.2653061224,
                                         7.3469387755,
                                         7.4285714286,
                                         7.5102040816,
                                         14.8571428571,
                                         15.0204081633,
                                         15.1836734694,
                                         15.3469387755,
                                         22.7755102041,
                                         23.0204081633,
                                         23.2653061224,
                                         23.5102040816,
                                         31.0204081633,
                                         31.3469387755,
                                         31.6734693878,
                                         32.,
                                         31.0204081633,
                                         31.3469387755,
                                         31.6734693878,
                                         32.,
                                         31.0204081633,
                                         31.3469387755,
                                         31.6734693878,
                                         32.,
                                         31.0204081633,
                                         31.3469387755,
                                         31.6734693878,
                                         32.,
                                         23.7551020408,
                                         24.,
                                         24.2448979592,
                                         24.4897959184,
                                         16.1632653061,
                                         16.3265306122,
                                         16.4897959184,
                                         16.6530612245,
                                         8.2448979592,
                                         8.3265306122,
                                         8.4081632653,
                                         8.4897959184,
                                         7.2653061224,
                                         7.3469387755,
                                         7.4285714286,
                                         7.5102040816,
                                         14.8571428571,
                                         15.0204081633,
                                         15.1836734694,
                                         15.3469387755,
                                         22.7755102041,
                                         23.0204081633,
                                         23.2653061224,
                                         23.5102040816,
                                         31.0204081633,
                                         31.3469387755,
                                         31.6734693878,
                                         32.,
                                         31.0204081633,
                                         31.3469387755,
                                         31.6734693878,
                                         32.,
                                         31.0204081633,
                                         31.3469387755,
                                         31.6734693878,
                                         32.,
                                         31.0204081633,
                                         31.3469387755,
                                         31.6734693878,
                                         32.,
                                         23.7551020408,
                                         24.,
                                         24.2448979592,
                                         24.4897959184,
                                         16.1632653061,
                                         16.3265306122,
                                         16.4897959184,
                                         16.6530612245,
                                         8.2448979592,
                                         8.3265306122,
                                         8.4081632653,
                                         8.4897959184,
                                         7.2653061224,
                                         7.3469387755,
                                         7.4285714286,
                                         7.5102040816,
                                         14.8571428571,
                                         15.0204081633,
                                         15.1836734694,
                                         15.3469387755,
                                         22.7755102041,
                                         23.0204081633,
                                         23.2653061224,
                                         23.5102040816,
                                         31.0204081633,
                                         31.3469387755,
                                         31.6734693878,
                                         32.,
                                         31.0204081633,
                                         31.3469387755,
                                         31.6734693878,
                                         32.,
                                         31.0204081633,
                                         31.3469387755,
                                         31.6734693878,
                                         32.,
                                         31.0204081633,
                                         31.3469387755,
                                         31.6734693878,
                                         32.,
                                         23.7551020408,
                                         24.,
                                         24.2448979592,
                                         24.4897959184,
                                         16.1632653061,
                                         16.3265306122,
                                         16.4897959184,
                                         16.6530612245,
                                         8.2448979592,
                                         8.3265306122,
                                         8.4081632653,
                                         8.4897959184,
                                         7.2653061224,
                                         7.3469387755,
                                         7.4285714286,
                                         7.5102040816,
                                         14.8571428571,
                                         15.0204081633,
                                         15.1836734694,
                                         15.3469387755,
                                         22.7755102041,
                                         23.0204081633,
                                         23.2653061224,
                                         23.5102040816,
                                         31.0204081633,
                                         31.3469387755,
                                         31.6734693878,
                                         32.,
                                         31.0204081633,
                                         31.3469387755,
                                         31.6734693878,
                                         32.,
                                         31.0204081633,
                                         31.3469387755,
                                         31.6734693878,
                                         32.,
                                         31.0204081633,
                                         31.3469387755,
                                         31.6734693878,
                                         32.,
                                         23.7551020408,
                                         24.,
                                         24.2448979592,
                                         24.4897959184,
                                         16.1632653061,
                                         16.3265306122,
                                         16.4897959184,
                                         16.6530612245,
                                         8.2448979592,
                                         8.3265306122,
                                         8.4081632653,
                                         8.4897959184,
                                         5.9387755102,
                                         6.,
                                         6.0612244898,
                                         6.1224489796,
                                         12.1224489796,
                                         12.2448979592,
                                         12.3673469388,
                                         12.4897959184,
                                         18.5510204082,
                                         18.7346938776,
                                         18.9183673469,
                                         19.1020408163,
                                         25.2244897959,
                                         25.4693877551,
                                         25.7142857143,
                                         25.9591836735,
                                         25.2244897959,
                                         25.4693877551,
                                         25.7142857143,
                                         25.9591836735,
                                         25.2244897959,
                                         25.4693877551,
                                         25.7142857143,
                                         25.9591836735,
                                         25.2244897959,
                                         25.4693877551,
                                         25.7142857143,
                                         25.9591836735,
                                         19.2857142857,
                                         19.4693877551,
                                         19.6530612245,
                                         19.8367346939,
                                         13.1020408163,
                                         13.2244897959,
                                         13.3469387755,
                                         13.4693877551,
                                         6.6734693878,
                                         6.7346938776,
                                         6.7959183673,
                                         6.8571428571,
                                         4.2857142857,
                                         4.3265306122,
                                         4.3673469388,
                                         4.4081632653,
                                         8.7346938776,
                                         8.8163265306,
                                         8.8979591837,
                                         8.9795918367,
                                         13.3469387755,
                                         13.4693877551,
                                         13.5918367347,
                                         13.7142857143,
                                         18.1224489796,
                                         18.2857142857,
                                         18.4489795918,
                                         18.612244898,
                                         18.1224489796,
                                         18.2857142857,
                                         18.4489795918,
                                         18.612244898,
                                         18.1224489796,
                                         18.2857142857,
                                         18.4489795918,
                                         18.612244898,
                                         18.1224489796,
                                         18.2857142857,
                                         18.4489795918,
                                         18.612244898,
                                         13.8367346939,
                                         13.9591836735,
                                         14.0816326531,
                                         14.2040816327,
                                         9.387755102,
                                         9.4693877551,
                                         9.5510204082,
                                         9.6326530612,
                                         4.7755102041,
                                         4.8163265306,
                                         4.8571428571,
                                         4.8979591837,
                                         2.306122449,
                                         2.3265306122,
                                         2.3469387755,
                                         2.3673469388,
                                         4.693877551,
                                         4.7346938776,
                                         4.7755102041,
                                         4.8163265306,
                                         7.1632653061,
                                         7.2244897959,
                                         7.2857142857,
                                         7.3469387755,
                                         9.7142857143,
                                         9.7959183673,
                                         9.8775510204,
                                         9.9591836735,
                                         9.7142857143,
                                         9.7959183673,
                                         9.8775510204,
                                         9.9591836735,
                                         9.7142857143,
                                         9.7959183673,
                                         9.8775510204,
                                         9.9591836735,
                                         9.7142857143,
                                         9.7959183673,
                                         9.8775510204,
                                         9.9591836735,
                                         7.4081632653,
                                         7.4693877551,
                                         7.5306122449,
                                         7.5918367347,
                                         5.0204081633,
                                         5.0612244898,
                                         5.1020408163,
                                         5.1428571429,
                                         2.5510204082,
                                         2.5714285714,
                                         2.5918367347,
                                         2.612244898,
                                         2.6326530612,
                                         2.6530612245,
                                         2.6734693878,
                                         2.693877551,
                                         5.3469387755,
                                         5.387755102,
                                         5.4285714286,
                                         5.4693877551,
                                         8.1428571429,
                                         8.2040816327,
                                         8.2653061224,
                                         8.3265306122,
                                         11.0204081633,
                                         11.1020408163,
                                         11.1836734694,
                                         11.2653061224,
                                         11.0204081633,
                                         11.1020408163,
                                         11.1836734694,
                                         11.2653061224,
                                         11.0204081633,
                                         11.1020408163,
                                         11.1836734694,
                                         11.2653061224,
                                         11.0204081633,
                                         11.1020408163,
                                         11.1836734694,
                                         11.2653061224,
                                         8.387755102,
                                         8.4489795918,
                                         8.5102040816,
                                         8.5714285714,
                                         5.6734693878,
                                         5.7142857143,
                                         5.7551020408,
                                         5.7959183673,
                                         2.8775510204,
                                         2.8979591837,
                                         2.9183673469,
                                         2.9387755102,
                                         5.5918367347,
                                         5.6326530612,
                                         5.6734693878,
                                         5.7142857143,
                                         11.3469387755,
                                         11.4285714286,
                                         11.5102040816,
                                         11.5918367347,
                                         17.2653061224,
                                         17.387755102,
                                         17.5102040816,
                                         17.6326530612,
                                         23.3469387755,
                                         23.5102040816,
                                         23.6734693878,
                                         23.8367346939,
                                         23.3469387755,
                                         23.5102040816,
                                         23.6734693878,
                                         23.8367346939,
                                         23.3469387755,
                                         23.5102040816,
                                         23.6734693878,
                                         23.8367346939,
                                         23.3469387755,
                                         23.5102040816,
                                         23.6734693878,
                                         23.8367346939,
                                         17.7551020408,
                                         17.8775510204,
                                         18.,
                                         18.1224489796,
                                         12.,
                                         12.0816326531,
                                         12.1632653061,
                                         12.2448979592,
                                         6.0816326531,
                                         6.1224489796,
                                         6.1632653061,
                                         6.2040816327,
                                         8.8775510204,
                                         8.9387755102,
                                         9.,
                                         9.0612244898,
                                         18.,
                                         18.1224489796,
                                         18.2448979592,
                                         18.3673469388,
                                         27.3673469388,
                                         27.5510204082,
                                         27.7346938776,
                                         27.9183673469,
                                         36.9795918367,
                                         37.2244897959,
                                         37.4693877551,
                                         37.7142857143,
                                         36.9795918367,
                                         37.2244897959,
                                         37.4693877551,
                                         37.7142857143,
                                         36.9795918367,
                                         37.2244897959,
                                         37.4693877551,
                                         37.7142857143,
                                         36.9795918367,
                                         37.2244897959,
                                         37.4693877551,
                                         37.7142857143,
                                         28.1020408163,
                                         28.2857142857,
                                         28.4693877551,
                                         28.6530612245,
                                         18.9795918367,
                                         19.1020408163,
                                         19.2244897959,
                                         19.3469387755,
                                         9.612244898,
                                         9.6734693878,
                                         9.7346938776,
                                         9.7959183673,
                                         12.4897959184,
                                         12.5714285714,
                                         12.6530612245,
                                         12.7346938776,
                                         25.306122449,
                                         25.4693877551,
                                         25.6326530612,
                                         25.7959183673,
                                         38.4489795918,
                                         38.693877551,
                                         38.9387755102,
                                         39.1836734694,
                                         51.9183673469,
                                         52.2448979592,
                                         52.5714285714,
                                         52.8979591837,
                                         51.9183673469,
                                         52.2448979592,
                                         52.5714285714,
                                         52.8979591837,
                                         51.9183673469,
                                         52.2448979592,
                                         52.5714285714,
                                         52.8979591837,
                                         51.9183673469,
                                         52.2448979592,
                                         52.5714285714,
                                         52.8979591837,
                                         39.4285714286,
                                         39.6734693878,
                                         39.9183673469,
                                         40.1632653061,
                                         26.612244898,
                                         26.7755102041,
                                         26.9387755102,
                                         27.1020408163,
                                         13.4693877551,
                                         13.5510204082,
                                         13.6326530612,
                                         13.7142857143,
                                         12.4897959184,
                                         12.5714285714,
                                         12.6530612245,
                                         12.7346938776,
                                         25.306122449,
                                         25.4693877551,
                                         25.6326530612,
                                         25.7959183673,
                                         38.4489795918,
                                         38.693877551,
                                         38.9387755102,
                                         39.1836734694,
                                         51.9183673469,
                                         52.2448979592,
                                         52.5714285714,
                                         52.8979591837,
                                         51.9183673469,
                                         52.2448979592,
                                         52.5714285714,
                                         52.8979591837,
                                         51.9183673469,
                                         52.2448979592,
                                         52.5714285714,
                                         52.8979591837,
                                         51.9183673469,
                                         52.2448979592,
                                         52.5714285714,
                                         52.8979591837,
                                         39.4285714286,
                                         39.6734693878,
                                         39.9183673469,
                                         40.1632653061,
                                         26.612244898,
                                         26.7755102041,
                                         26.9387755102,
                                         27.1020408163,
                                         13.4693877551,
                                         13.5510204082,
                                         13.6326530612,
                                         13.7142857143,
                                         12.4897959184,
                                         12.5714285714,
                                         12.6530612245,
                                         12.7346938776,
                                         25.306122449,
                                         25.4693877551,
                                         25.6326530612,
                                         25.7959183673,
                                         38.4489795918,
                                         38.693877551,
                                         38.9387755102,
                                         39.1836734694,
                                         51.9183673469,
                                         52.2448979592,
                                         52.5714285714,
                                         52.8979591837,
                                         51.9183673469,
                                         52.2448979592,
                                         52.5714285714,
                                         52.8979591837,
                                         51.9183673469,
                                         52.2448979592,
                                         52.5714285714,
                                         52.8979591837,
                                         51.9183673469,
                                         52.2448979592,
                                         52.5714285714,
                                         52.8979591837,
                                         39.4285714286,
                                         39.6734693878,
                                         39.9183673469,
                                         40.1632653061,
                                         26.612244898,
                                         26.7755102041,
                                         26.9387755102,
                                         27.1020408163,
                                         13.4693877551,
                                         13.5510204082,
                                         13.6326530612,
                                         13.7142857143,
                                         12.4897959184,
                                         12.5714285714,
                                         12.6530612245,
                                         12.7346938776,
                                         25.306122449,
                                         25.4693877551,
                                         25.6326530612,
                                         25.7959183673,
                                         38.4489795918,
                                         38.693877551,
                                         38.9387755102,
                                         39.1836734694,
                                         51.9183673469,
                                         52.2448979592,
                                         52.5714285714,
                                         52.8979591837,
                                         51.9183673469,
                                         52.2448979592,
                                         52.5714285714,
                                         52.8979591837,
                                         51.9183673469,
                                         52.2448979592,
                                         52.5714285714,
                                         52.8979591837,
                                         51.9183673469,
                                         52.2448979592,
                                         52.5714285714,
                                         52.8979591837,
                                         39.4285714286,
                                         39.6734693878,
                                         39.9183673469,
                                         40.1632653061,
                                         26.612244898,
                                         26.7755102041,
                                         26.9387755102,
                                         27.1020408163,
                                         13.4693877551,
                                         13.5510204082,
                                         13.6326530612,
                                         13.7142857143,
                                         9.8571428571,
                                         9.9183673469,
                                         9.9795918367,
                                         10.0408163265,
                                         19.9591836735,
                                         20.0816326531,
                                         20.2040816327,
                                         20.3265306122,
                                         30.306122449,
                                         30.4897959184,
                                         30.6734693878,
                                         30.8571428571,
                                         40.8979591837,
                                         41.1428571429,
                                         41.387755102,
                                         41.6326530612,
                                         40.8979591837,
                                         41.1428571429,
                                         41.387755102,
                                         41.6326530612,
                                         40.8979591837,
                                         41.1428571429,
                                         41.387755102,
                                         41.6326530612,
                                         40.8979591837,
                                         41.1428571429,
                                         41.387755102,
                                         41.6326530612,
                                         31.0408163265,
                                         31.2244897959,
                                         31.4081632653,
                                         31.5918367347,
                                         20.9387755102,
                                         21.0612244898,
                                         21.1836734694,
                                         21.306122449,
                                         10.5918367347,
                                         10.6530612245,
                                         10.7142857143,
                                         10.7755102041,
                                         6.8979591837,
                                         6.9387755102,
                                         6.9795918367,
                                         7.0204081633,
                                         13.9591836735,
                                         14.0408163265,
                                         14.1224489796,
                                         14.2040816327,
                                         21.1836734694,
                                         21.306122449,
                                         21.4285714286,
                                         21.5510204082,
                                         28.5714285714,
                                         28.7346938776,
                                         28.8979591837,
                                         29.0612244898,
                                         28.5714285714,
                                         28.7346938776,
                                         28.8979591837,
                                         29.0612244898,
                                         28.5714285714,
                                         28.7346938776,
                                         28.8979591837,
                                         29.0612244898,
                                         28.5714285714,
                                         28.7346938776,
                                         28.8979591837,
                                         29.0612244898,
                                         21.6734693878,
                                         21.7959183673,
                                         21.9183673469,
                                         22.0408163265,
                                         14.612244898,
                                         14.693877551,
                                         14.7755102041,
                                         14.8571428571,
                                         7.387755102,
                                         7.4285714286,
                                         7.4693877551,
                                         7.5102040816,
                                         3.612244898,
                                         3.6326530612,
                                         3.6530612245,
                                         3.6734693878,
                                         7.306122449,
                                         7.3469387755,
                                         7.387755102,
                                         7.4285714286,
                                         11.0816326531,
                                         11.1428571429,
                                         11.2040816327,
                                         11.2653061224,
                                         14.9387755102,
                                         15.0204081633,
                                         15.1020408163,
                                         15.1836734694,
                                         14.9387755102,
                                         15.0204081633,
                                         15.1020408163,
                                         15.1836734694,
                                         14.9387755102,
                                         15.0204081633,
                                         15.1020408163,
                                         15.1836734694,
                                         14.9387755102,
                                         15.0204081633,
                                         15.1020408163,
                                         15.1836734694,
                                         11.3265306122,
                                         11.387755102,
                                         11.4489795918,
                                         11.5102040816,
                                         7.6326530612,
                                         7.6734693878,
                                         7.7142857143,
                                         7.7551020408,
                                         3.8571428571,
                                         3.8775510204,
                                         3.8979591837,
                                         3.9183673469};
  const std::array<int, 4> in_shape = {{3, 10, 10, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
