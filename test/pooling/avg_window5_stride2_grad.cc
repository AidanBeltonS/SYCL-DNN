/*
 * Copyright 2018 Codeplay Software Ltd.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use these files except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

// DO NOT MODIFY BY HAND
// This file was automatically generated by generate_pooling_tests.py.
// Results calculated using Tensorflow v1.8.0.

#include <gtest/gtest.h>

#include "sycldnn/pooling/launch.h"
#include "sycldnn/pooling/operators.h"
#include "sycldnn/pooling/params.h"

#include "test/pooling/pooling_fixture.h"
#include "test/types/kernel_data_types.h"

#include <CL/sycl.hpp>

#include <vector>

using namespace sycldnn;
template <typename DataType>
using AvgWindow5Stride2Grad =
    PoolingFixture<DataType, pooling::Average, pooling::Backpropagate>;
TYPED_TEST_CASE(AvgWindow5Stride2Grad, types::GTestKernelDataTypes);
TYPED_TEST(AvgWindow5Stride2Grad, SAME1x7x7x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.8177777778, 0.8177777778, 1.2977777778, 0.8533333333, 1.8311111111,
      1.4577777778, 1.4577777778, 0.8177777778, 0.8177777778, 1.2977777778,
      0.8533333333, 1.8311111111, 1.4577777778, 1.4577777778, 1.8177777778,
      1.8177777778, 2.7377777778, 1.6933333333, 3.4711111111, 2.6977777778,
      2.6977777778, 1.5733333333, 1.5733333333, 2.2933333333, 1.36,
      2.6933333333, 2.0533333333, 2.0533333333, 3.9511111111, 3.9511111111,
      5.6711111111, 3.2933333333, 6.4044444444, 4.8311111111, 4.8311111111,
      3.3777777778, 3.3777777778, 4.8177777778, 2.7733333333, 5.3511111111,
      4.0177777778, 4.0177777778, 3.3777777778, 3.3777777778, 4.8177777778,
      2.7733333333, 5.3511111111, 4.0177777778, 4.0177777778};
  const std::array<int, 4> in_shape = {{1, 7, 7, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID1x7x7x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.04, 0.04, 0.12, 0.12, 0.12, 0.08, 0.08, 0.04, 0.04, 0.12,
      0.12, 0.12, 0.08, 0.08, 0.16, 0.16, 0.4,  0.4,  0.4,  0.24,
      0.24, 0.16, 0.16, 0.4,  0.4,  0.4,  0.24, 0.24, 0.16, 0.16,
      0.4,  0.4,  0.4,  0.24, 0.24, 0.12, 0.12, 0.28, 0.28, 0.28,
      0.16, 0.16, 0.12, 0.12, 0.28, 0.28, 0.28, 0.16, 0.16};
  const std::array<int, 4> in_shape = {{1, 7, 7, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME1x7x7x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      1.3511111111,  1.6355555556,  1.3511111111,  1.6355555556,  2.2044444444,
      2.5955555556,  1.4933333333,  1.7066666667,  3.2711111111,  3.6622222222,
      2.6311111111,  2.9155555556,  2.6311111111,  2.9155555556,  1.3511111111,
      1.6355555556,  1.3511111111,  1.6355555556,  2.2044444444,  2.5955555556,
      1.4933333333,  1.7066666667,  3.2711111111,  3.6622222222,  2.6311111111,
      2.9155555556,  2.6311111111,  2.9155555556,  3.2444444444,  3.6355555556,
      3.2444444444,  3.6355555556,  4.9377777778,  5.4755555556,  3.0933333333,
      3.3866666667,  6.4044444444,  6.9422222222,  5.0044444444,  5.3955555556,
      5.0044444444,  5.3955555556,  2.9333333333,  3.1466666667,  2.9333333333,
      3.1466666667,  4.2933333333,  4.5866666667,  2.56,          2.72,
      5.0933333333,  5.3866666667,  3.8933333333,  4.1066666667,  3.8933333333,
      4.1066666667,  7.5111111111,  7.9022222222,  7.5111111111,  7.9022222222,
      10.8044444444, 11.3422222222, 6.2933333333,  6.5866666667,  12.2711111111,
      12.8088888889, 9.2711111111,  9.6622222222,  9.2711111111,  9.6622222222,
      6.4711111111,  6.7555555556,  6.4711111111,  6.7555555556,  9.2444444444,
      9.6355555556,  5.3333333333,  5.5466666667,  10.3111111111, 10.7022222222,
      7.7511111111,  8.0355555556,  7.7511111111,  8.0355555556,  6.4711111111,
      6.7555555556,  6.4711111111,  6.7555555556,  9.2444444444,  9.6355555556,
      5.3333333333,  5.5466666667,  10.3111111111, 10.7022222222, 7.7511111111,
      8.0355555556,  7.7511111111,  8.0355555556};
  const std::array<int, 4> in_shape = {{1, 7, 7, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID1x7x7x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.04, 0.08, 0.04, 0.08, 0.16, 0.24, 0.16, 0.24, 0.16, 0.24, 0.12,
      0.16, 0.12, 0.16, 0.04, 0.08, 0.04, 0.08, 0.16, 0.24, 0.16, 0.24,
      0.16, 0.24, 0.12, 0.16, 0.12, 0.16, 0.24, 0.32, 0.24, 0.32, 0.64,
      0.8,  0.64, 0.8,  0.64, 0.8,  0.4,  0.48, 0.4,  0.48, 0.24, 0.32,
      0.24, 0.32, 0.64, 0.8,  0.64, 0.8,  0.64, 0.8,  0.4,  0.48, 0.4,
      0.48, 0.24, 0.32, 0.24, 0.32, 0.64, 0.8,  0.64, 0.8,  0.64, 0.8,
      0.4,  0.48, 0.4,  0.48, 0.2,  0.24, 0.2,  0.24, 0.48, 0.56, 0.48,
      0.56, 0.48, 0.56, 0.28, 0.32, 0.28, 0.32, 0.2,  0.24, 0.2,  0.24,
      0.48, 0.56, 0.48, 0.56, 0.48, 0.56, 0.28, 0.32, 0.28, 0.32};
  const std::array<int, 4> in_shape = {{1, 7, 7, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME1x7x7x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {2.4177777778,
                                         2.7022222222,
                                         2.9866666667,
                                         3.2711111111,
                                         2.4177777778,
                                         2.7022222222,
                                         2.9866666667,
                                         3.2711111111,
                                         4.0177777778,
                                         4.4088888889,
                                         4.8,
                                         5.1911111111,
                                         2.7733333333,
                                         2.9866666667,
                                         3.2,
                                         3.4133333333,
                                         6.1511111111,
                                         6.5422222222,
                                         6.9333333333,
                                         7.3244444444,
                                         4.9777777778,
                                         5.2622222222,
                                         5.5466666667,
                                         5.8311111111,
                                         4.9777777778,
                                         5.2622222222,
                                         5.5466666667,
                                         5.8311111111,
                                         2.4177777778,
                                         2.7022222222,
                                         2.9866666667,
                                         3.2711111111,
                                         2.4177777778,
                                         2.7022222222,
                                         2.9866666667,
                                         3.2711111111,
                                         4.0177777778,
                                         4.4088888889,
                                         4.8,
                                         5.1911111111,
                                         2.7733333333,
                                         2.9866666667,
                                         3.2,
                                         3.4133333333,
                                         6.1511111111,
                                         6.5422222222,
                                         6.9333333333,
                                         7.3244444444,
                                         4.9777777778,
                                         5.2622222222,
                                         5.5466666667,
                                         5.8311111111,
                                         4.9777777778,
                                         5.2622222222,
                                         5.5466666667,
                                         5.8311111111,
                                         6.0977777778,
                                         6.4888888889,
                                         6.88,
                                         7.2711111111,
                                         6.0977777778,
                                         6.4888888889,
                                         6.88,
                                         7.2711111111,
                                         9.3377777778,
                                         9.8755555556,
                                         10.4133333333,
                                         10.9511111111,
                                         5.8933333333,
                                         6.1866666667,
                                         6.48,
                                         6.7733333333,
                                         12.2711111111,
                                         12.8088888889,
                                         13.3466666667,
                                         13.8844444444,
                                         9.6177777778,
                                         10.0088888889,
                                         10.4,
                                         10.7911111111,
                                         9.6177777778,
                                         10.0088888889,
                                         10.4,
                                         10.7911111111,
                                         5.6533333333,
                                         5.8666666667,
                                         6.08,
                                         6.2933333333,
                                         5.6533333333,
                                         5.8666666667,
                                         6.08,
                                         6.2933333333,
                                         8.2933333333,
                                         8.5866666667,
                                         8.88,
                                         9.1733333333,
                                         4.96,
                                         5.12,
                                         5.28,
                                         5.44,
                                         9.8933333333,
                                         10.1866666667,
                                         10.48,
                                         10.7733333333,
                                         7.5733333333,
                                         7.7866666667,
                                         8.,
                                         8.2133333333,
                                         7.5733333333,
                                         7.7866666667,
                                         8.,
                                         8.2133333333,
                                         14.6311111111,
                                         15.0222222222,
                                         15.4133333333,
                                         15.8044444444,
                                         14.6311111111,
                                         15.0222222222,
                                         15.4133333333,
                                         15.8044444444,
                                         21.0711111111,
                                         21.6088888889,
                                         22.1466666667,
                                         22.6844444444,
                                         12.2933333333,
                                         12.5866666667,
                                         12.88,
                                         13.1733333333,
                                         24.0044444444,
                                         24.5422222222,
                                         25.08,
                                         25.6177777778,
                                         18.1511111111,
                                         18.5422222222,
                                         18.9333333333,
                                         19.3244444444,
                                         18.1511111111,
                                         18.5422222222,
                                         18.9333333333,
                                         19.3244444444,
                                         12.6577777778,
                                         12.9422222222,
                                         13.2266666667,
                                         13.5111111111,
                                         12.6577777778,
                                         12.9422222222,
                                         13.2266666667,
                                         13.5111111111,
                                         18.0977777778,
                                         18.4888888889,
                                         18.88,
                                         19.2711111111,
                                         10.4533333333,
                                         10.6666666667,
                                         10.88,
                                         11.0933333333,
                                         20.2311111111,
                                         20.6222222222,
                                         21.0133333333,
                                         21.4044444444,
                                         15.2177777778,
                                         15.5022222222,
                                         15.7866666667,
                                         16.0711111111,
                                         15.2177777778,
                                         15.5022222222,
                                         15.7866666667,
                                         16.0711111111,
                                         12.6577777778,
                                         12.9422222222,
                                         13.2266666667,
                                         13.5111111111,
                                         12.6577777778,
                                         12.9422222222,
                                         13.2266666667,
                                         13.5111111111,
                                         18.0977777778,
                                         18.4888888889,
                                         18.88,
                                         19.2711111111,
                                         10.4533333333,
                                         10.6666666667,
                                         10.88,
                                         11.0933333333,
                                         20.2311111111,
                                         20.6222222222,
                                         21.0133333333,
                                         21.4044444444,
                                         15.2177777778,
                                         15.5022222222,
                                         15.7866666667,
                                         16.0711111111,
                                         15.2177777778,
                                         15.5022222222,
                                         15.7866666667,
                                         16.0711111111};
  const std::array<int, 4> in_shape = {{1, 7, 7, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID1x7x7x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.04, 0.08, 0.12, 0.16, 0.04, 0.08, 0.12, 0.16, 0.24, 0.32, 0.4,  0.48,
      0.24, 0.32, 0.4,  0.48, 0.24, 0.32, 0.4,  0.48, 0.2,  0.24, 0.28, 0.32,
      0.2,  0.24, 0.28, 0.32, 0.04, 0.08, 0.12, 0.16, 0.04, 0.08, 0.12, 0.16,
      0.24, 0.32, 0.4,  0.48, 0.24, 0.32, 0.4,  0.48, 0.24, 0.32, 0.4,  0.48,
      0.2,  0.24, 0.28, 0.32, 0.2,  0.24, 0.28, 0.32, 0.4,  0.48, 0.56, 0.64,
      0.4,  0.48, 0.56, 0.64, 1.12, 1.28, 1.44, 1.6,  1.12, 1.28, 1.44, 1.6,
      1.12, 1.28, 1.44, 1.6,  0.72, 0.8,  0.88, 0.96, 0.72, 0.8,  0.88, 0.96,
      0.4,  0.48, 0.56, 0.64, 0.4,  0.48, 0.56, 0.64, 1.12, 1.28, 1.44, 1.6,
      1.12, 1.28, 1.44, 1.6,  1.12, 1.28, 1.44, 1.6,  0.72, 0.8,  0.88, 0.96,
      0.72, 0.8,  0.88, 0.96, 0.4,  0.48, 0.56, 0.64, 0.4,  0.48, 0.56, 0.64,
      1.12, 1.28, 1.44, 1.6,  1.12, 1.28, 1.44, 1.6,  1.12, 1.28, 1.44, 1.6,
      0.72, 0.8,  0.88, 0.96, 0.72, 0.8,  0.88, 0.96, 0.36, 0.4,  0.44, 0.48,
      0.36, 0.4,  0.44, 0.48, 0.88, 0.96, 1.04, 1.12, 0.88, 0.96, 1.04, 1.12,
      0.88, 0.96, 1.04, 1.12, 0.52, 0.56, 0.6,  0.64, 0.52, 0.56, 0.6,  0.64,
      0.36, 0.4,  0.44, 0.48, 0.36, 0.4,  0.44, 0.48, 0.88, 0.96, 1.04, 1.12,
      0.88, 0.96, 1.04, 1.12, 0.88, 0.96, 1.04, 1.12, 0.52, 0.56, 0.6,  0.64,
      0.52, 0.56, 0.6,  0.64};
  const std::array<int, 4> in_shape = {{1, 7, 7, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME1x7x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.3333333333, 0.7066666667, 0.7066666667, 1.1866666667, 0.8533333333,
      1.8311111111, 1.4577777778, 1.4577777778, 0.3333333333, 0.7066666667,
      0.7066666667, 1.1866666667, 0.8533333333, 1.8311111111, 1.4577777778,
      1.4577777778, 0.7833333333, 1.5566666667, 1.5566666667, 2.4766666667,
      1.6933333333, 3.4711111111, 2.6977777778, 2.6977777778, 0.7,
      1.34,         1.34,         2.06,         1.36,         2.6933333333,
      2.0533333333, 2.0533333333, 1.7833333333, 3.3566666667, 3.3566666667,
      5.0766666667, 3.2933333333, 6.4044444444, 4.8311111111, 4.8311111111,
      1.5333333333, 2.8666666667, 2.8666666667, 4.3066666667, 2.7733333333,
      5.3511111111, 4.0177777778, 4.0177777778, 1.5333333333, 2.8666666667,
      2.8666666667, 4.3066666667, 2.7733333333, 5.3511111111, 4.0177777778,
      4.0177777778};
  const std::array<int, 4> in_shape = {{1, 7, 8, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID1x7x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.04, 0.04, 0.12, 0.12, 0.12, 0.08, 0.08, 0.,   0.04, 0.04, 0.12, 0.12,
      0.12, 0.08, 0.08, 0.,   0.16, 0.16, 0.4,  0.4,  0.4,  0.24, 0.24, 0.,
      0.16, 0.16, 0.4,  0.4,  0.4,  0.24, 0.24, 0.,   0.16, 0.16, 0.4,  0.4,
      0.4,  0.24, 0.24, 0.,   0.12, 0.12, 0.28, 0.28, 0.28, 0.16, 0.16, 0.,
      0.12, 0.12, 0.28, 0.28, 0.28, 0.16, 0.16, 0.,
  };
  const std::array<int, 4> in_shape = {{1, 7, 8, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME1x7x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.5333333333,  0.6666666667,  1.1733333333,  1.4133333333, 1.1733333333,
      1.4133333333,  2.0266666667,  2.3733333333,  1.4933333333, 1.7066666667,
      3.2711111111,  3.6622222222,  2.6311111111,  2.9155555556, 2.6311111111,
      2.9155555556,  0.5333333333,  0.6666666667,  1.1733333333, 1.4133333333,
      1.1733333333,  1.4133333333,  2.0266666667,  2.3733333333, 1.4933333333,
      1.7066666667,  3.2711111111,  3.6622222222,  2.6311111111, 2.9155555556,
      2.6311111111,  2.9155555556,  1.3833333333,  1.5666666667, 2.7833333333,
      3.1133333333,  2.7833333333,  3.1133333333,  4.4766666667, 4.9533333333,
      3.0933333333,  3.3866666667,  6.4044444444,  6.9422222222, 5.0044444444,
      5.3955555556,  5.0044444444,  5.3955555556,  1.3,          1.4,
      2.5,           2.68,          2.5,           2.68,         3.86,
      4.12,          2.56,          2.72,          5.0933333333, 5.3866666667,
      3.8933333333,  4.1066666667,  3.8933333333,  4.1066666667, 3.3833333333,
      3.5666666667,  6.3833333333,  6.7133333333,  6.3833333333, 6.7133333333,
      9.6766666667,  10.1533333333, 6.2933333333,  6.5866666667, 12.2711111111,
      12.8088888889, 9.2711111111,  9.6622222222,  9.2711111111, 9.6622222222,
      2.9333333333,  3.0666666667,  5.4933333333,  5.7333333333, 5.4933333333,
      5.7333333333,  8.2666666667,  8.6133333333,  5.3333333333, 5.5466666667,
      10.3111111111, 10.7022222222, 7.7511111111,  8.0355555556, 7.7511111111,
      8.0355555556,  2.9333333333,  3.0666666667,  5.4933333333, 5.7333333333,
      5.4933333333,  5.7333333333,  8.2666666667,  8.6133333333, 5.3333333333,
      5.5466666667,  10.3111111111, 10.7022222222, 7.7511111111, 8.0355555556,
      7.7511111111,  8.0355555556};
  const std::array<int, 4> in_shape = {{1, 7, 8, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID1x7x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.04, 0.08, 0.04, 0.08, 0.16, 0.24, 0.16, 0.24, 0.16, 0.24, 0.12, 0.16,
      0.12, 0.16, 0.,   0.,   0.04, 0.08, 0.04, 0.08, 0.16, 0.24, 0.16, 0.24,
      0.16, 0.24, 0.12, 0.16, 0.12, 0.16, 0.,   0.,   0.24, 0.32, 0.24, 0.32,
      0.64, 0.8,  0.64, 0.8,  0.64, 0.8,  0.4,  0.48, 0.4,  0.48, 0.,   0.,
      0.24, 0.32, 0.24, 0.32, 0.64, 0.8,  0.64, 0.8,  0.64, 0.8,  0.4,  0.48,
      0.4,  0.48, 0.,   0.,   0.24, 0.32, 0.24, 0.32, 0.64, 0.8,  0.64, 0.8,
      0.64, 0.8,  0.4,  0.48, 0.4,  0.48, 0.,   0.,   0.2,  0.24, 0.2,  0.24,
      0.48, 0.56, 0.48, 0.56, 0.48, 0.56, 0.28, 0.32, 0.28, 0.32, 0.,   0.,
      0.2,  0.24, 0.2,  0.24, 0.48, 0.56, 0.48, 0.56, 0.48, 0.56, 0.28, 0.32,
      0.28, 0.32, 0.,   0.,
  };
  const std::array<int, 4> in_shape = {{1, 7, 8, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME1x7x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.9333333333,
                                         1.0666666667,
                                         1.2,
                                         1.3333333333,
                                         2.1066666667,
                                         2.3466666667,
                                         2.5866666667,
                                         2.8266666667,
                                         2.1066666667,
                                         2.3466666667,
                                         2.5866666667,
                                         2.8266666667,
                                         3.7066666667,
                                         4.0533333333,
                                         4.4,
                                         4.7466666667,
                                         2.7733333333,
                                         2.9866666667,
                                         3.2,
                                         3.4133333333,
                                         6.1511111111,
                                         6.5422222222,
                                         6.9333333333,
                                         7.3244444444,
                                         4.9777777778,
                                         5.2622222222,
                                         5.5466666667,
                                         5.8311111111,
                                         4.9777777778,
                                         5.2622222222,
                                         5.5466666667,
                                         5.8311111111,
                                         0.9333333333,
                                         1.0666666667,
                                         1.2,
                                         1.3333333333,
                                         2.1066666667,
                                         2.3466666667,
                                         2.5866666667,
                                         2.8266666667,
                                         2.1066666667,
                                         2.3466666667,
                                         2.5866666667,
                                         2.8266666667,
                                         3.7066666667,
                                         4.0533333333,
                                         4.4,
                                         4.7466666667,
                                         2.7733333333,
                                         2.9866666667,
                                         3.2,
                                         3.4133333333,
                                         6.1511111111,
                                         6.5422222222,
                                         6.9333333333,
                                         7.3244444444,
                                         4.9777777778,
                                         5.2622222222,
                                         5.5466666667,
                                         5.8311111111,
                                         4.9777777778,
                                         5.2622222222,
                                         5.5466666667,
                                         5.8311111111,
                                         2.5833333333,
                                         2.7666666667,
                                         2.95,
                                         3.1333333333,
                                         5.2366666667,
                                         5.5666666667,
                                         5.8966666667,
                                         6.2266666667,
                                         5.2366666667,
                                         5.5666666667,
                                         5.8966666667,
                                         6.2266666667,
                                         8.4766666667,
                                         8.9533333333,
                                         9.43,
                                         9.9066666667,
                                         5.8933333333,
                                         6.1866666667,
                                         6.48,
                                         6.7733333333,
                                         12.2711111111,
                                         12.8088888889,
                                         13.3466666667,
                                         13.8844444444,
                                         9.6177777778,
                                         10.0088888889,
                                         10.4,
                                         10.7911111111,
                                         9.6177777778,
                                         10.0088888889,
                                         10.4,
                                         10.7911111111,
                                         2.5,
                                         2.6,
                                         2.7,
                                         2.8,
                                         4.82,
                                         5.,
                                         5.18,
                                         5.36,
                                         4.82,
                                         5.,
                                         5.18,
                                         5.36,
                                         7.46,
                                         7.72,
                                         7.98,
                                         8.24,
                                         4.96,
                                         5.12,
                                         5.28,
                                         5.44,
                                         9.8933333333,
                                         10.1866666667,
                                         10.48,
                                         10.7733333333,
                                         7.5733333333,
                                         7.7866666667,
                                         8.,
                                         8.2133333333,
                                         7.5733333333,
                                         7.7866666667,
                                         8.,
                                         8.2133333333,
                                         6.5833333333,
                                         6.7666666667,
                                         6.95,
                                         7.1333333333,
                                         12.4366666667,
                                         12.7666666667,
                                         13.0966666667,
                                         13.4266666667,
                                         12.4366666667,
                                         12.7666666667,
                                         13.0966666667,
                                         13.4266666667,
                                         18.8766666667,
                                         19.3533333333,
                                         19.83,
                                         20.3066666667,
                                         12.2933333333,
                                         12.5866666667,
                                         12.88,
                                         13.1733333333,
                                         24.0044444444,
                                         24.5422222222,
                                         25.08,
                                         25.6177777778,
                                         18.1511111111,
                                         18.5422222222,
                                         18.9333333333,
                                         19.3244444444,
                                         18.1511111111,
                                         18.5422222222,
                                         18.9333333333,
                                         19.3244444444,
                                         5.7333333333,
                                         5.8666666667,
                                         6.,
                                         6.1333333333,
                                         10.7466666667,
                                         10.9866666667,
                                         11.2266666667,
                                         11.4666666667,
                                         10.7466666667,
                                         10.9866666667,
                                         11.2266666667,
                                         11.4666666667,
                                         16.1866666667,
                                         16.5333333333,
                                         16.88,
                                         17.2266666667,
                                         10.4533333333,
                                         10.6666666667,
                                         10.88,
                                         11.0933333333,
                                         20.2311111111,
                                         20.6222222222,
                                         21.0133333333,
                                         21.4044444444,
                                         15.2177777778,
                                         15.5022222222,
                                         15.7866666667,
                                         16.0711111111,
                                         15.2177777778,
                                         15.5022222222,
                                         15.7866666667,
                                         16.0711111111,
                                         5.7333333333,
                                         5.8666666667,
                                         6.,
                                         6.1333333333,
                                         10.7466666667,
                                         10.9866666667,
                                         11.2266666667,
                                         11.4666666667,
                                         10.7466666667,
                                         10.9866666667,
                                         11.2266666667,
                                         11.4666666667,
                                         16.1866666667,
                                         16.5333333333,
                                         16.88,
                                         17.2266666667,
                                         10.4533333333,
                                         10.6666666667,
                                         10.88,
                                         11.0933333333,
                                         20.2311111111,
                                         20.6222222222,
                                         21.0133333333,
                                         21.4044444444,
                                         15.2177777778,
                                         15.5022222222,
                                         15.7866666667,
                                         16.0711111111,
                                         15.2177777778,
                                         15.5022222222,
                                         15.7866666667,
                                         16.0711111111};
  const std::array<int, 4> in_shape = {{1, 7, 8, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID1x7x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.04, 0.08, 0.12, 0.16, 0.04, 0.08, 0.12, 0.16, 0.24, 0.32, 0.4,  0.48,
      0.24, 0.32, 0.4,  0.48, 0.24, 0.32, 0.4,  0.48, 0.2,  0.24, 0.28, 0.32,
      0.2,  0.24, 0.28, 0.32, 0.,   0.,   0.,   0.,   0.04, 0.08, 0.12, 0.16,
      0.04, 0.08, 0.12, 0.16, 0.24, 0.32, 0.4,  0.48, 0.24, 0.32, 0.4,  0.48,
      0.24, 0.32, 0.4,  0.48, 0.2,  0.24, 0.28, 0.32, 0.2,  0.24, 0.28, 0.32,
      0.,   0.,   0.,   0.,   0.4,  0.48, 0.56, 0.64, 0.4,  0.48, 0.56, 0.64,
      1.12, 1.28, 1.44, 1.6,  1.12, 1.28, 1.44, 1.6,  1.12, 1.28, 1.44, 1.6,
      0.72, 0.8,  0.88, 0.96, 0.72, 0.8,  0.88, 0.96, 0.,   0.,   0.,   0.,
      0.4,  0.48, 0.56, 0.64, 0.4,  0.48, 0.56, 0.64, 1.12, 1.28, 1.44, 1.6,
      1.12, 1.28, 1.44, 1.6,  1.12, 1.28, 1.44, 1.6,  0.72, 0.8,  0.88, 0.96,
      0.72, 0.8,  0.88, 0.96, 0.,   0.,   0.,   0.,   0.4,  0.48, 0.56, 0.64,
      0.4,  0.48, 0.56, 0.64, 1.12, 1.28, 1.44, 1.6,  1.12, 1.28, 1.44, 1.6,
      1.12, 1.28, 1.44, 1.6,  0.72, 0.8,  0.88, 0.96, 0.72, 0.8,  0.88, 0.96,
      0.,   0.,   0.,   0.,   0.36, 0.4,  0.44, 0.48, 0.36, 0.4,  0.44, 0.48,
      0.88, 0.96, 1.04, 1.12, 0.88, 0.96, 1.04, 1.12, 0.88, 0.96, 1.04, 1.12,
      0.52, 0.56, 0.6,  0.64, 0.52, 0.56, 0.6,  0.64, 0.,   0.,   0.,   0.,
      0.36, 0.4,  0.44, 0.48, 0.36, 0.4,  0.44, 0.48, 0.88, 0.96, 1.04, 1.12,
      0.88, 0.96, 1.04, 1.12, 0.88, 0.96, 1.04, 1.12, 0.52, 0.56, 0.6,  0.64,
      0.52, 0.56, 0.6,  0.64, 0.,   0.,   0.,   0.,
  };
  const std::array<int, 4> in_shape = {{1, 7, 8, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME1x7x10x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.3833333333, 0.7966666667, 0.7966666667, 1.3166666667, 0.9333333333,
      1.56,         1.1466666667, 2.3688888889, 1.8488888889, 1.8488888889,
      0.3833333333, 0.7966666667, 0.7966666667, 1.3166666667, 0.9333333333,
      1.56,         1.1466666667, 2.3688888889, 1.8488888889, 1.8488888889,
      0.9333333333, 1.8266666667, 1.8266666667, 2.8666666667, 1.9333333333,
      3.12,         2.2266666667, 4.4488888889, 3.4088888889, 3.4088888889,
      0.85,         1.61,         1.61,         2.45,         1.6,
      2.52,         1.76,         3.4266666667, 2.5866666667, 2.5866666667,
      2.1833333333, 4.0766666667, 4.0766666667, 6.1166666667, 3.9333333333,
      6.12,         4.2266666667, 8.1155555556, 6.0755555556, 6.0755555556,
      1.8833333333, 3.4966666667, 3.4966666667, 5.2166666667, 3.3333333333,
      5.16,         3.5466666667, 6.7688888889, 5.0488888889, 5.0488888889,
      1.8833333333, 3.4966666667, 3.4966666667, 5.2166666667, 3.3333333333,
      5.16,         3.5466666667, 6.7688888889, 5.0488888889, 5.0488888889};
  const std::array<int, 4> in_shape = {{1, 7, 10, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID1x7x10x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.04, 0.04, 0.12, 0.12, 0.24, 0.2,  0.2,  0.12, 0.12, 0.,   0.04, 0.04,
      0.12, 0.12, 0.24, 0.2,  0.2,  0.12, 0.12, 0.,   0.2,  0.2,  0.48, 0.48,
      0.84, 0.64, 0.64, 0.36, 0.36, 0.,   0.2,  0.2,  0.48, 0.48, 0.84, 0.64,
      0.64, 0.36, 0.36, 0.,   0.2,  0.2,  0.48, 0.48, 0.84, 0.64, 0.64, 0.36,
      0.36, 0.,   0.16, 0.16, 0.36, 0.36, 0.6,  0.44, 0.44, 0.24, 0.24, 0.,
      0.16, 0.16, 0.36, 0.36, 0.6,  0.44, 0.44, 0.24, 0.24, 0.,
  };
  const std::array<int, 4> in_shape = {{1, 7, 10, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME1x7x10x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.6333333333,  0.7666666667,  1.3533333333,  1.5933333333, 1.3533333333,
      1.5933333333,  2.2866666667,  2.6333333333,  1.6533333333, 1.8666666667,
      2.8,           3.12,          2.08,          2.2933333333, 4.3466666667,
      4.7377777778,  3.4133333333,  3.6977777778,  3.4133333333, 3.6977777778,
      0.6333333333,  0.7666666667,  1.3533333333,  1.5933333333, 1.3533333333,
      1.5933333333,  2.2866666667,  2.6333333333,  1.6533333333, 1.8666666667,
      2.8,           3.12,          2.08,          2.2933333333, 4.3466666667,
      4.7377777778,  3.4133333333,  3.6977777778,  3.4133333333, 3.6977777778,
      1.6833333333,  1.8666666667,  3.3233333333,  3.6533333333, 3.3233333333,
      3.6533333333,  5.2566666667,  5.7333333333,  3.5733333333, 3.8666666667,
      5.8,           6.24,          4.16,          4.4533333333, 8.36,
      8.8977777778,  6.4266666667,  6.8177777778,  6.4266666667, 6.8177777778,
      1.6,           1.7,           3.04,          3.22,         3.04,
      3.22,          4.64,          4.9,           3.04,         3.2,
      4.8,           5.04,          3.36,          3.52,         6.56,
      6.8533333333,  4.96,          5.1733333333,  4.96,         5.1733333333,
      4.1833333333,  4.3666666667,  7.8233333333,  8.1533333333, 7.8233333333,
      8.1533333333,  11.7566666667, 12.2333333333, 7.5733333333, 7.8666666667,
      11.8,          12.24,         8.16,          8.4533333333, 15.6933333333,
      16.2311111111, 11.76,         12.1511111111, 11.76,        12.1511111111,
      3.6333333333,  3.7666666667,  6.7533333333,  6.9933333333, 6.7533333333,
      6.9933333333,  10.0866666667, 10.4333333333, 6.4533333333, 6.6666666667,
      10.,           10.32,         6.88,          7.0933333333, 13.1466666667,
      13.5377777778, 9.8133333333,  10.0977777778, 9.8133333333, 10.0977777778,
      3.6333333333,  3.7666666667,  6.7533333333,  6.9933333333, 6.7533333333,
      6.9933333333,  10.0866666667, 10.4333333333, 6.4533333333, 6.6666666667,
      10.,           10.32,         6.88,          7.0933333333, 13.1466666667,
      13.5377777778, 9.8133333333,  10.0977777778, 9.8133333333, 10.0977777778};
  const std::array<int, 4> in_shape = {{1, 7, 10, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID1x7x10x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.04, 0.08, 0.04, 0.08, 0.16, 0.24, 0.16, 0.24, 0.36, 0.48, 0.32, 0.4,
      0.32, 0.4,  0.2,  0.24, 0.2,  0.24, 0.,   0.,   0.04, 0.08, 0.04, 0.08,
      0.16, 0.24, 0.16, 0.24, 0.36, 0.48, 0.32, 0.4,  0.32, 0.4,  0.2,  0.24,
      0.2,  0.24, 0.,   0.,   0.32, 0.4,  0.32, 0.4,  0.8,  0.96, 0.8,  0.96,
      1.44, 1.68, 1.12, 1.28, 1.12, 1.28, 0.64, 0.72, 0.64, 0.72, 0.,   0.,
      0.32, 0.4,  0.32, 0.4,  0.8,  0.96, 0.8,  0.96, 1.44, 1.68, 1.12, 1.28,
      1.12, 1.28, 0.64, 0.72, 0.64, 0.72, 0.,   0.,   0.32, 0.4,  0.32, 0.4,
      0.8,  0.96, 0.8,  0.96, 1.44, 1.68, 1.12, 1.28, 1.12, 1.28, 0.64, 0.72,
      0.64, 0.72, 0.,   0.,   0.28, 0.32, 0.28, 0.32, 0.64, 0.72, 0.64, 0.72,
      1.08, 1.2,  0.8,  0.88, 0.8,  0.88, 0.44, 0.48, 0.44, 0.48, 0.,   0.,
      0.28, 0.32, 0.28, 0.32, 0.64, 0.72, 0.64, 0.72, 1.08, 1.2,  0.8,  0.88,
      0.8,  0.88, 0.44, 0.48, 0.44, 0.48, 0.,   0.,
  };
  const std::array<int, 4> in_shape = {{1, 7, 10, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME1x7x10x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      1.1333333333,  1.2666666667,  1.4,           1.5333333333,
      2.4666666667,  2.7066666667,  2.9466666667,  3.1866666667,
      2.4666666667,  2.7066666667,  2.9466666667,  3.1866666667,
      4.2266666667,  4.5733333333,  4.92,          5.2666666667,
      3.0933333333,  3.3066666667,  3.52,          3.7333333333,
      5.28,          5.6,           5.92,          6.24,
      3.9466666667,  4.16,          4.3733333333,  4.5866666667,
      8.3022222222,  8.6933333333,  9.0844444444,  9.4755555556,
      6.5422222222,  6.8266666667,  7.1111111111,  7.3955555556,
      6.5422222222,  6.8266666667,  7.1111111111,  7.3955555556,
      1.1333333333,  1.2666666667,  1.4,           1.5333333333,
      2.4666666667,  2.7066666667,  2.9466666667,  3.1866666667,
      2.4666666667,  2.7066666667,  2.9466666667,  3.1866666667,
      4.2266666667,  4.5733333333,  4.92,          5.2666666667,
      3.0933333333,  3.3066666667,  3.52,          3.7333333333,
      5.28,          5.6,           5.92,          6.24,
      3.9466666667,  4.16,          4.3733333333,  4.5866666667,
      8.3022222222,  8.6933333333,  9.0844444444,  9.4755555556,
      6.5422222222,  6.8266666667,  7.1111111111,  7.3955555556,
      6.5422222222,  6.8266666667,  7.1111111111,  7.3955555556,
      3.1833333333,  3.3666666667,  3.55,          3.7333333333,
      6.3166666667,  6.6466666667,  6.9766666667,  7.3066666667,
      6.3166666667,  6.6466666667,  6.9766666667,  7.3066666667,
      10.0366666667, 10.5133333333, 10.99,         11.4666666667,
      6.8533333333,  7.1466666667,  7.44,          7.7333333333,
      11.16,         11.6,          12.04,         12.48,
      8.0266666667,  8.32,          8.6133333333,  8.9066666667,
      16.1822222222, 16.72,         17.2577777778, 17.7955555556,
      12.4622222222, 12.8533333333, 13.2444444444, 13.6355555556,
      12.4622222222, 12.8533333333, 13.2444444444, 13.6355555556,
      3.1,           3.2,           3.3,           3.4,
      5.9,           6.08,          6.26,          6.44,
      5.9,           6.08,          6.26,          6.44,
      9.02,          9.28,          9.54,          9.8,
      5.92,          6.08,          6.24,          6.4,
      9.36,          9.6,           9.84,          10.08,
      6.56,          6.72,          6.88,          7.04,
      12.8266666667, 13.12,         13.4133333333, 13.7066666667,
      9.7066666667,  9.92,          10.1333333333, 10.3466666667,
      9.7066666667,  9.92,          10.1333333333, 10.3466666667,
      8.1833333333,  8.3666666667,  8.55,          8.7333333333,
      15.3166666667, 15.6466666667, 15.9766666667, 16.3066666667,
      15.3166666667, 15.6466666667, 15.9766666667, 16.3066666667,
      23.0366666667, 23.5133333333, 23.99,         24.4666666667,
      14.8533333333, 15.1466666667, 15.44,         15.7333333333,
      23.16,         23.6,          24.04,         24.48,
      16.0266666667, 16.32,         16.6133333333, 16.9066666667,
      30.8488888889, 31.3866666667, 31.9244444444, 32.4622222222,
      23.1288888889, 23.52,         23.9111111111, 24.3022222222,
      23.1288888889, 23.52,         23.9111111111, 24.3022222222,
      7.1333333333,  7.2666666667,  7.4,           7.5333333333,
      13.2666666667, 13.5066666667, 13.7466666667, 13.9866666667,
      13.2666666667, 13.5066666667, 13.7466666667, 13.9866666667,
      19.8266666667, 20.1733333333, 20.52,         20.8666666667,
      12.6933333333, 12.9066666667, 13.12,         13.3333333333,
      19.68,         20.,           20.32,         20.64,
      13.5466666667, 13.76,         13.9733333333, 14.1866666667,
      25.9022222222, 26.2933333333, 26.6844444444, 27.0755555556,
      19.3422222222, 19.6266666667, 19.9111111111, 20.1955555556,
      19.3422222222, 19.6266666667, 19.9111111111, 20.1955555556,
      7.1333333333,  7.2666666667,  7.4,           7.5333333333,
      13.2666666667, 13.5066666667, 13.7466666667, 13.9866666667,
      13.2666666667, 13.5066666667, 13.7466666667, 13.9866666667,
      19.8266666667, 20.1733333333, 20.52,         20.8666666667,
      12.6933333333, 12.9066666667, 13.12,         13.3333333333,
      19.68,         20.,           20.32,         20.64,
      13.5466666667, 13.76,         13.9733333333, 14.1866666667,
      25.9022222222, 26.2933333333, 26.6844444444, 27.0755555556,
      19.3422222222, 19.6266666667, 19.9111111111, 20.1955555556,
      19.3422222222, 19.6266666667, 19.9111111111, 20.1955555556};
  const std::array<int, 4> in_shape = {{1, 7, 10, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID1x7x10x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.04, 0.08, 0.12, 0.16, 0.04, 0.08, 0.12, 0.16, 0.24, 0.32, 0.4,  0.48,
      0.24, 0.32, 0.4,  0.48, 0.6,  0.72, 0.84, 0.96, 0.56, 0.64, 0.72, 0.8,
      0.56, 0.64, 0.72, 0.8,  0.36, 0.4,  0.44, 0.48, 0.36, 0.4,  0.44, 0.48,
      0.,   0.,   0.,   0.,   0.04, 0.08, 0.12, 0.16, 0.04, 0.08, 0.12, 0.16,
      0.24, 0.32, 0.4,  0.48, 0.24, 0.32, 0.4,  0.48, 0.6,  0.72, 0.84, 0.96,
      0.56, 0.64, 0.72, 0.8,  0.56, 0.64, 0.72, 0.8,  0.36, 0.4,  0.44, 0.48,
      0.36, 0.4,  0.44, 0.48, 0.,   0.,   0.,   0.,   0.56, 0.64, 0.72, 0.8,
      0.56, 0.64, 0.72, 0.8,  1.44, 1.6,  1.76, 1.92, 1.44, 1.6,  1.76, 1.92,
      2.64, 2.88, 3.12, 3.36, 2.08, 2.24, 2.4,  2.56, 2.08, 2.24, 2.4,  2.56,
      1.2,  1.28, 1.36, 1.44, 1.2,  1.28, 1.36, 1.44, 0.,   0.,   0.,   0.,
      0.56, 0.64, 0.72, 0.8,  0.56, 0.64, 0.72, 0.8,  1.44, 1.6,  1.76, 1.92,
      1.44, 1.6,  1.76, 1.92, 2.64, 2.88, 3.12, 3.36, 2.08, 2.24, 2.4,  2.56,
      2.08, 2.24, 2.4,  2.56, 1.2,  1.28, 1.36, 1.44, 1.2,  1.28, 1.36, 1.44,
      0.,   0.,   0.,   0.,   0.56, 0.64, 0.72, 0.8,  0.56, 0.64, 0.72, 0.8,
      1.44, 1.6,  1.76, 1.92, 1.44, 1.6,  1.76, 1.92, 2.64, 2.88, 3.12, 3.36,
      2.08, 2.24, 2.4,  2.56, 2.08, 2.24, 2.4,  2.56, 1.2,  1.28, 1.36, 1.44,
      1.2,  1.28, 1.36, 1.44, 0.,   0.,   0.,   0.,   0.52, 0.56, 0.6,  0.64,
      0.52, 0.56, 0.6,  0.64, 1.2,  1.28, 1.36, 1.44, 1.2,  1.28, 1.36, 1.44,
      2.04, 2.16, 2.28, 2.4,  1.52, 1.6,  1.68, 1.76, 1.52, 1.6,  1.68, 1.76,
      0.84, 0.88, 0.92, 0.96, 0.84, 0.88, 0.92, 0.96, 0.,   0.,   0.,   0.,
      0.52, 0.56, 0.6,  0.64, 0.52, 0.56, 0.6,  0.64, 1.2,  1.28, 1.36, 1.44,
      1.2,  1.28, 1.36, 1.44, 2.04, 2.16, 2.28, 2.4,  1.52, 1.6,  1.68, 1.76,
      1.52, 1.6,  1.68, 1.76, 0.84, 0.88, 0.92, 0.96, 0.84, 0.88, 0.92, 0.96,
      0.,   0.,   0.,   0.,
  };
  const std::array<int, 4> in_shape = {{1, 7, 10, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME1x8x7x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.1833333333, 0.1833333333, 0.3333333333, 0.25,         0.5833333333,
      0.4833333333, 0.4833333333, 0.7566666667, 0.7566666667, 1.1866666667,
      0.77,         1.6366666667, 1.2966666667, 1.2966666667, 0.7566666667,
      0.7566666667, 1.1866666667, 0.77,         1.6366666667, 1.2966666667,
      1.2966666667, 1.7566666667, 1.7566666667, 2.6266666667, 1.61,
      3.2766666667, 2.5366666667, 2.5366666667, 1.5733333333, 1.5733333333,
      2.2933333333, 1.36,         2.6933333333, 2.0533333333, 2.0533333333,
      3.9511111111, 3.9511111111, 5.6711111111, 3.2933333333, 6.4044444444,
      4.8311111111, 4.8311111111, 3.3777777778, 3.3777777778, 4.8177777778,
      2.7733333333, 5.3511111111, 4.0177777778, 4.0177777778, 3.3777777778,
      3.3777777778, 4.8177777778, 2.7733333333, 5.3511111111, 4.0177777778,
      4.0177777778};
  const std::array<int, 4> in_shape = {{1, 8, 7, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID1x8x7x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.04, 0.04, 0.12, 0.12, 0.12, 0.08, 0.08, 0.04, 0.04, 0.12, 0.12, 0.12,
      0.08, 0.08, 0.16, 0.16, 0.4,  0.4,  0.4,  0.24, 0.24, 0.16, 0.16, 0.4,
      0.4,  0.4,  0.24, 0.24, 0.16, 0.16, 0.4,  0.4,  0.4,  0.24, 0.24, 0.12,
      0.12, 0.28, 0.28, 0.28, 0.16, 0.16, 0.12, 0.12, 0.28, 0.28, 0.28, 0.16,
      0.16, 0.,   0.,   0.,   0.,   0.,   0.,   0.,
  };
  const std::array<int, 4> in_shape = {{1, 8, 7, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME1x8x7x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.2333333333,  0.3666666667,  0.2333333333,  0.3666666667,  0.4833333333,
      0.6666666667,  0.4,           0.5,           0.9833333333,  1.1666666667,
      0.8333333333,  0.9666666667,  0.8333333333,  0.9666666667,  1.2733333333,
      1.5133333333,  1.2733333333,  1.5133333333,  2.0433333333,  2.3733333333,
      1.36,          1.54,          2.9433333333,  3.2733333333,  2.3533333333,
      2.5933333333,  2.3533333333,  2.5933333333,  1.2733333333,  1.5133333333,
      1.2733333333,  1.5133333333,  2.0433333333,  2.3733333333,  1.36,
      1.54,          2.9433333333,  3.2733333333,  2.3533333333,  2.5933333333,
      2.3533333333,  2.5933333333,  3.1666666667,  3.5133333333,  3.1666666667,
      3.5133333333,  4.7766666667,  5.2533333333,  2.96,          3.22,
      6.0766666667,  6.5533333333,  4.7266666667,  5.0733333333,  4.7266666667,
      5.0733333333,  2.9333333333,  3.1466666667,  2.9333333333,  3.1466666667,
      4.2933333333,  4.5866666667,  2.56,          2.72,          5.0933333333,
      5.3866666667,  3.8933333333,  4.1066666667,  3.8933333333,  4.1066666667,
      7.5111111111,  7.9022222222,  7.5111111111,  7.9022222222,  10.8044444444,
      11.3422222222, 6.2933333333,  6.5866666667,  12.2711111111, 12.8088888889,
      9.2711111111,  9.6622222222,  9.2711111111,  9.6622222222,  6.4711111111,
      6.7555555556,  6.4711111111,  6.7555555556,  9.2444444444,  9.6355555556,
      5.3333333333,  5.5466666667,  10.3111111111, 10.7022222222, 7.7511111111,
      8.0355555556,  7.7511111111,  8.0355555556,  6.4711111111,  6.7555555556,
      6.4711111111,  6.7555555556,  9.2444444444,  9.6355555556,  5.3333333333,
      5.5466666667,  10.3111111111, 10.7022222222, 7.7511111111,  8.0355555556,
      7.7511111111,  8.0355555556};
  const std::array<int, 4> in_shape = {{1, 8, 7, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID1x8x7x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.04, 0.08, 0.04, 0.08, 0.16, 0.24, 0.16, 0.24, 0.16, 0.24, 0.12, 0.16,
      0.12, 0.16, 0.04, 0.08, 0.04, 0.08, 0.16, 0.24, 0.16, 0.24, 0.16, 0.24,
      0.12, 0.16, 0.12, 0.16, 0.24, 0.32, 0.24, 0.32, 0.64, 0.8,  0.64, 0.8,
      0.64, 0.8,  0.4,  0.48, 0.4,  0.48, 0.24, 0.32, 0.24, 0.32, 0.64, 0.8,
      0.64, 0.8,  0.64, 0.8,  0.4,  0.48, 0.4,  0.48, 0.24, 0.32, 0.24, 0.32,
      0.64, 0.8,  0.64, 0.8,  0.64, 0.8,  0.4,  0.48, 0.4,  0.48, 0.2,  0.24,
      0.2,  0.24, 0.48, 0.56, 0.48, 0.56, 0.48, 0.56, 0.28, 0.32, 0.28, 0.32,
      0.2,  0.24, 0.2,  0.24, 0.48, 0.56, 0.48, 0.56, 0.48, 0.56, 0.28, 0.32,
      0.28, 0.32, 0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,
  };
  const std::array<int, 4> in_shape = {{1, 8, 7, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME1x8x7x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.3333333333,
                                         0.4666666667,
                                         0.6,
                                         0.7333333333,
                                         0.3333333333,
                                         0.4666666667,
                                         0.6,
                                         0.7333333333,
                                         0.7833333333,
                                         0.9666666667,
                                         1.15,
                                         1.3333333333,
                                         0.7,
                                         0.8,
                                         0.9,
                                         1.,
                                         1.7833333333,
                                         1.9666666667,
                                         2.15,
                                         2.3333333333,
                                         1.5333333333,
                                         1.6666666667,
                                         1.8,
                                         1.9333333333,
                                         1.5333333333,
                                         1.6666666667,
                                         1.8,
                                         1.9333333333,
                                         2.3066666667,
                                         2.5466666667,
                                         2.7866666667,
                                         3.0266666667,
                                         2.3066666667,
                                         2.5466666667,
                                         2.7866666667,
                                         3.0266666667,
                                         3.7566666667,
                                         4.0866666667,
                                         4.4166666667,
                                         4.7466666667,
                                         2.54,
                                         2.72,
                                         2.9,
                                         3.08,
                                         5.5566666667,
                                         5.8866666667,
                                         6.2166666667,
                                         6.5466666667,
                                         4.4666666667,
                                         4.7066666667,
                                         4.9466666667,
                                         5.1866666667,
                                         4.4666666667,
                                         4.7066666667,
                                         4.9466666667,
                                         5.1866666667,
                                         2.3066666667,
                                         2.5466666667,
                                         2.7866666667,
                                         3.0266666667,
                                         2.3066666667,
                                         2.5466666667,
                                         2.7866666667,
                                         3.0266666667,
                                         3.7566666667,
                                         4.0866666667,
                                         4.4166666667,
                                         4.7466666667,
                                         2.54,
                                         2.72,
                                         2.9,
                                         3.08,
                                         5.5566666667,
                                         5.8866666667,
                                         6.2166666667,
                                         6.5466666667,
                                         4.4666666667,
                                         4.7066666667,
                                         4.9466666667,
                                         5.1866666667,
                                         4.4666666667,
                                         4.7066666667,
                                         4.9466666667,
                                         5.1866666667,
                                         5.9866666667,
                                         6.3333333333,
                                         6.68,
                                         7.0266666667,
                                         5.9866666667,
                                         6.3333333333,
                                         6.68,
                                         7.0266666667,
                                         9.0766666667,
                                         9.5533333333,
                                         10.03,
                                         10.5066666667,
                                         5.66,
                                         5.92,
                                         6.18,
                                         6.44,
                                         11.6766666667,
                                         12.1533333333,
                                         12.63,
                                         13.1066666667,
                                         9.1066666667,
                                         9.4533333333,
                                         9.8,
                                         10.1466666667,
                                         9.1066666667,
                                         9.4533333333,
                                         9.8,
                                         10.1466666667,
                                         5.6533333333,
                                         5.8666666667,
                                         6.08,
                                         6.2933333333,
                                         5.6533333333,
                                         5.8666666667,
                                         6.08,
                                         6.2933333333,
                                         8.2933333333,
                                         8.5866666667,
                                         8.88,
                                         9.1733333333,
                                         4.96,
                                         5.12,
                                         5.28,
                                         5.44,
                                         9.8933333333,
                                         10.1866666667,
                                         10.48,
                                         10.7733333333,
                                         7.5733333333,
                                         7.7866666667,
                                         8.,
                                         8.2133333333,
                                         7.5733333333,
                                         7.7866666667,
                                         8.,
                                         8.2133333333,
                                         14.6311111111,
                                         15.0222222222,
                                         15.4133333333,
                                         15.8044444444,
                                         14.6311111111,
                                         15.0222222222,
                                         15.4133333333,
                                         15.8044444444,
                                         21.0711111111,
                                         21.6088888889,
                                         22.1466666667,
                                         22.6844444444,
                                         12.2933333333,
                                         12.5866666667,
                                         12.88,
                                         13.1733333333,
                                         24.0044444444,
                                         24.5422222222,
                                         25.08,
                                         25.6177777778,
                                         18.1511111111,
                                         18.5422222222,
                                         18.9333333333,
                                         19.3244444444,
                                         18.1511111111,
                                         18.5422222222,
                                         18.9333333333,
                                         19.3244444444,
                                         12.6577777778,
                                         12.9422222222,
                                         13.2266666667,
                                         13.5111111111,
                                         12.6577777778,
                                         12.9422222222,
                                         13.2266666667,
                                         13.5111111111,
                                         18.0977777778,
                                         18.4888888889,
                                         18.88,
                                         19.2711111111,
                                         10.4533333333,
                                         10.6666666667,
                                         10.88,
                                         11.0933333333,
                                         20.2311111111,
                                         20.6222222222,
                                         21.0133333333,
                                         21.4044444444,
                                         15.2177777778,
                                         15.5022222222,
                                         15.7866666667,
                                         16.0711111111,
                                         15.2177777778,
                                         15.5022222222,
                                         15.7866666667,
                                         16.0711111111,
                                         12.6577777778,
                                         12.9422222222,
                                         13.2266666667,
                                         13.5111111111,
                                         12.6577777778,
                                         12.9422222222,
                                         13.2266666667,
                                         13.5111111111,
                                         18.0977777778,
                                         18.4888888889,
                                         18.88,
                                         19.2711111111,
                                         10.4533333333,
                                         10.6666666667,
                                         10.88,
                                         11.0933333333,
                                         20.2311111111,
                                         20.6222222222,
                                         21.0133333333,
                                         21.4044444444,
                                         15.2177777778,
                                         15.5022222222,
                                         15.7866666667,
                                         16.0711111111,
                                         15.2177777778,
                                         15.5022222222,
                                         15.7866666667,
                                         16.0711111111};
  const std::array<int, 4> in_shape = {{1, 8, 7, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID1x8x7x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.04, 0.08, 0.12, 0.16, 0.04, 0.08, 0.12, 0.16, 0.24, 0.32, 0.4,  0.48,
      0.24, 0.32, 0.4,  0.48, 0.24, 0.32, 0.4,  0.48, 0.2,  0.24, 0.28, 0.32,
      0.2,  0.24, 0.28, 0.32, 0.04, 0.08, 0.12, 0.16, 0.04, 0.08, 0.12, 0.16,
      0.24, 0.32, 0.4,  0.48, 0.24, 0.32, 0.4,  0.48, 0.24, 0.32, 0.4,  0.48,
      0.2,  0.24, 0.28, 0.32, 0.2,  0.24, 0.28, 0.32, 0.4,  0.48, 0.56, 0.64,
      0.4,  0.48, 0.56, 0.64, 1.12, 1.28, 1.44, 1.6,  1.12, 1.28, 1.44, 1.6,
      1.12, 1.28, 1.44, 1.6,  0.72, 0.8,  0.88, 0.96, 0.72, 0.8,  0.88, 0.96,
      0.4,  0.48, 0.56, 0.64, 0.4,  0.48, 0.56, 0.64, 1.12, 1.28, 1.44, 1.6,
      1.12, 1.28, 1.44, 1.6,  1.12, 1.28, 1.44, 1.6,  0.72, 0.8,  0.88, 0.96,
      0.72, 0.8,  0.88, 0.96, 0.4,  0.48, 0.56, 0.64, 0.4,  0.48, 0.56, 0.64,
      1.12, 1.28, 1.44, 1.6,  1.12, 1.28, 1.44, 1.6,  1.12, 1.28, 1.44, 1.6,
      0.72, 0.8,  0.88, 0.96, 0.72, 0.8,  0.88, 0.96, 0.36, 0.4,  0.44, 0.48,
      0.36, 0.4,  0.44, 0.48, 0.88, 0.96, 1.04, 1.12, 0.88, 0.96, 1.04, 1.12,
      0.88, 0.96, 1.04, 1.12, 0.52, 0.56, 0.6,  0.64, 0.52, 0.56, 0.6,  0.64,
      0.36, 0.4,  0.44, 0.48, 0.36, 0.4,  0.44, 0.48, 0.88, 0.96, 1.04, 1.12,
      0.88, 0.96, 1.04, 1.12, 0.88, 0.96, 1.04, 1.12, 0.52, 0.56, 0.6,  0.64,
      0.52, 0.56, 0.6,  0.64, 0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
  };
  const std::array<int, 4> in_shape = {{1, 8, 7, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME1x8x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.0625,       0.1625,       0.1625,       0.3125,       0.25,
      0.5833333333, 0.4833333333, 0.4833333333, 0.3125,       0.6525,
      0.6525,       1.0825,       0.77,         1.6366666667, 1.2966666667,
      1.2966666667, 0.3125,       0.6525,       0.6525,       1.0825,
      0.77,         1.6366666667, 1.2966666667, 1.2966666667, 0.7625,
      1.5025,       1.5025,       2.3725,       1.61,         3.2766666667,
      2.5366666667, 2.5366666667, 0.7,          1.34,         1.34,
      2.06,         1.36,         2.6933333333, 2.0533333333, 2.0533333333,
      1.7833333333, 3.3566666667, 3.3566666667, 5.0766666667, 3.2933333333,
      6.4044444444, 4.8311111111, 4.8311111111, 1.5333333333, 2.8666666667,
      2.8666666667, 4.3066666667, 2.7733333333, 5.3511111111, 4.0177777778,
      4.0177777778, 1.5333333333, 2.8666666667, 2.8666666667, 4.3066666667,
      2.7733333333, 5.3511111111, 4.0177777778, 4.0177777778};
  const std::array<int, 4> in_shape = {{1, 8, 8, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID1x8x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.04, 0.04, 0.12, 0.12, 0.12, 0.08, 0.08, 0.,   0.04, 0.04, 0.12,
      0.12, 0.12, 0.08, 0.08, 0.,   0.16, 0.16, 0.4,  0.4,  0.4,  0.24,
      0.24, 0.,   0.16, 0.16, 0.4,  0.4,  0.4,  0.24, 0.24, 0.,   0.16,
      0.16, 0.4,  0.4,  0.4,  0.24, 0.24, 0.,   0.12, 0.12, 0.28, 0.28,
      0.28, 0.16, 0.16, 0.,   0.12, 0.12, 0.28, 0.28, 0.28, 0.16, 0.16,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
  };
  const std::array<int, 4> in_shape = {{1, 8, 8, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME1x8x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.0625,        0.125,         0.2125,        0.325,         0.2125,
      0.325,         0.4625,        0.625,         0.4,           0.5,
      0.9833333333,  1.1666666667,  0.8333333333,  0.9666666667,  0.8333333333,
      0.9666666667,  0.5125,        0.625,         1.1025,        1.305,
      1.1025,        1.305,         1.8725,        2.165,         1.36,
      1.54,          2.9433333333,  3.2733333333,  2.3533333333,  2.5933333333,
      2.3533333333,  2.5933333333,  0.5125,        0.625,         1.1025,
      1.305,         1.1025,        1.305,         1.8725,        2.165,
      1.36,          1.54,          2.9433333333,  3.2733333333,  2.3533333333,
      2.5933333333,  2.3533333333,  2.5933333333,  1.3625,        1.525,
      2.7125,        3.005,         2.7125,        3.005,         4.3225,
      4.745,         2.96,          3.22,          6.0766666667,  6.5533333333,
      4.7266666667,  5.0733333333,  4.7266666667,  5.0733333333,  1.3,
      1.4,           2.5,           2.68,          2.5,           2.68,
      3.86,          4.12,          2.56,          2.72,          5.0933333333,
      5.3866666667,  3.8933333333,  4.1066666667,  3.8933333333,  4.1066666667,
      3.3833333333,  3.5666666667,  6.3833333333,  6.7133333333,  6.3833333333,
      6.7133333333,  9.6766666667,  10.1533333333, 6.2933333333,  6.5866666667,
      12.2711111111, 12.8088888889, 9.2711111111,  9.6622222222,  9.2711111111,
      9.6622222222,  2.9333333333,  3.0666666667,  5.4933333333,  5.7333333333,
      5.4933333333,  5.7333333333,  8.2666666667,  8.6133333333,  5.3333333333,
      5.5466666667,  10.3111111111, 10.7022222222, 7.7511111111,  8.0355555556,
      7.7511111111,  8.0355555556,  2.9333333333,  3.0666666667,  5.4933333333,
      5.7333333333,  5.4933333333,  5.7333333333,  8.2666666667,  8.6133333333,
      5.3333333333,  5.5466666667,  10.3111111111, 10.7022222222, 7.7511111111,
      8.0355555556,  7.7511111111,  8.0355555556};
  const std::array<int, 4> in_shape = {{1, 8, 8, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID1x8x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.04, 0.08, 0.04, 0.08, 0.16, 0.24, 0.16, 0.24, 0.16, 0.24, 0.12, 0.16,
      0.12, 0.16, 0.,   0.,   0.04, 0.08, 0.04, 0.08, 0.16, 0.24, 0.16, 0.24,
      0.16, 0.24, 0.12, 0.16, 0.12, 0.16, 0.,   0.,   0.24, 0.32, 0.24, 0.32,
      0.64, 0.8,  0.64, 0.8,  0.64, 0.8,  0.4,  0.48, 0.4,  0.48, 0.,   0.,
      0.24, 0.32, 0.24, 0.32, 0.64, 0.8,  0.64, 0.8,  0.64, 0.8,  0.4,  0.48,
      0.4,  0.48, 0.,   0.,   0.24, 0.32, 0.24, 0.32, 0.64, 0.8,  0.64, 0.8,
      0.64, 0.8,  0.4,  0.48, 0.4,  0.48, 0.,   0.,   0.2,  0.24, 0.2,  0.24,
      0.48, 0.56, 0.48, 0.56, 0.48, 0.56, 0.28, 0.32, 0.28, 0.32, 0.,   0.,
      0.2,  0.24, 0.2,  0.24, 0.48, 0.56, 0.48, 0.56, 0.48, 0.56, 0.28, 0.32,
      0.28, 0.32, 0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
  };
  const std::array<int, 4> in_shape = {{1, 8, 8, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME1x8x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.0625,
                                         0.125,
                                         0.1875,
                                         0.25,
                                         0.3125,
                                         0.425,
                                         0.5375,
                                         0.65,
                                         0.3125,
                                         0.425,
                                         0.5375,
                                         0.65,
                                         0.7625,
                                         0.925,
                                         1.0875,
                                         1.25,
                                         0.7,
                                         0.8,
                                         0.9,
                                         1.,
                                         1.7833333333,
                                         1.9666666667,
                                         2.15,
                                         2.3333333333,
                                         1.5333333333,
                                         1.6666666667,
                                         1.8,
                                         1.9333333333,
                                         1.5333333333,
                                         1.6666666667,
                                         1.8,
                                         1.9333333333,
                                         0.9125,
                                         1.025,
                                         1.1375,
                                         1.25,
                                         2.0025,
                                         2.205,
                                         2.4075,
                                         2.61,
                                         2.0025,
                                         2.205,
                                         2.4075,
                                         2.61,
                                         3.4525,
                                         3.745,
                                         4.0375,
                                         4.33,
                                         2.54,
                                         2.72,
                                         2.9,
                                         3.08,
                                         5.5566666667,
                                         5.8866666667,
                                         6.2166666667,
                                         6.5466666667,
                                         4.4666666667,
                                         4.7066666667,
                                         4.9466666667,
                                         5.1866666667,
                                         4.4666666667,
                                         4.7066666667,
                                         4.9466666667,
                                         5.1866666667,
                                         0.9125,
                                         1.025,
                                         1.1375,
                                         1.25,
                                         2.0025,
                                         2.205,
                                         2.4075,
                                         2.61,
                                         2.0025,
                                         2.205,
                                         2.4075,
                                         2.61,
                                         3.4525,
                                         3.745,
                                         4.0375,
                                         4.33,
                                         2.54,
                                         2.72,
                                         2.9,
                                         3.08,
                                         5.5566666667,
                                         5.8866666667,
                                         6.2166666667,
                                         6.5466666667,
                                         4.4666666667,
                                         4.7066666667,
                                         4.9466666667,
                                         5.1866666667,
                                         4.4666666667,
                                         4.7066666667,
                                         4.9466666667,
                                         5.1866666667,
                                         2.5625,
                                         2.725,
                                         2.8875,
                                         3.05,
                                         5.1325,
                                         5.425,
                                         5.7175,
                                         6.01,
                                         5.1325,
                                         5.425,
                                         5.7175,
                                         6.01,
                                         8.2225,
                                         8.645,
                                         9.0675,
                                         9.49,
                                         5.66,
                                         5.92,
                                         6.18,
                                         6.44,
                                         11.6766666667,
                                         12.1533333333,
                                         12.63,
                                         13.1066666667,
                                         9.1066666667,
                                         9.4533333333,
                                         9.8,
                                         10.1466666667,
                                         9.1066666667,
                                         9.4533333333,
                                         9.8,
                                         10.1466666667,
                                         2.5,
                                         2.6,
                                         2.7,
                                         2.8,
                                         4.82,
                                         5.,
                                         5.18,
                                         5.36,
                                         4.82,
                                         5.,
                                         5.18,
                                         5.36,
                                         7.46,
                                         7.72,
                                         7.98,
                                         8.24,
                                         4.96,
                                         5.12,
                                         5.28,
                                         5.44,
                                         9.8933333333,
                                         10.1866666667,
                                         10.48,
                                         10.7733333333,
                                         7.5733333333,
                                         7.7866666667,
                                         8.,
                                         8.2133333333,
                                         7.5733333333,
                                         7.7866666667,
                                         8.,
                                         8.2133333333,
                                         6.5833333333,
                                         6.7666666667,
                                         6.95,
                                         7.1333333333,
                                         12.4366666667,
                                         12.7666666667,
                                         13.0966666667,
                                         13.4266666667,
                                         12.4366666667,
                                         12.7666666667,
                                         13.0966666667,
                                         13.4266666667,
                                         18.8766666667,
                                         19.3533333333,
                                         19.83,
                                         20.3066666667,
                                         12.2933333333,
                                         12.5866666667,
                                         12.88,
                                         13.1733333333,
                                         24.0044444444,
                                         24.5422222222,
                                         25.08,
                                         25.6177777778,
                                         18.1511111111,
                                         18.5422222222,
                                         18.9333333333,
                                         19.3244444444,
                                         18.1511111111,
                                         18.5422222222,
                                         18.9333333333,
                                         19.3244444444,
                                         5.7333333333,
                                         5.8666666667,
                                         6.,
                                         6.1333333333,
                                         10.7466666667,
                                         10.9866666667,
                                         11.2266666667,
                                         11.4666666667,
                                         10.7466666667,
                                         10.9866666667,
                                         11.2266666667,
                                         11.4666666667,
                                         16.1866666667,
                                         16.5333333333,
                                         16.88,
                                         17.2266666667,
                                         10.4533333333,
                                         10.6666666667,
                                         10.88,
                                         11.0933333333,
                                         20.2311111111,
                                         20.6222222222,
                                         21.0133333333,
                                         21.4044444444,
                                         15.2177777778,
                                         15.5022222222,
                                         15.7866666667,
                                         16.0711111111,
                                         15.2177777778,
                                         15.5022222222,
                                         15.7866666667,
                                         16.0711111111,
                                         5.7333333333,
                                         5.8666666667,
                                         6.,
                                         6.1333333333,
                                         10.7466666667,
                                         10.9866666667,
                                         11.2266666667,
                                         11.4666666667,
                                         10.7466666667,
                                         10.9866666667,
                                         11.2266666667,
                                         11.4666666667,
                                         16.1866666667,
                                         16.5333333333,
                                         16.88,
                                         17.2266666667,
                                         10.4533333333,
                                         10.6666666667,
                                         10.88,
                                         11.0933333333,
                                         20.2311111111,
                                         20.6222222222,
                                         21.0133333333,
                                         21.4044444444,
                                         15.2177777778,
                                         15.5022222222,
                                         15.7866666667,
                                         16.0711111111,
                                         15.2177777778,
                                         15.5022222222,
                                         15.7866666667,
                                         16.0711111111};
  const std::array<int, 4> in_shape = {{1, 8, 8, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID1x8x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.04, 0.08, 0.12, 0.16, 0.04, 0.08, 0.12, 0.16, 0.24, 0.32, 0.4,  0.48,
      0.24, 0.32, 0.4,  0.48, 0.24, 0.32, 0.4,  0.48, 0.2,  0.24, 0.28, 0.32,
      0.2,  0.24, 0.28, 0.32, 0.,   0.,   0.,   0.,   0.04, 0.08, 0.12, 0.16,
      0.04, 0.08, 0.12, 0.16, 0.24, 0.32, 0.4,  0.48, 0.24, 0.32, 0.4,  0.48,
      0.24, 0.32, 0.4,  0.48, 0.2,  0.24, 0.28, 0.32, 0.2,  0.24, 0.28, 0.32,
      0.,   0.,   0.,   0.,   0.4,  0.48, 0.56, 0.64, 0.4,  0.48, 0.56, 0.64,
      1.12, 1.28, 1.44, 1.6,  1.12, 1.28, 1.44, 1.6,  1.12, 1.28, 1.44, 1.6,
      0.72, 0.8,  0.88, 0.96, 0.72, 0.8,  0.88, 0.96, 0.,   0.,   0.,   0.,
      0.4,  0.48, 0.56, 0.64, 0.4,  0.48, 0.56, 0.64, 1.12, 1.28, 1.44, 1.6,
      1.12, 1.28, 1.44, 1.6,  1.12, 1.28, 1.44, 1.6,  0.72, 0.8,  0.88, 0.96,
      0.72, 0.8,  0.88, 0.96, 0.,   0.,   0.,   0.,   0.4,  0.48, 0.56, 0.64,
      0.4,  0.48, 0.56, 0.64, 1.12, 1.28, 1.44, 1.6,  1.12, 1.28, 1.44, 1.6,
      1.12, 1.28, 1.44, 1.6,  0.72, 0.8,  0.88, 0.96, 0.72, 0.8,  0.88, 0.96,
      0.,   0.,   0.,   0.,   0.36, 0.4,  0.44, 0.48, 0.36, 0.4,  0.44, 0.48,
      0.88, 0.96, 1.04, 1.12, 0.88, 0.96, 1.04, 1.12, 0.88, 0.96, 1.04, 1.12,
      0.52, 0.56, 0.6,  0.64, 0.52, 0.56, 0.6,  0.64, 0.,   0.,   0.,   0.,
      0.36, 0.4,  0.44, 0.48, 0.36, 0.4,  0.44, 0.48, 0.88, 0.96, 1.04, 1.12,
      0.88, 0.96, 1.04, 1.12, 0.88, 0.96, 1.04, 1.12, 0.52, 0.56, 0.6,  0.64,
      0.52, 0.56, 0.6,  0.64, 0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,
  };
  const std::array<int, 4> in_shape = {{1, 8, 8, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME1x8x10x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.0625,       0.1625,       0.1625,       0.3125,       0.25,
      0.45,         0.35,         0.7666666667, 0.6166666667, 0.6166666667,
      0.3625,       0.7425,       0.7425,       1.2125,       0.85,
      1.41,         1.03,         2.1133333333, 1.6433333333, 1.6433333333,
      0.3625,       0.7425,       0.7425,       1.2125,       0.85,
      1.41,         1.03,         2.1133333333, 1.6433333333, 1.6433333333,
      0.9125,       1.7725,       1.7725,       2.7625,       1.85,
      2.97,         2.11,         4.1933333333, 3.2033333333, 3.2033333333,
      0.85,         1.61,         1.61,         2.45,         1.6,
      2.52,         1.76,         3.4266666667, 2.5866666667, 2.5866666667,
      2.1833333333, 4.0766666667, 4.0766666667, 6.1166666667, 3.9333333333,
      6.12,         4.2266666667, 8.1155555556, 6.0755555556, 6.0755555556,
      1.8833333333, 3.4966666667, 3.4966666667, 5.2166666667, 3.3333333333,
      5.16,         3.5466666667, 6.7688888889, 5.0488888889, 5.0488888889,
      1.8833333333, 3.4966666667, 3.4966666667, 5.2166666667, 3.3333333333,
      5.16,         3.5466666667, 6.7688888889, 5.0488888889, 5.0488888889};
  const std::array<int, 4> in_shape = {{1, 8, 10, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID1x8x10x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.04, 0.04, 0.12, 0.12, 0.24, 0.2,  0.2,  0.12, 0.12, 0.,   0.04, 0.04,
      0.12, 0.12, 0.24, 0.2,  0.2,  0.12, 0.12, 0.,   0.2,  0.2,  0.48, 0.48,
      0.84, 0.64, 0.64, 0.36, 0.36, 0.,   0.2,  0.2,  0.48, 0.48, 0.84, 0.64,
      0.64, 0.36, 0.36, 0.,   0.2,  0.2,  0.48, 0.48, 0.84, 0.64, 0.64, 0.36,
      0.36, 0.,   0.16, 0.16, 0.36, 0.36, 0.6,  0.44, 0.44, 0.24, 0.24, 0.,
      0.16, 0.16, 0.36, 0.36, 0.6,  0.44, 0.44, 0.24, 0.24, 0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
  };
  const std::array<int, 4> in_shape = {{1, 8, 10, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME1x8x10x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.0625,        0.125,         0.2125,        0.325,        0.2125,
      0.325,         0.4625,        0.625,         0.4,          0.5,
      0.75,          0.9,           0.6,           0.7,          1.35,
      1.5333333333,  1.1,           1.2333333333,  1.1,          1.2333333333,
      0.6125,        0.725,         1.2825,        1.485,        1.2825,
      1.485,         2.1325,        2.425,         1.52,         1.7,
      2.55,          2.82,          1.88,          2.06,         3.8966666667,
      4.2266666667,  3.0466666667,  3.2866666667,  3.0466666667, 3.2866666667,
      0.6125,        0.725,         1.2825,        1.485,        1.2825,
      1.485,         2.1325,        2.425,         1.52,         1.7,
      2.55,          2.82,          1.88,          2.06,         3.8966666667,
      4.2266666667,  3.0466666667,  3.2866666667,  3.0466666667, 3.2866666667,
      1.6625,        1.825,         3.2525,        3.545,        3.2525,
      3.545,         5.1025,        5.525,         3.44,         3.7,
      5.55,          5.94,          3.96,          4.22,         7.91,
      8.3866666667,  6.06,          6.4066666667,  6.06,         6.4066666667,
      1.6,           1.7,           3.04,          3.22,         3.04,
      3.22,          4.64,          4.9,           3.04,         3.2,
      4.8,           5.04,          3.36,          3.52,         6.56,
      6.8533333333,  4.96,          5.1733333333,  4.96,         5.1733333333,
      4.1833333333,  4.3666666667,  7.8233333333,  8.1533333333, 7.8233333333,
      8.1533333333,  11.7566666667, 12.2333333333, 7.5733333333, 7.8666666667,
      11.8,          12.24,         8.16,          8.4533333333, 15.6933333333,
      16.2311111111, 11.76,         12.1511111111, 11.76,        12.1511111111,
      3.6333333333,  3.7666666667,  6.7533333333,  6.9933333333, 6.7533333333,
      6.9933333333,  10.0866666667, 10.4333333333, 6.4533333333, 6.6666666667,
      10.,           10.32,         6.88,          7.0933333333, 13.1466666667,
      13.5377777778, 9.8133333333,  10.0977777778, 9.8133333333, 10.0977777778,
      3.6333333333,  3.7666666667,  6.7533333333,  6.9933333333, 6.7533333333,
      6.9933333333,  10.0866666667, 10.4333333333, 6.4533333333, 6.6666666667,
      10.,           10.32,         6.88,          7.0933333333, 13.1466666667,
      13.5377777778, 9.8133333333,  10.0977777778, 9.8133333333, 10.0977777778};
  const std::array<int, 4> in_shape = {{1, 8, 10, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID1x8x10x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.04, 0.08, 0.04, 0.08, 0.16, 0.24, 0.16, 0.24, 0.36, 0.48, 0.32, 0.4,
      0.32, 0.4,  0.2,  0.24, 0.2,  0.24, 0.,   0.,   0.04, 0.08, 0.04, 0.08,
      0.16, 0.24, 0.16, 0.24, 0.36, 0.48, 0.32, 0.4,  0.32, 0.4,  0.2,  0.24,
      0.2,  0.24, 0.,   0.,   0.32, 0.4,  0.32, 0.4,  0.8,  0.96, 0.8,  0.96,
      1.44, 1.68, 1.12, 1.28, 1.12, 1.28, 0.64, 0.72, 0.64, 0.72, 0.,   0.,
      0.32, 0.4,  0.32, 0.4,  0.8,  0.96, 0.8,  0.96, 1.44, 1.68, 1.12, 1.28,
      1.12, 1.28, 0.64, 0.72, 0.64, 0.72, 0.,   0.,   0.32, 0.4,  0.32, 0.4,
      0.8,  0.96, 0.8,  0.96, 1.44, 1.68, 1.12, 1.28, 1.12, 1.28, 0.64, 0.72,
      0.64, 0.72, 0.,   0.,   0.28, 0.32, 0.28, 0.32, 0.64, 0.72, 0.64, 0.72,
      1.08, 1.2,  0.8,  0.88, 0.8,  0.88, 0.44, 0.48, 0.44, 0.48, 0.,   0.,
      0.28, 0.32, 0.28, 0.32, 0.64, 0.72, 0.64, 0.72, 1.08, 1.2,  0.8,  0.88,
      0.8,  0.88, 0.44, 0.48, 0.44, 0.48, 0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,
  };
  const std::array<int, 4> in_shape = {{1, 8, 10, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME1x8x10x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.0625,        0.125,         0.1875,        0.25,
      0.3125,        0.425,         0.5375,        0.65,
      0.3125,        0.425,         0.5375,        0.65,
      0.7625,        0.925,         1.0875,        1.25,
      0.7,           0.8,           0.9,           1.,
      1.35,          1.5,           1.65,          1.8,
      1.1,           1.2,           1.3,           1.4,
      2.5166666667,  2.7,           2.8833333333,  3.0666666667,
      2.0666666667,  2.2,           2.3333333333,  2.4666666667,
      2.0666666667,  2.2,           2.3333333333,  2.4666666667,
      1.1125,        1.225,         1.3375,        1.45,
      2.3625,        2.565,         2.7675,        2.97,
      2.3625,        2.565,         2.7675,        2.97,
      3.9725,        4.265,         4.5575,        4.85,
      2.86,          3.04,          3.22,          3.4,
      4.83,          5.1,           5.37,          5.64,
      3.58,          3.76,          3.94,          4.12,
      7.4633333333,  7.7933333333,  8.1233333333,  8.4533333333,
      5.8533333333,  6.0933333333,  6.3333333333,  6.5733333333,
      5.8533333333,  6.0933333333,  6.3333333333,  6.5733333333,
      1.1125,        1.225,         1.3375,        1.45,
      2.3625,        2.565,         2.7675,        2.97,
      2.3625,        2.565,         2.7675,        2.97,
      3.9725,        4.265,         4.5575,        4.85,
      2.86,          3.04,          3.22,          3.4,
      4.83,          5.1,           5.37,          5.64,
      3.58,          3.76,          3.94,          4.12,
      7.4633333333,  7.7933333333,  8.1233333333,  8.4533333333,
      5.8533333333,  6.0933333333,  6.3333333333,  6.5733333333,
      5.8533333333,  6.0933333333,  6.3333333333,  6.5733333333,
      3.1625,        3.325,         3.4875,        3.65,
      6.2125,        6.505,         6.7975,        7.09,
      6.2125,        6.505,         6.7975,        7.09,
      9.7825,        10.205,        10.6275,       11.05,
      6.62,          6.88,          7.14,          7.4,
      10.71,         11.1,          11.49,         11.88,
      7.66,          7.92,          8.18,          8.44,
      15.3433333333, 15.82,         16.2966666667, 16.7733333333,
      11.7733333333, 12.12,         12.4666666667, 12.8133333333,
      11.7733333333, 12.12,         12.4666666667, 12.8133333333,
      3.1,           3.2,           3.3,           3.4,
      5.9,           6.08,          6.26,          6.44,
      5.9,           6.08,          6.26,          6.44,
      9.02,          9.28,          9.54,          9.8,
      5.92,          6.08,          6.24,          6.4,
      9.36,          9.6,           9.84,          10.08,
      6.56,          6.72,          6.88,          7.04,
      12.8266666667, 13.12,         13.4133333333, 13.7066666667,
      9.7066666667,  9.92,          10.1333333333, 10.3466666667,
      9.7066666667,  9.92,          10.1333333333, 10.3466666667,
      8.1833333333,  8.3666666667,  8.55,          8.7333333333,
      15.3166666667, 15.6466666667, 15.9766666667, 16.3066666667,
      15.3166666667, 15.6466666667, 15.9766666667, 16.3066666667,
      23.0366666667, 23.5133333333, 23.99,         24.4666666667,
      14.8533333333, 15.1466666667, 15.44,         15.7333333333,
      23.16,         23.6,          24.04,         24.48,
      16.0266666667, 16.32,         16.6133333333, 16.9066666667,
      30.8488888889, 31.3866666667, 31.9244444444, 32.4622222222,
      23.1288888889, 23.52,         23.9111111111, 24.3022222222,
      23.1288888889, 23.52,         23.9111111111, 24.3022222222,
      7.1333333333,  7.2666666667,  7.4,           7.5333333333,
      13.2666666667, 13.5066666667, 13.7466666667, 13.9866666667,
      13.2666666667, 13.5066666667, 13.7466666667, 13.9866666667,
      19.8266666667, 20.1733333333, 20.52,         20.8666666667,
      12.6933333333, 12.9066666667, 13.12,         13.3333333333,
      19.68,         20.,           20.32,         20.64,
      13.5466666667, 13.76,         13.9733333333, 14.1866666667,
      25.9022222222, 26.2933333333, 26.6844444444, 27.0755555556,
      19.3422222222, 19.6266666667, 19.9111111111, 20.1955555556,
      19.3422222222, 19.6266666667, 19.9111111111, 20.1955555556,
      7.1333333333,  7.2666666667,  7.4,           7.5333333333,
      13.2666666667, 13.5066666667, 13.7466666667, 13.9866666667,
      13.2666666667, 13.5066666667, 13.7466666667, 13.9866666667,
      19.8266666667, 20.1733333333, 20.52,         20.8666666667,
      12.6933333333, 12.9066666667, 13.12,         13.3333333333,
      19.68,         20.,           20.32,         20.64,
      13.5466666667, 13.76,         13.9733333333, 14.1866666667,
      25.9022222222, 26.2933333333, 26.6844444444, 27.0755555556,
      19.3422222222, 19.6266666667, 19.9111111111, 20.1955555556,
      19.3422222222, 19.6266666667, 19.9111111111, 20.1955555556};
  const std::array<int, 4> in_shape = {{1, 8, 10, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID1x8x10x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.04, 0.08, 0.12, 0.16, 0.04, 0.08, 0.12, 0.16, 0.24, 0.32, 0.4,  0.48,
      0.24, 0.32, 0.4,  0.48, 0.6,  0.72, 0.84, 0.96, 0.56, 0.64, 0.72, 0.8,
      0.56, 0.64, 0.72, 0.8,  0.36, 0.4,  0.44, 0.48, 0.36, 0.4,  0.44, 0.48,
      0.,   0.,   0.,   0.,   0.04, 0.08, 0.12, 0.16, 0.04, 0.08, 0.12, 0.16,
      0.24, 0.32, 0.4,  0.48, 0.24, 0.32, 0.4,  0.48, 0.6,  0.72, 0.84, 0.96,
      0.56, 0.64, 0.72, 0.8,  0.56, 0.64, 0.72, 0.8,  0.36, 0.4,  0.44, 0.48,
      0.36, 0.4,  0.44, 0.48, 0.,   0.,   0.,   0.,   0.56, 0.64, 0.72, 0.8,
      0.56, 0.64, 0.72, 0.8,  1.44, 1.6,  1.76, 1.92, 1.44, 1.6,  1.76, 1.92,
      2.64, 2.88, 3.12, 3.36, 2.08, 2.24, 2.4,  2.56, 2.08, 2.24, 2.4,  2.56,
      1.2,  1.28, 1.36, 1.44, 1.2,  1.28, 1.36, 1.44, 0.,   0.,   0.,   0.,
      0.56, 0.64, 0.72, 0.8,  0.56, 0.64, 0.72, 0.8,  1.44, 1.6,  1.76, 1.92,
      1.44, 1.6,  1.76, 1.92, 2.64, 2.88, 3.12, 3.36, 2.08, 2.24, 2.4,  2.56,
      2.08, 2.24, 2.4,  2.56, 1.2,  1.28, 1.36, 1.44, 1.2,  1.28, 1.36, 1.44,
      0.,   0.,   0.,   0.,   0.56, 0.64, 0.72, 0.8,  0.56, 0.64, 0.72, 0.8,
      1.44, 1.6,  1.76, 1.92, 1.44, 1.6,  1.76, 1.92, 2.64, 2.88, 3.12, 3.36,
      2.08, 2.24, 2.4,  2.56, 2.08, 2.24, 2.4,  2.56, 1.2,  1.28, 1.36, 1.44,
      1.2,  1.28, 1.36, 1.44, 0.,   0.,   0.,   0.,   0.52, 0.56, 0.6,  0.64,
      0.52, 0.56, 0.6,  0.64, 1.2,  1.28, 1.36, 1.44, 1.2,  1.28, 1.36, 1.44,
      2.04, 2.16, 2.28, 2.4,  1.52, 1.6,  1.68, 1.76, 1.52, 1.6,  1.68, 1.76,
      0.84, 0.88, 0.92, 0.96, 0.84, 0.88, 0.92, 0.96, 0.,   0.,   0.,   0.,
      0.52, 0.56, 0.6,  0.64, 0.52, 0.56, 0.6,  0.64, 1.2,  1.28, 1.36, 1.44,
      1.2,  1.28, 1.36, 1.44, 2.04, 2.16, 2.28, 2.4,  1.52, 1.6,  1.68, 1.76,
      1.52, 1.6,  1.68, 1.76, 0.84, 0.88, 0.92, 0.96, 0.84, 0.88, 0.92, 0.96,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
  };
  const std::array<int, 4> in_shape = {{1, 8, 10, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME1x10x7x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.1833333333, 0.1833333333, 0.3333333333, 0.25,         0.5833333333,
      0.4833333333, 0.4833333333, 0.7566666667, 0.7566666667, 1.1866666667,
      0.77,         1.6366666667, 1.2966666667, 1.2966666667, 0.7566666667,
      0.7566666667, 1.1866666667, 0.77,         1.6366666667, 1.2966666667,
      1.2966666667, 1.7566666667, 1.7566666667, 2.6266666667, 1.61,
      3.2766666667, 2.5366666667, 2.5366666667, 1.5733333333, 1.5733333333,
      2.2933333333, 1.36,         2.6933333333, 2.0533333333, 2.0533333333,
      3.,           3.,           4.32,         2.52,         4.92,
      3.72,         3.72,         2.4266666667, 2.4266666667, 3.4666666667,
      2.,           3.8666666667, 2.9066666667, 2.9066666667, 5.5155555556,
      5.5155555556, 7.8222222222, 4.4666666667, 8.5555555556, 6.3955555556,
      6.3955555556, 4.5155555556, 4.5155555556, 6.3822222222, 3.6266666667,
      6.9155555556, 5.1555555556, 5.1555555556, 4.5155555556, 4.5155555556,
      6.3822222222, 3.6266666667, 6.9155555556, 5.1555555556, 5.1555555556};
  const std::array<int, 4> in_shape = {{1, 10, 7, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID1x10x7x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.04, 0.04, 0.12, 0.12, 0.12, 0.08, 0.08, 0.04, 0.04, 0.12, 0.12, 0.12,
      0.08, 0.08, 0.16, 0.16, 0.4,  0.4,  0.4,  0.24, 0.24, 0.16, 0.16, 0.4,
      0.4,  0.4,  0.24, 0.24, 0.36, 0.36, 0.84, 0.84, 0.84, 0.48, 0.48, 0.32,
      0.32, 0.72, 0.72, 0.72, 0.4,  0.4,  0.32, 0.32, 0.72, 0.72, 0.72, 0.4,
      0.4,  0.2,  0.2,  0.44, 0.44, 0.44, 0.24, 0.24, 0.2,  0.2,  0.44, 0.44,
      0.44, 0.24, 0.24, 0.,   0.,   0.,   0.,   0.,   0.,   0.,
  };
  const std::array<int, 4> in_shape = {{1, 10, 7, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME1x10x7x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.2333333333,  0.3666666667,
                                         0.2333333333,  0.3666666667,
                                         0.4833333333,  0.6666666667,
                                         0.4,           0.5,
                                         0.9833333333,  1.1666666667,
                                         0.8333333333,  0.9666666667,
                                         0.8333333333,  0.9666666667,
                                         1.2733333333,  1.5133333333,
                                         1.2733333333,  1.5133333333,
                                         2.0433333333,  2.3733333333,
                                         1.36,          1.54,
                                         2.9433333333,  3.2733333333,
                                         2.3533333333,  2.5933333333,
                                         2.3533333333,  2.5933333333,
                                         1.2733333333,  1.5133333333,
                                         1.2733333333,  1.5133333333,
                                         2.0433333333,  2.3733333333,
                                         1.36,          1.54,
                                         2.9433333333,  3.2733333333,
                                         2.3533333333,  2.5933333333,
                                         2.3533333333,  2.5933333333,
                                         3.1666666667,  3.5133333333,
                                         3.1666666667,  3.5133333333,
                                         4.7766666667,  5.2533333333,
                                         2.96,          3.22,
                                         6.0766666667,  6.5533333333,
                                         4.7266666667,  5.0733333333,
                                         4.7266666667,  5.0733333333,
                                         2.9333333333,  3.1466666667,
                                         2.9333333333,  3.1466666667,
                                         4.2933333333,  4.5866666667,
                                         2.56,          2.72,
                                         5.0933333333,  5.3866666667,
                                         3.8933333333,  4.1066666667,
                                         3.8933333333,  4.1066666667,
                                         5.68,          6.,
                                         5.68,          6.,
                                         8.2,           8.64,
                                         4.8,           5.04,
                                         9.4,           9.84,
                                         7.12,          7.44,
                                         7.12,          7.44,
                                         4.64,          4.8533333333,
                                         4.64,          4.8533333333,
                                         6.64,          6.9333333333,
                                         3.84,          4.,
                                         7.44,          7.7333333333,
                                         5.6,           5.8133333333,
                                         5.6,           5.8133333333,
                                         10.64,         11.0311111111,
                                         10.64,         11.0311111111,
                                         15.1066666667, 15.6444444444,
                                         8.64,          8.9333333333,
                                         16.5733333333, 17.1111111111,
                                         12.4,          12.7911111111,
                                         12.4,          12.7911111111,
                                         8.7466666667,  9.0311111111,
                                         8.7466666667,  9.0311111111,
                                         12.3733333333, 12.7644444444,
                                         7.04,          7.2533333333,
                                         13.44,         13.8311111111,
                                         10.0266666667, 10.3111111111,
                                         10.0266666667, 10.3111111111,
                                         8.7466666667,  9.0311111111,
                                         8.7466666667,  9.0311111111,
                                         12.3733333333, 12.7644444444,
                                         7.04,          7.2533333333,
                                         13.44,         13.8311111111,
                                         10.0266666667, 10.3111111111,
                                         10.0266666667, 10.3111111111};
  const std::array<int, 4> in_shape = {{1, 10, 7, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID1x10x7x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.04, 0.08, 0.04, 0.08, 0.16, 0.24, 0.16, 0.24, 0.16, 0.24, 0.12, 0.16,
      0.12, 0.16, 0.04, 0.08, 0.04, 0.08, 0.16, 0.24, 0.16, 0.24, 0.16, 0.24,
      0.12, 0.16, 0.12, 0.16, 0.24, 0.32, 0.24, 0.32, 0.64, 0.8,  0.64, 0.8,
      0.64, 0.8,  0.4,  0.48, 0.4,  0.48, 0.24, 0.32, 0.24, 0.32, 0.64, 0.8,
      0.64, 0.8,  0.64, 0.8,  0.4,  0.48, 0.4,  0.48, 0.6,  0.72, 0.6,  0.72,
      1.44, 1.68, 1.44, 1.68, 1.44, 1.68, 0.84, 0.96, 0.84, 0.96, 0.56, 0.64,
      0.56, 0.64, 1.28, 1.44, 1.28, 1.44, 1.28, 1.44, 0.72, 0.8,  0.72, 0.8,
      0.56, 0.64, 0.56, 0.64, 1.28, 1.44, 1.28, 1.44, 1.28, 1.44, 0.72, 0.8,
      0.72, 0.8,  0.36, 0.4,  0.36, 0.4,  0.8,  0.88, 0.8,  0.88, 0.8,  0.88,
      0.44, 0.48, 0.44, 0.48, 0.36, 0.4,  0.36, 0.4,  0.8,  0.88, 0.8,  0.88,
      0.8,  0.88, 0.44, 0.48, 0.44, 0.48, 0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
  };
  const std::array<int, 4> in_shape = {{1, 10, 7, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME1x10x7x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.3333333333,
                                         0.4666666667,
                                         0.6,
                                         0.7333333333,
                                         0.3333333333,
                                         0.4666666667,
                                         0.6,
                                         0.7333333333,
                                         0.7833333333,
                                         0.9666666667,
                                         1.15,
                                         1.3333333333,
                                         0.7,
                                         0.8,
                                         0.9,
                                         1.,
                                         1.7833333333,
                                         1.9666666667,
                                         2.15,
                                         2.3333333333,
                                         1.5333333333,
                                         1.6666666667,
                                         1.8,
                                         1.9333333333,
                                         1.5333333333,
                                         1.6666666667,
                                         1.8,
                                         1.9333333333,
                                         2.3066666667,
                                         2.5466666667,
                                         2.7866666667,
                                         3.0266666667,
                                         2.3066666667,
                                         2.5466666667,
                                         2.7866666667,
                                         3.0266666667,
                                         3.7566666667,
                                         4.0866666667,
                                         4.4166666667,
                                         4.7466666667,
                                         2.54,
                                         2.72,
                                         2.9,
                                         3.08,
                                         5.5566666667,
                                         5.8866666667,
                                         6.2166666667,
                                         6.5466666667,
                                         4.4666666667,
                                         4.7066666667,
                                         4.9466666667,
                                         5.1866666667,
                                         4.4666666667,
                                         4.7066666667,
                                         4.9466666667,
                                         5.1866666667,
                                         2.3066666667,
                                         2.5466666667,
                                         2.7866666667,
                                         3.0266666667,
                                         2.3066666667,
                                         2.5466666667,
                                         2.7866666667,
                                         3.0266666667,
                                         3.7566666667,
                                         4.0866666667,
                                         4.4166666667,
                                         4.7466666667,
                                         2.54,
                                         2.72,
                                         2.9,
                                         3.08,
                                         5.5566666667,
                                         5.8866666667,
                                         6.2166666667,
                                         6.5466666667,
                                         4.4666666667,
                                         4.7066666667,
                                         4.9466666667,
                                         5.1866666667,
                                         4.4666666667,
                                         4.7066666667,
                                         4.9466666667,
                                         5.1866666667,
                                         5.9866666667,
                                         6.3333333333,
                                         6.68,
                                         7.0266666667,
                                         5.9866666667,
                                         6.3333333333,
                                         6.68,
                                         7.0266666667,
                                         9.0766666667,
                                         9.5533333333,
                                         10.03,
                                         10.5066666667,
                                         5.66,
                                         5.92,
                                         6.18,
                                         6.44,
                                         11.6766666667,
                                         12.1533333333,
                                         12.63,
                                         13.1066666667,
                                         9.1066666667,
                                         9.4533333333,
                                         9.8,
                                         10.1466666667,
                                         9.1066666667,
                                         9.4533333333,
                                         9.8,
                                         10.1466666667,
                                         5.6533333333,
                                         5.8666666667,
                                         6.08,
                                         6.2933333333,
                                         5.6533333333,
                                         5.8666666667,
                                         6.08,
                                         6.2933333333,
                                         8.2933333333,
                                         8.5866666667,
                                         8.88,
                                         9.1733333333,
                                         4.96,
                                         5.12,
                                         5.28,
                                         5.44,
                                         9.8933333333,
                                         10.1866666667,
                                         10.48,
                                         10.7733333333,
                                         7.5733333333,
                                         7.7866666667,
                                         8.,
                                         8.2133333333,
                                         7.5733333333,
                                         7.7866666667,
                                         8.,
                                         8.2133333333,
                                         11.04,
                                         11.36,
                                         11.68,
                                         12.,
                                         11.04,
                                         11.36,
                                         11.68,
                                         12.,
                                         15.96,
                                         16.4,
                                         16.84,
                                         17.28,
                                         9.36,
                                         9.6,
                                         9.84,
                                         10.08,
                                         18.36,
                                         18.8,
                                         19.24,
                                         19.68,
                                         13.92,
                                         14.24,
                                         14.56,
                                         14.88,
                                         13.92,
                                         14.24,
                                         14.56,
                                         14.88,
                                         9.0666666667,
                                         9.28,
                                         9.4933333333,
                                         9.7066666667,
                                         9.0666666667,
                                         9.28,
                                         9.4933333333,
                                         9.7066666667,
                                         12.9866666667,
                                         13.28,
                                         13.5733333333,
                                         13.8666666667,
                                         7.52,
                                         7.68,
                                         7.84,
                                         8.,
                                         14.5866666667,
                                         14.88,
                                         15.1733333333,
                                         15.4666666667,
                                         10.9866666667,
                                         11.2,
                                         11.4133333333,
                                         11.6266666667,
                                         10.9866666667,
                                         11.2,
                                         11.4133333333,
                                         11.6266666667,
                                         20.8888888889,
                                         21.28,
                                         21.6711111111,
                                         22.0622222222,
                                         20.8888888889,
                                         21.28,
                                         21.6711111111,
                                         22.0622222222,
                                         29.6755555556,
                                         30.2133333333,
                                         30.7511111111,
                                         31.2888888889,
                                         16.9866666667,
                                         17.28,
                                         17.5733333333,
                                         17.8666666667,
                                         32.6088888889,
                                         33.1466666667,
                                         33.6844444444,
                                         34.2222222222,
                                         24.4088888889,
                                         24.8,
                                         25.1911111111,
                                         25.5822222222,
                                         24.4088888889,
                                         24.8,
                                         25.1911111111,
                                         25.5822222222,
                                         17.2088888889,
                                         17.4933333333,
                                         17.7777777778,
                                         18.0622222222,
                                         17.2088888889,
                                         17.4933333333,
                                         17.7777777778,
                                         18.0622222222,
                                         24.3555555556,
                                         24.7466666667,
                                         25.1377777778,
                                         25.5288888889,
                                         13.8666666667,
                                         14.08,
                                         14.2933333333,
                                         14.5066666667,
                                         26.4888888889,
                                         26.88,
                                         27.2711111111,
                                         27.6622222222,
                                         19.7688888889,
                                         20.0533333333,
                                         20.3377777778,
                                         20.6222222222,
                                         19.7688888889,
                                         20.0533333333,
                                         20.3377777778,
                                         20.6222222222,
                                         17.2088888889,
                                         17.4933333333,
                                         17.7777777778,
                                         18.0622222222,
                                         17.2088888889,
                                         17.4933333333,
                                         17.7777777778,
                                         18.0622222222,
                                         24.3555555556,
                                         24.7466666667,
                                         25.1377777778,
                                         25.5288888889,
                                         13.8666666667,
                                         14.08,
                                         14.2933333333,
                                         14.5066666667,
                                         26.4888888889,
                                         26.88,
                                         27.2711111111,
                                         27.6622222222,
                                         19.7688888889,
                                         20.0533333333,
                                         20.3377777778,
                                         20.6222222222,
                                         19.7688888889,
                                         20.0533333333,
                                         20.3377777778,
                                         20.6222222222};
  const std::array<int, 4> in_shape = {{1, 10, 7, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID1x10x7x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.04, 0.08, 0.12, 0.16, 0.04, 0.08, 0.12, 0.16, 0.24, 0.32, 0.4,  0.48,
      0.24, 0.32, 0.4,  0.48, 0.24, 0.32, 0.4,  0.48, 0.2,  0.24, 0.28, 0.32,
      0.2,  0.24, 0.28, 0.32, 0.04, 0.08, 0.12, 0.16, 0.04, 0.08, 0.12, 0.16,
      0.24, 0.32, 0.4,  0.48, 0.24, 0.32, 0.4,  0.48, 0.24, 0.32, 0.4,  0.48,
      0.2,  0.24, 0.28, 0.32, 0.2,  0.24, 0.28, 0.32, 0.4,  0.48, 0.56, 0.64,
      0.4,  0.48, 0.56, 0.64, 1.12, 1.28, 1.44, 1.6,  1.12, 1.28, 1.44, 1.6,
      1.12, 1.28, 1.44, 1.6,  0.72, 0.8,  0.88, 0.96, 0.72, 0.8,  0.88, 0.96,
      0.4,  0.48, 0.56, 0.64, 0.4,  0.48, 0.56, 0.64, 1.12, 1.28, 1.44, 1.6,
      1.12, 1.28, 1.44, 1.6,  1.12, 1.28, 1.44, 1.6,  0.72, 0.8,  0.88, 0.96,
      0.72, 0.8,  0.88, 0.96, 1.08, 1.2,  1.32, 1.44, 1.08, 1.2,  1.32, 1.44,
      2.64, 2.88, 3.12, 3.36, 2.64, 2.88, 3.12, 3.36, 2.64, 2.88, 3.12, 3.36,
      1.56, 1.68, 1.8,  1.92, 1.56, 1.68, 1.8,  1.92, 1.04, 1.12, 1.2,  1.28,
      1.04, 1.12, 1.2,  1.28, 2.4,  2.56, 2.72, 2.88, 2.4,  2.56, 2.72, 2.88,
      2.4,  2.56, 2.72, 2.88, 1.36, 1.44, 1.52, 1.6,  1.36, 1.44, 1.52, 1.6,
      1.04, 1.12, 1.2,  1.28, 1.04, 1.12, 1.2,  1.28, 2.4,  2.56, 2.72, 2.88,
      2.4,  2.56, 2.72, 2.88, 2.4,  2.56, 2.72, 2.88, 1.36, 1.44, 1.52, 1.6,
      1.36, 1.44, 1.52, 1.6,  0.68, 0.72, 0.76, 0.8,  0.68, 0.72, 0.76, 0.8,
      1.52, 1.6,  1.68, 1.76, 1.52, 1.6,  1.68, 1.76, 1.52, 1.6,  1.68, 1.76,
      0.84, 0.88, 0.92, 0.96, 0.84, 0.88, 0.92, 0.96, 0.68, 0.72, 0.76, 0.8,
      0.68, 0.72, 0.76, 0.8,  1.52, 1.6,  1.68, 1.76, 1.52, 1.6,  1.68, 1.76,
      1.52, 1.6,  1.68, 1.76, 0.84, 0.88, 0.92, 0.96, 0.84, 0.88, 0.92, 0.96,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,
  };
  const std::array<int, 4> in_shape = {{1, 10, 7, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME1x10x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.0625,       0.1625,       0.1625,       0.3125,       0.25,
      0.5833333333, 0.4833333333, 0.4833333333, 0.3125,       0.6525,
      0.6525,       1.0825,       0.77,         1.6366666667, 1.2966666667,
      1.2966666667, 0.3125,       0.6525,       0.6525,       1.0825,
      0.77,         1.6366666667, 1.2966666667, 1.2966666667, 0.7625,
      1.5025,       1.5025,       2.3725,       1.61,         3.2766666667,
      2.5366666667, 2.5366666667, 0.7,          1.34,         1.34,
      2.06,         1.36,         2.6933333333, 2.0533333333, 2.0533333333,
      1.35,         2.55,         2.55,         3.87,         2.52,
      4.92,         3.72,         3.72,         1.1,          2.06,
      2.06,         3.1,          2.,           3.8666666667, 2.9066666667,
      2.9066666667, 2.5166666667, 4.6766666667, 4.6766666667, 6.9833333333,
      4.4666666667, 8.5555555556, 6.3955555556, 6.3955555556, 2.0666666667,
      3.8266666667, 3.8266666667, 5.6933333333, 3.6266666667, 6.9155555556,
      5.1555555556, 5.1555555556, 2.0666666667, 3.8266666667, 3.8266666667,
      5.6933333333, 3.6266666667, 6.9155555556, 5.1555555556, 5.1555555556};
  const std::array<int, 4> in_shape = {{1, 10, 8, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID1x10x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.04, 0.04, 0.12, 0.12, 0.12, 0.08, 0.08, 0.,   0.04, 0.04, 0.12, 0.12,
      0.12, 0.08, 0.08, 0.,   0.16, 0.16, 0.4,  0.4,  0.4,  0.24, 0.24, 0.,
      0.16, 0.16, 0.4,  0.4,  0.4,  0.24, 0.24, 0.,   0.36, 0.36, 0.84, 0.84,
      0.84, 0.48, 0.48, 0.,   0.32, 0.32, 0.72, 0.72, 0.72, 0.4,  0.4,  0.,
      0.32, 0.32, 0.72, 0.72, 0.72, 0.4,  0.4,  0.,   0.2,  0.2,  0.44, 0.44,
      0.44, 0.24, 0.24, 0.,   0.2,  0.2,  0.44, 0.44, 0.44, 0.24, 0.24, 0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
  };
  const std::array<int, 4> in_shape = {{1, 10, 8, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME1x10x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.0625,
                                         0.125,
                                         0.2125,
                                         0.325,
                                         0.2125,
                                         0.325,
                                         0.4625,
                                         0.625,
                                         0.4,
                                         0.5,
                                         0.9833333333,
                                         1.1666666667,
                                         0.8333333333,
                                         0.9666666667,
                                         0.8333333333,
                                         0.9666666667,
                                         0.5125,
                                         0.625,
                                         1.1025,
                                         1.305,
                                         1.1025,
                                         1.305,
                                         1.8725,
                                         2.165,
                                         1.36,
                                         1.54,
                                         2.9433333333,
                                         3.2733333333,
                                         2.3533333333,
                                         2.5933333333,
                                         2.3533333333,
                                         2.5933333333,
                                         0.5125,
                                         0.625,
                                         1.1025,
                                         1.305,
                                         1.1025,
                                         1.305,
                                         1.8725,
                                         2.165,
                                         1.36,
                                         1.54,
                                         2.9433333333,
                                         3.2733333333,
                                         2.3533333333,
                                         2.5933333333,
                                         2.3533333333,
                                         2.5933333333,
                                         1.3625,
                                         1.525,
                                         2.7125,
                                         3.005,
                                         2.7125,
                                         3.005,
                                         4.3225,
                                         4.745,
                                         2.96,
                                         3.22,
                                         6.0766666667,
                                         6.5533333333,
                                         4.7266666667,
                                         5.0733333333,
                                         4.7266666667,
                                         5.0733333333,
                                         1.3,
                                         1.4,
                                         2.5,
                                         2.68,
                                         2.5,
                                         2.68,
                                         3.86,
                                         4.12,
                                         2.56,
                                         2.72,
                                         5.0933333333,
                                         5.3866666667,
                                         3.8933333333,
                                         4.1066666667,
                                         3.8933333333,
                                         4.1066666667,
                                         2.55,
                                         2.7,
                                         4.83,
                                         5.1,
                                         4.83,
                                         5.1,
                                         7.35,
                                         7.74,
                                         4.8,
                                         5.04,
                                         9.4,
                                         9.84,
                                         7.12,
                                         7.44,
                                         7.12,
                                         7.44,
                                         2.1,
                                         2.2,
                                         3.94,
                                         4.12,
                                         3.94,
                                         4.12,
                                         5.94,
                                         6.2,
                                         3.84,
                                         4.,
                                         7.44,
                                         7.7333333333,
                                         5.6,
                                         5.8133333333,
                                         5.6,
                                         5.8133333333,
                                         4.85,
                                         5.0333333333,
                                         9.0233333333,
                                         9.3533333333,
                                         9.0233333333,
                                         9.3533333333,
                                         13.49,
                                         13.9666666667,
                                         8.64,
                                         8.9333333333,
                                         16.5733333333,
                                         17.1111111111,
                                         12.4,
                                         12.7911111111,
                                         12.4,
                                         12.7911111111,
                                         4.,
                                         4.1333333333,
                                         7.4133333333,
                                         7.6533333333,
                                         7.4133333333,
                                         7.6533333333,
                                         11.04,
                                         11.3866666667,
                                         7.04,
                                         7.2533333333,
                                         13.44,
                                         13.8311111111,
                                         10.0266666667,
                                         10.3111111111,
                                         10.0266666667,
                                         10.3111111111,
                                         4.,
                                         4.1333333333,
                                         7.4133333333,
                                         7.6533333333,
                                         7.4133333333,
                                         7.6533333333,
                                         11.04,
                                         11.3866666667,
                                         7.04,
                                         7.2533333333,
                                         13.44,
                                         13.8311111111,
                                         10.0266666667,
                                         10.3111111111,
                                         10.0266666667,
                                         10.3111111111};
  const std::array<int, 4> in_shape = {{1, 10, 8, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID1x10x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.04, 0.08, 0.04, 0.08, 0.16, 0.24, 0.16, 0.24, 0.16, 0.24, 0.12, 0.16,
      0.12, 0.16, 0.,   0.,   0.04, 0.08, 0.04, 0.08, 0.16, 0.24, 0.16, 0.24,
      0.16, 0.24, 0.12, 0.16, 0.12, 0.16, 0.,   0.,   0.24, 0.32, 0.24, 0.32,
      0.64, 0.8,  0.64, 0.8,  0.64, 0.8,  0.4,  0.48, 0.4,  0.48, 0.,   0.,
      0.24, 0.32, 0.24, 0.32, 0.64, 0.8,  0.64, 0.8,  0.64, 0.8,  0.4,  0.48,
      0.4,  0.48, 0.,   0.,   0.6,  0.72, 0.6,  0.72, 1.44, 1.68, 1.44, 1.68,
      1.44, 1.68, 0.84, 0.96, 0.84, 0.96, 0.,   0.,   0.56, 0.64, 0.56, 0.64,
      1.28, 1.44, 1.28, 1.44, 1.28, 1.44, 0.72, 0.8,  0.72, 0.8,  0.,   0.,
      0.56, 0.64, 0.56, 0.64, 1.28, 1.44, 1.28, 1.44, 1.28, 1.44, 0.72, 0.8,
      0.72, 0.8,  0.,   0.,   0.36, 0.4,  0.36, 0.4,  0.8,  0.88, 0.8,  0.88,
      0.8,  0.88, 0.44, 0.48, 0.44, 0.48, 0.,   0.,   0.36, 0.4,  0.36, 0.4,
      0.8,  0.88, 0.8,  0.88, 0.8,  0.88, 0.44, 0.48, 0.44, 0.48, 0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,
  };
  const std::array<int, 4> in_shape = {{1, 10, 8, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME1x10x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.0625,
                                         0.125,
                                         0.1875,
                                         0.25,
                                         0.3125,
                                         0.425,
                                         0.5375,
                                         0.65,
                                         0.3125,
                                         0.425,
                                         0.5375,
                                         0.65,
                                         0.7625,
                                         0.925,
                                         1.0875,
                                         1.25,
                                         0.7,
                                         0.8,
                                         0.9,
                                         1.,
                                         1.7833333333,
                                         1.9666666667,
                                         2.15,
                                         2.3333333333,
                                         1.5333333333,
                                         1.6666666667,
                                         1.8,
                                         1.9333333333,
                                         1.5333333333,
                                         1.6666666667,
                                         1.8,
                                         1.9333333333,
                                         0.9125,
                                         1.025,
                                         1.1375,
                                         1.25,
                                         2.0025,
                                         2.205,
                                         2.4075,
                                         2.61,
                                         2.0025,
                                         2.205,
                                         2.4075,
                                         2.61,
                                         3.4525,
                                         3.745,
                                         4.0375,
                                         4.33,
                                         2.54,
                                         2.72,
                                         2.9,
                                         3.08,
                                         5.5566666667,
                                         5.8866666667,
                                         6.2166666667,
                                         6.5466666667,
                                         4.4666666667,
                                         4.7066666667,
                                         4.9466666667,
                                         5.1866666667,
                                         4.4666666667,
                                         4.7066666667,
                                         4.9466666667,
                                         5.1866666667,
                                         0.9125,
                                         1.025,
                                         1.1375,
                                         1.25,
                                         2.0025,
                                         2.205,
                                         2.4075,
                                         2.61,
                                         2.0025,
                                         2.205,
                                         2.4075,
                                         2.61,
                                         3.4525,
                                         3.745,
                                         4.0375,
                                         4.33,
                                         2.54,
                                         2.72,
                                         2.9,
                                         3.08,
                                         5.5566666667,
                                         5.8866666667,
                                         6.2166666667,
                                         6.5466666667,
                                         4.4666666667,
                                         4.7066666667,
                                         4.9466666667,
                                         5.1866666667,
                                         4.4666666667,
                                         4.7066666667,
                                         4.9466666667,
                                         5.1866666667,
                                         2.5625,
                                         2.725,
                                         2.8875,
                                         3.05,
                                         5.1325,
                                         5.425,
                                         5.7175,
                                         6.01,
                                         5.1325,
                                         5.425,
                                         5.7175,
                                         6.01,
                                         8.2225,
                                         8.645,
                                         9.0675,
                                         9.49,
                                         5.66,
                                         5.92,
                                         6.18,
                                         6.44,
                                         11.6766666667,
                                         12.1533333333,
                                         12.63,
                                         13.1066666667,
                                         9.1066666667,
                                         9.4533333333,
                                         9.8,
                                         10.1466666667,
                                         9.1066666667,
                                         9.4533333333,
                                         9.8,
                                         10.1466666667,
                                         2.5,
                                         2.6,
                                         2.7,
                                         2.8,
                                         4.82,
                                         5.,
                                         5.18,
                                         5.36,
                                         4.82,
                                         5.,
                                         5.18,
                                         5.36,
                                         7.46,
                                         7.72,
                                         7.98,
                                         8.24,
                                         4.96,
                                         5.12,
                                         5.28,
                                         5.44,
                                         9.8933333333,
                                         10.1866666667,
                                         10.48,
                                         10.7733333333,
                                         7.5733333333,
                                         7.7866666667,
                                         8.,
                                         8.2133333333,
                                         7.5733333333,
                                         7.7866666667,
                                         8.,
                                         8.2133333333,
                                         4.95,
                                         5.1,
                                         5.25,
                                         5.4,
                                         9.39,
                                         9.66,
                                         9.93,
                                         10.2,
                                         9.39,
                                         9.66,
                                         9.93,
                                         10.2,
                                         14.31,
                                         14.7,
                                         15.09,
                                         15.48,
                                         9.36,
                                         9.6,
                                         9.84,
                                         10.08,
                                         18.36,
                                         18.8,
                                         19.24,
                                         19.68,
                                         13.92,
                                         14.24,
                                         14.56,
                                         14.88,
                                         13.92,
                                         14.24,
                                         14.56,
                                         14.88,
                                         4.1,
                                         4.2,
                                         4.3,
                                         4.4,
                                         7.7,
                                         7.88,
                                         8.06,
                                         8.24,
                                         7.7,
                                         7.88,
                                         8.06,
                                         8.24,
                                         11.62,
                                         11.88,
                                         12.14,
                                         12.4,
                                         7.52,
                                         7.68,
                                         7.84,
                                         8.,
                                         14.5866666667,
                                         14.88,
                                         15.1733333333,
                                         15.4666666667,
                                         10.9866666667,
                                         11.2,
                                         11.4133333333,
                                         11.6266666667,
                                         10.9866666667,
                                         11.2,
                                         11.4133333333,
                                         11.6266666667,
                                         9.5166666667,
                                         9.7,
                                         9.8833333333,
                                         10.0666666667,
                                         17.7166666667,
                                         18.0466666667,
                                         18.3766666667,
                                         18.7066666667,
                                         17.7166666667,
                                         18.0466666667,
                                         18.3766666667,
                                         18.7066666667,
                                         26.5033333333,
                                         26.98,
                                         27.4566666667,
                                         27.9333333333,
                                         16.9866666667,
                                         17.28,
                                         17.5733333333,
                                         17.8666666667,
                                         32.6088888889,
                                         33.1466666667,
                                         33.6844444444,
                                         34.2222222222,
                                         24.4088888889,
                                         24.8,
                                         25.1911111111,
                                         25.5822222222,
                                         24.4088888889,
                                         24.8,
                                         25.1911111111,
                                         25.5822222222,
                                         7.8666666667,
                                         8.,
                                         8.1333333333,
                                         8.2666666667,
                                         14.5866666667,
                                         14.8266666667,
                                         15.0666666667,
                                         15.3066666667,
                                         14.5866666667,
                                         14.8266666667,
                                         15.0666666667,
                                         15.3066666667,
                                         21.7333333333,
                                         22.08,
                                         22.4266666667,
                                         22.7733333333,
                                         13.8666666667,
                                         14.08,
                                         14.2933333333,
                                         14.5066666667,
                                         26.4888888889,
                                         26.88,
                                         27.2711111111,
                                         27.6622222222,
                                         19.7688888889,
                                         20.0533333333,
                                         20.3377777778,
                                         20.6222222222,
                                         19.7688888889,
                                         20.0533333333,
                                         20.3377777778,
                                         20.6222222222,
                                         7.8666666667,
                                         8.,
                                         8.1333333333,
                                         8.2666666667,
                                         14.5866666667,
                                         14.8266666667,
                                         15.0666666667,
                                         15.3066666667,
                                         14.5866666667,
                                         14.8266666667,
                                         15.0666666667,
                                         15.3066666667,
                                         21.7333333333,
                                         22.08,
                                         22.4266666667,
                                         22.7733333333,
                                         13.8666666667,
                                         14.08,
                                         14.2933333333,
                                         14.5066666667,
                                         26.4888888889,
                                         26.88,
                                         27.2711111111,
                                         27.6622222222,
                                         19.7688888889,
                                         20.0533333333,
                                         20.3377777778,
                                         20.6222222222,
                                         19.7688888889,
                                         20.0533333333,
                                         20.3377777778,
                                         20.6222222222};
  const std::array<int, 4> in_shape = {{1, 10, 8, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID1x10x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.04, 0.08, 0.12, 0.16, 0.04, 0.08, 0.12, 0.16, 0.24, 0.32, 0.4,  0.48,
      0.24, 0.32, 0.4,  0.48, 0.24, 0.32, 0.4,  0.48, 0.2,  0.24, 0.28, 0.32,
      0.2,  0.24, 0.28, 0.32, 0.,   0.,   0.,   0.,   0.04, 0.08, 0.12, 0.16,
      0.04, 0.08, 0.12, 0.16, 0.24, 0.32, 0.4,  0.48, 0.24, 0.32, 0.4,  0.48,
      0.24, 0.32, 0.4,  0.48, 0.2,  0.24, 0.28, 0.32, 0.2,  0.24, 0.28, 0.32,
      0.,   0.,   0.,   0.,   0.4,  0.48, 0.56, 0.64, 0.4,  0.48, 0.56, 0.64,
      1.12, 1.28, 1.44, 1.6,  1.12, 1.28, 1.44, 1.6,  1.12, 1.28, 1.44, 1.6,
      0.72, 0.8,  0.88, 0.96, 0.72, 0.8,  0.88, 0.96, 0.,   0.,   0.,   0.,
      0.4,  0.48, 0.56, 0.64, 0.4,  0.48, 0.56, 0.64, 1.12, 1.28, 1.44, 1.6,
      1.12, 1.28, 1.44, 1.6,  1.12, 1.28, 1.44, 1.6,  0.72, 0.8,  0.88, 0.96,
      0.72, 0.8,  0.88, 0.96, 0.,   0.,   0.,   0.,   1.08, 1.2,  1.32, 1.44,
      1.08, 1.2,  1.32, 1.44, 2.64, 2.88, 3.12, 3.36, 2.64, 2.88, 3.12, 3.36,
      2.64, 2.88, 3.12, 3.36, 1.56, 1.68, 1.8,  1.92, 1.56, 1.68, 1.8,  1.92,
      0.,   0.,   0.,   0.,   1.04, 1.12, 1.2,  1.28, 1.04, 1.12, 1.2,  1.28,
      2.4,  2.56, 2.72, 2.88, 2.4,  2.56, 2.72, 2.88, 2.4,  2.56, 2.72, 2.88,
      1.36, 1.44, 1.52, 1.6,  1.36, 1.44, 1.52, 1.6,  0.,   0.,   0.,   0.,
      1.04, 1.12, 1.2,  1.28, 1.04, 1.12, 1.2,  1.28, 2.4,  2.56, 2.72, 2.88,
      2.4,  2.56, 2.72, 2.88, 2.4,  2.56, 2.72, 2.88, 1.36, 1.44, 1.52, 1.6,
      1.36, 1.44, 1.52, 1.6,  0.,   0.,   0.,   0.,   0.68, 0.72, 0.76, 0.8,
      0.68, 0.72, 0.76, 0.8,  1.52, 1.6,  1.68, 1.76, 1.52, 1.6,  1.68, 1.76,
      1.52, 1.6,  1.68, 1.76, 0.84, 0.88, 0.92, 0.96, 0.84, 0.88, 0.92, 0.96,
      0.,   0.,   0.,   0.,   0.68, 0.72, 0.76, 0.8,  0.68, 0.72, 0.76, 0.8,
      1.52, 1.6,  1.68, 1.76, 1.52, 1.6,  1.68, 1.76, 1.52, 1.6,  1.68, 1.76,
      0.84, 0.88, 0.92, 0.96, 0.84, 0.88, 0.92, 0.96, 0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
  };
  const std::array<int, 4> in_shape = {{1, 10, 8, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME1x10x10x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.0625, 0.1625,       0.1625,        0.3125,       0.25,
      0.45,   0.35,         0.7666666667,  0.6166666667, 0.6166666667,
      0.3625, 0.7425,       0.7425,        1.2125,       0.85,
      1.41,   1.03,         2.1133333333,  1.6433333333, 1.6433333333,
      0.3625, 0.7425,       0.7425,        1.2125,       0.85,
      1.41,   1.03,         2.1133333333,  1.6433333333, 1.6433333333,
      0.9125, 1.7725,       1.7725,        2.7625,       1.85,
      2.97,   2.11,         4.1933333333,  3.2033333333, 3.2033333333,
      0.85,   1.61,         1.61,          2.45,         1.6,
      2.52,   1.76,         3.4266666667,  2.5866666667, 2.5866666667,
      1.65,   3.09,         3.09,          4.65,         3.,
      4.68,   3.24,         6.24,          4.68,         4.68,
      1.35,   2.51,         2.51,          3.75,         2.4,
      3.72,   2.56,         4.8933333333,  3.6533333333, 3.6533333333,
      3.1,    5.7266666667, 5.7266666667,  8.5,          5.4,
      8.32,   5.6933333333, 10.8044444444, 8.0311111111, 8.0311111111,
      2.55,   4.6966666667, 4.6966666667,  6.95,         4.4,
      6.76,   4.6133333333, 8.7244444444,  6.4711111111, 6.4711111111,
      2.55,   4.6966666667, 4.6966666667,  6.95,         4.4,
      6.76,   4.6133333333, 8.7244444444,  6.4711111111, 6.4711111111};
  const std::array<int, 4> in_shape = {{1, 10, 10, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID1x10x10x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.04, 0.04, 0.12, 0.12, 0.24, 0.2,  0.2,  0.12, 0.12, 0.,   0.04, 0.04,
      0.12, 0.12, 0.24, 0.2,  0.2,  0.12, 0.12, 0.,   0.2,  0.2,  0.48, 0.48,
      0.84, 0.64, 0.64, 0.36, 0.36, 0.,   0.2,  0.2,  0.48, 0.48, 0.84, 0.64,
      0.64, 0.36, 0.36, 0.,   0.48, 0.48, 1.08, 1.08, 1.8,  1.32, 1.32, 0.72,
      0.72, 0.,   0.44, 0.44, 0.96, 0.96, 1.56, 1.12, 1.12, 0.6,  0.6,  0.,
      0.44, 0.44, 0.96, 0.96, 1.56, 1.12, 1.12, 0.6,  0.6,  0.,   0.28, 0.28,
      0.6,  0.6,  0.96, 0.68, 0.68, 0.36, 0.36, 0.,   0.28, 0.28, 0.6,  0.6,
      0.96, 0.68, 0.68, 0.36, 0.36, 0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,
  };
  const std::array<int, 4> in_shape = {{1, 10, 10, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME1x10x10x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.0625,
                                         0.125,
                                         0.2125,
                                         0.325,
                                         0.2125,
                                         0.325,
                                         0.4625,
                                         0.625,
                                         0.4,
                                         0.5,
                                         0.75,
                                         0.9,
                                         0.6,
                                         0.7,
                                         1.35,
                                         1.5333333333,
                                         1.1,
                                         1.2333333333,
                                         1.1,
                                         1.2333333333,
                                         0.6125,
                                         0.725,
                                         1.2825,
                                         1.485,
                                         1.2825,
                                         1.485,
                                         2.1325,
                                         2.425,
                                         1.52,
                                         1.7,
                                         2.55,
                                         2.82,
                                         1.88,
                                         2.06,
                                         3.8966666667,
                                         4.2266666667,
                                         3.0466666667,
                                         3.2866666667,
                                         3.0466666667,
                                         3.2866666667,
                                         0.6125,
                                         0.725,
                                         1.2825,
                                         1.485,
                                         1.2825,
                                         1.485,
                                         2.1325,
                                         2.425,
                                         1.52,
                                         1.7,
                                         2.55,
                                         2.82,
                                         1.88,
                                         2.06,
                                         3.8966666667,
                                         4.2266666667,
                                         3.0466666667,
                                         3.2866666667,
                                         3.0466666667,
                                         3.2866666667,
                                         1.6625,
                                         1.825,
                                         3.2525,
                                         3.545,
                                         3.2525,
                                         3.545,
                                         5.1025,
                                         5.525,
                                         3.44,
                                         3.7,
                                         5.55,
                                         5.94,
                                         3.96,
                                         4.22,
                                         7.91,
                                         8.3866666667,
                                         6.06,
                                         6.4066666667,
                                         6.06,
                                         6.4066666667,
                                         1.6,
                                         1.7,
                                         3.04,
                                         3.22,
                                         3.04,
                                         3.22,
                                         4.64,
                                         4.9,
                                         3.04,
                                         3.2,
                                         4.8,
                                         5.04,
                                         3.36,
                                         3.52,
                                         6.56,
                                         6.8533333333,
                                         4.96,
                                         5.1733333333,
                                         4.96,
                                         5.1733333333,
                                         3.15,
                                         3.3,
                                         5.91,
                                         6.18,
                                         5.91,
                                         6.18,
                                         8.91,
                                         9.3,
                                         5.76,
                                         6.,
                                         9.,
                                         9.36,
                                         6.24,
                                         6.48,
                                         12.04,
                                         12.48,
                                         9.04,
                                         9.36,
                                         9.04,
                                         9.36,
                                         2.6,
                                         2.7,
                                         4.84,
                                         5.02,
                                         4.84,
                                         5.02,
                                         7.24,
                                         7.5,
                                         4.64,
                                         4.8,
                                         7.2,
                                         7.44,
                                         4.96,
                                         5.12,
                                         9.4933333333,
                                         9.7866666667,
                                         7.0933333333,
                                         7.3066666667,
                                         7.0933333333,
                                         7.3066666667,
                                         6.0166666667,
                                         6.2,
                                         11.1233333333,
                                         11.4533333333,
                                         11.1233333333,
                                         11.4533333333,
                                         16.5233333333,
                                         17.,
                                         10.5066666667,
                                         10.8,
                                         16.2,
                                         16.64,
                                         11.0933333333,
                                         11.3866666667,
                                         21.0711111111,
                                         21.6088888889,
                                         15.6711111111,
                                         16.0622222222,
                                         15.6711111111,
                                         16.0622222222,
                                         4.9666666667,
                                         5.1,
                                         9.1533333333,
                                         9.3933333333,
                                         9.1533333333,
                                         9.3933333333,
                                         13.5533333333,
                                         13.9,
                                         8.5866666667,
                                         8.8,
                                         13.2,
                                         13.52,
                                         9.0133333333,
                                         9.2266666667,
                                         17.0577777778,
                                         17.4488888889,
                                         12.6577777778,
                                         12.9422222222,
                                         12.6577777778,
                                         12.9422222222,
                                         4.9666666667,
                                         5.1,
                                         9.1533333333,
                                         9.3933333333,
                                         9.1533333333,
                                         9.3933333333,
                                         13.5533333333,
                                         13.9,
                                         8.5866666667,
                                         8.8,
                                         13.2,
                                         13.52,
                                         9.0133333333,
                                         9.2266666667,
                                         17.0577777778,
                                         17.4488888889,
                                         12.6577777778,
                                         12.9422222222,
                                         12.6577777778,
                                         12.9422222222};
  const std::array<int, 4> in_shape = {{1, 10, 10, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID1x10x10x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.04, 0.08, 0.04, 0.08, 0.16, 0.24, 0.16, 0.24, 0.36, 0.48, 0.32, 0.4,
      0.32, 0.4,  0.2,  0.24, 0.2,  0.24, 0.,   0.,   0.04, 0.08, 0.04, 0.08,
      0.16, 0.24, 0.16, 0.24, 0.36, 0.48, 0.32, 0.4,  0.32, 0.4,  0.2,  0.24,
      0.2,  0.24, 0.,   0.,   0.32, 0.4,  0.32, 0.4,  0.8,  0.96, 0.8,  0.96,
      1.44, 1.68, 1.12, 1.28, 1.12, 1.28, 0.64, 0.72, 0.64, 0.72, 0.,   0.,
      0.32, 0.4,  0.32, 0.4,  0.8,  0.96, 0.8,  0.96, 1.44, 1.68, 1.12, 1.28,
      1.12, 1.28, 0.64, 0.72, 0.64, 0.72, 0.,   0.,   0.84, 0.96, 0.84, 0.96,
      1.92, 2.16, 1.92, 2.16, 3.24, 3.6,  2.4,  2.64, 2.4,  2.64, 1.32, 1.44,
      1.32, 1.44, 0.,   0.,   0.8,  0.88, 0.8,  0.88, 1.76, 1.92, 1.76, 1.92,
      2.88, 3.12, 2.08, 2.24, 2.08, 2.24, 1.12, 1.2,  1.12, 1.2,  0.,   0.,
      0.8,  0.88, 0.8,  0.88, 1.76, 1.92, 1.76, 1.92, 2.88, 3.12, 2.08, 2.24,
      2.08, 2.24, 1.12, 1.2,  1.12, 1.2,  0.,   0.,   0.52, 0.56, 0.52, 0.56,
      1.12, 1.2,  1.12, 1.2,  1.8,  1.92, 1.28, 1.36, 1.28, 1.36, 0.68, 0.72,
      0.68, 0.72, 0.,   0.,   0.52, 0.56, 0.52, 0.56, 1.12, 1.2,  1.12, 1.2,
      1.8,  1.92, 1.28, 1.36, 1.28, 1.36, 0.68, 0.72, 0.68, 0.72, 0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
  };
  const std::array<int, 4> in_shape = {{1, 10, 10, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME1x10x10x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.0625,        0.125,         0.1875,        0.25,
      0.3125,        0.425,         0.5375,        0.65,
      0.3125,        0.425,         0.5375,        0.65,
      0.7625,        0.925,         1.0875,        1.25,
      0.7,           0.8,           0.9,           1.,
      1.35,          1.5,           1.65,          1.8,
      1.1,           1.2,           1.3,           1.4,
      2.5166666667,  2.7,           2.8833333333,  3.0666666667,
      2.0666666667,  2.2,           2.3333333333,  2.4666666667,
      2.0666666667,  2.2,           2.3333333333,  2.4666666667,
      1.1125,        1.225,         1.3375,        1.45,
      2.3625,        2.565,         2.7675,        2.97,
      2.3625,        2.565,         2.7675,        2.97,
      3.9725,        4.265,         4.5575,        4.85,
      2.86,          3.04,          3.22,          3.4,
      4.83,          5.1,           5.37,          5.64,
      3.58,          3.76,          3.94,          4.12,
      7.4633333333,  7.7933333333,  8.1233333333,  8.4533333333,
      5.8533333333,  6.0933333333,  6.3333333333,  6.5733333333,
      5.8533333333,  6.0933333333,  6.3333333333,  6.5733333333,
      1.1125,        1.225,         1.3375,        1.45,
      2.3625,        2.565,         2.7675,        2.97,
      2.3625,        2.565,         2.7675,        2.97,
      3.9725,        4.265,         4.5575,        4.85,
      2.86,          3.04,          3.22,          3.4,
      4.83,          5.1,           5.37,          5.64,
      3.58,          3.76,          3.94,          4.12,
      7.4633333333,  7.7933333333,  8.1233333333,  8.4533333333,
      5.8533333333,  6.0933333333,  6.3333333333,  6.5733333333,
      5.8533333333,  6.0933333333,  6.3333333333,  6.5733333333,
      3.1625,        3.325,         3.4875,        3.65,
      6.2125,        6.505,         6.7975,        7.09,
      6.2125,        6.505,         6.7975,        7.09,
      9.7825,        10.205,        10.6275,       11.05,
      6.62,          6.88,          7.14,          7.4,
      10.71,         11.1,          11.49,         11.88,
      7.66,          7.92,          8.18,          8.44,
      15.3433333333, 15.82,         16.2966666667, 16.7733333333,
      11.7733333333, 12.12,         12.4666666667, 12.8133333333,
      11.7733333333, 12.12,         12.4666666667, 12.8133333333,
      3.1,           3.2,           3.3,           3.4,
      5.9,           6.08,          6.26,          6.44,
      5.9,           6.08,          6.26,          6.44,
      9.02,          9.28,          9.54,          9.8,
      5.92,          6.08,          6.24,          6.4,
      9.36,          9.6,           9.84,          10.08,
      6.56,          6.72,          6.88,          7.04,
      12.8266666667, 13.12,         13.4133333333, 13.7066666667,
      9.7066666667,  9.92,          10.1333333333, 10.3466666667,
      9.7066666667,  9.92,          10.1333333333, 10.3466666667,
      6.15,          6.3,           6.45,          6.6,
      11.55,         11.82,         12.09,         12.36,
      11.55,         11.82,         12.09,         12.36,
      17.43,         17.82,         18.21,         18.6,
      11.28,         11.52,         11.76,         12.,
      17.64,         18.,           18.36,         18.72,
      12.24,         12.48,         12.72,         12.96,
      23.64,         24.08,         24.52,         24.96,
      17.76,         18.08,         18.4,          18.72,
      17.76,         18.08,         18.4,          18.72,
      5.1,           5.2,           5.3,           5.4,
      9.5,           9.68,          9.86,          10.04,
      9.5,           9.68,          9.86,          10.04,
      14.22,         14.48,         14.74,         15.,
      9.12,          9.28,          9.44,          9.6,
      14.16,         14.4,          14.64,         14.88,
      9.76,          9.92,          10.08,         10.24,
      18.6933333333, 18.9866666667, 19.28,         19.5733333333,
      13.9733333333, 14.1866666667, 14.4,          14.6133333333,
      13.9733333333, 14.1866666667, 14.4,          14.6133333333,
      11.85,         12.0333333333, 12.2166666667, 12.4,
      21.9166666667, 22.2466666667, 22.5766666667, 22.9066666667,
      21.9166666667, 22.2466666667, 22.5766666667, 22.9066666667,
      32.57,         33.0466666667, 33.5233333333, 34.,
      20.72,         21.0133333333, 21.3066666667, 21.6,
      31.96,         32.4,          32.84,         33.28,
      21.8933333333, 22.1866666667, 22.48,         22.7733333333,
      41.6044444444, 42.1422222222, 42.68,         43.2177777778,
      30.9511111111, 31.3422222222, 31.7333333333, 32.1244444444,
      30.9511111111, 31.3422222222, 31.7333333333, 32.1244444444,
      9.8,           9.9333333333,  10.0666666667, 10.2,
      18.0666666667, 18.3066666667, 18.5466666667, 18.7866666667,
      18.0666666667, 18.3066666667, 18.5466666667, 18.7866666667,
      26.76,         27.1066666667, 27.4533333333, 27.8,
      16.96,         17.1733333333, 17.3866666667, 17.6,
      26.08,         26.4,          26.72,         27.04,
      17.8133333333, 18.0266666667, 18.24,         18.4533333333,
      33.7244444444, 34.1155555556, 34.5066666667, 34.8977777778,
      25.0311111111, 25.3155555556, 25.6,          25.8844444444,
      25.0311111111, 25.3155555556, 25.6,          25.8844444444,
      9.8,           9.9333333333,  10.0666666667, 10.2,
      18.0666666667, 18.3066666667, 18.5466666667, 18.7866666667,
      18.0666666667, 18.3066666667, 18.5466666667, 18.7866666667,
      26.76,         27.1066666667, 27.4533333333, 27.8,
      16.96,         17.1733333333, 17.3866666667, 17.6,
      26.08,         26.4,          26.72,         27.04,
      17.8133333333, 18.0266666667, 18.24,         18.4533333333,
      33.7244444444, 34.1155555556, 34.5066666667, 34.8977777778,
      25.0311111111, 25.3155555556, 25.6,          25.8844444444,
      25.0311111111, 25.3155555556, 25.6,          25.8844444444};
  const std::array<int, 4> in_shape = {{1, 10, 10, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID1x10x10x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.04, 0.08, 0.12, 0.16, 0.04, 0.08, 0.12, 0.16, 0.24, 0.32, 0.4,  0.48,
      0.24, 0.32, 0.4,  0.48, 0.6,  0.72, 0.84, 0.96, 0.56, 0.64, 0.72, 0.8,
      0.56, 0.64, 0.72, 0.8,  0.36, 0.4,  0.44, 0.48, 0.36, 0.4,  0.44, 0.48,
      0.,   0.,   0.,   0.,   0.04, 0.08, 0.12, 0.16, 0.04, 0.08, 0.12, 0.16,
      0.24, 0.32, 0.4,  0.48, 0.24, 0.32, 0.4,  0.48, 0.6,  0.72, 0.84, 0.96,
      0.56, 0.64, 0.72, 0.8,  0.56, 0.64, 0.72, 0.8,  0.36, 0.4,  0.44, 0.48,
      0.36, 0.4,  0.44, 0.48, 0.,   0.,   0.,   0.,   0.56, 0.64, 0.72, 0.8,
      0.56, 0.64, 0.72, 0.8,  1.44, 1.6,  1.76, 1.92, 1.44, 1.6,  1.76, 1.92,
      2.64, 2.88, 3.12, 3.36, 2.08, 2.24, 2.4,  2.56, 2.08, 2.24, 2.4,  2.56,
      1.2,  1.28, 1.36, 1.44, 1.2,  1.28, 1.36, 1.44, 0.,   0.,   0.,   0.,
      0.56, 0.64, 0.72, 0.8,  0.56, 0.64, 0.72, 0.8,  1.44, 1.6,  1.76, 1.92,
      1.44, 1.6,  1.76, 1.92, 2.64, 2.88, 3.12, 3.36, 2.08, 2.24, 2.4,  2.56,
      2.08, 2.24, 2.4,  2.56, 1.2,  1.28, 1.36, 1.44, 1.2,  1.28, 1.36, 1.44,
      0.,   0.,   0.,   0.,   1.56, 1.68, 1.8,  1.92, 1.56, 1.68, 1.8,  1.92,
      3.6,  3.84, 4.08, 4.32, 3.6,  3.84, 4.08, 4.32, 6.12, 6.48, 6.84, 7.2,
      4.56, 4.8,  5.04, 5.28, 4.56, 4.8,  5.04, 5.28, 2.52, 2.64, 2.76, 2.88,
      2.52, 2.64, 2.76, 2.88, 0.,   0.,   0.,   0.,   1.52, 1.6,  1.68, 1.76,
      1.52, 1.6,  1.68, 1.76, 3.36, 3.52, 3.68, 3.84, 3.36, 3.52, 3.68, 3.84,
      5.52, 5.76, 6.,   6.24, 4.,   4.16, 4.32, 4.48, 4.,   4.16, 4.32, 4.48,
      2.16, 2.24, 2.32, 2.4,  2.16, 2.24, 2.32, 2.4,  0.,   0.,   0.,   0.,
      1.52, 1.6,  1.68, 1.76, 1.52, 1.6,  1.68, 1.76, 3.36, 3.52, 3.68, 3.84,
      3.36, 3.52, 3.68, 3.84, 5.52, 5.76, 6.,   6.24, 4.,   4.16, 4.32, 4.48,
      4.,   4.16, 4.32, 4.48, 2.16, 2.24, 2.32, 2.4,  2.16, 2.24, 2.32, 2.4,
      0.,   0.,   0.,   0.,   1.,   1.04, 1.08, 1.12, 1.,   1.04, 1.08, 1.12,
      2.16, 2.24, 2.32, 2.4,  2.16, 2.24, 2.32, 2.4,  3.48, 3.6,  3.72, 3.84,
      2.48, 2.56, 2.64, 2.72, 2.48, 2.56, 2.64, 2.72, 1.32, 1.36, 1.4,  1.44,
      1.32, 1.36, 1.4,  1.44, 0.,   0.,   0.,   0.,   1.,   1.04, 1.08, 1.12,
      1.,   1.04, 1.08, 1.12, 2.16, 2.24, 2.32, 2.4,  2.16, 2.24, 2.32, 2.4,
      3.48, 3.6,  3.72, 3.84, 2.48, 2.56, 2.64, 2.72, 2.48, 2.56, 2.64, 2.72,
      1.32, 1.36, 1.4,  1.44, 1.32, 1.36, 1.4,  1.44, 0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,
  };
  const std::array<int, 4> in_shape = {{1, 10, 10, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME3x7x7x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.8177777778,  0.8177777778,  1.2977777778,  0.8533333333,  1.8311111111,
      1.4577777778,  1.4577777778,  0.8177777778,  0.8177777778,  1.2977777778,
      0.8533333333,  1.8311111111,  1.4577777778,  1.4577777778,  1.8177777778,
      1.8177777778,  2.7377777778,  1.6933333333,  3.4711111111,  2.6977777778,
      2.6977777778,  1.5733333333,  1.5733333333,  2.2933333333,  1.36,
      2.6933333333,  2.0533333333,  2.0533333333,  3.9511111111,  3.9511111111,
      5.6711111111,  3.2933333333,  6.4044444444,  4.8311111111,  4.8311111111,
      3.3777777778,  3.3777777778,  4.8177777778,  2.7733333333,  5.3511111111,
      4.0177777778,  4.0177777778,  3.3777777778,  3.3777777778,  4.8177777778,
      2.7733333333,  5.3511111111,  4.0177777778,  4.0177777778,  5.3688888889,
      5.3688888889,  7.5555555556,  4.2666666667,  8.0888888889,  6.0088888889,
      6.0088888889,  5.3688888889,  5.3688888889,  7.5555555556,  4.2666666667,
      8.0888888889,  6.0088888889,  6.0088888889,  8.0755555556,  8.0755555556,
      11.3422222222, 6.3866666667,  12.0755555556, 8.9555555556,  8.9555555556,
      4.9866666667,  4.9866666667,  6.9866666667,  3.92,          7.3866666667,
      5.4666666667,  5.4666666667,  10.2088888889, 10.2088888889, 14.2755555556,
      7.9866666667,  15.0088888889, 11.0888888889, 11.0888888889, 7.9288888889,
      7.9288888889,  11.0755555556, 6.1866666667,  11.6088888889, 8.5688888889,
      8.5688888889,  7.9288888889,  7.9288888889,  11.0755555556, 6.1866666667,
      11.6088888889, 8.5688888889,  8.5688888889,  9.92,          9.92,
      13.8133333333, 7.68,          14.3466666667, 10.56,         10.56,
      9.92,          9.92,          13.8133333333, 7.68,          14.3466666667,
      10.56,         10.56,         14.3333333333, 14.3333333333, 19.9466666667,
      11.08,         20.68,         15.2133333333, 15.2133333333, 8.4,
      8.4,           11.68,         6.48,          12.08,         8.88,
      8.88,          16.4666666667, 16.4666666667, 22.88,         12.68,
      23.6133333333, 17.3466666667, 17.3466666667, 12.48,         12.48,
      17.3333333333, 9.6,           17.8666666667, 13.12,         13.12,
      12.48,         12.48,         17.3333333333, 9.6,           17.8666666667,
      13.12,         13.12,
  };
  const std::array<int, 4> in_shape = {{3, 7, 7, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID3x7x7x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.04, 0.04, 0.12, 0.12, 0.12, 0.08, 0.08, 0.04, 0.04, 0.12, 0.12, 0.12,
      0.08, 0.08, 0.16, 0.16, 0.4,  0.4,  0.4,  0.24, 0.24, 0.16, 0.16, 0.4,
      0.4,  0.4,  0.24, 0.24, 0.16, 0.16, 0.4,  0.4,  0.4,  0.24, 0.24, 0.12,
      0.12, 0.28, 0.28, 0.28, 0.16, 0.16, 0.12, 0.12, 0.28, 0.28, 0.28, 0.16,
      0.16, 0.2,  0.2,  0.44, 0.44, 0.44, 0.24, 0.24, 0.2,  0.2,  0.44, 0.44,
      0.44, 0.24, 0.24, 0.48, 0.48, 1.04, 1.04, 1.04, 0.56, 0.56, 0.48, 0.48,
      1.04, 1.04, 1.04, 0.56, 0.56, 0.48, 0.48, 1.04, 1.04, 1.04, 0.56, 0.56,
      0.28, 0.28, 0.6,  0.6,  0.6,  0.32, 0.32, 0.28, 0.28, 0.6,  0.6,  0.6,
      0.32, 0.32, 0.36, 0.36, 0.76, 0.76, 0.76, 0.4,  0.4,  0.36, 0.36, 0.76,
      0.76, 0.76, 0.4,  0.4,  0.8,  0.8,  1.68, 1.68, 1.68, 0.88, 0.88, 0.8,
      0.8,  1.68, 1.68, 1.68, 0.88, 0.88, 0.8,  0.8,  1.68, 1.68, 1.68, 0.88,
      0.88, 0.44, 0.44, 0.92, 0.92, 0.92, 0.48, 0.48, 0.44, 0.44, 0.92, 0.92,
      0.92, 0.48, 0.48};
  const std::array<int, 4> in_shape = {{3, 7, 7, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME3x7x7x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      1.3511111111,  1.6355555556,  1.3511111111,  1.6355555556,  2.2044444444,
      2.5955555556,  1.4933333333,  1.7066666667,  3.2711111111,  3.6622222222,
      2.6311111111,  2.9155555556,  2.6311111111,  2.9155555556,  1.3511111111,
      1.6355555556,  1.3511111111,  1.6355555556,  2.2044444444,  2.5955555556,
      1.4933333333,  1.7066666667,  3.2711111111,  3.6622222222,  2.6311111111,
      2.9155555556,  2.6311111111,  2.9155555556,  3.2444444444,  3.6355555556,
      3.2444444444,  3.6355555556,  4.9377777778,  5.4755555556,  3.0933333333,
      3.3866666667,  6.4044444444,  6.9422222222,  5.0044444444,  5.3955555556,
      5.0044444444,  5.3955555556,  2.9333333333,  3.1466666667,  2.9333333333,
      3.1466666667,  4.2933333333,  4.5866666667,  2.56,          2.72,
      5.0933333333,  5.3866666667,  3.8933333333,  4.1066666667,  3.8933333333,
      4.1066666667,  7.5111111111,  7.9022222222,  7.5111111111,  7.9022222222,
      10.8044444444, 11.3422222222, 6.2933333333,  6.5866666667,  12.2711111111,
      12.8088888889, 9.2711111111,  9.6622222222,  9.2711111111,  9.6622222222,
      6.4711111111,  6.7555555556,  6.4711111111,  6.7555555556,  9.2444444444,
      9.6355555556,  5.3333333333,  5.5466666667,  10.3111111111, 10.7022222222,
      7.7511111111,  8.0355555556,  7.7511111111,  8.0355555556,  6.4711111111,
      6.7555555556,  6.4711111111,  6.7555555556,  9.2444444444,  9.6355555556,
      5.3333333333,  5.5466666667,  10.3111111111, 10.7022222222, 7.7511111111,
      8.0355555556,  7.7511111111,  8.0355555556,  10.4533333333, 10.7377777778,
      10.4533333333, 10.7377777778, 14.72,         15.1111111111, 8.32,
      8.5333333333,  15.7866666667, 16.1777777778, 11.7333333333, 12.0177777778,
      11.7333333333, 12.0177777778, 10.4533333333, 10.7377777778, 10.4533333333,
      10.7377777778, 14.72,         15.1111111111, 8.32,          8.5333333333,
      15.7866666667, 16.1777777778, 11.7333333333, 12.0177777778, 11.7333333333,
      12.0177777778, 15.76,         16.1511111111, 15.76,         16.1511111111,
      22.1466666667, 22.6844444444, 12.48,         12.7733333333, 23.6133333333,
      24.1511111111, 17.52,         17.9111111111, 17.52,         17.9111111111,
      9.76,          9.9733333333,  9.76,          9.9733333333,  13.68,
      13.9733333333, 7.68,          7.84,          14.48,         14.7733333333,
      10.72,         10.9333333333, 10.72,         10.9333333333, 20.0266666667,
      20.4177777778, 20.0266666667, 20.4177777778, 28.0133333333, 28.5511111111,
      15.68,         15.9733333333, 29.48,         30.0177777778, 21.7866666667,
      22.1777777778, 21.7866666667, 22.1777777778, 15.5733333333, 15.8577777778,
      15.5733333333, 15.8577777778, 21.76,         22.1511111111, 12.16,
      12.3733333333, 22.8266666667, 23.2177777778, 16.8533333333, 17.1377777778,
      16.8533333333, 17.1377777778, 15.5733333333, 15.8577777778, 15.5733333333,
      15.8577777778, 21.76,         22.1511111111, 12.16,         12.3733333333,
      22.8266666667, 23.2177777778, 16.8533333333, 17.1377777778, 16.8533333333,
      17.1377777778, 19.5555555556, 19.84,         19.5555555556, 19.84,
      27.2355555556, 27.6266666667, 15.1466666667, 15.36,         28.3022222222,
      28.6933333333, 20.8355555556, 21.12,         20.8355555556, 21.12,
      19.5555555556, 19.84,         19.5555555556, 19.84,         27.2355555556,
      27.6266666667, 15.1466666667, 15.36,         28.3022222222, 28.6933333333,
      20.8355555556, 21.12,         20.8355555556, 21.12,         28.2755555556,
      28.6666666667, 28.2755555556, 28.6666666667, 39.3555555556, 39.8933333333,
      21.8666666667, 22.16,         40.8222222222, 41.36,         30.0355555556,
      30.4266666667, 30.0355555556, 30.4266666667, 16.5866666667, 16.8,
      16.5866666667, 16.8,          23.0666666667, 23.36,         12.8,
      12.96,         23.8666666667, 24.16,         17.5466666667, 17.76,
      17.5466666667, 17.76,         32.5422222222, 32.9333333333, 32.5422222222,
      32.9333333333, 45.2222222222, 45.76,         25.0666666667, 25.36,
      46.6888888889, 47.2266666667, 34.3022222222, 34.6933333333, 34.3022222222,
      34.6933333333, 24.6755555556, 24.96,         24.6755555556, 24.96,
      34.2755555556, 34.6666666667, 18.9866666667, 19.2,          35.3422222222,
      35.7333333333, 25.9555555556, 26.24,         25.9555555556, 26.24,
      24.6755555556, 24.96,         24.6755555556, 24.96,         34.2755555556,
      34.6666666667, 18.9866666667, 19.2,          35.3422222222, 35.7333333333,
      25.9555555556, 26.24,         25.9555555556, 26.24,
  };
  const std::array<int, 4> in_shape = {{3, 7, 7, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID3x7x7x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.04, 0.08, 0.04, 0.08, 0.16, 0.24, 0.16, 0.24, 0.16, 0.24, 0.12, 0.16,
      0.12, 0.16, 0.04, 0.08, 0.04, 0.08, 0.16, 0.24, 0.16, 0.24, 0.16, 0.24,
      0.12, 0.16, 0.12, 0.16, 0.24, 0.32, 0.24, 0.32, 0.64, 0.8,  0.64, 0.8,
      0.64, 0.8,  0.4,  0.48, 0.4,  0.48, 0.24, 0.32, 0.24, 0.32, 0.64, 0.8,
      0.64, 0.8,  0.64, 0.8,  0.4,  0.48, 0.4,  0.48, 0.24, 0.32, 0.24, 0.32,
      0.64, 0.8,  0.64, 0.8,  0.64, 0.8,  0.4,  0.48, 0.4,  0.48, 0.2,  0.24,
      0.2,  0.24, 0.48, 0.56, 0.48, 0.56, 0.48, 0.56, 0.28, 0.32, 0.28, 0.32,
      0.2,  0.24, 0.2,  0.24, 0.48, 0.56, 0.48, 0.56, 0.48, 0.56, 0.28, 0.32,
      0.28, 0.32, 0.36, 0.4,  0.36, 0.4,  0.8,  0.88, 0.8,  0.88, 0.8,  0.88,
      0.44, 0.48, 0.44, 0.48, 0.36, 0.4,  0.36, 0.4,  0.8,  0.88, 0.8,  0.88,
      0.8,  0.88, 0.44, 0.48, 0.44, 0.48, 0.88, 0.96, 0.88, 0.96, 1.92, 2.08,
      1.92, 2.08, 1.92, 2.08, 1.04, 1.12, 1.04, 1.12, 0.88, 0.96, 0.88, 0.96,
      1.92, 2.08, 1.92, 2.08, 1.92, 2.08, 1.04, 1.12, 1.04, 1.12, 0.88, 0.96,
      0.88, 0.96, 1.92, 2.08, 1.92, 2.08, 1.92, 2.08, 1.04, 1.12, 1.04, 1.12,
      0.52, 0.56, 0.52, 0.56, 1.12, 1.2,  1.12, 1.2,  1.12, 1.2,  0.6,  0.64,
      0.6,  0.64, 0.52, 0.56, 0.52, 0.56, 1.12, 1.2,  1.12, 1.2,  1.12, 1.2,
      0.6,  0.64, 0.6,  0.64, 0.68, 0.72, 0.68, 0.72, 1.44, 1.52, 1.44, 1.52,
      1.44, 1.52, 0.76, 0.8,  0.76, 0.8,  0.68, 0.72, 0.68, 0.72, 1.44, 1.52,
      1.44, 1.52, 1.44, 1.52, 0.76, 0.8,  0.76, 0.8,  1.52, 1.6,  1.52, 1.6,
      3.2,  3.36, 3.2,  3.36, 3.2,  3.36, 1.68, 1.76, 1.68, 1.76, 1.52, 1.6,
      1.52, 1.6,  3.2,  3.36, 3.2,  3.36, 3.2,  3.36, 1.68, 1.76, 1.68, 1.76,
      1.52, 1.6,  1.52, 1.6,  3.2,  3.36, 3.2,  3.36, 3.2,  3.36, 1.68, 1.76,
      1.68, 1.76, 0.84, 0.88, 0.84, 0.88, 1.76, 1.84, 1.76, 1.84, 1.76, 1.84,
      0.92, 0.96, 0.92, 0.96, 0.84, 0.88, 0.84, 0.88, 1.76, 1.84, 1.76, 1.84,
      1.76, 1.84, 0.92, 0.96, 0.92, 0.96};
  const std::array<int, 4> in_shape = {{3, 7, 7, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME3x7x7x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      2.4177777778,
      2.7022222222,
      2.9866666667,
      3.2711111111,
      2.4177777778,
      2.7022222222,
      2.9866666667,
      3.2711111111,
      4.0177777778,
      4.4088888889,
      4.8,
      5.1911111111,
      2.7733333333,
      2.9866666667,
      3.2,
      3.4133333333,
      6.1511111111,
      6.5422222222,
      6.9333333333,
      7.3244444444,
      4.9777777778,
      5.2622222222,
      5.5466666667,
      5.8311111111,
      4.9777777778,
      5.2622222222,
      5.5466666667,
      5.8311111111,
      2.4177777778,
      2.7022222222,
      2.9866666667,
      3.2711111111,
      2.4177777778,
      2.7022222222,
      2.9866666667,
      3.2711111111,
      4.0177777778,
      4.4088888889,
      4.8,
      5.1911111111,
      2.7733333333,
      2.9866666667,
      3.2,
      3.4133333333,
      6.1511111111,
      6.5422222222,
      6.9333333333,
      7.3244444444,
      4.9777777778,
      5.2622222222,
      5.5466666667,
      5.8311111111,
      4.9777777778,
      5.2622222222,
      5.5466666667,
      5.8311111111,
      6.0977777778,
      6.4888888889,
      6.88,
      7.2711111111,
      6.0977777778,
      6.4888888889,
      6.88,
      7.2711111111,
      9.3377777778,
      9.8755555556,
      10.4133333333,
      10.9511111111,
      5.8933333333,
      6.1866666667,
      6.48,
      6.7733333333,
      12.2711111111,
      12.8088888889,
      13.3466666667,
      13.8844444444,
      9.6177777778,
      10.0088888889,
      10.4,
      10.7911111111,
      9.6177777778,
      10.0088888889,
      10.4,
      10.7911111111,
      5.6533333333,
      5.8666666667,
      6.08,
      6.2933333333,
      5.6533333333,
      5.8666666667,
      6.08,
      6.2933333333,
      8.2933333333,
      8.5866666667,
      8.88,
      9.1733333333,
      4.96,
      5.12,
      5.28,
      5.44,
      9.8933333333,
      10.1866666667,
      10.48,
      10.7733333333,
      7.5733333333,
      7.7866666667,
      8.,
      8.2133333333,
      7.5733333333,
      7.7866666667,
      8.,
      8.2133333333,
      14.6311111111,
      15.0222222222,
      15.4133333333,
      15.8044444444,
      14.6311111111,
      15.0222222222,
      15.4133333333,
      15.8044444444,
      21.0711111111,
      21.6088888889,
      22.1466666667,
      22.6844444444,
      12.2933333333,
      12.5866666667,
      12.88,
      13.1733333333,
      24.0044444444,
      24.5422222222,
      25.08,
      25.6177777778,
      18.1511111111,
      18.5422222222,
      18.9333333333,
      19.3244444444,
      18.1511111111,
      18.5422222222,
      18.9333333333,
      19.3244444444,
      12.6577777778,
      12.9422222222,
      13.2266666667,
      13.5111111111,
      12.6577777778,
      12.9422222222,
      13.2266666667,
      13.5111111111,
      18.0977777778,
      18.4888888889,
      18.88,
      19.2711111111,
      10.4533333333,
      10.6666666667,
      10.88,
      11.0933333333,
      20.2311111111,
      20.6222222222,
      21.0133333333,
      21.4044444444,
      15.2177777778,
      15.5022222222,
      15.7866666667,
      16.0711111111,
      15.2177777778,
      15.5022222222,
      15.7866666667,
      16.0711111111,
      12.6577777778,
      12.9422222222,
      13.2266666667,
      13.5111111111,
      12.6577777778,
      12.9422222222,
      13.2266666667,
      13.5111111111,
      18.0977777778,
      18.4888888889,
      18.88,
      19.2711111111,
      10.4533333333,
      10.6666666667,
      10.88,
      11.0933333333,
      20.2311111111,
      20.6222222222,
      21.0133333333,
      21.4044444444,
      15.2177777778,
      15.5022222222,
      15.7866666667,
      16.0711111111,
      15.2177777778,
      15.5022222222,
      15.7866666667,
      16.0711111111,
      20.6222222222,
      20.9066666667,
      21.1911111111,
      21.4755555556,
      20.6222222222,
      20.9066666667,
      21.1911111111,
      21.4755555556,
      29.0488888889,
      29.44,
      29.8311111111,
      30.2222222222,
      16.4266666667,
      16.64,
      16.8533333333,
      17.0666666667,
      31.1822222222,
      31.5733333333,
      31.9644444444,
      32.3555555556,
      23.1822222222,
      23.4666666667,
      23.7511111111,
      24.0355555556,
      23.1822222222,
      23.4666666667,
      23.7511111111,
      24.0355555556,
      20.6222222222,
      20.9066666667,
      21.1911111111,
      21.4755555556,
      20.6222222222,
      20.9066666667,
      21.1911111111,
      21.4755555556,
      29.0488888889,
      29.44,
      29.8311111111,
      30.2222222222,
      16.4266666667,
      16.64,
      16.8533333333,
      17.0666666667,
      31.1822222222,
      31.5733333333,
      31.9644444444,
      32.3555555556,
      23.1822222222,
      23.4666666667,
      23.7511111111,
      24.0355555556,
      23.1822222222,
      23.4666666667,
      23.7511111111,
      24.0355555556,
      31.1288888889,
      31.52,
      31.9111111111,
      32.3022222222,
      31.1288888889,
      31.52,
      31.9111111111,
      32.3022222222,
      43.7555555556,
      44.2933333333,
      44.8311111111,
      45.3688888889,
      24.6666666667,
      24.96,
      25.2533333333,
      25.5466666667,
      46.6888888889,
      47.2266666667,
      47.7644444444,
      48.3022222222,
      34.6488888889,
      35.04,
      35.4311111111,
      35.8222222222,
      34.6488888889,
      35.04,
      35.4311111111,
      35.8222222222,
      19.3066666667,
      19.52,
      19.7333333333,
      19.9466666667,
      19.3066666667,
      19.52,
      19.7333333333,
      19.9466666667,
      27.0666666667,
      27.36,
      27.6533333333,
      27.9466666667,
      15.2,
      15.36,
      15.52,
      15.68,
      28.6666666667,
      28.96,
      29.2533333333,
      29.5466666667,
      21.2266666667,
      21.44,
      21.6533333333,
      21.8666666667,
      21.2266666667,
      21.44,
      21.6533333333,
      21.8666666667,
      39.6622222222,
      40.0533333333,
      40.4444444444,
      40.8355555556,
      39.6622222222,
      40.0533333333,
      40.4444444444,
      40.8355555556,
      55.4888888889,
      56.0266666667,
      56.5644444444,
      57.1022222222,
      31.0666666667,
      31.36,
      31.6533333333,
      31.9466666667,
      58.4222222222,
      58.96,
      59.4977777778,
      60.0355555556,
      43.1822222222,
      43.5733333333,
      43.9644444444,
      44.3555555556,
      43.1822222222,
      43.5733333333,
      43.9644444444,
      44.3555555556,
      30.8622222222,
      31.1466666667,
      31.4311111111,
      31.7155555556,
      30.8622222222,
      31.1466666667,
      31.4311111111,
      31.7155555556,
      43.1288888889,
      43.52,
      43.9111111111,
      44.3022222222,
      24.1066666667,
      24.32,
      24.5333333333,
      24.7466666667,
      45.2622222222,
      45.6533333333,
      46.0444444444,
      46.4355555556,
      33.4222222222,
      33.7066666667,
      33.9911111111,
      34.2755555556,
      33.4222222222,
      33.7066666667,
      33.9911111111,
      34.2755555556,
      30.8622222222,
      31.1466666667,
      31.4311111111,
      31.7155555556,
      30.8622222222,
      31.1466666667,
      31.4311111111,
      31.7155555556,
      43.1288888889,
      43.52,
      43.9111111111,
      44.3022222222,
      24.1066666667,
      24.32,
      24.5333333333,
      24.7466666667,
      45.2622222222,
      45.6533333333,
      46.0444444444,
      46.4355555556,
      33.4222222222,
      33.7066666667,
      33.9911111111,
      34.2755555556,
      33.4222222222,
      33.7066666667,
      33.9911111111,
      34.2755555556,
      38.8266666667,
      39.1111111111,
      39.3955555556,
      39.68,
      38.8266666667,
      39.1111111111,
      39.3955555556,
      39.68,
      54.08,
      54.4711111111,
      54.8622222222,
      55.2533333333,
      30.08,
      30.2933333333,
      30.5066666667,
      30.72,
      56.2133333333,
      56.6044444444,
      56.9955555556,
      57.3866666667,
      41.3866666667,
      41.6711111111,
      41.9555555556,
      42.24,
      41.3866666667,
      41.6711111111,
      41.9555555556,
      42.24,
      38.8266666667,
      39.1111111111,
      39.3955555556,
      39.68,
      38.8266666667,
      39.1111111111,
      39.3955555556,
      39.68,
      54.08,
      54.4711111111,
      54.8622222222,
      55.2533333333,
      30.08,
      30.2933333333,
      30.5066666667,
      30.72,
      56.2133333333,
      56.6044444444,
      56.9955555556,
      57.3866666667,
      41.3866666667,
      41.6711111111,
      41.9555555556,
      42.24,
      41.3866666667,
      41.6711111111,
      41.9555555556,
      42.24,
      56.16,
      56.5511111111,
      56.9422222222,
      57.3333333333,
      56.16,
      56.5511111111,
      56.9422222222,
      57.3333333333,
      78.1733333333,
      78.7111111111,
      79.2488888889,
      79.7866666667,
      43.44,
      43.7333333333,
      44.0266666667,
      44.32,
      81.1066666667,
      81.6444444444,
      82.1822222222,
      82.72,
      59.68,
      60.0711111111,
      60.4622222222,
      60.8533333333,
      59.68,
      60.0711111111,
      60.4622222222,
      60.8533333333,
      32.96,
      33.1733333333,
      33.3866666667,
      33.6,
      32.96,
      33.1733333333,
      33.3866666667,
      33.6,
      45.84,
      46.1333333333,
      46.4266666667,
      46.72,
      25.44,
      25.6,
      25.76,
      25.92,
      47.44,
      47.7333333333,
      48.0266666667,
      48.32,
      34.88,
      35.0933333333,
      35.3066666667,
      35.52,
      34.88,
      35.0933333333,
      35.3066666667,
      35.52,
      64.6933333333,
      65.0844444444,
      65.4755555556,
      65.8666666667,
      64.6933333333,
      65.0844444444,
      65.4755555556,
      65.8666666667,
      89.9066666667,
      90.4444444444,
      90.9822222222,
      91.52,
      49.84,
      50.1333333333,
      50.4266666667,
      50.72,
      92.84,
      93.3777777778,
      93.9155555556,
      94.4533333333,
      68.2133333333,
      68.6044444444,
      68.9955555556,
      69.3866666667,
      68.2133333333,
      68.6044444444,
      68.9955555556,
      69.3866666667,
      49.0666666667,
      49.3511111111,
      49.6355555556,
      49.92,
      49.0666666667,
      49.3511111111,
      49.6355555556,
      49.92,
      68.16,
      68.5511111111,
      68.9422222222,
      69.3333333333,
      37.76,
      37.9733333333,
      38.1866666667,
      38.4,
      70.2933333333,
      70.6844444444,
      71.0755555556,
      71.4666666667,
      51.6266666667,
      51.9111111111,
      52.1955555556,
      52.48,
      51.6266666667,
      51.9111111111,
      52.1955555556,
      52.48,
      49.0666666667,
      49.3511111111,
      49.6355555556,
      49.92,
      49.0666666667,
      49.3511111111,
      49.6355555556,
      49.92,
      68.16,
      68.5511111111,
      68.9422222222,
      69.3333333333,
      37.76,
      37.9733333333,
      38.1866666667,
      38.4,
      70.2933333333,
      70.6844444444,
      71.0755555556,
      71.4666666667,
      51.6266666667,
      51.9111111111,
      52.1955555556,
      52.48,
      51.6266666667,
      51.9111111111,
      52.1955555556,
      52.48,
  };
  const std::array<int, 4> in_shape = {{3, 7, 7, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID3x7x7x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.04, 0.08, 0.12, 0.16, 0.04, 0.08, 0.12, 0.16, 0.24, 0.32, 0.4,  0.48,
      0.24, 0.32, 0.4,  0.48, 0.24, 0.32, 0.4,  0.48, 0.2,  0.24, 0.28, 0.32,
      0.2,  0.24, 0.28, 0.32, 0.04, 0.08, 0.12, 0.16, 0.04, 0.08, 0.12, 0.16,
      0.24, 0.32, 0.4,  0.48, 0.24, 0.32, 0.4,  0.48, 0.24, 0.32, 0.4,  0.48,
      0.2,  0.24, 0.28, 0.32, 0.2,  0.24, 0.28, 0.32, 0.4,  0.48, 0.56, 0.64,
      0.4,  0.48, 0.56, 0.64, 1.12, 1.28, 1.44, 1.6,  1.12, 1.28, 1.44, 1.6,
      1.12, 1.28, 1.44, 1.6,  0.72, 0.8,  0.88, 0.96, 0.72, 0.8,  0.88, 0.96,
      0.4,  0.48, 0.56, 0.64, 0.4,  0.48, 0.56, 0.64, 1.12, 1.28, 1.44, 1.6,
      1.12, 1.28, 1.44, 1.6,  1.12, 1.28, 1.44, 1.6,  0.72, 0.8,  0.88, 0.96,
      0.72, 0.8,  0.88, 0.96, 0.4,  0.48, 0.56, 0.64, 0.4,  0.48, 0.56, 0.64,
      1.12, 1.28, 1.44, 1.6,  1.12, 1.28, 1.44, 1.6,  1.12, 1.28, 1.44, 1.6,
      0.72, 0.8,  0.88, 0.96, 0.72, 0.8,  0.88, 0.96, 0.36, 0.4,  0.44, 0.48,
      0.36, 0.4,  0.44, 0.48, 0.88, 0.96, 1.04, 1.12, 0.88, 0.96, 1.04, 1.12,
      0.88, 0.96, 1.04, 1.12, 0.52, 0.56, 0.6,  0.64, 0.52, 0.56, 0.6,  0.64,
      0.36, 0.4,  0.44, 0.48, 0.36, 0.4,  0.44, 0.48, 0.88, 0.96, 1.04, 1.12,
      0.88, 0.96, 1.04, 1.12, 0.88, 0.96, 1.04, 1.12, 0.52, 0.56, 0.6,  0.64,
      0.52, 0.56, 0.6,  0.64, 0.68, 0.72, 0.76, 0.8,  0.68, 0.72, 0.76, 0.8,
      1.52, 1.6,  1.68, 1.76, 1.52, 1.6,  1.68, 1.76, 1.52, 1.6,  1.68, 1.76,
      0.84, 0.88, 0.92, 0.96, 0.84, 0.88, 0.92, 0.96, 0.68, 0.72, 0.76, 0.8,
      0.68, 0.72, 0.76, 0.8,  1.52, 1.6,  1.68, 1.76, 1.52, 1.6,  1.68, 1.76,
      1.52, 1.6,  1.68, 1.76, 0.84, 0.88, 0.92, 0.96, 0.84, 0.88, 0.92, 0.96,
      1.68, 1.76, 1.84, 1.92, 1.68, 1.76, 1.84, 1.92, 3.68, 3.84, 4.,   4.16,
      3.68, 3.84, 4.,   4.16, 3.68, 3.84, 4.,   4.16, 2.,   2.08, 2.16, 2.24,
      2.,   2.08, 2.16, 2.24, 1.68, 1.76, 1.84, 1.92, 1.68, 1.76, 1.84, 1.92,
      3.68, 3.84, 4.,   4.16, 3.68, 3.84, 4.,   4.16, 3.68, 3.84, 4.,   4.16,
      2.,   2.08, 2.16, 2.24, 2.,   2.08, 2.16, 2.24, 1.68, 1.76, 1.84, 1.92,
      1.68, 1.76, 1.84, 1.92, 3.68, 3.84, 4.,   4.16, 3.68, 3.84, 4.,   4.16,
      3.68, 3.84, 4.,   4.16, 2.,   2.08, 2.16, 2.24, 2.,   2.08, 2.16, 2.24,
      1.,   1.04, 1.08, 1.12, 1.,   1.04, 1.08, 1.12, 2.16, 2.24, 2.32, 2.4,
      2.16, 2.24, 2.32, 2.4,  2.16, 2.24, 2.32, 2.4,  1.16, 1.2,  1.24, 1.28,
      1.16, 1.2,  1.24, 1.28, 1.,   1.04, 1.08, 1.12, 1.,   1.04, 1.08, 1.12,
      2.16, 2.24, 2.32, 2.4,  2.16, 2.24, 2.32, 2.4,  2.16, 2.24, 2.32, 2.4,
      1.16, 1.2,  1.24, 1.28, 1.16, 1.2,  1.24, 1.28, 1.32, 1.36, 1.4,  1.44,
      1.32, 1.36, 1.4,  1.44, 2.8,  2.88, 2.96, 3.04, 2.8,  2.88, 2.96, 3.04,
      2.8,  2.88, 2.96, 3.04, 1.48, 1.52, 1.56, 1.6,  1.48, 1.52, 1.56, 1.6,
      1.32, 1.36, 1.4,  1.44, 1.32, 1.36, 1.4,  1.44, 2.8,  2.88, 2.96, 3.04,
      2.8,  2.88, 2.96, 3.04, 2.8,  2.88, 2.96, 3.04, 1.48, 1.52, 1.56, 1.6,
      1.48, 1.52, 1.56, 1.6,  2.96, 3.04, 3.12, 3.2,  2.96, 3.04, 3.12, 3.2,
      6.24, 6.4,  6.56, 6.72, 6.24, 6.4,  6.56, 6.72, 6.24, 6.4,  6.56, 6.72,
      3.28, 3.36, 3.44, 3.52, 3.28, 3.36, 3.44, 3.52, 2.96, 3.04, 3.12, 3.2,
      2.96, 3.04, 3.12, 3.2,  6.24, 6.4,  6.56, 6.72, 6.24, 6.4,  6.56, 6.72,
      6.24, 6.4,  6.56, 6.72, 3.28, 3.36, 3.44, 3.52, 3.28, 3.36, 3.44, 3.52,
      2.96, 3.04, 3.12, 3.2,  2.96, 3.04, 3.12, 3.2,  6.24, 6.4,  6.56, 6.72,
      6.24, 6.4,  6.56, 6.72, 6.24, 6.4,  6.56, 6.72, 3.28, 3.36, 3.44, 3.52,
      3.28, 3.36, 3.44, 3.52, 1.64, 1.68, 1.72, 1.76, 1.64, 1.68, 1.72, 1.76,
      3.44, 3.52, 3.6,  3.68, 3.44, 3.52, 3.6,  3.68, 3.44, 3.52, 3.6,  3.68,
      1.8,  1.84, 1.88, 1.92, 1.8,  1.84, 1.88, 1.92, 1.64, 1.68, 1.72, 1.76,
      1.64, 1.68, 1.72, 1.76, 3.44, 3.52, 3.6,  3.68, 3.44, 3.52, 3.6,  3.68,
      3.44, 3.52, 3.6,  3.68, 1.8,  1.84, 1.88, 1.92, 1.8,  1.84, 1.88, 1.92};
  const std::array<int, 4> in_shape = {{3, 7, 7, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME3x7x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.3333333333,  0.7066666667,  0.7066666667,  1.1866666667,  0.8533333333,
      1.8311111111,  1.4577777778,  1.4577777778,  0.3333333333,  0.7066666667,
      0.7066666667,  1.1866666667,  0.8533333333,  1.8311111111,  1.4577777778,
      1.4577777778,  0.7833333333,  1.5566666667,  1.5566666667,  2.4766666667,
      1.6933333333,  3.4711111111,  2.6977777778,  2.6977777778,  0.7,
      1.34,          1.34,          2.06,          1.36,          2.6933333333,
      2.0533333333,  2.0533333333,  1.7833333333,  3.3566666667,  3.3566666667,
      5.0766666667,  3.2933333333,  6.4044444444,  4.8311111111,  4.8311111111,
      1.5333333333,  2.8666666667,  2.8666666667,  4.3066666667,  2.7733333333,
      5.3511111111,  4.0177777778,  4.0177777778,  1.5333333333,  2.8666666667,
      2.8666666667,  4.3066666667,  2.7733333333,  5.3511111111,  4.0177777778,
      4.0177777778,  2.4666666667,  4.5466666667,  4.5466666667,  6.7333333333,
      4.2666666667,  8.0888888889,  6.0088888889,  6.0088888889,  2.4666666667,
      4.5466666667,  4.5466666667,  6.7333333333,  4.2666666667,  8.0888888889,
      6.0088888889,  6.0088888889,  3.7166666667,  6.8366666667,  6.8366666667,
      10.1033333333, 6.3866666667,  12.0755555556, 8.9555555556,  8.9555555556,
      2.3,           4.22,          4.22,          6.22,          3.92,
      7.3866666667,  5.4666666667,  5.4666666667,  4.7166666667,  8.6366666667,
      8.6366666667,  12.7033333333, 7.9866666667,  15.0088888889, 11.0888888889,
      11.0888888889, 3.6666666667,  6.7066666667,  6.7066666667,  9.8533333333,
      6.1866666667,  11.6088888889, 8.5688888889,  8.5688888889,  3.6666666667,
      6.7066666667,  6.7066666667,  9.8533333333,  6.1866666667,  11.6088888889,
      8.5688888889,  8.5688888889,  4.6,           8.3866666667,  8.3866666667,
      12.28,         7.68,          14.3466666667, 10.56,         10.56,
      4.6,           8.3866666667,  8.3866666667,  12.28,         7.68,
      14.3466666667, 10.56,         10.56,         6.65,          12.1166666667,
      12.1166666667, 17.73,         11.08,         20.68,         15.2133333333,
      15.2133333333, 3.9,           7.1,           7.1,           10.38,
      6.48,          12.08,         8.88,          8.88,          7.65,
      13.9166666667, 13.9166666667, 20.33,         12.68,         23.6133333333,
      17.3466666667, 17.3466666667, 5.8,           10.5466666667, 10.5466666667,
      15.4,          9.6,           17.8666666667, 13.12,         13.12,
      5.8,           10.5466666667, 10.5466666667, 15.4,          9.6,
      17.8666666667, 13.12,         13.12,
  };
  const std::array<int, 4> in_shape = {{3, 7, 8, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID3x7x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.04, 0.04, 0.12, 0.12, 0.12, 0.08, 0.08, 0.,   0.04, 0.04, 0.12, 0.12,
      0.12, 0.08, 0.08, 0.,   0.16, 0.16, 0.4,  0.4,  0.4,  0.24, 0.24, 0.,
      0.16, 0.16, 0.4,  0.4,  0.4,  0.24, 0.24, 0.,   0.16, 0.16, 0.4,  0.4,
      0.4,  0.24, 0.24, 0.,   0.12, 0.12, 0.28, 0.28, 0.28, 0.16, 0.16, 0.,
      0.12, 0.12, 0.28, 0.28, 0.28, 0.16, 0.16, 0.,   0.2,  0.2,  0.44, 0.44,
      0.44, 0.24, 0.24, 0.,   0.2,  0.2,  0.44, 0.44, 0.44, 0.24, 0.24, 0.,
      0.48, 0.48, 1.04, 1.04, 1.04, 0.56, 0.56, 0.,   0.48, 0.48, 1.04, 1.04,
      1.04, 0.56, 0.56, 0.,   0.48, 0.48, 1.04, 1.04, 1.04, 0.56, 0.56, 0.,
      0.28, 0.28, 0.6,  0.6,  0.6,  0.32, 0.32, 0.,   0.28, 0.28, 0.6,  0.6,
      0.6,  0.32, 0.32, 0.,   0.36, 0.36, 0.76, 0.76, 0.76, 0.4,  0.4,  0.,
      0.36, 0.36, 0.76, 0.76, 0.76, 0.4,  0.4,  0.,   0.8,  0.8,  1.68, 1.68,
      1.68, 0.88, 0.88, 0.,   0.8,  0.8,  1.68, 1.68, 1.68, 0.88, 0.88, 0.,
      0.8,  0.8,  1.68, 1.68, 1.68, 0.88, 0.88, 0.,   0.44, 0.44, 0.92, 0.92,
      0.92, 0.48, 0.48, 0.,   0.44, 0.44, 0.92, 0.92, 0.92, 0.48, 0.48, 0.,
  };
  const std::array<int, 4> in_shape = {{3, 7, 8, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME3x7x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.5333333333,  0.6666666667,  1.1733333333,  1.4133333333,  1.1733333333,
      1.4133333333,  2.0266666667,  2.3733333333,  1.4933333333,  1.7066666667,
      3.2711111111,  3.6622222222,  2.6311111111,  2.9155555556,  2.6311111111,
      2.9155555556,  0.5333333333,  0.6666666667,  1.1733333333,  1.4133333333,
      1.1733333333,  1.4133333333,  2.0266666667,  2.3733333333,  1.4933333333,
      1.7066666667,  3.2711111111,  3.6622222222,  2.6311111111,  2.9155555556,
      2.6311111111,  2.9155555556,  1.3833333333,  1.5666666667,  2.7833333333,
      3.1133333333,  2.7833333333,  3.1133333333,  4.4766666667,  4.9533333333,
      3.0933333333,  3.3866666667,  6.4044444444,  6.9422222222,  5.0044444444,
      5.3955555556,  5.0044444444,  5.3955555556,  1.3,           1.4,
      2.5,           2.68,          2.5,           2.68,          3.86,
      4.12,          2.56,          2.72,          5.0933333333,  5.3866666667,
      3.8933333333,  4.1066666667,  3.8933333333,  4.1066666667,  3.3833333333,
      3.5666666667,  6.3833333333,  6.7133333333,  6.3833333333,  6.7133333333,
      9.6766666667,  10.1533333333, 6.2933333333,  6.5866666667,  12.2711111111,
      12.8088888889, 9.2711111111,  9.6622222222,  9.2711111111,  9.6622222222,
      2.9333333333,  3.0666666667,  5.4933333333,  5.7333333333,  5.4933333333,
      5.7333333333,  8.2666666667,  8.6133333333,  5.3333333333,  5.5466666667,
      10.3111111111, 10.7022222222, 7.7511111111,  8.0355555556,  7.7511111111,
      8.0355555556,  2.9333333333,  3.0666666667,  5.4933333333,  5.7333333333,
      5.4933333333,  5.7333333333,  8.2666666667,  8.6133333333,  5.3333333333,
      5.5466666667,  10.3111111111, 10.7022222222, 7.7511111111,  8.0355555556,
      7.7511111111,  8.0355555556,  4.8,           4.9333333333,  8.8533333333,
      9.0933333333,  8.8533333333,  9.0933333333,  13.12,         13.4666666667,
      8.32,          8.5333333333,  15.7866666667, 16.1777777778, 11.7333333333,
      12.0177777778, 11.7333333333, 12.0177777778, 4.8,           4.9333333333,
      8.8533333333,  9.0933333333,  8.8533333333,  9.0933333333,  13.12,
      13.4666666667, 8.32,          8.5333333333,  15.7866666667, 16.1777777778,
      11.7333333333, 12.0177777778, 11.7333333333, 12.0177777778, 7.25,
      7.4333333333,  13.3433333333, 13.6733333333, 13.3433333333, 13.6733333333,
      19.73,         20.2066666667, 12.48,         12.7733333333, 23.6133333333,
      24.1511111111, 17.52,         17.9111111111, 17.52,         17.9111111111,
      4.5,           4.6,           8.26,          8.44,          8.26,
      8.44,          12.18,         12.44,         7.68,          7.84,
      14.48,         14.7733333333, 10.72,         10.9333333333, 10.72,
      10.9333333333, 9.25,          9.4333333333,  16.9433333333, 17.2733333333,
      16.9433333333, 17.2733333333, 24.93,         25.4066666667, 15.68,
      15.9733333333, 29.48,         30.0177777778, 21.7866666667, 22.1777777778,
      21.7866666667, 22.1777777778, 7.2,           7.3333333333,  13.1733333333,
      13.4133333333, 13.1733333333, 13.4133333333, 19.36,         19.7066666667,
      12.16,         12.3733333333, 22.8266666667, 23.2177777778, 16.8533333333,
      17.1377777778, 16.8533333333, 17.1377777778, 7.2,           7.3333333333,
      13.1733333333, 13.4133333333, 13.1733333333, 13.4133333333, 19.36,
      19.7066666667, 12.16,         12.3733333333, 22.8266666667, 23.2177777778,
      16.8533333333, 17.1377777778, 16.8533333333, 17.1377777778, 9.0666666667,
      9.2,           16.5333333333, 16.7733333333, 16.5333333333, 16.7733333333,
      24.2133333333, 24.56,         15.1466666667, 15.36,         28.3022222222,
      28.6933333333, 20.8355555556, 21.12,         20.8355555556, 21.12,
      9.0666666667,  9.2,           16.5333333333, 16.7733333333, 16.5333333333,
      16.7733333333, 24.2133333333, 24.56,         15.1466666667, 15.36,
      28.3022222222, 28.6933333333, 20.8355555556, 21.12,         20.8355555556,
      21.12,         13.1166666667, 13.3,          23.9033333333, 24.2333333333,
      23.9033333333, 24.2333333333, 34.9833333333, 35.46,         21.8666666667,
      22.16,         40.8222222222, 41.36,         30.0355555556, 30.4266666667,
      30.0355555556, 30.4266666667, 7.7,           7.8,           14.02,
      14.2,          14.02,         14.2,          20.5,          20.76,
      12.8,          12.96,         23.8666666667, 24.16,         17.5466666667,
      17.76,         17.5466666667, 17.76,         15.1166666667, 15.3,
      27.5033333333, 27.8333333333, 27.5033333333, 27.8333333333, 40.1833333333,
      40.66,         25.0666666667, 25.36,         46.6888888889, 47.2266666667,
      34.3022222222, 34.6933333333, 34.3022222222, 34.6933333333, 11.4666666667,
      11.6,          20.8533333333, 21.0933333333, 20.8533333333, 21.0933333333,
      30.4533333333, 30.8,          18.9866666667, 19.2,          35.3422222222,
      35.7333333333, 25.9555555556, 26.24,         25.9555555556, 26.24,
      11.4666666667, 11.6,          20.8533333333, 21.0933333333, 20.8533333333,
      21.0933333333, 30.4533333333, 30.8,          18.9866666667, 19.2,
      35.3422222222, 35.7333333333, 25.9555555556, 26.24,         25.9555555556,
      26.24,
  };
  const std::array<int, 4> in_shape = {{3, 7, 8, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID3x7x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.04, 0.08, 0.04, 0.08, 0.16, 0.24, 0.16, 0.24, 0.16, 0.24, 0.12, 0.16,
      0.12, 0.16, 0.,   0.,   0.04, 0.08, 0.04, 0.08, 0.16, 0.24, 0.16, 0.24,
      0.16, 0.24, 0.12, 0.16, 0.12, 0.16, 0.,   0.,   0.24, 0.32, 0.24, 0.32,
      0.64, 0.8,  0.64, 0.8,  0.64, 0.8,  0.4,  0.48, 0.4,  0.48, 0.,   0.,
      0.24, 0.32, 0.24, 0.32, 0.64, 0.8,  0.64, 0.8,  0.64, 0.8,  0.4,  0.48,
      0.4,  0.48, 0.,   0.,   0.24, 0.32, 0.24, 0.32, 0.64, 0.8,  0.64, 0.8,
      0.64, 0.8,  0.4,  0.48, 0.4,  0.48, 0.,   0.,   0.2,  0.24, 0.2,  0.24,
      0.48, 0.56, 0.48, 0.56, 0.48, 0.56, 0.28, 0.32, 0.28, 0.32, 0.,   0.,
      0.2,  0.24, 0.2,  0.24, 0.48, 0.56, 0.48, 0.56, 0.48, 0.56, 0.28, 0.32,
      0.28, 0.32, 0.,   0.,   0.36, 0.4,  0.36, 0.4,  0.8,  0.88, 0.8,  0.88,
      0.8,  0.88, 0.44, 0.48, 0.44, 0.48, 0.,   0.,   0.36, 0.4,  0.36, 0.4,
      0.8,  0.88, 0.8,  0.88, 0.8,  0.88, 0.44, 0.48, 0.44, 0.48, 0.,   0.,
      0.88, 0.96, 0.88, 0.96, 1.92, 2.08, 1.92, 2.08, 1.92, 2.08, 1.04, 1.12,
      1.04, 1.12, 0.,   0.,   0.88, 0.96, 0.88, 0.96, 1.92, 2.08, 1.92, 2.08,
      1.92, 2.08, 1.04, 1.12, 1.04, 1.12, 0.,   0.,   0.88, 0.96, 0.88, 0.96,
      1.92, 2.08, 1.92, 2.08, 1.92, 2.08, 1.04, 1.12, 1.04, 1.12, 0.,   0.,
      0.52, 0.56, 0.52, 0.56, 1.12, 1.2,  1.12, 1.2,  1.12, 1.2,  0.6,  0.64,
      0.6,  0.64, 0.,   0.,   0.52, 0.56, 0.52, 0.56, 1.12, 1.2,  1.12, 1.2,
      1.12, 1.2,  0.6,  0.64, 0.6,  0.64, 0.,   0.,   0.68, 0.72, 0.68, 0.72,
      1.44, 1.52, 1.44, 1.52, 1.44, 1.52, 0.76, 0.8,  0.76, 0.8,  0.,   0.,
      0.68, 0.72, 0.68, 0.72, 1.44, 1.52, 1.44, 1.52, 1.44, 1.52, 0.76, 0.8,
      0.76, 0.8,  0.,   0.,   1.52, 1.6,  1.52, 1.6,  3.2,  3.36, 3.2,  3.36,
      3.2,  3.36, 1.68, 1.76, 1.68, 1.76, 0.,   0.,   1.52, 1.6,  1.52, 1.6,
      3.2,  3.36, 3.2,  3.36, 3.2,  3.36, 1.68, 1.76, 1.68, 1.76, 0.,   0.,
      1.52, 1.6,  1.52, 1.6,  3.2,  3.36, 3.2,  3.36, 3.2,  3.36, 1.68, 1.76,
      1.68, 1.76, 0.,   0.,   0.84, 0.88, 0.84, 0.88, 1.76, 1.84, 1.76, 1.84,
      1.76, 1.84, 0.92, 0.96, 0.92, 0.96, 0.,   0.,   0.84, 0.88, 0.84, 0.88,
      1.76, 1.84, 1.76, 1.84, 1.76, 1.84, 0.92, 0.96, 0.92, 0.96, 0.,   0.,
  };
  const std::array<int, 4> in_shape = {{3, 7, 8, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME3x7x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.9333333333,
      1.0666666667,
      1.2,
      1.3333333333,
      2.1066666667,
      2.3466666667,
      2.5866666667,
      2.8266666667,
      2.1066666667,
      2.3466666667,
      2.5866666667,
      2.8266666667,
      3.7066666667,
      4.0533333333,
      4.4,
      4.7466666667,
      2.7733333333,
      2.9866666667,
      3.2,
      3.4133333333,
      6.1511111111,
      6.5422222222,
      6.9333333333,
      7.3244444444,
      4.9777777778,
      5.2622222222,
      5.5466666667,
      5.8311111111,
      4.9777777778,
      5.2622222222,
      5.5466666667,
      5.8311111111,
      0.9333333333,
      1.0666666667,
      1.2,
      1.3333333333,
      2.1066666667,
      2.3466666667,
      2.5866666667,
      2.8266666667,
      2.1066666667,
      2.3466666667,
      2.5866666667,
      2.8266666667,
      3.7066666667,
      4.0533333333,
      4.4,
      4.7466666667,
      2.7733333333,
      2.9866666667,
      3.2,
      3.4133333333,
      6.1511111111,
      6.5422222222,
      6.9333333333,
      7.3244444444,
      4.9777777778,
      5.2622222222,
      5.5466666667,
      5.8311111111,
      4.9777777778,
      5.2622222222,
      5.5466666667,
      5.8311111111,
      2.5833333333,
      2.7666666667,
      2.95,
      3.1333333333,
      5.2366666667,
      5.5666666667,
      5.8966666667,
      6.2266666667,
      5.2366666667,
      5.5666666667,
      5.8966666667,
      6.2266666667,
      8.4766666667,
      8.9533333333,
      9.43,
      9.9066666667,
      5.8933333333,
      6.1866666667,
      6.48,
      6.7733333333,
      12.2711111111,
      12.8088888889,
      13.3466666667,
      13.8844444444,
      9.6177777778,
      10.0088888889,
      10.4,
      10.7911111111,
      9.6177777778,
      10.0088888889,
      10.4,
      10.7911111111,
      2.5,
      2.6,
      2.7,
      2.8,
      4.82,
      5.,
      5.18,
      5.36,
      4.82,
      5.,
      5.18,
      5.36,
      7.46,
      7.72,
      7.98,
      8.24,
      4.96,
      5.12,
      5.28,
      5.44,
      9.8933333333,
      10.1866666667,
      10.48,
      10.7733333333,
      7.5733333333,
      7.7866666667,
      8.,
      8.2133333333,
      7.5733333333,
      7.7866666667,
      8.,
      8.2133333333,
      6.5833333333,
      6.7666666667,
      6.95,
      7.1333333333,
      12.4366666667,
      12.7666666667,
      13.0966666667,
      13.4266666667,
      12.4366666667,
      12.7666666667,
      13.0966666667,
      13.4266666667,
      18.8766666667,
      19.3533333333,
      19.83,
      20.3066666667,
      12.2933333333,
      12.5866666667,
      12.88,
      13.1733333333,
      24.0044444444,
      24.5422222222,
      25.08,
      25.6177777778,
      18.1511111111,
      18.5422222222,
      18.9333333333,
      19.3244444444,
      18.1511111111,
      18.5422222222,
      18.9333333333,
      19.3244444444,
      5.7333333333,
      5.8666666667,
      6.,
      6.1333333333,
      10.7466666667,
      10.9866666667,
      11.2266666667,
      11.4666666667,
      10.7466666667,
      10.9866666667,
      11.2266666667,
      11.4666666667,
      16.1866666667,
      16.5333333333,
      16.88,
      17.2266666667,
      10.4533333333,
      10.6666666667,
      10.88,
      11.0933333333,
      20.2311111111,
      20.6222222222,
      21.0133333333,
      21.4044444444,
      15.2177777778,
      15.5022222222,
      15.7866666667,
      16.0711111111,
      15.2177777778,
      15.5022222222,
      15.7866666667,
      16.0711111111,
      5.7333333333,
      5.8666666667,
      6.,
      6.1333333333,
      10.7466666667,
      10.9866666667,
      11.2266666667,
      11.4666666667,
      10.7466666667,
      10.9866666667,
      11.2266666667,
      11.4666666667,
      16.1866666667,
      16.5333333333,
      16.88,
      17.2266666667,
      10.4533333333,
      10.6666666667,
      10.88,
      11.0933333333,
      20.2311111111,
      20.6222222222,
      21.0133333333,
      21.4044444444,
      15.2177777778,
      15.5022222222,
      15.7866666667,
      16.0711111111,
      15.2177777778,
      15.5022222222,
      15.7866666667,
      16.0711111111,
      9.4666666667,
      9.6,
      9.7333333333,
      9.8666666667,
      17.4666666667,
      17.7066666667,
      17.9466666667,
      18.1866666667,
      17.4666666667,
      17.7066666667,
      17.9466666667,
      18.1866666667,
      25.8933333333,
      26.24,
      26.5866666667,
      26.9333333333,
      16.4266666667,
      16.64,
      16.8533333333,
      17.0666666667,
      31.1822222222,
      31.5733333333,
      31.9644444444,
      32.3555555556,
      23.1822222222,
      23.4666666667,
      23.7511111111,
      24.0355555556,
      23.1822222222,
      23.4666666667,
      23.7511111111,
      24.0355555556,
      9.4666666667,
      9.6,
      9.7333333333,
      9.8666666667,
      17.4666666667,
      17.7066666667,
      17.9466666667,
      18.1866666667,
      17.4666666667,
      17.7066666667,
      17.9466666667,
      18.1866666667,
      25.8933333333,
      26.24,
      26.5866666667,
      26.9333333333,
      16.4266666667,
      16.64,
      16.8533333333,
      17.0666666667,
      31.1822222222,
      31.5733333333,
      31.9644444444,
      32.3555555556,
      23.1822222222,
      23.4666666667,
      23.7511111111,
      24.0355555556,
      23.1822222222,
      23.4666666667,
      23.7511111111,
      24.0355555556,
      14.3166666667,
      14.5,
      14.6833333333,
      14.8666666667,
      26.3566666667,
      26.6866666667,
      27.0166666667,
      27.3466666667,
      26.3566666667,
      26.6866666667,
      27.0166666667,
      27.3466666667,
      38.9833333333,
      39.46,
      39.9366666667,
      40.4133333333,
      24.6666666667,
      24.96,
      25.2533333333,
      25.5466666667,
      46.6888888889,
      47.2266666667,
      47.7644444444,
      48.3022222222,
      34.6488888889,
      35.04,
      35.4311111111,
      35.8222222222,
      34.6488888889,
      35.04,
      35.4311111111,
      35.8222222222,
      8.9,
      9.,
      9.1,
      9.2,
      16.34,
      16.52,
      16.7,
      16.88,
      16.34,
      16.52,
      16.7,
      16.88,
      24.1,
      24.36,
      24.62,
      24.88,
      15.2,
      15.36,
      15.52,
      15.68,
      28.6666666667,
      28.96,
      29.2533333333,
      29.5466666667,
      21.2266666667,
      21.44,
      21.6533333333,
      21.8666666667,
      21.2266666667,
      21.44,
      21.6533333333,
      21.8666666667,
      18.3166666667,
      18.5,
      18.6833333333,
      18.8666666667,
      33.5566666667,
      33.8866666667,
      34.2166666667,
      34.5466666667,
      33.5566666667,
      33.8866666667,
      34.2166666667,
      34.5466666667,
      49.3833333333,
      49.86,
      50.3366666667,
      50.8133333333,
      31.0666666667,
      31.36,
      31.6533333333,
      31.9466666667,
      58.4222222222,
      58.96,
      59.4977777778,
      60.0355555556,
      43.1822222222,
      43.5733333333,
      43.9644444444,
      44.3555555556,
      43.1822222222,
      43.5733333333,
      43.9644444444,
      44.3555555556,
      14.2666666667,
      14.4,
      14.5333333333,
      14.6666666667,
      26.1066666667,
      26.3466666667,
      26.5866666667,
      26.8266666667,
      26.1066666667,
      26.3466666667,
      26.5866666667,
      26.8266666667,
      38.3733333333,
      38.72,
      39.0666666667,
      39.4133333333,
      24.1066666667,
      24.32,
      24.5333333333,
      24.7466666667,
      45.2622222222,
      45.6533333333,
      46.0444444444,
      46.4355555556,
      33.4222222222,
      33.7066666667,
      33.9911111111,
      34.2755555556,
      33.4222222222,
      33.7066666667,
      33.9911111111,
      34.2755555556,
      14.2666666667,
      14.4,
      14.5333333333,
      14.6666666667,
      26.1066666667,
      26.3466666667,
      26.5866666667,
      26.8266666667,
      26.1066666667,
      26.3466666667,
      26.5866666667,
      26.8266666667,
      38.3733333333,
      38.72,
      39.0666666667,
      39.4133333333,
      24.1066666667,
      24.32,
      24.5333333333,
      24.7466666667,
      45.2622222222,
      45.6533333333,
      46.0444444444,
      46.4355555556,
      33.4222222222,
      33.7066666667,
      33.9911111111,
      34.2755555556,
      33.4222222222,
      33.7066666667,
      33.9911111111,
      34.2755555556,
      18.,
      18.1333333333,
      18.2666666667,
      18.4,
      32.8266666667,
      33.0666666667,
      33.3066666667,
      33.5466666667,
      32.8266666667,
      33.0666666667,
      33.3066666667,
      33.5466666667,
      48.08,
      48.4266666667,
      48.7733333333,
      49.12,
      30.08,
      30.2933333333,
      30.5066666667,
      30.72,
      56.2133333333,
      56.6044444444,
      56.9955555556,
      57.3866666667,
      41.3866666667,
      41.6711111111,
      41.9555555556,
      42.24,
      41.3866666667,
      41.6711111111,
      41.9555555556,
      42.24,
      18.,
      18.1333333333,
      18.2666666667,
      18.4,
      32.8266666667,
      33.0666666667,
      33.3066666667,
      33.5466666667,
      32.8266666667,
      33.0666666667,
      33.3066666667,
      33.5466666667,
      48.08,
      48.4266666667,
      48.7733333333,
      49.12,
      30.08,
      30.2933333333,
      30.5066666667,
      30.72,
      56.2133333333,
      56.6044444444,
      56.9955555556,
      57.3866666667,
      41.3866666667,
      41.6711111111,
      41.9555555556,
      42.24,
      41.3866666667,
      41.6711111111,
      41.9555555556,
      42.24,
      26.05,
      26.2333333333,
      26.4166666667,
      26.6,
      47.4766666667,
      47.8066666667,
      48.1366666667,
      48.4666666667,
      47.4766666667,
      47.8066666667,
      48.1366666667,
      48.4666666667,
      69.49,
      69.9666666667,
      70.4433333333,
      70.92,
      43.44,
      43.7333333333,
      44.0266666667,
      44.32,
      81.1066666667,
      81.6444444444,
      82.1822222222,
      82.72,
      59.68,
      60.0711111111,
      60.4622222222,
      60.8533333333,
      59.68,
      60.0711111111,
      60.4622222222,
      60.8533333333,
      15.3,
      15.4,
      15.5,
      15.6,
      27.86,
      28.04,
      28.22,
      28.4,
      27.86,
      28.04,
      28.22,
      28.4,
      40.74,
      41.,
      41.26,
      41.52,
      25.44,
      25.6,
      25.76,
      25.92,
      47.44,
      47.7333333333,
      48.0266666667,
      48.32,
      34.88,
      35.0933333333,
      35.3066666667,
      35.52,
      34.88,
      35.0933333333,
      35.3066666667,
      35.52,
      30.05,
      30.2333333333,
      30.4166666667,
      30.6,
      54.6766666667,
      55.0066666667,
      55.3366666667,
      55.6666666667,
      54.6766666667,
      55.0066666667,
      55.3366666667,
      55.6666666667,
      79.89,
      80.3666666667,
      80.8433333333,
      81.32,
      49.84,
      50.1333333333,
      50.4266666667,
      50.72,
      92.84,
      93.3777777778,
      93.9155555556,
      94.4533333333,
      68.2133333333,
      68.6044444444,
      68.9955555556,
      69.3866666667,
      68.2133333333,
      68.6044444444,
      68.9955555556,
      69.3866666667,
      22.8,
      22.9333333333,
      23.0666666667,
      23.2,
      41.4666666667,
      41.7066666667,
      41.9466666667,
      42.1866666667,
      41.4666666667,
      41.7066666667,
      41.9466666667,
      42.1866666667,
      60.56,
      60.9066666667,
      61.2533333333,
      61.6,
      37.76,
      37.9733333333,
      38.1866666667,
      38.4,
      70.2933333333,
      70.6844444444,
      71.0755555556,
      71.4666666667,
      51.6266666667,
      51.9111111111,
      52.1955555556,
      52.48,
      51.6266666667,
      51.9111111111,
      52.1955555556,
      52.48,
      22.8,
      22.9333333333,
      23.0666666667,
      23.2,
      41.4666666667,
      41.7066666667,
      41.9466666667,
      42.1866666667,
      41.4666666667,
      41.7066666667,
      41.9466666667,
      42.1866666667,
      60.56,
      60.9066666667,
      61.2533333333,
      61.6,
      37.76,
      37.9733333333,
      38.1866666667,
      38.4,
      70.2933333333,
      70.6844444444,
      71.0755555556,
      71.4666666667,
      51.6266666667,
      51.9111111111,
      52.1955555556,
      52.48,
      51.6266666667,
      51.9111111111,
      52.1955555556,
      52.48,
  };
  const std::array<int, 4> in_shape = {{3, 7, 8, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID3x7x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.04, 0.08, 0.12, 0.16, 0.04, 0.08, 0.12, 0.16, 0.24, 0.32, 0.4,  0.48,
      0.24, 0.32, 0.4,  0.48, 0.24, 0.32, 0.4,  0.48, 0.2,  0.24, 0.28, 0.32,
      0.2,  0.24, 0.28, 0.32, 0.,   0.,   0.,   0.,   0.04, 0.08, 0.12, 0.16,
      0.04, 0.08, 0.12, 0.16, 0.24, 0.32, 0.4,  0.48, 0.24, 0.32, 0.4,  0.48,
      0.24, 0.32, 0.4,  0.48, 0.2,  0.24, 0.28, 0.32, 0.2,  0.24, 0.28, 0.32,
      0.,   0.,   0.,   0.,   0.4,  0.48, 0.56, 0.64, 0.4,  0.48, 0.56, 0.64,
      1.12, 1.28, 1.44, 1.6,  1.12, 1.28, 1.44, 1.6,  1.12, 1.28, 1.44, 1.6,
      0.72, 0.8,  0.88, 0.96, 0.72, 0.8,  0.88, 0.96, 0.,   0.,   0.,   0.,
      0.4,  0.48, 0.56, 0.64, 0.4,  0.48, 0.56, 0.64, 1.12, 1.28, 1.44, 1.6,
      1.12, 1.28, 1.44, 1.6,  1.12, 1.28, 1.44, 1.6,  0.72, 0.8,  0.88, 0.96,
      0.72, 0.8,  0.88, 0.96, 0.,   0.,   0.,   0.,   0.4,  0.48, 0.56, 0.64,
      0.4,  0.48, 0.56, 0.64, 1.12, 1.28, 1.44, 1.6,  1.12, 1.28, 1.44, 1.6,
      1.12, 1.28, 1.44, 1.6,  0.72, 0.8,  0.88, 0.96, 0.72, 0.8,  0.88, 0.96,
      0.,   0.,   0.,   0.,   0.36, 0.4,  0.44, 0.48, 0.36, 0.4,  0.44, 0.48,
      0.88, 0.96, 1.04, 1.12, 0.88, 0.96, 1.04, 1.12, 0.88, 0.96, 1.04, 1.12,
      0.52, 0.56, 0.6,  0.64, 0.52, 0.56, 0.6,  0.64, 0.,   0.,   0.,   0.,
      0.36, 0.4,  0.44, 0.48, 0.36, 0.4,  0.44, 0.48, 0.88, 0.96, 1.04, 1.12,
      0.88, 0.96, 1.04, 1.12, 0.88, 0.96, 1.04, 1.12, 0.52, 0.56, 0.6,  0.64,
      0.52, 0.56, 0.6,  0.64, 0.,   0.,   0.,   0.,   0.68, 0.72, 0.76, 0.8,
      0.68, 0.72, 0.76, 0.8,  1.52, 1.6,  1.68, 1.76, 1.52, 1.6,  1.68, 1.76,
      1.52, 1.6,  1.68, 1.76, 0.84, 0.88, 0.92, 0.96, 0.84, 0.88, 0.92, 0.96,
      0.,   0.,   0.,   0.,   0.68, 0.72, 0.76, 0.8,  0.68, 0.72, 0.76, 0.8,
      1.52, 1.6,  1.68, 1.76, 1.52, 1.6,  1.68, 1.76, 1.52, 1.6,  1.68, 1.76,
      0.84, 0.88, 0.92, 0.96, 0.84, 0.88, 0.92, 0.96, 0.,   0.,   0.,   0.,
      1.68, 1.76, 1.84, 1.92, 1.68, 1.76, 1.84, 1.92, 3.68, 3.84, 4.,   4.16,
      3.68, 3.84, 4.,   4.16, 3.68, 3.84, 4.,   4.16, 2.,   2.08, 2.16, 2.24,
      2.,   2.08, 2.16, 2.24, 0.,   0.,   0.,   0.,   1.68, 1.76, 1.84, 1.92,
      1.68, 1.76, 1.84, 1.92, 3.68, 3.84, 4.,   4.16, 3.68, 3.84, 4.,   4.16,
      3.68, 3.84, 4.,   4.16, 2.,   2.08, 2.16, 2.24, 2.,   2.08, 2.16, 2.24,
      0.,   0.,   0.,   0.,   1.68, 1.76, 1.84, 1.92, 1.68, 1.76, 1.84, 1.92,
      3.68, 3.84, 4.,   4.16, 3.68, 3.84, 4.,   4.16, 3.68, 3.84, 4.,   4.16,
      2.,   2.08, 2.16, 2.24, 2.,   2.08, 2.16, 2.24, 0.,   0.,   0.,   0.,
      1.,   1.04, 1.08, 1.12, 1.,   1.04, 1.08, 1.12, 2.16, 2.24, 2.32, 2.4,
      2.16, 2.24, 2.32, 2.4,  2.16, 2.24, 2.32, 2.4,  1.16, 1.2,  1.24, 1.28,
      1.16, 1.2,  1.24, 1.28, 0.,   0.,   0.,   0.,   1.,   1.04, 1.08, 1.12,
      1.,   1.04, 1.08, 1.12, 2.16, 2.24, 2.32, 2.4,  2.16, 2.24, 2.32, 2.4,
      2.16, 2.24, 2.32, 2.4,  1.16, 1.2,  1.24, 1.28, 1.16, 1.2,  1.24, 1.28,
      0.,   0.,   0.,   0.,   1.32, 1.36, 1.4,  1.44, 1.32, 1.36, 1.4,  1.44,
      2.8,  2.88, 2.96, 3.04, 2.8,  2.88, 2.96, 3.04, 2.8,  2.88, 2.96, 3.04,
      1.48, 1.52, 1.56, 1.6,  1.48, 1.52, 1.56, 1.6,  0.,   0.,   0.,   0.,
      1.32, 1.36, 1.4,  1.44, 1.32, 1.36, 1.4,  1.44, 2.8,  2.88, 2.96, 3.04,
      2.8,  2.88, 2.96, 3.04, 2.8,  2.88, 2.96, 3.04, 1.48, 1.52, 1.56, 1.6,
      1.48, 1.52, 1.56, 1.6,  0.,   0.,   0.,   0.,   2.96, 3.04, 3.12, 3.2,
      2.96, 3.04, 3.12, 3.2,  6.24, 6.4,  6.56, 6.72, 6.24, 6.4,  6.56, 6.72,
      6.24, 6.4,  6.56, 6.72, 3.28, 3.36, 3.44, 3.52, 3.28, 3.36, 3.44, 3.52,
      0.,   0.,   0.,   0.,   2.96, 3.04, 3.12, 3.2,  2.96, 3.04, 3.12, 3.2,
      6.24, 6.4,  6.56, 6.72, 6.24, 6.4,  6.56, 6.72, 6.24, 6.4,  6.56, 6.72,
      3.28, 3.36, 3.44, 3.52, 3.28, 3.36, 3.44, 3.52, 0.,   0.,   0.,   0.,
      2.96, 3.04, 3.12, 3.2,  2.96, 3.04, 3.12, 3.2,  6.24, 6.4,  6.56, 6.72,
      6.24, 6.4,  6.56, 6.72, 6.24, 6.4,  6.56, 6.72, 3.28, 3.36, 3.44, 3.52,
      3.28, 3.36, 3.44, 3.52, 0.,   0.,   0.,   0.,   1.64, 1.68, 1.72, 1.76,
      1.64, 1.68, 1.72, 1.76, 3.44, 3.52, 3.6,  3.68, 3.44, 3.52, 3.6,  3.68,
      3.44, 3.52, 3.6,  3.68, 1.8,  1.84, 1.88, 1.92, 1.8,  1.84, 1.88, 1.92,
      0.,   0.,   0.,   0.,   1.64, 1.68, 1.72, 1.76, 1.64, 1.68, 1.72, 1.76,
      3.44, 3.52, 3.6,  3.68, 3.44, 3.52, 3.6,  3.68, 3.44, 3.52, 3.6,  3.68,
      1.8,  1.84, 1.88, 1.92, 1.8,  1.84, 1.88, 1.92, 0.,   0.,   0.,   0.,
  };
  const std::array<int, 4> in_shape = {{3, 7, 8, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME3x7x10x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.3833333333, 0.7966666667,  0.7966666667,  1.3166666667,  0.9333333333,
      1.56,         1.1466666667,  2.3688888889,  1.8488888889,  1.8488888889,
      0.3833333333, 0.7966666667,  0.7966666667,  1.3166666667,  0.9333333333,
      1.56,         1.1466666667,  2.3688888889,  1.8488888889,  1.8488888889,
      0.9333333333, 1.8266666667,  1.8266666667,  2.8666666667,  1.9333333333,
      3.12,         2.2266666667,  4.4488888889,  3.4088888889,  3.4088888889,
      0.85,         1.61,          1.61,          2.45,          1.6,
      2.52,         1.76,          3.4266666667,  2.5866666667,  2.5866666667,
      2.1833333333, 4.0766666667,  4.0766666667,  6.1166666667,  3.9333333333,
      6.12,         4.2266666667,  8.1155555556,  6.0755555556,  6.0755555556,
      1.8833333333, 3.4966666667,  3.4966666667,  5.2166666667,  3.3333333333,
      5.16,         3.5466666667,  6.7688888889,  5.0488888889,  5.0488888889,
      1.8833333333, 3.4966666667,  3.4966666667,  5.2166666667,  3.3333333333,
      5.16,         3.5466666667,  6.7688888889,  5.0488888889,  5.0488888889,
      3.05,         5.5966666667,  5.5966666667,  8.25,          5.2,
      7.96,         5.4133333333,  10.1911111111, 7.5377777778,  7.5377777778,
      3.05,         5.5966666667,  5.5966666667,  8.25,          5.2,
      7.96,         5.4133333333,  10.1911111111, 7.5377777778,  7.5377777778,
      4.6,          8.4266666667,  8.4266666667,  12.4,          7.8,
      11.92,        8.0933333333,  15.2044444444, 11.2311111111, 11.2311111111,
      2.85,         5.21,          5.21,          7.65,          4.8,
      7.32,         4.96,          9.2933333333,  6.8533333333,  6.8533333333,
      5.85,         10.6766666667, 10.6766666667, 15.65,         9.8,
      14.92,        10.0933333333, 18.8711111111, 13.8977777778, 13.8977777778,
      4.55,         8.2966666667,  8.2966666667,  12.15,         7.6,
      11.56,        7.8133333333,  14.5911111111, 10.7377777778, 10.7377777778,
      4.55,         8.2966666667,  8.2966666667,  12.15,         7.6,
      11.56,        7.8133333333,  14.5911111111, 10.7377777778, 10.7377777778,
      5.7166666667, 10.3966666667, 10.3966666667, 15.1833333333, 9.4666666667,
      14.36,        9.68,          18.0133333333, 13.2266666667, 13.2266666667,
      5.7166666667, 10.3966666667, 10.3966666667, 15.1833333333, 9.4666666667,
      14.36,        9.68,          18.0133333333, 13.2266666667, 13.2266666667,
      8.2666666667, 15.0266666667, 15.0266666667, 21.9333333333, 13.6666666667,
      20.72,        13.96,         25.96,         19.0533333333, 19.0533333333,
      4.85,         8.81,          8.81,          12.85,         8.,
      12.12,        8.16,          15.16,         11.12,         11.12,
      9.5166666667, 17.2766666667, 17.2766666667, 25.1833333333, 15.6666666667,
      23.72,        15.96,         29.6266666667, 21.72,         21.72,
      7.2166666667, 13.0966666667, 13.0966666667, 19.0833333333, 11.8666666667,
      17.96,        12.08,         22.4133333333, 16.4266666667, 16.4266666667,
      7.2166666667, 13.0966666667, 13.0966666667, 19.0833333333, 11.8666666667,
      17.96,        12.08,         22.4133333333, 16.4266666667, 16.4266666667};
  const std::array<int, 4> in_shape = {{3, 7, 10, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID3x7x10x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.04, 0.04, 0.12, 0.12, 0.24, 0.2,  0.2,  0.12, 0.12, 0.,   0.04, 0.04,
      0.12, 0.12, 0.24, 0.2,  0.2,  0.12, 0.12, 0.,   0.2,  0.2,  0.48, 0.48,
      0.84, 0.64, 0.64, 0.36, 0.36, 0.,   0.2,  0.2,  0.48, 0.48, 0.84, 0.64,
      0.64, 0.36, 0.36, 0.,   0.2,  0.2,  0.48, 0.48, 0.84, 0.64, 0.64, 0.36,
      0.36, 0.,   0.16, 0.16, 0.36, 0.36, 0.6,  0.44, 0.44, 0.24, 0.24, 0.,
      0.16, 0.16, 0.36, 0.36, 0.6,  0.44, 0.44, 0.24, 0.24, 0.,   0.28, 0.28,
      0.6,  0.6,  0.96, 0.68, 0.68, 0.36, 0.36, 0.,   0.28, 0.28, 0.6,  0.6,
      0.96, 0.68, 0.68, 0.36, 0.36, 0.,   0.68, 0.68, 1.44, 1.44, 2.28, 1.6,
      1.6,  0.84, 0.84, 0.,   0.68, 0.68, 1.44, 1.44, 2.28, 1.6,  1.6,  0.84,
      0.84, 0.,   0.68, 0.68, 1.44, 1.44, 2.28, 1.6,  1.6,  0.84, 0.84, 0.,
      0.4,  0.4,  0.84, 0.84, 1.32, 0.92, 0.92, 0.48, 0.48, 0.,   0.4,  0.4,
      0.84, 0.84, 1.32, 0.92, 0.92, 0.48, 0.48, 0.,   0.52, 0.52, 1.08, 1.08,
      1.68, 1.16, 1.16, 0.6,  0.6,  0.,   0.52, 0.52, 1.08, 1.08, 1.68, 1.16,
      1.16, 0.6,  0.6,  0.,   1.16, 1.16, 2.4,  2.4,  3.72, 2.56, 2.56, 1.32,
      1.32, 0.,   1.16, 1.16, 2.4,  2.4,  3.72, 2.56, 2.56, 1.32, 1.32, 0.,
      1.16, 1.16, 2.4,  2.4,  3.72, 2.56, 2.56, 1.32, 1.32, 0.,   0.64, 0.64,
      1.32, 1.32, 2.04, 1.4,  1.4,  0.72, 0.72, 0.,   0.64, 0.64, 1.32, 1.32,
      2.04, 1.4,  1.4,  0.72, 0.72, 0.,
  };
  const std::array<int, 4> in_shape = {{3, 7, 10, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME3x7x10x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.6333333333,  0.7666666667,  1.3533333333,  1.5933333333,
      1.3533333333,  1.5933333333,  2.2866666667,  2.6333333333,
      1.6533333333,  1.8666666667,  2.8,           3.12,
      2.08,          2.2933333333,  4.3466666667,  4.7377777778,
      3.4133333333,  3.6977777778,  3.4133333333,  3.6977777778,
      0.6333333333,  0.7666666667,  1.3533333333,  1.5933333333,
      1.3533333333,  1.5933333333,  2.2866666667,  2.6333333333,
      1.6533333333,  1.8666666667,  2.8,           3.12,
      2.08,          2.2933333333,  4.3466666667,  4.7377777778,
      3.4133333333,  3.6977777778,  3.4133333333,  3.6977777778,
      1.6833333333,  1.8666666667,  3.3233333333,  3.6533333333,
      3.3233333333,  3.6533333333,  5.2566666667,  5.7333333333,
      3.5733333333,  3.8666666667,  5.8,           6.24,
      4.16,          4.4533333333,  8.36,          8.8977777778,
      6.4266666667,  6.8177777778,  6.4266666667,  6.8177777778,
      1.6,           1.7,           3.04,          3.22,
      3.04,          3.22,          4.64,          4.9,
      3.04,          3.2,           4.8,           5.04,
      3.36,          3.52,          6.56,          6.8533333333,
      4.96,          5.1733333333,  4.96,          5.1733333333,
      4.1833333333,  4.3666666667,  7.8233333333,  8.1533333333,
      7.8233333333,  8.1533333333,  11.7566666667, 12.2333333333,
      7.5733333333,  7.8666666667,  11.8,          12.24,
      8.16,          8.4533333333,  15.6933333333, 16.2311111111,
      11.76,         12.1511111111, 11.76,         12.1511111111,
      3.6333333333,  3.7666666667,  6.7533333333,  6.9933333333,
      6.7533333333,  6.9933333333,  10.0866666667, 10.4333333333,
      6.4533333333,  6.6666666667,  10.,           10.32,
      6.88,          7.0933333333,  13.1466666667, 13.5377777778,
      9.8133333333,  10.0977777778, 9.8133333333,  10.0977777778,
      3.6333333333,  3.7666666667,  6.7533333333,  6.9933333333,
      6.7533333333,  6.9933333333,  10.0866666667, 10.4333333333,
      6.4533333333,  6.6666666667,  10.,           10.32,
      6.88,          7.0933333333,  13.1466666667, 13.5377777778,
      9.8133333333,  10.0977777778, 9.8133333333,  10.0977777778,
      5.9666666667,  6.1,           10.9533333333, 11.1933333333,
      10.9533333333, 11.1933333333, 16.1533333333, 16.5,
      10.1866666667, 10.4,          15.6,          15.92,
      10.6133333333, 10.8266666667, 19.9911111111, 20.3822222222,
      14.7911111111, 15.0755555556, 14.7911111111, 15.0755555556,
      5.9666666667,  6.1,           10.9533333333, 11.1933333333,
      10.9533333333, 11.1933333333, 16.1533333333, 16.5,
      10.1866666667, 10.4,          15.6,          15.92,
      10.6133333333, 10.8266666667, 19.9911111111, 20.3822222222,
      14.7911111111, 15.0755555556, 14.7911111111, 15.0755555556,
      9.0166666667,  9.2,           16.5233333333, 16.8533333333,
      16.5233333333, 16.8533333333, 24.3233333333, 24.8,
      15.3066666667, 15.6,          23.4,          23.84,
      15.8933333333, 16.1866666667, 29.8711111111, 30.4088888889,
      22.0711111111, 22.4622222222, 22.0711111111, 22.4622222222,
      5.6,           5.7,           10.24,         10.42,
      10.24,         10.42,         15.04,         15.3,
      9.44,          9.6,           14.4,          14.64,
      9.76,          9.92,          18.2933333333, 18.5866666667,
      13.4933333333, 13.7066666667, 13.4933333333, 13.7066666667,
      11.5166666667, 11.7,          21.0233333333, 21.3533333333,
      21.0233333333, 21.3533333333, 30.8233333333, 31.3,
      19.3066666667, 19.6,          29.4,          29.84,
      19.8933333333, 20.1866666667, 37.2044444444, 37.7422222222,
      27.4044444444, 27.7955555556, 27.4044444444, 27.7955555556,
      8.9666666667,  9.1,           16.3533333333, 16.5933333333,
      16.3533333333, 16.5933333333, 23.9533333333, 24.3,
      14.9866666667, 15.2,          22.8,          23.12,
      15.4133333333, 15.6266666667, 28.7911111111, 29.1822222222,
      21.1911111111, 21.4755555556, 21.1911111111, 21.4755555556,
      8.9666666667,  9.1,           16.3533333333, 16.5933333333,
      16.3533333333, 16.5933333333, 23.9533333333, 24.3,
      14.9866666667, 15.2,          22.8,          23.12,
      15.4133333333, 15.6266666667, 28.7911111111, 29.1822222222,
      21.1911111111, 21.4755555556, 21.1911111111, 21.4755555556,
      11.3,          11.4333333333, 20.5533333333, 20.7933333333,
      20.5533333333, 20.7933333333, 30.02,         30.3666666667,
      18.72,         18.9333333333, 28.4,          28.72,
      19.1466666667, 19.36,         35.6355555556, 36.0266666667,
      26.1688888889, 26.4533333333, 26.1688888889, 26.4533333333,
      11.3,          11.4333333333, 20.5533333333, 20.7933333333,
      20.5533333333, 20.7933333333, 30.02,         30.3666666667,
      18.72,         18.9333333333, 28.4,          28.72,
      19.1466666667, 19.36,         35.6355555556, 36.0266666667,
      26.1688888889, 26.4533333333, 26.1688888889, 26.4533333333,
      16.35,         16.5333333333, 29.7233333333, 30.0533333333,
      29.7233333333, 30.0533333333, 43.39,         43.8666666667,
      27.04,         27.3333333333, 41.,           41.44,
      27.6266666667, 27.92,         51.3822222222, 51.92,
      37.7155555556, 38.1066666667, 37.7155555556, 38.1066666667,
      9.6,           9.7,           17.44,         17.62,
      17.44,         17.62,         25.44,         25.7,
      15.84,         16.,           24.,           24.24,
      16.16,         16.32,         30.0266666667, 30.32,
      22.0266666667, 22.24,         22.0266666667, 22.24,
      18.85,         19.0333333333, 34.2233333333, 34.5533333333,
      34.2233333333, 34.5533333333, 49.89,         50.3666666667,
      31.04,         31.3333333333, 47.,           47.44,
      31.6266666667, 31.92,         58.7155555556, 59.2533333333,
      43.0488888889, 43.44,         43.0488888889, 43.44,
      14.3,          14.4333333333, 25.9533333333, 26.1933333333,
      25.9533333333, 26.1933333333, 37.82,         38.1666666667,
      23.52,         23.7333333333, 35.6,          35.92,
      23.9466666667, 24.16,         44.4355555556, 44.8266666667,
      32.5688888889, 32.8533333333, 32.5688888889, 32.8533333333,
      14.3,          14.4333333333, 25.9533333333, 26.1933333333,
      25.9533333333, 26.1933333333, 37.82,         38.1666666667,
      23.52,         23.7333333333, 35.6,          35.92,
      23.9466666667, 24.16,         44.4355555556, 44.8266666667,
      32.5688888889, 32.8533333333, 32.5688888889, 32.8533333333};
  const std::array<int, 4> in_shape = {{3, 7, 10, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID3x7x10x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.04, 0.08, 0.04, 0.08, 0.16, 0.24, 0.16, 0.24, 0.36, 0.48, 0.32, 0.4,
      0.32, 0.4,  0.2,  0.24, 0.2,  0.24, 0.,   0.,   0.04, 0.08, 0.04, 0.08,
      0.16, 0.24, 0.16, 0.24, 0.36, 0.48, 0.32, 0.4,  0.32, 0.4,  0.2,  0.24,
      0.2,  0.24, 0.,   0.,   0.32, 0.4,  0.32, 0.4,  0.8,  0.96, 0.8,  0.96,
      1.44, 1.68, 1.12, 1.28, 1.12, 1.28, 0.64, 0.72, 0.64, 0.72, 0.,   0.,
      0.32, 0.4,  0.32, 0.4,  0.8,  0.96, 0.8,  0.96, 1.44, 1.68, 1.12, 1.28,
      1.12, 1.28, 0.64, 0.72, 0.64, 0.72, 0.,   0.,   0.32, 0.4,  0.32, 0.4,
      0.8,  0.96, 0.8,  0.96, 1.44, 1.68, 1.12, 1.28, 1.12, 1.28, 0.64, 0.72,
      0.64, 0.72, 0.,   0.,   0.28, 0.32, 0.28, 0.32, 0.64, 0.72, 0.64, 0.72,
      1.08, 1.2,  0.8,  0.88, 0.8,  0.88, 0.44, 0.48, 0.44, 0.48, 0.,   0.,
      0.28, 0.32, 0.28, 0.32, 0.64, 0.72, 0.64, 0.72, 1.08, 1.2,  0.8,  0.88,
      0.8,  0.88, 0.44, 0.48, 0.44, 0.48, 0.,   0.,   0.52, 0.56, 0.52, 0.56,
      1.12, 1.2,  1.12, 1.2,  1.8,  1.92, 1.28, 1.36, 1.28, 1.36, 0.68, 0.72,
      0.68, 0.72, 0.,   0.,   0.52, 0.56, 0.52, 0.56, 1.12, 1.2,  1.12, 1.2,
      1.8,  1.92, 1.28, 1.36, 1.28, 1.36, 0.68, 0.72, 0.68, 0.72, 0.,   0.,
      1.28, 1.36, 1.28, 1.36, 2.72, 2.88, 2.72, 2.88, 4.32, 4.56, 3.04, 3.2,
      3.04, 3.2,  1.6,  1.68, 1.6,  1.68, 0.,   0.,   1.28, 1.36, 1.28, 1.36,
      2.72, 2.88, 2.72, 2.88, 4.32, 4.56, 3.04, 3.2,  3.04, 3.2,  1.6,  1.68,
      1.6,  1.68, 0.,   0.,   1.28, 1.36, 1.28, 1.36, 2.72, 2.88, 2.72, 2.88,
      4.32, 4.56, 3.04, 3.2,  3.04, 3.2,  1.6,  1.68, 1.6,  1.68, 0.,   0.,
      0.76, 0.8,  0.76, 0.8,  1.6,  1.68, 1.6,  1.68, 2.52, 2.64, 1.76, 1.84,
      1.76, 1.84, 0.92, 0.96, 0.92, 0.96, 0.,   0.,   0.76, 0.8,  0.76, 0.8,
      1.6,  1.68, 1.6,  1.68, 2.52, 2.64, 1.76, 1.84, 1.76, 1.84, 0.92, 0.96,
      0.92, 0.96, 0.,   0.,   1.,   1.04, 1.,   1.04, 2.08, 2.16, 2.08, 2.16,
      3.24, 3.36, 2.24, 2.32, 2.24, 2.32, 1.16, 1.2,  1.16, 1.2,  0.,   0.,
      1.,   1.04, 1.,   1.04, 2.08, 2.16, 2.08, 2.16, 3.24, 3.36, 2.24, 2.32,
      2.24, 2.32, 1.16, 1.2,  1.16, 1.2,  0.,   0.,   2.24, 2.32, 2.24, 2.32,
      4.64, 4.8,  4.64, 4.8,  7.2,  7.44, 4.96, 5.12, 4.96, 5.12, 2.56, 2.64,
      2.56, 2.64, 0.,   0.,   2.24, 2.32, 2.24, 2.32, 4.64, 4.8,  4.64, 4.8,
      7.2,  7.44, 4.96, 5.12, 4.96, 5.12, 2.56, 2.64, 2.56, 2.64, 0.,   0.,
      2.24, 2.32, 2.24, 2.32, 4.64, 4.8,  4.64, 4.8,  7.2,  7.44, 4.96, 5.12,
      4.96, 5.12, 2.56, 2.64, 2.56, 2.64, 0.,   0.,   1.24, 1.28, 1.24, 1.28,
      2.56, 2.64, 2.56, 2.64, 3.96, 4.08, 2.72, 2.8,  2.72, 2.8,  1.4,  1.44,
      1.4,  1.44, 0.,   0.,   1.24, 1.28, 1.24, 1.28, 2.56, 2.64, 2.56, 2.64,
      3.96, 4.08, 2.72, 2.8,  2.72, 2.8,  1.4,  1.44, 1.4,  1.44, 0.,   0.,
  };
  const std::array<int, 4> in_shape = {{3, 7, 10, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME3x7x10x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {1.1333333333,
                                         1.2666666667,
                                         1.4,
                                         1.5333333333,
                                         2.4666666667,
                                         2.7066666667,
                                         2.9466666667,
                                         3.1866666667,
                                         2.4666666667,
                                         2.7066666667,
                                         2.9466666667,
                                         3.1866666667,
                                         4.2266666667,
                                         4.5733333333,
                                         4.92,
                                         5.2666666667,
                                         3.0933333333,
                                         3.3066666667,
                                         3.52,
                                         3.7333333333,
                                         5.28,
                                         5.6,
                                         5.92,
                                         6.24,
                                         3.9466666667,
                                         4.16,
                                         4.3733333333,
                                         4.5866666667,
                                         8.3022222222,
                                         8.6933333333,
                                         9.0844444444,
                                         9.4755555556,
                                         6.5422222222,
                                         6.8266666667,
                                         7.1111111111,
                                         7.3955555556,
                                         6.5422222222,
                                         6.8266666667,
                                         7.1111111111,
                                         7.3955555556,
                                         1.1333333333,
                                         1.2666666667,
                                         1.4,
                                         1.5333333333,
                                         2.4666666667,
                                         2.7066666667,
                                         2.9466666667,
                                         3.1866666667,
                                         2.4666666667,
                                         2.7066666667,
                                         2.9466666667,
                                         3.1866666667,
                                         4.2266666667,
                                         4.5733333333,
                                         4.92,
                                         5.2666666667,
                                         3.0933333333,
                                         3.3066666667,
                                         3.52,
                                         3.7333333333,
                                         5.28,
                                         5.6,
                                         5.92,
                                         6.24,
                                         3.9466666667,
                                         4.16,
                                         4.3733333333,
                                         4.5866666667,
                                         8.3022222222,
                                         8.6933333333,
                                         9.0844444444,
                                         9.4755555556,
                                         6.5422222222,
                                         6.8266666667,
                                         7.1111111111,
                                         7.3955555556,
                                         6.5422222222,
                                         6.8266666667,
                                         7.1111111111,
                                         7.3955555556,
                                         3.1833333333,
                                         3.3666666667,
                                         3.55,
                                         3.7333333333,
                                         6.3166666667,
                                         6.6466666667,
                                         6.9766666667,
                                         7.3066666667,
                                         6.3166666667,
                                         6.6466666667,
                                         6.9766666667,
                                         7.3066666667,
                                         10.0366666667,
                                         10.5133333333,
                                         10.99,
                                         11.4666666667,
                                         6.8533333333,
                                         7.1466666667,
                                         7.44,
                                         7.7333333333,
                                         11.16,
                                         11.6,
                                         12.04,
                                         12.48,
                                         8.0266666667,
                                         8.32,
                                         8.6133333333,
                                         8.9066666667,
                                         16.1822222222,
                                         16.72,
                                         17.2577777778,
                                         17.7955555556,
                                         12.4622222222,
                                         12.8533333333,
                                         13.2444444444,
                                         13.6355555556,
                                         12.4622222222,
                                         12.8533333333,
                                         13.2444444444,
                                         13.6355555556,
                                         3.1,
                                         3.2,
                                         3.3,
                                         3.4,
                                         5.9,
                                         6.08,
                                         6.26,
                                         6.44,
                                         5.9,
                                         6.08,
                                         6.26,
                                         6.44,
                                         9.02,
                                         9.28,
                                         9.54,
                                         9.8,
                                         5.92,
                                         6.08,
                                         6.24,
                                         6.4,
                                         9.36,
                                         9.6,
                                         9.84,
                                         10.08,
                                         6.56,
                                         6.72,
                                         6.88,
                                         7.04,
                                         12.8266666667,
                                         13.12,
                                         13.4133333333,
                                         13.7066666667,
                                         9.7066666667,
                                         9.92,
                                         10.1333333333,
                                         10.3466666667,
                                         9.7066666667,
                                         9.92,
                                         10.1333333333,
                                         10.3466666667,
                                         8.1833333333,
                                         8.3666666667,
                                         8.55,
                                         8.7333333333,
                                         15.3166666667,
                                         15.6466666667,
                                         15.9766666667,
                                         16.3066666667,
                                         15.3166666667,
                                         15.6466666667,
                                         15.9766666667,
                                         16.3066666667,
                                         23.0366666667,
                                         23.5133333333,
                                         23.99,
                                         24.4666666667,
                                         14.8533333333,
                                         15.1466666667,
                                         15.44,
                                         15.7333333333,
                                         23.16,
                                         23.6,
                                         24.04,
                                         24.48,
                                         16.0266666667,
                                         16.32,
                                         16.6133333333,
                                         16.9066666667,
                                         30.8488888889,
                                         31.3866666667,
                                         31.9244444444,
                                         32.4622222222,
                                         23.1288888889,
                                         23.52,
                                         23.9111111111,
                                         24.3022222222,
                                         23.1288888889,
                                         23.52,
                                         23.9111111111,
                                         24.3022222222,
                                         7.1333333333,
                                         7.2666666667,
                                         7.4,
                                         7.5333333333,
                                         13.2666666667,
                                         13.5066666667,
                                         13.7466666667,
                                         13.9866666667,
                                         13.2666666667,
                                         13.5066666667,
                                         13.7466666667,
                                         13.9866666667,
                                         19.8266666667,
                                         20.1733333333,
                                         20.52,
                                         20.8666666667,
                                         12.6933333333,
                                         12.9066666667,
                                         13.12,
                                         13.3333333333,
                                         19.68,
                                         20.,
                                         20.32,
                                         20.64,
                                         13.5466666667,
                                         13.76,
                                         13.9733333333,
                                         14.1866666667,
                                         25.9022222222,
                                         26.2933333333,
                                         26.6844444444,
                                         27.0755555556,
                                         19.3422222222,
                                         19.6266666667,
                                         19.9111111111,
                                         20.1955555556,
                                         19.3422222222,
                                         19.6266666667,
                                         19.9111111111,
                                         20.1955555556,
                                         7.1333333333,
                                         7.2666666667,
                                         7.4,
                                         7.5333333333,
                                         13.2666666667,
                                         13.5066666667,
                                         13.7466666667,
                                         13.9866666667,
                                         13.2666666667,
                                         13.5066666667,
                                         13.7466666667,
                                         13.9866666667,
                                         19.8266666667,
                                         20.1733333333,
                                         20.52,
                                         20.8666666667,
                                         12.6933333333,
                                         12.9066666667,
                                         13.12,
                                         13.3333333333,
                                         19.68,
                                         20.,
                                         20.32,
                                         20.64,
                                         13.5466666667,
                                         13.76,
                                         13.9733333333,
                                         14.1866666667,
                                         25.9022222222,
                                         26.2933333333,
                                         26.6844444444,
                                         27.0755555556,
                                         19.3422222222,
                                         19.6266666667,
                                         19.9111111111,
                                         20.1955555556,
                                         19.3422222222,
                                         19.6266666667,
                                         19.9111111111,
                                         20.1955555556,
                                         11.8,
                                         11.9333333333,
                                         12.0666666667,
                                         12.2,
                                         21.6666666667,
                                         21.9066666667,
                                         22.1466666667,
                                         22.3866666667,
                                         21.6666666667,
                                         21.9066666667,
                                         22.1466666667,
                                         22.3866666667,
                                         31.96,
                                         32.3066666667,
                                         32.6533333333,
                                         33.,
                                         20.16,
                                         20.3733333333,
                                         20.5866666667,
                                         20.8,
                                         30.88,
                                         31.2,
                                         31.52,
                                         31.84,
                                         21.0133333333,
                                         21.2266666667,
                                         21.44,
                                         21.6533333333,
                                         39.5911111111,
                                         39.9822222222,
                                         40.3733333333,
                                         40.7644444444,
                                         29.2977777778,
                                         29.5822222222,
                                         29.8666666667,
                                         30.1511111111,
                                         29.2977777778,
                                         29.5822222222,
                                         29.8666666667,
                                         30.1511111111,
                                         11.8,
                                         11.9333333333,
                                         12.0666666667,
                                         12.2,
                                         21.6666666667,
                                         21.9066666667,
                                         22.1466666667,
                                         22.3866666667,
                                         21.6666666667,
                                         21.9066666667,
                                         22.1466666667,
                                         22.3866666667,
                                         31.96,
                                         32.3066666667,
                                         32.6533333333,
                                         33.,
                                         20.16,
                                         20.3733333333,
                                         20.5866666667,
                                         20.8,
                                         30.88,
                                         31.2,
                                         31.52,
                                         31.84,
                                         21.0133333333,
                                         21.2266666667,
                                         21.44,
                                         21.6533333333,
                                         39.5911111111,
                                         39.9822222222,
                                         40.3733333333,
                                         40.7644444444,
                                         29.2977777778,
                                         29.5822222222,
                                         29.8666666667,
                                         30.1511111111,
                                         29.2977777778,
                                         29.5822222222,
                                         29.8666666667,
                                         30.1511111111,
                                         17.85,
                                         18.0333333333,
                                         18.2166666667,
                                         18.4,
                                         32.7166666667,
                                         33.0466666667,
                                         33.3766666667,
                                         33.7066666667,
                                         32.7166666667,
                                         33.0466666667,
                                         33.3766666667,
                                         33.7066666667,
                                         48.17,
                                         48.6466666667,
                                         49.1233333333,
                                         49.6,
                                         30.32,
                                         30.6133333333,
                                         30.9066666667,
                                         31.2,
                                         46.36,
                                         46.8,
                                         47.24,
                                         47.68,
                                         31.4933333333,
                                         31.7866666667,
                                         32.08,
                                         32.3733333333,
                                         59.2044444444,
                                         59.7422222222,
                                         60.28,
                                         60.8177777778,
                                         43.7511111111,
                                         44.1422222222,
                                         44.5333333333,
                                         44.9244444444,
                                         43.7511111111,
                                         44.1422222222,
                                         44.5333333333,
                                         44.9244444444,
                                         11.1,
                                         11.2,
                                         11.3,
                                         11.4,
                                         20.3,
                                         20.48,
                                         20.66,
                                         20.84,
                                         20.3,
                                         20.48,
                                         20.66,
                                         20.84,
                                         29.82,
                                         30.08,
                                         30.34,
                                         30.6,
                                         18.72,
                                         18.88,
                                         19.04,
                                         19.2,
                                         28.56,
                                         28.8,
                                         29.04,
                                         29.28,
                                         19.36,
                                         19.52,
                                         19.68,
                                         19.84,
                                         36.2933333333,
                                         36.5866666667,
                                         36.88,
                                         37.1733333333,
                                         26.7733333333,
                                         26.9866666667,
                                         27.2,
                                         27.4133333333,
                                         26.7733333333,
                                         26.9866666667,
                                         27.2,
                                         27.4133333333,
                                         22.85,
                                         23.0333333333,
                                         23.2166666667,
                                         23.4,
                                         41.7166666667,
                                         42.0466666667,
                                         42.3766666667,
                                         42.7066666667,
                                         41.7166666667,
                                         42.0466666667,
                                         42.3766666667,
                                         42.7066666667,
                                         61.17,
                                         61.6466666667,
                                         62.1233333333,
                                         62.6,
                                         38.32,
                                         38.6133333333,
                                         38.9066666667,
                                         39.2,
                                         58.36,
                                         58.8,
                                         59.24,
                                         59.68,
                                         39.4933333333,
                                         39.7866666667,
                                         40.08,
                                         40.3733333333,
                                         73.8711111111,
                                         74.4088888889,
                                         74.9466666667,
                                         75.4844444444,
                                         54.4177777778,
                                         54.8088888889,
                                         55.2,
                                         55.5911111111,
                                         54.4177777778,
                                         54.8088888889,
                                         55.2,
                                         55.5911111111,
                                         17.8,
                                         17.9333333333,
                                         18.0666666667,
                                         18.2,
                                         32.4666666667,
                                         32.7066666667,
                                         32.9466666667,
                                         33.1866666667,
                                         32.4666666667,
                                         32.7066666667,
                                         32.9466666667,
                                         33.1866666667,
                                         47.56,
                                         47.9066666667,
                                         48.2533333333,
                                         48.6,
                                         29.76,
                                         29.9733333333,
                                         30.1866666667,
                                         30.4,
                                         45.28,
                                         45.6,
                                         45.92,
                                         46.24,
                                         30.6133333333,
                                         30.8266666667,
                                         31.04,
                                         31.2533333333,
                                         57.1911111111,
                                         57.5822222222,
                                         57.9733333333,
                                         58.3644444444,
                                         42.0977777778,
                                         42.3822222222,
                                         42.6666666667,
                                         42.9511111111,
                                         42.0977777778,
                                         42.3822222222,
                                         42.6666666667,
                                         42.9511111111,
                                         17.8,
                                         17.9333333333,
                                         18.0666666667,
                                         18.2,
                                         32.4666666667,
                                         32.7066666667,
                                         32.9466666667,
                                         33.1866666667,
                                         32.4666666667,
                                         32.7066666667,
                                         32.9466666667,
                                         33.1866666667,
                                         47.56,
                                         47.9066666667,
                                         48.2533333333,
                                         48.6,
                                         29.76,
                                         29.9733333333,
                                         30.1866666667,
                                         30.4,
                                         45.28,
                                         45.6,
                                         45.92,
                                         46.24,
                                         30.6133333333,
                                         30.8266666667,
                                         31.04,
                                         31.2533333333,
                                         57.1911111111,
                                         57.5822222222,
                                         57.9733333333,
                                         58.3644444444,
                                         42.0977777778,
                                         42.3822222222,
                                         42.6666666667,
                                         42.9511111111,
                                         42.0977777778,
                                         42.3822222222,
                                         42.6666666667,
                                         42.9511111111,
                                         22.4666666667,
                                         22.6,
                                         22.7333333333,
                                         22.8666666667,
                                         40.8666666667,
                                         41.1066666667,
                                         41.3466666667,
                                         41.5866666667,
                                         40.8666666667,
                                         41.1066666667,
                                         41.3466666667,
                                         41.5866666667,
                                         59.6933333333,
                                         60.04,
                                         60.3866666667,
                                         60.7333333333,
                                         37.2266666667,
                                         37.44,
                                         37.6533333333,
                                         37.8666666667,
                                         56.48,
                                         56.8,
                                         57.12,
                                         57.44,
                                         38.08,
                                         38.2933333333,
                                         38.5066666667,
                                         38.72,
                                         70.88,
                                         71.2711111111,
                                         71.6622222222,
                                         72.0533333333,
                                         52.0533333333,
                                         52.3377777778,
                                         52.6222222222,
                                         52.9066666667,
                                         52.0533333333,
                                         52.3377777778,
                                         52.6222222222,
                                         52.9066666667,
                                         22.4666666667,
                                         22.6,
                                         22.7333333333,
                                         22.8666666667,
                                         40.8666666667,
                                         41.1066666667,
                                         41.3466666667,
                                         41.5866666667,
                                         40.8666666667,
                                         41.1066666667,
                                         41.3466666667,
                                         41.5866666667,
                                         59.6933333333,
                                         60.04,
                                         60.3866666667,
                                         60.7333333333,
                                         37.2266666667,
                                         37.44,
                                         37.6533333333,
                                         37.8666666667,
                                         56.48,
                                         56.8,
                                         57.12,
                                         57.44,
                                         38.08,
                                         38.2933333333,
                                         38.5066666667,
                                         38.72,
                                         70.88,
                                         71.2711111111,
                                         71.6622222222,
                                         72.0533333333,
                                         52.0533333333,
                                         52.3377777778,
                                         52.6222222222,
                                         52.9066666667,
                                         52.0533333333,
                                         52.3377777778,
                                         52.6222222222,
                                         52.9066666667,
                                         32.5166666667,
                                         32.7,
                                         32.8833333333,
                                         33.0666666667,
                                         59.1166666667,
                                         59.4466666667,
                                         59.7766666667,
                                         60.1066666667,
                                         59.1166666667,
                                         59.4466666667,
                                         59.7766666667,
                                         60.1066666667,
                                         86.3033333333,
                                         86.78,
                                         87.2566666667,
                                         87.7333333333,
                                         53.7866666667,
                                         54.08,
                                         54.3733333333,
                                         54.6666666667,
                                         81.56,
                                         82.,
                                         82.44,
                                         82.88,
                                         54.96,
                                         55.2533333333,
                                         55.5466666667,
                                         55.84,
                                         102.2266666667,
                                         102.7644444444,
                                         103.3022222222,
                                         103.84,
                                         75.04,
                                         75.4311111111,
                                         75.8222222222,
                                         76.2133333333,
                                         75.04,
                                         75.4311111111,
                                         75.8222222222,
                                         76.2133333333,
                                         19.1,
                                         19.2,
                                         19.3,
                                         19.4,
                                         34.7,
                                         34.88,
                                         35.06,
                                         35.24,
                                         34.7,
                                         34.88,
                                         35.06,
                                         35.24,
                                         50.62,
                                         50.88,
                                         51.14,
                                         51.4,
                                         31.52,
                                         31.68,
                                         31.84,
                                         32.,
                                         47.76,
                                         48.,
                                         48.24,
                                         48.48,
                                         32.16,
                                         32.32,
                                         32.48,
                                         32.64,
                                         59.76,
                                         60.0533333333,
                                         60.3466666667,
                                         60.64,
                                         43.84,
                                         44.0533333333,
                                         44.2666666667,
                                         44.48,
                                         43.84,
                                         44.0533333333,
                                         44.2666666667,
                                         44.48,
                                         37.5166666667,
                                         37.7,
                                         37.8833333333,
                                         38.0666666667,
                                         68.1166666667,
                                         68.4466666667,
                                         68.7766666667,
                                         69.1066666667,
                                         68.1166666667,
                                         68.4466666667,
                                         68.7766666667,
                                         69.1066666667,
                                         99.3033333333,
                                         99.78,
                                         100.2566666667,
                                         100.7333333333,
                                         61.7866666667,
                                         62.08,
                                         62.3733333333,
                                         62.6666666667,
                                         93.56,
                                         94.,
                                         94.44,
                                         94.88,
                                         62.96,
                                         63.2533333333,
                                         63.5466666667,
                                         63.84,
                                         116.8933333333,
                                         117.4311111111,
                                         117.9688888889,
                                         118.5066666667,
                                         85.7066666667,
                                         86.0977777778,
                                         86.4888888889,
                                         86.88,
                                         85.7066666667,
                                         86.0977777778,
                                         86.4888888889,
                                         86.88,
                                         28.4666666667,
                                         28.6,
                                         28.7333333333,
                                         28.8666666667,
                                         51.6666666667,
                                         51.9066666667,
                                         52.1466666667,
                                         52.3866666667,
                                         51.6666666667,
                                         51.9066666667,
                                         52.1466666667,
                                         52.3866666667,
                                         75.2933333333,
                                         75.64,
                                         75.9866666667,
                                         76.3333333333,
                                         46.8266666667,
                                         47.04,
                                         47.2533333333,
                                         47.4666666667,
                                         70.88,
                                         71.2,
                                         71.52,
                                         71.84,
                                         47.68,
                                         47.8933333333,
                                         48.1066666667,
                                         48.32,
                                         88.48,
                                         88.8711111111,
                                         89.2622222222,
                                         89.6533333333,
                                         64.8533333333,
                                         65.1377777778,
                                         65.4222222222,
                                         65.7066666667,
                                         64.8533333333,
                                         65.1377777778,
                                         65.4222222222,
                                         65.7066666667,
                                         28.4666666667,
                                         28.6,
                                         28.7333333333,
                                         28.8666666667,
                                         51.6666666667,
                                         51.9066666667,
                                         52.1466666667,
                                         52.3866666667,
                                         51.6666666667,
                                         51.9066666667,
                                         52.1466666667,
                                         52.3866666667,
                                         75.2933333333,
                                         75.64,
                                         75.9866666667,
                                         76.3333333333,
                                         46.8266666667,
                                         47.04,
                                         47.2533333333,
                                         47.4666666667,
                                         70.88,
                                         71.2,
                                         71.52,
                                         71.84,
                                         47.68,
                                         47.8933333333,
                                         48.1066666667,
                                         48.32,
                                         88.48,
                                         88.8711111111,
                                         89.2622222222,
                                         89.6533333333,
                                         64.8533333333,
                                         65.1377777778,
                                         65.4222222222,
                                         65.7066666667,
                                         64.8533333333,
                                         65.1377777778,
                                         65.4222222222,
                                         65.7066666667};
  const std::array<int, 4> in_shape = {{3, 7, 10, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID3x7x10x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.04, 0.08,  0.12,  0.16,  0.04, 0.08,  0.12,  0.16,  0.24, 0.32,  0.4,
      0.48, 0.24,  0.32,  0.4,   0.48, 0.6,   0.72,  0.84,  0.96, 0.56,  0.64,
      0.72, 0.8,   0.56,  0.64,  0.72, 0.8,   0.36,  0.4,   0.44, 0.48,  0.36,
      0.4,  0.44,  0.48,  0.,    0.,   0.,    0.,    0.04,  0.08, 0.12,  0.16,
      0.04, 0.08,  0.12,  0.16,  0.24, 0.32,  0.4,   0.48,  0.24, 0.32,  0.4,
      0.48, 0.6,   0.72,  0.84,  0.96, 0.56,  0.64,  0.72,  0.8,  0.56,  0.64,
      0.72, 0.8,   0.36,  0.4,   0.44, 0.48,  0.36,  0.4,   0.44, 0.48,  0.,
      0.,   0.,    0.,    0.56,  0.64, 0.72,  0.8,   0.56,  0.64, 0.72,  0.8,
      1.44, 1.6,   1.76,  1.92,  1.44, 1.6,   1.76,  1.92,  2.64, 2.88,  3.12,
      3.36, 2.08,  2.24,  2.4,   2.56, 2.08,  2.24,  2.4,   2.56, 1.2,   1.28,
      1.36, 1.44,  1.2,   1.28,  1.36, 1.44,  0.,    0.,    0.,   0.,    0.56,
      0.64, 0.72,  0.8,   0.56,  0.64, 0.72,  0.8,   1.44,  1.6,  1.76,  1.92,
      1.44, 1.6,   1.76,  1.92,  2.64, 2.88,  3.12,  3.36,  2.08, 2.24,  2.4,
      2.56, 2.08,  2.24,  2.4,   2.56, 1.2,   1.28,  1.36,  1.44, 1.2,   1.28,
      1.36, 1.44,  0.,    0.,    0.,   0.,    0.56,  0.64,  0.72, 0.8,   0.56,
      0.64, 0.72,  0.8,   1.44,  1.6,  1.76,  1.92,  1.44,  1.6,  1.76,  1.92,
      2.64, 2.88,  3.12,  3.36,  2.08, 2.24,  2.4,   2.56,  2.08, 2.24,  2.4,
      2.56, 1.2,   1.28,  1.36,  1.44, 1.2,   1.28,  1.36,  1.44, 0.,    0.,
      0.,   0.,    0.52,  0.56,  0.6,  0.64,  0.52,  0.56,  0.6,  0.64,  1.2,
      1.28, 1.36,  1.44,  1.2,   1.28, 1.36,  1.44,  2.04,  2.16, 2.28,  2.4,
      1.52, 1.6,   1.68,  1.76,  1.52, 1.6,   1.68,  1.76,  0.84, 0.88,  0.92,
      0.96, 0.84,  0.88,  0.92,  0.96, 0.,    0.,    0.,    0.,   0.52,  0.56,
      0.6,  0.64,  0.52,  0.56,  0.6,  0.64,  1.2,   1.28,  1.36, 1.44,  1.2,
      1.28, 1.36,  1.44,  2.04,  2.16, 2.28,  2.4,   1.52,  1.6,  1.68,  1.76,
      1.52, 1.6,   1.68,  1.76,  0.84, 0.88,  0.92,  0.96,  0.84, 0.88,  0.92,
      0.96, 0.,    0.,    0.,    0.,   1.,    1.04,  1.08,  1.12, 1.,    1.04,
      1.08, 1.12,  2.16,  2.24,  2.32, 2.4,   2.16,  2.24,  2.32, 2.4,   3.48,
      3.6,  3.72,  3.84,  2.48,  2.56, 2.64,  2.72,  2.48,  2.56, 2.64,  2.72,
      1.32, 1.36,  1.4,   1.44,  1.32, 1.36,  1.4,   1.44,  0.,   0.,    0.,
      0.,   1.,    1.04,  1.08,  1.12, 1.,    1.04,  1.08,  1.12, 2.16,  2.24,
      2.32, 2.4,   2.16,  2.24,  2.32, 2.4,   3.48,  3.6,   3.72, 3.84,  2.48,
      2.56, 2.64,  2.72,  2.48,  2.56, 2.64,  2.72,  1.32,  1.36, 1.4,   1.44,
      1.32, 1.36,  1.4,   1.44,  0.,   0.,    0.,    0.,    2.48, 2.56,  2.64,
      2.72, 2.48,  2.56,  2.64,  2.72, 5.28,  5.44,  5.6,   5.76, 5.28,  5.44,
      5.6,  5.76,  8.4,   8.64,  8.88, 9.12,  5.92,  6.08,  6.24, 6.4,   5.92,
      6.08, 6.24,  6.4,   3.12,  3.2,  3.28,  3.36,  3.12,  3.2,  3.28,  3.36,
      0.,   0.,    0.,    0.,    2.48, 2.56,  2.64,  2.72,  2.48, 2.56,  2.64,
      2.72, 5.28,  5.44,  5.6,   5.76, 5.28,  5.44,  5.6,   5.76, 8.4,   8.64,
      8.88, 9.12,  5.92,  6.08,  6.24, 6.4,   5.92,  6.08,  6.24, 6.4,   3.12,
      3.2,  3.28,  3.36,  3.12,  3.2,  3.28,  3.36,  0.,    0.,   0.,    0.,
      2.48, 2.56,  2.64,  2.72,  2.48, 2.56,  2.64,  2.72,  5.28, 5.44,  5.6,
      5.76, 5.28,  5.44,  5.6,   5.76, 8.4,   8.64,  8.88,  9.12, 5.92,  6.08,
      6.24, 6.4,   5.92,  6.08,  6.24, 6.4,   3.12,  3.2,   3.28, 3.36,  3.12,
      3.2,  3.28,  3.36,  0.,    0.,   0.,    0.,    1.48,  1.52, 1.56,  1.6,
      1.48, 1.52,  1.56,  1.6,   3.12, 3.2,   3.28,  3.36,  3.12, 3.2,   3.28,
      3.36, 4.92,  5.04,  5.16,  5.28, 3.44,  3.52,  3.6,   3.68, 3.44,  3.52,
      3.6,  3.68,  1.8,   1.84,  1.88, 1.92,  1.8,   1.84,  1.88, 1.92,  0.,
      0.,   0.,    0.,    1.48,  1.52, 1.56,  1.6,   1.48,  1.52, 1.56,  1.6,
      3.12, 3.2,   3.28,  3.36,  3.12, 3.2,   3.28,  3.36,  4.92, 5.04,  5.16,
      5.28, 3.44,  3.52,  3.6,   3.68, 3.44,  3.52,  3.6,   3.68, 1.8,   1.84,
      1.88, 1.92,  1.8,   1.84,  1.88, 1.92,  0.,    0.,    0.,   0.,    1.96,
      2.,   2.04,  2.08,  1.96,  2.,   2.04,  2.08,  4.08,  4.16, 4.24,  4.32,
      4.08, 4.16,  4.24,  4.32,  6.36, 6.48,  6.6,   6.72,  4.4,  4.48,  4.56,
      4.64, 4.4,   4.48,  4.56,  4.64, 2.28,  2.32,  2.36,  2.4,  2.28,  2.32,
      2.36, 2.4,   0.,    0.,    0.,   0.,    1.96,  2.,    2.04, 2.08,  1.96,
      2.,   2.04,  2.08,  4.08,  4.16, 4.24,  4.32,  4.08,  4.16, 4.24,  4.32,
      6.36, 6.48,  6.6,   6.72,  4.4,  4.48,  4.56,  4.64,  4.4,  4.48,  4.56,
      4.64, 2.28,  2.32,  2.36,  2.4,  2.28,  2.32,  2.36,  2.4,  0.,    0.,
      0.,   0.,    4.4,   4.48,  4.56, 4.64,  4.4,   4.48,  4.56, 4.64,  9.12,
      9.28, 9.44,  9.6,   9.12,  9.28, 9.44,  9.6,   14.16, 14.4, 14.64, 14.88,
      9.76, 9.92,  10.08, 10.24, 9.76, 9.92,  10.08, 10.24, 5.04, 5.12,  5.2,
      5.28, 5.04,  5.12,  5.2,   5.28, 0.,    0.,    0.,    0.,   4.4,   4.48,
      4.56, 4.64,  4.4,   4.48,  4.56, 4.64,  9.12,  9.28,  9.44, 9.6,   9.12,
      9.28, 9.44,  9.6,   14.16, 14.4, 14.64, 14.88, 9.76,  9.92, 10.08, 10.24,
      9.76, 9.92,  10.08, 10.24, 5.04, 5.12,  5.2,   5.28,  5.04, 5.12,  5.2,
      5.28, 0.,    0.,    0.,    0.,   4.4,   4.48,  4.56,  4.64, 4.4,   4.48,
      4.56, 4.64,  9.12,  9.28,  9.44, 9.6,   9.12,  9.28,  9.44, 9.6,   14.16,
      14.4, 14.64, 14.88, 9.76,  9.92, 10.08, 10.24, 9.76,  9.92, 10.08, 10.24,
      5.04, 5.12,  5.2,   5.28,  5.04, 5.12,  5.2,   5.28,  0.,   0.,    0.,
      0.,   2.44,  2.48,  2.52,  2.56, 2.44,  2.48,  2.52,  2.56, 5.04,  5.12,
      5.2,  5.28,  5.04,  5.12,  5.2,  5.28,  7.8,   7.92,  8.04, 8.16,  5.36,
      5.44, 5.52,  5.6,   5.36,  5.44, 5.52,  5.6,   2.76,  2.8,  2.84,  2.88,
      2.76, 2.8,   2.84,  2.88,  0.,   0.,    0.,    0.,    2.44, 2.48,  2.52,
      2.56, 2.44,  2.48,  2.52,  2.56, 5.04,  5.12,  5.2,   5.28, 5.04,  5.12,
      5.2,  5.28,  7.8,   7.92,  8.04, 8.16,  5.36,  5.44,  5.52, 5.6,   5.36,
      5.44, 5.52,  5.6,   2.76,  2.8,  2.84,  2.88,  2.76,  2.8,  2.84,  2.88,
      0.,   0.,    0.,    0.,
  };
  const std::array<int, 4> in_shape = {{3, 7, 10, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME3x8x7x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.1833333333,  0.1833333333,  0.3333333333,  0.25,          0.5833333333,
      0.4833333333,  0.4833333333,  0.7566666667,  0.7566666667,  1.1866666667,
      0.77,          1.6366666667,  1.2966666667,  1.2966666667,  0.7566666667,
      0.7566666667,  1.1866666667,  0.77,          1.6366666667,  1.2966666667,
      1.2966666667,  1.7566666667,  1.7566666667,  2.6266666667,  1.61,
      3.2766666667,  2.5366666667,  2.5366666667,  1.5733333333,  1.5733333333,
      2.2933333333,  1.36,          2.6933333333,  2.0533333333,  2.0533333333,
      3.9511111111,  3.9511111111,  5.6711111111,  3.2933333333,  6.4044444444,
      4.8311111111,  4.8311111111,  3.3777777778,  3.3777777778,  4.8177777778,
      2.7733333333,  5.3511111111,  4.0177777778,  4.0177777778,  3.3777777778,
      3.3777777778,  4.8177777778,  2.7733333333,  5.3511111111,  4.0177777778,
      4.0177777778,  2.3166666667,  2.3166666667,  3.2666666667,  1.85,
      3.5166666667,  2.6166666667,  2.6166666667,  4.5966666667,  4.5966666667,
      6.4666666667,  3.65,          6.9166666667,  5.1366666667,  5.1366666667,
      4.5966666667,  4.5966666667,  6.4666666667,  3.65,          6.9166666667,
      5.1366666667,  5.1366666667,  7.3033333333,  7.3033333333,  10.2533333333,
      5.77,          10.9033333333, 8.0833333333,  8.0833333333,  4.9866666667,
      4.9866666667,  6.9866666667,  3.92,          7.3866666667,  5.4666666667,
      5.4666666667,  10.2088888889, 10.2088888889, 14.2755555556, 7.9866666667,
      15.0088888889, 11.0888888889, 11.0888888889, 7.9288888889,  7.9288888889,
      11.0755555556, 6.1866666667,  11.6088888889, 8.5688888889,  8.5688888889,
      7.9288888889,  7.9288888889,  11.0755555556, 6.1866666667,  11.6088888889,
      8.5688888889,  8.5688888889,  4.45,          4.45,          6.2,
      3.45,          6.45,          4.75,          4.75,          8.4366666667,
      8.4366666667,  11.7466666667, 6.53,          12.1966666667, 8.9766666667,
      8.9766666667,  8.4366666667,  8.4366666667,  11.7466666667, 6.53,
      12.1966666667, 8.9766666667,  8.9766666667,  12.85,         12.85,
      17.88,         9.93,          18.53,         13.63,         13.63,
      8.4,           8.4,           11.68,         6.48,          12.08,
      8.88,          8.88,          16.4666666667, 16.4666666667, 22.88,
      12.68,         23.6133333333, 17.3466666667, 17.3466666667, 12.48,
      12.48,         17.3333333333, 9.6,           17.8666666667, 13.12,
      13.12,         12.48,         12.48,         17.3333333333, 9.6,
      17.8666666667, 13.12,         13.12,
  };
  const std::array<int, 4> in_shape = {{3, 8, 7, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID3x8x7x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.04, 0.04, 0.12, 0.12, 0.12, 0.08, 0.08, 0.04, 0.04, 0.12, 0.12, 0.12,
      0.08, 0.08, 0.16, 0.16, 0.4,  0.4,  0.4,  0.24, 0.24, 0.16, 0.16, 0.4,
      0.4,  0.4,  0.24, 0.24, 0.16, 0.16, 0.4,  0.4,  0.4,  0.24, 0.24, 0.12,
      0.12, 0.28, 0.28, 0.28, 0.16, 0.16, 0.12, 0.12, 0.28, 0.28, 0.28, 0.16,
      0.16, 0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.2,  0.2,  0.44, 0.44,
      0.44, 0.24, 0.24, 0.2,  0.2,  0.44, 0.44, 0.44, 0.24, 0.24, 0.48, 0.48,
      1.04, 1.04, 1.04, 0.56, 0.56, 0.48, 0.48, 1.04, 1.04, 1.04, 0.56, 0.56,
      0.48, 0.48, 1.04, 1.04, 1.04, 0.56, 0.56, 0.28, 0.28, 0.6,  0.6,  0.6,
      0.32, 0.32, 0.28, 0.28, 0.6,  0.6,  0.6,  0.32, 0.32, 0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.36, 0.36, 0.76, 0.76, 0.76, 0.4,  0.4,  0.36,
      0.36, 0.76, 0.76, 0.76, 0.4,  0.4,  0.8,  0.8,  1.68, 1.68, 1.68, 0.88,
      0.88, 0.8,  0.8,  1.68, 1.68, 1.68, 0.88, 0.88, 0.8,  0.8,  1.68, 1.68,
      1.68, 0.88, 0.88, 0.44, 0.44, 0.92, 0.92, 0.92, 0.48, 0.48, 0.44, 0.44,
      0.92, 0.92, 0.92, 0.48, 0.48, 0.,   0.,   0.,   0.,   0.,   0.,   0.,
  };
  const std::array<int, 4> in_shape = {{3, 8, 7, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME3x8x7x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.2333333333,  0.3666666667,  0.2333333333,  0.3666666667,  0.4833333333,
      0.6666666667,  0.4,           0.5,           0.9833333333,  1.1666666667,
      0.8333333333,  0.9666666667,  0.8333333333,  0.9666666667,  1.2733333333,
      1.5133333333,  1.2733333333,  1.5133333333,  2.0433333333,  2.3733333333,
      1.36,          1.54,          2.9433333333,  3.2733333333,  2.3533333333,
      2.5933333333,  2.3533333333,  2.5933333333,  1.2733333333,  1.5133333333,
      1.2733333333,  1.5133333333,  2.0433333333,  2.3733333333,  1.36,
      1.54,          2.9433333333,  3.2733333333,  2.3533333333,  2.5933333333,
      2.3533333333,  2.5933333333,  3.1666666667,  3.5133333333,  3.1666666667,
      3.5133333333,  4.7766666667,  5.2533333333,  2.96,          3.22,
      6.0766666667,  6.5533333333,  4.7266666667,  5.0733333333,  4.7266666667,
      5.0733333333,  2.9333333333,  3.1466666667,  2.9333333333,  3.1466666667,
      4.2933333333,  4.5866666667,  2.56,          2.72,          5.0933333333,
      5.3866666667,  3.8933333333,  4.1066666667,  3.8933333333,  4.1066666667,
      7.5111111111,  7.9022222222,  7.5111111111,  7.9022222222,  10.8044444444,
      11.3422222222, 6.2933333333,  6.5866666667,  12.2711111111, 12.8088888889,
      9.2711111111,  9.6622222222,  9.2711111111,  9.6622222222,  6.4711111111,
      6.7555555556,  6.4711111111,  6.7555555556,  9.2444444444,  9.6355555556,
      5.3333333333,  5.5466666667,  10.3111111111, 10.7022222222, 7.7511111111,
      8.0355555556,  7.7511111111,  8.0355555556,  6.4711111111,  6.7555555556,
      6.4711111111,  6.7555555556,  9.2444444444,  9.6355555556,  5.3333333333,
      5.5466666667,  10.3111111111, 10.7022222222, 7.7511111111,  8.0355555556,
      7.7511111111,  8.0355555556,  4.5,           4.6333333333,  4.5,
      4.6333333333,  6.35,          6.5333333333,  3.6,           3.7,
      6.85,          7.0333333333,  5.1,           5.2333333333,  5.1,
      5.2333333333,  8.9533333333,  9.1933333333,  8.9533333333,  9.1933333333,
      12.6033333333, 12.9333333333, 7.12,          7.3,           13.5033333333,
      13.8333333333, 10.0333333333, 10.2733333333, 10.0333333333, 10.2733333333,
      8.9533333333,  9.1933333333,  8.9533333333,  9.1933333333,  12.6033333333,
      12.9333333333, 7.12,          7.3,           13.5033333333, 13.8333333333,
      10.0333333333, 10.2733333333, 10.0333333333, 10.2733333333, 14.26,
      14.6066666667, 14.26,         14.6066666667, 20.03,         20.5066666667,
      11.28,         11.54,         21.33,         21.8066666667, 15.82,
      16.1666666667, 15.82,         16.1666666667, 9.76,          9.9733333333,
      9.76,          9.9733333333,  13.68,         13.9733333333, 7.68,
      7.84,          14.48,         14.7733333333, 10.72,         10.9333333333,
      10.72,         10.9333333333, 20.0266666667, 20.4177777778, 20.0266666667,
      20.4177777778, 28.0133333333, 28.5511111111, 15.68,         15.9733333333,
      29.48,         30.0177777778, 21.7866666667, 22.1777777778, 21.7866666667,
      22.1777777778, 15.5733333333, 15.8577777778, 15.5733333333, 15.8577777778,
      21.76,         22.1511111111, 12.16,         12.3733333333, 22.8266666667,
      23.2177777778, 16.8533333333, 17.1377777778, 16.8533333333, 17.1377777778,
      15.5733333333, 15.8577777778, 15.5733333333, 15.8577777778, 21.76,
      22.1511111111, 12.16,         12.3733333333, 22.8266666667, 23.2177777778,
      16.8533333333, 17.1377777778, 16.8533333333, 17.1377777778, 8.7666666667,
      8.9,           8.7666666667,  8.9,           12.2166666667, 12.4,
      6.8,           6.9,           12.7166666667, 12.9,          9.3666666667,
      9.5,           9.3666666667,  9.5,           16.6333333333, 16.8733333333,
      16.6333333333, 16.8733333333, 23.1633333333, 23.4933333333, 12.88,
      13.06,         24.0633333333, 24.3933333333, 17.7133333333, 17.9533333333,
      17.7133333333, 17.9533333333, 16.6333333333, 16.8733333333, 16.6333333333,
      16.8733333333, 23.1633333333, 23.4933333333, 12.88,         13.06,
      24.0633333333, 24.3933333333, 17.7133333333, 17.9533333333, 17.7133333333,
      17.9533333333, 25.3533333333, 25.7,          25.3533333333, 25.7,
      35.2833333333, 35.76,         19.6,          19.86,         36.5833333333,
      37.06,         26.9133333333, 27.26,         26.9133333333, 27.26,
      16.5866666667, 16.8,          16.5866666667, 16.8,          23.0666666667,
      23.36,         12.8,          12.96,         23.8666666667, 24.16,
      17.5466666667, 17.76,         17.5466666667, 17.76,         32.5422222222,
      32.9333333333, 32.5422222222, 32.9333333333, 45.2222222222, 45.76,
      25.0666666667, 25.36,         46.6888888889, 47.2266666667, 34.3022222222,
      34.6933333333, 34.3022222222, 34.6933333333, 24.6755555556, 24.96,
      24.6755555556, 24.96,         34.2755555556, 34.6666666667, 18.9866666667,
      19.2,          35.3422222222, 35.7333333333, 25.9555555556, 26.24,
      25.9555555556, 26.24,         24.6755555556, 24.96,         24.6755555556,
      24.96,         34.2755555556, 34.6666666667, 18.9866666667, 19.2,
      35.3422222222, 35.7333333333, 25.9555555556, 26.24,         25.9555555556,
      26.24,
  };
  const std::array<int, 4> in_shape = {{3, 8, 7, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID3x8x7x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.04, 0.08, 0.04, 0.08, 0.16, 0.24, 0.16, 0.24, 0.16, 0.24, 0.12, 0.16,
      0.12, 0.16, 0.04, 0.08, 0.04, 0.08, 0.16, 0.24, 0.16, 0.24, 0.16, 0.24,
      0.12, 0.16, 0.12, 0.16, 0.24, 0.32, 0.24, 0.32, 0.64, 0.8,  0.64, 0.8,
      0.64, 0.8,  0.4,  0.48, 0.4,  0.48, 0.24, 0.32, 0.24, 0.32, 0.64, 0.8,
      0.64, 0.8,  0.64, 0.8,  0.4,  0.48, 0.4,  0.48, 0.24, 0.32, 0.24, 0.32,
      0.64, 0.8,  0.64, 0.8,  0.64, 0.8,  0.4,  0.48, 0.4,  0.48, 0.2,  0.24,
      0.2,  0.24, 0.48, 0.56, 0.48, 0.56, 0.48, 0.56, 0.28, 0.32, 0.28, 0.32,
      0.2,  0.24, 0.2,  0.24, 0.48, 0.56, 0.48, 0.56, 0.48, 0.56, 0.28, 0.32,
      0.28, 0.32, 0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.36, 0.4,  0.36, 0.4,  0.8,  0.88, 0.8,  0.88,
      0.8,  0.88, 0.44, 0.48, 0.44, 0.48, 0.36, 0.4,  0.36, 0.4,  0.8,  0.88,
      0.8,  0.88, 0.8,  0.88, 0.44, 0.48, 0.44, 0.48, 0.88, 0.96, 0.88, 0.96,
      1.92, 2.08, 1.92, 2.08, 1.92, 2.08, 1.04, 1.12, 1.04, 1.12, 0.88, 0.96,
      0.88, 0.96, 1.92, 2.08, 1.92, 2.08, 1.92, 2.08, 1.04, 1.12, 1.04, 1.12,
      0.88, 0.96, 0.88, 0.96, 1.92, 2.08, 1.92, 2.08, 1.92, 2.08, 1.04, 1.12,
      1.04, 1.12, 0.52, 0.56, 0.52, 0.56, 1.12, 1.2,  1.12, 1.2,  1.12, 1.2,
      0.6,  0.64, 0.6,  0.64, 0.52, 0.56, 0.52, 0.56, 1.12, 1.2,  1.12, 1.2,
      1.12, 1.2,  0.6,  0.64, 0.6,  0.64, 0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.68, 0.72, 0.68, 0.72,
      1.44, 1.52, 1.44, 1.52, 1.44, 1.52, 0.76, 0.8,  0.76, 0.8,  0.68, 0.72,
      0.68, 0.72, 1.44, 1.52, 1.44, 1.52, 1.44, 1.52, 0.76, 0.8,  0.76, 0.8,
      1.52, 1.6,  1.52, 1.6,  3.2,  3.36, 3.2,  3.36, 3.2,  3.36, 1.68, 1.76,
      1.68, 1.76, 1.52, 1.6,  1.52, 1.6,  3.2,  3.36, 3.2,  3.36, 3.2,  3.36,
      1.68, 1.76, 1.68, 1.76, 1.52, 1.6,  1.52, 1.6,  3.2,  3.36, 3.2,  3.36,
      3.2,  3.36, 1.68, 1.76, 1.68, 1.76, 0.84, 0.88, 0.84, 0.88, 1.76, 1.84,
      1.76, 1.84, 1.76, 1.84, 0.92, 0.96, 0.92, 0.96, 0.84, 0.88, 0.84, 0.88,
      1.76, 1.84, 1.76, 1.84, 1.76, 1.84, 0.92, 0.96, 0.92, 0.96, 0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
  };
  const std::array<int, 4> in_shape = {{3, 8, 7, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME3x8x7x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.3333333333,
      0.4666666667,
      0.6,
      0.7333333333,
      0.3333333333,
      0.4666666667,
      0.6,
      0.7333333333,
      0.7833333333,
      0.9666666667,
      1.15,
      1.3333333333,
      0.7,
      0.8,
      0.9,
      1.,
      1.7833333333,
      1.9666666667,
      2.15,
      2.3333333333,
      1.5333333333,
      1.6666666667,
      1.8,
      1.9333333333,
      1.5333333333,
      1.6666666667,
      1.8,
      1.9333333333,
      2.3066666667,
      2.5466666667,
      2.7866666667,
      3.0266666667,
      2.3066666667,
      2.5466666667,
      2.7866666667,
      3.0266666667,
      3.7566666667,
      4.0866666667,
      4.4166666667,
      4.7466666667,
      2.54,
      2.72,
      2.9,
      3.08,
      5.5566666667,
      5.8866666667,
      6.2166666667,
      6.5466666667,
      4.4666666667,
      4.7066666667,
      4.9466666667,
      5.1866666667,
      4.4666666667,
      4.7066666667,
      4.9466666667,
      5.1866666667,
      2.3066666667,
      2.5466666667,
      2.7866666667,
      3.0266666667,
      2.3066666667,
      2.5466666667,
      2.7866666667,
      3.0266666667,
      3.7566666667,
      4.0866666667,
      4.4166666667,
      4.7466666667,
      2.54,
      2.72,
      2.9,
      3.08,
      5.5566666667,
      5.8866666667,
      6.2166666667,
      6.5466666667,
      4.4666666667,
      4.7066666667,
      4.9466666667,
      5.1866666667,
      4.4666666667,
      4.7066666667,
      4.9466666667,
      5.1866666667,
      5.9866666667,
      6.3333333333,
      6.68,
      7.0266666667,
      5.9866666667,
      6.3333333333,
      6.68,
      7.0266666667,
      9.0766666667,
      9.5533333333,
      10.03,
      10.5066666667,
      5.66,
      5.92,
      6.18,
      6.44,
      11.6766666667,
      12.1533333333,
      12.63,
      13.1066666667,
      9.1066666667,
      9.4533333333,
      9.8,
      10.1466666667,
      9.1066666667,
      9.4533333333,
      9.8,
      10.1466666667,
      5.6533333333,
      5.8666666667,
      6.08,
      6.2933333333,
      5.6533333333,
      5.8666666667,
      6.08,
      6.2933333333,
      8.2933333333,
      8.5866666667,
      8.88,
      9.1733333333,
      4.96,
      5.12,
      5.28,
      5.44,
      9.8933333333,
      10.1866666667,
      10.48,
      10.7733333333,
      7.5733333333,
      7.7866666667,
      8.,
      8.2133333333,
      7.5733333333,
      7.7866666667,
      8.,
      8.2133333333,
      14.6311111111,
      15.0222222222,
      15.4133333333,
      15.8044444444,
      14.6311111111,
      15.0222222222,
      15.4133333333,
      15.8044444444,
      21.0711111111,
      21.6088888889,
      22.1466666667,
      22.6844444444,
      12.2933333333,
      12.5866666667,
      12.88,
      13.1733333333,
      24.0044444444,
      24.5422222222,
      25.08,
      25.6177777778,
      18.1511111111,
      18.5422222222,
      18.9333333333,
      19.3244444444,
      18.1511111111,
      18.5422222222,
      18.9333333333,
      19.3244444444,
      12.6577777778,
      12.9422222222,
      13.2266666667,
      13.5111111111,
      12.6577777778,
      12.9422222222,
      13.2266666667,
      13.5111111111,
      18.0977777778,
      18.4888888889,
      18.88,
      19.2711111111,
      10.4533333333,
      10.6666666667,
      10.88,
      11.0933333333,
      20.2311111111,
      20.6222222222,
      21.0133333333,
      21.4044444444,
      15.2177777778,
      15.5022222222,
      15.7866666667,
      16.0711111111,
      15.2177777778,
      15.5022222222,
      15.7866666667,
      16.0711111111,
      12.6577777778,
      12.9422222222,
      13.2266666667,
      13.5111111111,
      12.6577777778,
      12.9422222222,
      13.2266666667,
      13.5111111111,
      18.0977777778,
      18.4888888889,
      18.88,
      19.2711111111,
      10.4533333333,
      10.6666666667,
      10.88,
      11.0933333333,
      20.2311111111,
      20.6222222222,
      21.0133333333,
      21.4044444444,
      15.2177777778,
      15.5022222222,
      15.7866666667,
      16.0711111111,
      15.2177777778,
      15.5022222222,
      15.7866666667,
      16.0711111111,
      8.8666666667,
      9.,
      9.1333333333,
      9.2666666667,
      8.8666666667,
      9.,
      9.1333333333,
      9.2666666667,
      12.5166666667,
      12.7,
      12.8833333333,
      13.0666666667,
      7.1,
      7.2,
      7.3,
      7.4,
      13.5166666667,
      13.7,
      13.8833333333,
      14.0666666667,
      10.0666666667,
      10.2,
      10.3333333333,
      10.4666666667,
      10.0666666667,
      10.2,
      10.3333333333,
      10.4666666667,
      17.6666666667,
      17.9066666667,
      18.1466666667,
      18.3866666667,
      17.6666666667,
      17.9066666667,
      18.1466666667,
      18.3866666667,
      24.8766666667,
      25.2066666667,
      25.5366666667,
      25.8666666667,
      14.06,
      14.24,
      14.42,
      14.6,
      26.6766666667,
      27.0066666667,
      27.3366666667,
      27.6666666667,
      19.8266666667,
      20.0666666667,
      20.3066666667,
      20.5466666667,
      19.8266666667,
      20.0666666667,
      20.3066666667,
      20.5466666667,
      17.6666666667,
      17.9066666667,
      18.1466666667,
      18.3866666667,
      17.6666666667,
      17.9066666667,
      18.1466666667,
      18.3866666667,
      24.8766666667,
      25.2066666667,
      25.5366666667,
      25.8666666667,
      14.06,
      14.24,
      14.42,
      14.6,
      26.6766666667,
      27.0066666667,
      27.3366666667,
      27.6666666667,
      19.8266666667,
      20.0666666667,
      20.3066666667,
      20.5466666667,
      19.8266666667,
      20.0666666667,
      20.3066666667,
      20.5466666667,
      28.1733333333,
      28.52,
      28.8666666667,
      29.2133333333,
      28.1733333333,
      28.52,
      28.8666666667,
      29.2133333333,
      39.5833333333,
      40.06,
      40.5366666667,
      41.0133333333,
      22.3,
      22.56,
      22.82,
      23.08,
      42.1833333333,
      42.66,
      43.1366666667,
      43.6133333333,
      31.2933333333,
      31.64,
      31.9866666667,
      32.3333333333,
      31.2933333333,
      31.64,
      31.9866666667,
      32.3333333333,
      19.3066666667,
      19.52,
      19.7333333333,
      19.9466666667,
      19.3066666667,
      19.52,
      19.7333333333,
      19.9466666667,
      27.0666666667,
      27.36,
      27.6533333333,
      27.9466666667,
      15.2,
      15.36,
      15.52,
      15.68,
      28.6666666667,
      28.96,
      29.2533333333,
      29.5466666667,
      21.2266666667,
      21.44,
      21.6533333333,
      21.8666666667,
      21.2266666667,
      21.44,
      21.6533333333,
      21.8666666667,
      39.6622222222,
      40.0533333333,
      40.4444444444,
      40.8355555556,
      39.6622222222,
      40.0533333333,
      40.4444444444,
      40.8355555556,
      55.4888888889,
      56.0266666667,
      56.5644444444,
      57.1022222222,
      31.0666666667,
      31.36,
      31.6533333333,
      31.9466666667,
      58.4222222222,
      58.96,
      59.4977777778,
      60.0355555556,
      43.1822222222,
      43.5733333333,
      43.9644444444,
      44.3555555556,
      43.1822222222,
      43.5733333333,
      43.9644444444,
      44.3555555556,
      30.8622222222,
      31.1466666667,
      31.4311111111,
      31.7155555556,
      30.8622222222,
      31.1466666667,
      31.4311111111,
      31.7155555556,
      43.1288888889,
      43.52,
      43.9111111111,
      44.3022222222,
      24.1066666667,
      24.32,
      24.5333333333,
      24.7466666667,
      45.2622222222,
      45.6533333333,
      46.0444444444,
      46.4355555556,
      33.4222222222,
      33.7066666667,
      33.9911111111,
      34.2755555556,
      33.4222222222,
      33.7066666667,
      33.9911111111,
      34.2755555556,
      30.8622222222,
      31.1466666667,
      31.4311111111,
      31.7155555556,
      30.8622222222,
      31.1466666667,
      31.4311111111,
      31.7155555556,
      43.1288888889,
      43.52,
      43.9111111111,
      44.3022222222,
      24.1066666667,
      24.32,
      24.5333333333,
      24.7466666667,
      45.2622222222,
      45.6533333333,
      46.0444444444,
      46.4355555556,
      33.4222222222,
      33.7066666667,
      33.9911111111,
      34.2755555556,
      33.4222222222,
      33.7066666667,
      33.9911111111,
      34.2755555556,
      17.4,
      17.5333333333,
      17.6666666667,
      17.8,
      17.4,
      17.5333333333,
      17.6666666667,
      17.8,
      24.25,
      24.4333333333,
      24.6166666667,
      24.8,
      13.5,
      13.6,
      13.7,
      13.8,
      25.25,
      25.4333333333,
      25.6166666667,
      25.8,
      18.6,
      18.7333333333,
      18.8666666667,
      19.,
      18.6,
      18.7333333333,
      18.8666666667,
      19.,
      33.0266666667,
      33.2666666667,
      33.5066666667,
      33.7466666667,
      33.0266666667,
      33.2666666667,
      33.5066666667,
      33.7466666667,
      45.9966666667,
      46.3266666667,
      46.6566666667,
      46.9866666667,
      25.58,
      25.76,
      25.94,
      26.12,
      47.7966666667,
      48.1266666667,
      48.4566666667,
      48.7866666667,
      35.1866666667,
      35.4266666667,
      35.6666666667,
      35.9066666667,
      35.1866666667,
      35.4266666667,
      35.6666666667,
      35.9066666667,
      33.0266666667,
      33.2666666667,
      33.5066666667,
      33.7466666667,
      33.0266666667,
      33.2666666667,
      33.5066666667,
      33.7466666667,
      45.9966666667,
      46.3266666667,
      46.6566666667,
      46.9866666667,
      25.58,
      25.76,
      25.94,
      26.12,
      47.7966666667,
      48.1266666667,
      48.4566666667,
      48.7866666667,
      35.1866666667,
      35.4266666667,
      35.6666666667,
      35.9066666667,
      35.1866666667,
      35.4266666667,
      35.6666666667,
      35.9066666667,
      50.36,
      50.7066666667,
      51.0533333333,
      51.4,
      50.36,
      50.7066666667,
      51.0533333333,
      51.4,
      70.09,
      70.5666666667,
      71.0433333333,
      71.52,
      38.94,
      39.2,
      39.46,
      39.72,
      72.69,
      73.1666666667,
      73.6433333333,
      74.12,
      53.48,
      53.8266666667,
      54.1733333333,
      54.52,
      53.48,
      53.8266666667,
      54.1733333333,
      54.52,
      32.96,
      33.1733333333,
      33.3866666667,
      33.6,
      32.96,
      33.1733333333,
      33.3866666667,
      33.6,
      45.84,
      46.1333333333,
      46.4266666667,
      46.72,
      25.44,
      25.6,
      25.76,
      25.92,
      47.44,
      47.7333333333,
      48.0266666667,
      48.32,
      34.88,
      35.0933333333,
      35.3066666667,
      35.52,
      34.88,
      35.0933333333,
      35.3066666667,
      35.52,
      64.6933333333,
      65.0844444444,
      65.4755555556,
      65.8666666667,
      64.6933333333,
      65.0844444444,
      65.4755555556,
      65.8666666667,
      89.9066666667,
      90.4444444444,
      90.9822222222,
      91.52,
      49.84,
      50.1333333333,
      50.4266666667,
      50.72,
      92.84,
      93.3777777778,
      93.9155555556,
      94.4533333333,
      68.2133333333,
      68.6044444444,
      68.9955555556,
      69.3866666667,
      68.2133333333,
      68.6044444444,
      68.9955555556,
      69.3866666667,
      49.0666666667,
      49.3511111111,
      49.6355555556,
      49.92,
      49.0666666667,
      49.3511111111,
      49.6355555556,
      49.92,
      68.16,
      68.5511111111,
      68.9422222222,
      69.3333333333,
      37.76,
      37.9733333333,
      38.1866666667,
      38.4,
      70.2933333333,
      70.6844444444,
      71.0755555556,
      71.4666666667,
      51.6266666667,
      51.9111111111,
      52.1955555556,
      52.48,
      51.6266666667,
      51.9111111111,
      52.1955555556,
      52.48,
      49.0666666667,
      49.3511111111,
      49.6355555556,
      49.92,
      49.0666666667,
      49.3511111111,
      49.6355555556,
      49.92,
      68.16,
      68.5511111111,
      68.9422222222,
      69.3333333333,
      37.76,
      37.9733333333,
      38.1866666667,
      38.4,
      70.2933333333,
      70.6844444444,
      71.0755555556,
      71.4666666667,
      51.6266666667,
      51.9111111111,
      52.1955555556,
      52.48,
      51.6266666667,
      51.9111111111,
      52.1955555556,
      52.48,
  };
  const std::array<int, 4> in_shape = {{3, 8, 7, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID3x8x7x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.04, 0.08, 0.12, 0.16, 0.04, 0.08, 0.12, 0.16, 0.24, 0.32, 0.4,  0.48,
      0.24, 0.32, 0.4,  0.48, 0.24, 0.32, 0.4,  0.48, 0.2,  0.24, 0.28, 0.32,
      0.2,  0.24, 0.28, 0.32, 0.04, 0.08, 0.12, 0.16, 0.04, 0.08, 0.12, 0.16,
      0.24, 0.32, 0.4,  0.48, 0.24, 0.32, 0.4,  0.48, 0.24, 0.32, 0.4,  0.48,
      0.2,  0.24, 0.28, 0.32, 0.2,  0.24, 0.28, 0.32, 0.4,  0.48, 0.56, 0.64,
      0.4,  0.48, 0.56, 0.64, 1.12, 1.28, 1.44, 1.6,  1.12, 1.28, 1.44, 1.6,
      1.12, 1.28, 1.44, 1.6,  0.72, 0.8,  0.88, 0.96, 0.72, 0.8,  0.88, 0.96,
      0.4,  0.48, 0.56, 0.64, 0.4,  0.48, 0.56, 0.64, 1.12, 1.28, 1.44, 1.6,
      1.12, 1.28, 1.44, 1.6,  1.12, 1.28, 1.44, 1.6,  0.72, 0.8,  0.88, 0.96,
      0.72, 0.8,  0.88, 0.96, 0.4,  0.48, 0.56, 0.64, 0.4,  0.48, 0.56, 0.64,
      1.12, 1.28, 1.44, 1.6,  1.12, 1.28, 1.44, 1.6,  1.12, 1.28, 1.44, 1.6,
      0.72, 0.8,  0.88, 0.96, 0.72, 0.8,  0.88, 0.96, 0.36, 0.4,  0.44, 0.48,
      0.36, 0.4,  0.44, 0.48, 0.88, 0.96, 1.04, 1.12, 0.88, 0.96, 1.04, 1.12,
      0.88, 0.96, 1.04, 1.12, 0.52, 0.56, 0.6,  0.64, 0.52, 0.56, 0.6,  0.64,
      0.36, 0.4,  0.44, 0.48, 0.36, 0.4,  0.44, 0.48, 0.88, 0.96, 1.04, 1.12,
      0.88, 0.96, 1.04, 1.12, 0.88, 0.96, 1.04, 1.12, 0.52, 0.56, 0.6,  0.64,
      0.52, 0.56, 0.6,  0.64, 0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.68, 0.72, 0.76, 0.8,
      0.68, 0.72, 0.76, 0.8,  1.52, 1.6,  1.68, 1.76, 1.52, 1.6,  1.68, 1.76,
      1.52, 1.6,  1.68, 1.76, 0.84, 0.88, 0.92, 0.96, 0.84, 0.88, 0.92, 0.96,
      0.68, 0.72, 0.76, 0.8,  0.68, 0.72, 0.76, 0.8,  1.52, 1.6,  1.68, 1.76,
      1.52, 1.6,  1.68, 1.76, 1.52, 1.6,  1.68, 1.76, 0.84, 0.88, 0.92, 0.96,
      0.84, 0.88, 0.92, 0.96, 1.68, 1.76, 1.84, 1.92, 1.68, 1.76, 1.84, 1.92,
      3.68, 3.84, 4.,   4.16, 3.68, 3.84, 4.,   4.16, 3.68, 3.84, 4.,   4.16,
      2.,   2.08, 2.16, 2.24, 2.,   2.08, 2.16, 2.24, 1.68, 1.76, 1.84, 1.92,
      1.68, 1.76, 1.84, 1.92, 3.68, 3.84, 4.,   4.16, 3.68, 3.84, 4.,   4.16,
      3.68, 3.84, 4.,   4.16, 2.,   2.08, 2.16, 2.24, 2.,   2.08, 2.16, 2.24,
      1.68, 1.76, 1.84, 1.92, 1.68, 1.76, 1.84, 1.92, 3.68, 3.84, 4.,   4.16,
      3.68, 3.84, 4.,   4.16, 3.68, 3.84, 4.,   4.16, 2.,   2.08, 2.16, 2.24,
      2.,   2.08, 2.16, 2.24, 1.,   1.04, 1.08, 1.12, 1.,   1.04, 1.08, 1.12,
      2.16, 2.24, 2.32, 2.4,  2.16, 2.24, 2.32, 2.4,  2.16, 2.24, 2.32, 2.4,
      1.16, 1.2,  1.24, 1.28, 1.16, 1.2,  1.24, 1.28, 1.,   1.04, 1.08, 1.12,
      1.,   1.04, 1.08, 1.12, 2.16, 2.24, 2.32, 2.4,  2.16, 2.24, 2.32, 2.4,
      2.16, 2.24, 2.32, 2.4,  1.16, 1.2,  1.24, 1.28, 1.16, 1.2,  1.24, 1.28,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   1.32, 1.36, 1.4,  1.44, 1.32, 1.36, 1.4,  1.44,
      2.8,  2.88, 2.96, 3.04, 2.8,  2.88, 2.96, 3.04, 2.8,  2.88, 2.96, 3.04,
      1.48, 1.52, 1.56, 1.6,  1.48, 1.52, 1.56, 1.6,  1.32, 1.36, 1.4,  1.44,
      1.32, 1.36, 1.4,  1.44, 2.8,  2.88, 2.96, 3.04, 2.8,  2.88, 2.96, 3.04,
      2.8,  2.88, 2.96, 3.04, 1.48, 1.52, 1.56, 1.6,  1.48, 1.52, 1.56, 1.6,
      2.96, 3.04, 3.12, 3.2,  2.96, 3.04, 3.12, 3.2,  6.24, 6.4,  6.56, 6.72,
      6.24, 6.4,  6.56, 6.72, 6.24, 6.4,  6.56, 6.72, 3.28, 3.36, 3.44, 3.52,
      3.28, 3.36, 3.44, 3.52, 2.96, 3.04, 3.12, 3.2,  2.96, 3.04, 3.12, 3.2,
      6.24, 6.4,  6.56, 6.72, 6.24, 6.4,  6.56, 6.72, 6.24, 6.4,  6.56, 6.72,
      3.28, 3.36, 3.44, 3.52, 3.28, 3.36, 3.44, 3.52, 2.96, 3.04, 3.12, 3.2,
      2.96, 3.04, 3.12, 3.2,  6.24, 6.4,  6.56, 6.72, 6.24, 6.4,  6.56, 6.72,
      6.24, 6.4,  6.56, 6.72, 3.28, 3.36, 3.44, 3.52, 3.28, 3.36, 3.44, 3.52,
      1.64, 1.68, 1.72, 1.76, 1.64, 1.68, 1.72, 1.76, 3.44, 3.52, 3.6,  3.68,
      3.44, 3.52, 3.6,  3.68, 3.44, 3.52, 3.6,  3.68, 1.8,  1.84, 1.88, 1.92,
      1.8,  1.84, 1.88, 1.92, 1.64, 1.68, 1.72, 1.76, 1.64, 1.68, 1.72, 1.76,
      3.44, 3.52, 3.6,  3.68, 3.44, 3.52, 3.6,  3.68, 3.44, 3.52, 3.6,  3.68,
      1.8,  1.84, 1.88, 1.92, 1.8,  1.84, 1.88, 1.92, 0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
  };
  const std::array<int, 4> in_shape = {{3, 8, 7, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME3x8x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.0625,        0.1625,        0.1625,        0.3125,        0.25,
      0.5833333333,  0.4833333333,  0.4833333333,  0.3125,        0.6525,
      0.6525,        1.0825,        0.77,          1.6366666667,  1.2966666667,
      1.2966666667,  0.3125,        0.6525,        0.6525,        1.0825,
      0.77,          1.6366666667,  1.2966666667,  1.2966666667,  0.7625,
      1.5025,        1.5025,        2.3725,        1.61,          3.2766666667,
      2.5366666667,  2.5366666667,  0.7,           1.34,          1.34,
      2.06,          1.36,          2.6933333333,  2.0533333333,  2.0533333333,
      1.7833333333,  3.3566666667,  3.3566666667,  5.0766666667,  3.2933333333,
      6.4044444444,  4.8311111111,  4.8311111111,  1.5333333333,  2.8666666667,
      2.8666666667,  4.3066666667,  2.7733333333,  5.3511111111,  4.0177777778,
      4.0177777778,  1.5333333333,  2.8666666667,  2.8666666667,  4.3066666667,
      2.7733333333,  5.3511111111,  4.0177777778,  4.0177777778,  1.0625,
      1.9625,        1.9625,        2.9125,        1.85,          3.5166666667,
      2.6166666667,  2.6166666667,  2.1125,        3.8925,        3.8925,
      5.7625,        3.65,          6.9166666667,  5.1366666667,  5.1366666667,
      2.1125,        3.8925,        3.8925,        5.7625,        3.65,
      6.9166666667,  5.1366666667,  5.1366666667,  3.3625,        6.1825,
      6.1825,        9.1325,        5.77,          10.9033333333, 8.0833333333,
      8.0833333333,  2.3,           4.22,          4.22,          6.22,
      3.92,          7.3866666667,  5.4666666667,  5.4666666667,  4.7166666667,
      8.6366666667,  8.6366666667,  12.7033333333, 7.9866666667,  15.0088888889,
      11.0888888889, 11.0888888889, 3.6666666667,  6.7066666667,  6.7066666667,
      9.8533333333,  6.1866666667,  11.6088888889, 8.5688888889,  8.5688888889,
      3.6666666667,  6.7066666667,  6.7066666667,  9.8533333333,  6.1866666667,
      11.6088888889, 8.5688888889,  8.5688888889,  2.0625,        3.7625,
      3.7625,        5.5125,        3.45,          6.45,          4.75,
      4.75,          3.9125,        7.1325,        7.1325,        10.4425,
      6.53,          12.1966666667, 8.9766666667,  8.9766666667,  3.9125,
      7.1325,        7.1325,        10.4425,       6.53,          12.1966666667,
      8.9766666667,  8.9766666667,  5.9625,        10.8625,       10.8625,
      15.8925,       9.93,          18.53,         13.63,         13.63,
      3.9,           7.1,           7.1,           10.38,         6.48,
      12.08,         8.88,          8.88,          7.65,          13.9166666667,
      13.9166666667, 20.33,         12.68,         23.6133333333, 17.3466666667,
      17.3466666667, 5.8,           10.5466666667, 10.5466666667, 15.4,
      9.6,           17.8666666667, 13.12,         13.12,         5.8,
      10.5466666667, 10.5466666667, 15.4,          9.6,           17.8666666667,
      13.12,         13.12,
  };
  const std::array<int, 4> in_shape = {{3, 8, 8, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID3x8x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.04, 0.04, 0.12, 0.12, 0.12, 0.08, 0.08, 0.,   0.04, 0.04, 0.12, 0.12,
      0.12, 0.08, 0.08, 0.,   0.16, 0.16, 0.4,  0.4,  0.4,  0.24, 0.24, 0.,
      0.16, 0.16, 0.4,  0.4,  0.4,  0.24, 0.24, 0.,   0.16, 0.16, 0.4,  0.4,
      0.4,  0.24, 0.24, 0.,   0.12, 0.12, 0.28, 0.28, 0.28, 0.16, 0.16, 0.,
      0.12, 0.12, 0.28, 0.28, 0.28, 0.16, 0.16, 0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.2,  0.2,  0.44, 0.44, 0.44, 0.24, 0.24, 0.,
      0.2,  0.2,  0.44, 0.44, 0.44, 0.24, 0.24, 0.,   0.48, 0.48, 1.04, 1.04,
      1.04, 0.56, 0.56, 0.,   0.48, 0.48, 1.04, 1.04, 1.04, 0.56, 0.56, 0.,
      0.48, 0.48, 1.04, 1.04, 1.04, 0.56, 0.56, 0.,   0.28, 0.28, 0.6,  0.6,
      0.6,  0.32, 0.32, 0.,   0.28, 0.28, 0.6,  0.6,  0.6,  0.32, 0.32, 0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.36, 0.36, 0.76, 0.76,
      0.76, 0.4,  0.4,  0.,   0.36, 0.36, 0.76, 0.76, 0.76, 0.4,  0.4,  0.,
      0.8,  0.8,  1.68, 1.68, 1.68, 0.88, 0.88, 0.,   0.8,  0.8,  1.68, 1.68,
      1.68, 0.88, 0.88, 0.,   0.8,  0.8,  1.68, 1.68, 1.68, 0.88, 0.88, 0.,
      0.44, 0.44, 0.92, 0.92, 0.92, 0.48, 0.48, 0.,   0.44, 0.44, 0.92, 0.92,
      0.92, 0.48, 0.48, 0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
  };
  const std::array<int, 4> in_shape = {{3, 8, 8, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME3x8x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.0625,        0.125,         0.2125,        0.325,         0.2125,
      0.325,         0.4625,        0.625,         0.4,           0.5,
      0.9833333333,  1.1666666667,  0.8333333333,  0.9666666667,  0.8333333333,
      0.9666666667,  0.5125,        0.625,         1.1025,        1.305,
      1.1025,        1.305,         1.8725,        2.165,         1.36,
      1.54,          2.9433333333,  3.2733333333,  2.3533333333,  2.5933333333,
      2.3533333333,  2.5933333333,  0.5125,        0.625,         1.1025,
      1.305,         1.1025,        1.305,         1.8725,        2.165,
      1.36,          1.54,          2.9433333333,  3.2733333333,  2.3533333333,
      2.5933333333,  2.3533333333,  2.5933333333,  1.3625,        1.525,
      2.7125,        3.005,         2.7125,        3.005,         4.3225,
      4.745,         2.96,          3.22,          6.0766666667,  6.5533333333,
      4.7266666667,  5.0733333333,  4.7266666667,  5.0733333333,  1.3,
      1.4,           2.5,           2.68,          2.5,           2.68,
      3.86,          4.12,          2.56,          2.72,          5.0933333333,
      5.3866666667,  3.8933333333,  4.1066666667,  3.8933333333,  4.1066666667,
      3.3833333333,  3.5666666667,  6.3833333333,  6.7133333333,  6.3833333333,
      6.7133333333,  9.6766666667,  10.1533333333, 6.2933333333,  6.5866666667,
      12.2711111111, 12.8088888889, 9.2711111111,  9.6622222222,  9.2711111111,
      9.6622222222,  2.9333333333,  3.0666666667,  5.4933333333,  5.7333333333,
      5.4933333333,  5.7333333333,  8.2666666667,  8.6133333333,  5.3333333333,
      5.5466666667,  10.3111111111, 10.7022222222, 7.7511111111,  8.0355555556,
      7.7511111111,  8.0355555556,  2.9333333333,  3.0666666667,  5.4933333333,
      5.7333333333,  5.4933333333,  5.7333333333,  8.2666666667,  8.6133333333,
      5.3333333333,  5.5466666667,  10.3111111111, 10.7022222222, 7.7511111111,
      8.0355555556,  7.7511111111,  8.0355555556,  2.0625,        2.125,
      3.8125,        3.925,         3.8125,        3.925,         5.6625,
      5.825,         3.6,           3.7,           6.85,          7.0333333333,
      5.1,           5.2333333333,  5.1,           5.2333333333,  4.1125,
      4.225,         7.5825,        7.785,         7.5825,        7.785,
      11.2325,       11.525,        7.12,          7.3,           13.5033333333,
      13.8333333333, 10.0333333333, 10.2733333333, 10.0333333333, 10.2733333333,
      4.1125,        4.225,         7.5825,        7.785,         7.5825,
      7.785,         11.2325,       11.525,        7.12,          7.3,
      13.5033333333, 13.8333333333, 10.0333333333, 10.2733333333, 10.0333333333,
      10.2733333333, 6.5625,        6.725,         12.0725,       12.365,
      12.0725,       12.365,        17.8425,       18.265,        11.28,
      11.54,         21.33,         21.8066666667, 15.82,         16.1666666667,
      15.82,         16.1666666667, 4.5,           4.6,           8.26,
      8.44,          8.26,          8.44,          12.18,         12.44,
      7.68,          7.84,          14.48,         14.7733333333, 10.72,
      10.9333333333, 10.72,         10.9333333333, 9.25,          9.4333333333,
      16.9433333333, 17.2733333333, 16.9433333333, 17.2733333333, 24.93,
      25.4066666667, 15.68,         15.9733333333, 29.48,         30.0177777778,
      21.7866666667, 22.1777777778, 21.7866666667, 22.1777777778, 7.2,
      7.3333333333,  13.1733333333, 13.4133333333, 13.1733333333, 13.4133333333,
      19.36,         19.7066666667, 12.16,         12.3733333333, 22.8266666667,
      23.2177777778, 16.8533333333, 17.1377777778, 16.8533333333, 17.1377777778,
      7.2,           7.3333333333,  13.1733333333, 13.4133333333, 13.1733333333,
      13.4133333333, 19.36,         19.7066666667, 12.16,         12.3733333333,
      22.8266666667, 23.2177777778, 16.8533333333, 17.1377777778, 16.8533333333,
      17.1377777778, 4.0625,        4.125,         7.4125,        7.525,
      7.4125,        7.525,         10.8625,       11.025,        6.8,
      6.9,           12.7166666667, 12.9,          9.3666666667,  9.5,
      9.3666666667,  9.5,           7.7125,        7.825,         14.0625,
      14.265,        14.0625,       14.265,        20.5925,       20.885,
      12.88,         13.06,         24.0633333333, 24.3933333333, 17.7133333333,
      17.9533333333, 17.7133333333, 17.9533333333, 7.7125,        7.825,
      14.0625,       14.265,        14.0625,       14.265,        20.5925,
      20.885,        12.88,         13.06,         24.0633333333, 24.3933333333,
      17.7133333333, 17.9533333333, 17.7133333333, 17.9533333333, 11.7625,
      11.925,        21.4325,       21.725,        21.4325,       21.725,
      31.3625,       31.785,        19.6,          19.86,         36.5833333333,
      37.06,         26.9133333333, 27.26,         26.9133333333, 27.26,
      7.7,           7.8,           14.02,         14.2,          14.02,
      14.2,          20.5,          20.76,         12.8,          12.96,
      23.8666666667, 24.16,         17.5466666667, 17.76,         17.5466666667,
      17.76,         15.1166666667, 15.3,          27.5033333333, 27.8333333333,
      27.5033333333, 27.8333333333, 40.1833333333, 40.66,         25.0666666667,
      25.36,         46.6888888889, 47.2266666667, 34.3022222222, 34.6933333333,
      34.3022222222, 34.6933333333, 11.4666666667, 11.6,          20.8533333333,
      21.0933333333, 20.8533333333, 21.0933333333, 30.4533333333, 30.8,
      18.9866666667, 19.2,          35.3422222222, 35.7333333333, 25.9555555556,
      26.24,         25.9555555556, 26.24,         11.4666666667, 11.6,
      20.8533333333, 21.0933333333, 20.8533333333, 21.0933333333, 30.4533333333,
      30.8,          18.9866666667, 19.2,          35.3422222222, 35.7333333333,
      25.9555555556, 26.24,         25.9555555556, 26.24,
  };
  const std::array<int, 4> in_shape = {{3, 8, 8, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID3x8x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.04, 0.08, 0.04, 0.08, 0.16, 0.24, 0.16, 0.24, 0.16, 0.24, 0.12, 0.16,
      0.12, 0.16, 0.,   0.,   0.04, 0.08, 0.04, 0.08, 0.16, 0.24, 0.16, 0.24,
      0.16, 0.24, 0.12, 0.16, 0.12, 0.16, 0.,   0.,   0.24, 0.32, 0.24, 0.32,
      0.64, 0.8,  0.64, 0.8,  0.64, 0.8,  0.4,  0.48, 0.4,  0.48, 0.,   0.,
      0.24, 0.32, 0.24, 0.32, 0.64, 0.8,  0.64, 0.8,  0.64, 0.8,  0.4,  0.48,
      0.4,  0.48, 0.,   0.,   0.24, 0.32, 0.24, 0.32, 0.64, 0.8,  0.64, 0.8,
      0.64, 0.8,  0.4,  0.48, 0.4,  0.48, 0.,   0.,   0.2,  0.24, 0.2,  0.24,
      0.48, 0.56, 0.48, 0.56, 0.48, 0.56, 0.28, 0.32, 0.28, 0.32, 0.,   0.,
      0.2,  0.24, 0.2,  0.24, 0.48, 0.56, 0.48, 0.56, 0.48, 0.56, 0.28, 0.32,
      0.28, 0.32, 0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.36, 0.4,  0.36, 0.4,
      0.8,  0.88, 0.8,  0.88, 0.8,  0.88, 0.44, 0.48, 0.44, 0.48, 0.,   0.,
      0.36, 0.4,  0.36, 0.4,  0.8,  0.88, 0.8,  0.88, 0.8,  0.88, 0.44, 0.48,
      0.44, 0.48, 0.,   0.,   0.88, 0.96, 0.88, 0.96, 1.92, 2.08, 1.92, 2.08,
      1.92, 2.08, 1.04, 1.12, 1.04, 1.12, 0.,   0.,   0.88, 0.96, 0.88, 0.96,
      1.92, 2.08, 1.92, 2.08, 1.92, 2.08, 1.04, 1.12, 1.04, 1.12, 0.,   0.,
      0.88, 0.96, 0.88, 0.96, 1.92, 2.08, 1.92, 2.08, 1.92, 2.08, 1.04, 1.12,
      1.04, 1.12, 0.,   0.,   0.52, 0.56, 0.52, 0.56, 1.12, 1.2,  1.12, 1.2,
      1.12, 1.2,  0.6,  0.64, 0.6,  0.64, 0.,   0.,   0.52, 0.56, 0.52, 0.56,
      1.12, 1.2,  1.12, 1.2,  1.12, 1.2,  0.6,  0.64, 0.6,  0.64, 0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.68, 0.72, 0.68, 0.72, 1.44, 1.52, 1.44, 1.52,
      1.44, 1.52, 0.76, 0.8,  0.76, 0.8,  0.,   0.,   0.68, 0.72, 0.68, 0.72,
      1.44, 1.52, 1.44, 1.52, 1.44, 1.52, 0.76, 0.8,  0.76, 0.8,  0.,   0.,
      1.52, 1.6,  1.52, 1.6,  3.2,  3.36, 3.2,  3.36, 3.2,  3.36, 1.68, 1.76,
      1.68, 1.76, 0.,   0.,   1.52, 1.6,  1.52, 1.6,  3.2,  3.36, 3.2,  3.36,
      3.2,  3.36, 1.68, 1.76, 1.68, 1.76, 0.,   0.,   1.52, 1.6,  1.52, 1.6,
      3.2,  3.36, 3.2,  3.36, 3.2,  3.36, 1.68, 1.76, 1.68, 1.76, 0.,   0.,
      0.84, 0.88, 0.84, 0.88, 1.76, 1.84, 1.76, 1.84, 1.76, 1.84, 0.92, 0.96,
      0.92, 0.96, 0.,   0.,   0.84, 0.88, 0.84, 0.88, 1.76, 1.84, 1.76, 1.84,
      1.76, 1.84, 0.92, 0.96, 0.92, 0.96, 0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
  };
  const std::array<int, 4> in_shape = {{3, 8, 8, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME3x8x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.0625,
      0.125,
      0.1875,
      0.25,
      0.3125,
      0.425,
      0.5375,
      0.65,
      0.3125,
      0.425,
      0.5375,
      0.65,
      0.7625,
      0.925,
      1.0875,
      1.25,
      0.7,
      0.8,
      0.9,
      1.,
      1.7833333333,
      1.9666666667,
      2.15,
      2.3333333333,
      1.5333333333,
      1.6666666667,
      1.8,
      1.9333333333,
      1.5333333333,
      1.6666666667,
      1.8,
      1.9333333333,
      0.9125,
      1.025,
      1.1375,
      1.25,
      2.0025,
      2.205,
      2.4075,
      2.61,
      2.0025,
      2.205,
      2.4075,
      2.61,
      3.4525,
      3.745,
      4.0375,
      4.33,
      2.54,
      2.72,
      2.9,
      3.08,
      5.5566666667,
      5.8866666667,
      6.2166666667,
      6.5466666667,
      4.4666666667,
      4.7066666667,
      4.9466666667,
      5.1866666667,
      4.4666666667,
      4.7066666667,
      4.9466666667,
      5.1866666667,
      0.9125,
      1.025,
      1.1375,
      1.25,
      2.0025,
      2.205,
      2.4075,
      2.61,
      2.0025,
      2.205,
      2.4075,
      2.61,
      3.4525,
      3.745,
      4.0375,
      4.33,
      2.54,
      2.72,
      2.9,
      3.08,
      5.5566666667,
      5.8866666667,
      6.2166666667,
      6.5466666667,
      4.4666666667,
      4.7066666667,
      4.9466666667,
      5.1866666667,
      4.4666666667,
      4.7066666667,
      4.9466666667,
      5.1866666667,
      2.5625,
      2.725,
      2.8875,
      3.05,
      5.1325,
      5.425,
      5.7175,
      6.01,
      5.1325,
      5.425,
      5.7175,
      6.01,
      8.2225,
      8.645,
      9.0675,
      9.49,
      5.66,
      5.92,
      6.18,
      6.44,
      11.6766666667,
      12.1533333333,
      12.63,
      13.1066666667,
      9.1066666667,
      9.4533333333,
      9.8,
      10.1466666667,
      9.1066666667,
      9.4533333333,
      9.8,
      10.1466666667,
      2.5,
      2.6,
      2.7,
      2.8,
      4.82,
      5.,
      5.18,
      5.36,
      4.82,
      5.,
      5.18,
      5.36,
      7.46,
      7.72,
      7.98,
      8.24,
      4.96,
      5.12,
      5.28,
      5.44,
      9.8933333333,
      10.1866666667,
      10.48,
      10.7733333333,
      7.5733333333,
      7.7866666667,
      8.,
      8.2133333333,
      7.5733333333,
      7.7866666667,
      8.,
      8.2133333333,
      6.5833333333,
      6.7666666667,
      6.95,
      7.1333333333,
      12.4366666667,
      12.7666666667,
      13.0966666667,
      13.4266666667,
      12.4366666667,
      12.7666666667,
      13.0966666667,
      13.4266666667,
      18.8766666667,
      19.3533333333,
      19.83,
      20.3066666667,
      12.2933333333,
      12.5866666667,
      12.88,
      13.1733333333,
      24.0044444444,
      24.5422222222,
      25.08,
      25.6177777778,
      18.1511111111,
      18.5422222222,
      18.9333333333,
      19.3244444444,
      18.1511111111,
      18.5422222222,
      18.9333333333,
      19.3244444444,
      5.7333333333,
      5.8666666667,
      6.,
      6.1333333333,
      10.7466666667,
      10.9866666667,
      11.2266666667,
      11.4666666667,
      10.7466666667,
      10.9866666667,
      11.2266666667,
      11.4666666667,
      16.1866666667,
      16.5333333333,
      16.88,
      17.2266666667,
      10.4533333333,
      10.6666666667,
      10.88,
      11.0933333333,
      20.2311111111,
      20.6222222222,
      21.0133333333,
      21.4044444444,
      15.2177777778,
      15.5022222222,
      15.7866666667,
      16.0711111111,
      15.2177777778,
      15.5022222222,
      15.7866666667,
      16.0711111111,
      5.7333333333,
      5.8666666667,
      6.,
      6.1333333333,
      10.7466666667,
      10.9866666667,
      11.2266666667,
      11.4666666667,
      10.7466666667,
      10.9866666667,
      11.2266666667,
      11.4666666667,
      16.1866666667,
      16.5333333333,
      16.88,
      17.2266666667,
      10.4533333333,
      10.6666666667,
      10.88,
      11.0933333333,
      20.2311111111,
      20.6222222222,
      21.0133333333,
      21.4044444444,
      15.2177777778,
      15.5022222222,
      15.7866666667,
      16.0711111111,
      15.2177777778,
      15.5022222222,
      15.7866666667,
      16.0711111111,
      4.0625,
      4.125,
      4.1875,
      4.25,
      7.5125,
      7.625,
      7.7375,
      7.85,
      7.5125,
      7.625,
      7.7375,
      7.85,
      11.1625,
      11.325,
      11.4875,
      11.65,
      7.1,
      7.2,
      7.3,
      7.4,
      13.5166666667,
      13.7,
      13.8833333333,
      14.0666666667,
      10.0666666667,
      10.2,
      10.3333333333,
      10.4666666667,
      10.0666666667,
      10.2,
      10.3333333333,
      10.4666666667,
      8.1125,
      8.225,
      8.3375,
      8.45,
      14.9625,
      15.165,
      15.3675,
      15.57,
      14.9625,
      15.165,
      15.3675,
      15.57,
      22.1725,
      22.465,
      22.7575,
      23.05,
      14.06,
      14.24,
      14.42,
      14.6,
      26.6766666667,
      27.0066666667,
      27.3366666667,
      27.6666666667,
      19.8266666667,
      20.0666666667,
      20.3066666667,
      20.5466666667,
      19.8266666667,
      20.0666666667,
      20.3066666667,
      20.5466666667,
      8.1125,
      8.225,
      8.3375,
      8.45,
      14.9625,
      15.165,
      15.3675,
      15.57,
      14.9625,
      15.165,
      15.3675,
      15.57,
      22.1725,
      22.465,
      22.7575,
      23.05,
      14.06,
      14.24,
      14.42,
      14.6,
      26.6766666667,
      27.0066666667,
      27.3366666667,
      27.6666666667,
      19.8266666667,
      20.0666666667,
      20.3066666667,
      20.5466666667,
      19.8266666667,
      20.0666666667,
      20.3066666667,
      20.5466666667,
      12.9625,
      13.125,
      13.2875,
      13.45,
      23.8525,
      24.145,
      24.4375,
      24.73,
      23.8525,
      24.145,
      24.4375,
      24.73,
      35.2625,
      35.685,
      36.1075,
      36.53,
      22.3,
      22.56,
      22.82,
      23.08,
      42.1833333333,
      42.66,
      43.1366666667,
      43.6133333333,
      31.2933333333,
      31.64,
      31.9866666667,
      32.3333333333,
      31.2933333333,
      31.64,
      31.9866666667,
      32.3333333333,
      8.9,
      9.,
      9.1,
      9.2,
      16.34,
      16.52,
      16.7,
      16.88,
      16.34,
      16.52,
      16.7,
      16.88,
      24.1,
      24.36,
      24.62,
      24.88,
      15.2,
      15.36,
      15.52,
      15.68,
      28.6666666667,
      28.96,
      29.2533333333,
      29.5466666667,
      21.2266666667,
      21.44,
      21.6533333333,
      21.8666666667,
      21.2266666667,
      21.44,
      21.6533333333,
      21.8666666667,
      18.3166666667,
      18.5,
      18.6833333333,
      18.8666666667,
      33.5566666667,
      33.8866666667,
      34.2166666667,
      34.5466666667,
      33.5566666667,
      33.8866666667,
      34.2166666667,
      34.5466666667,
      49.3833333333,
      49.86,
      50.3366666667,
      50.8133333333,
      31.0666666667,
      31.36,
      31.6533333333,
      31.9466666667,
      58.4222222222,
      58.96,
      59.4977777778,
      60.0355555556,
      43.1822222222,
      43.5733333333,
      43.9644444444,
      44.3555555556,
      43.1822222222,
      43.5733333333,
      43.9644444444,
      44.3555555556,
      14.2666666667,
      14.4,
      14.5333333333,
      14.6666666667,
      26.1066666667,
      26.3466666667,
      26.5866666667,
      26.8266666667,
      26.1066666667,
      26.3466666667,
      26.5866666667,
      26.8266666667,
      38.3733333333,
      38.72,
      39.0666666667,
      39.4133333333,
      24.1066666667,
      24.32,
      24.5333333333,
      24.7466666667,
      45.2622222222,
      45.6533333333,
      46.0444444444,
      46.4355555556,
      33.4222222222,
      33.7066666667,
      33.9911111111,
      34.2755555556,
      33.4222222222,
      33.7066666667,
      33.9911111111,
      34.2755555556,
      14.2666666667,
      14.4,
      14.5333333333,
      14.6666666667,
      26.1066666667,
      26.3466666667,
      26.5866666667,
      26.8266666667,
      26.1066666667,
      26.3466666667,
      26.5866666667,
      26.8266666667,
      38.3733333333,
      38.72,
      39.0666666667,
      39.4133333333,
      24.1066666667,
      24.32,
      24.5333333333,
      24.7466666667,
      45.2622222222,
      45.6533333333,
      46.0444444444,
      46.4355555556,
      33.4222222222,
      33.7066666667,
      33.9911111111,
      34.2755555556,
      33.4222222222,
      33.7066666667,
      33.9911111111,
      34.2755555556,
      8.0625,
      8.125,
      8.1875,
      8.25,
      14.7125,
      14.825,
      14.9375,
      15.05,
      14.7125,
      14.825,
      14.9375,
      15.05,
      21.5625,
      21.725,
      21.8875,
      22.05,
      13.5,
      13.6,
      13.7,
      13.8,
      25.25,
      25.4333333333,
      25.6166666667,
      25.8,
      18.6,
      18.7333333333,
      18.8666666667,
      19.,
      18.6,
      18.7333333333,
      18.8666666667,
      19.,
      15.3125,
      15.425,
      15.5375,
      15.65,
      27.9225,
      28.125,
      28.3275,
      28.53,
      27.9225,
      28.125,
      28.3275,
      28.53,
      40.8925,
      41.185,
      41.4775,
      41.77,
      25.58,
      25.76,
      25.94,
      26.12,
      47.7966666667,
      48.1266666667,
      48.4566666667,
      48.7866666667,
      35.1866666667,
      35.4266666667,
      35.6666666667,
      35.9066666667,
      35.1866666667,
      35.4266666667,
      35.6666666667,
      35.9066666667,
      15.3125,
      15.425,
      15.5375,
      15.65,
      27.9225,
      28.125,
      28.3275,
      28.53,
      27.9225,
      28.125,
      28.3275,
      28.53,
      40.8925,
      41.185,
      41.4775,
      41.77,
      25.58,
      25.76,
      25.94,
      26.12,
      47.7966666667,
      48.1266666667,
      48.4566666667,
      48.7866666667,
      35.1866666667,
      35.4266666667,
      35.6666666667,
      35.9066666667,
      35.1866666667,
      35.4266666667,
      35.6666666667,
      35.9066666667,
      23.3625,
      23.525,
      23.6875,
      23.85,
      42.5725,
      42.865,
      43.1575,
      43.45,
      42.5725,
      42.865,
      43.1575,
      43.45,
      62.3025,
      62.725,
      63.1475,
      63.57,
      38.94,
      39.2,
      39.46,
      39.72,
      72.69,
      73.1666666667,
      73.6433333333,
      74.12,
      53.48,
      53.8266666667,
      54.1733333333,
      54.52,
      53.48,
      53.8266666667,
      54.1733333333,
      54.52,
      15.3,
      15.4,
      15.5,
      15.6,
      27.86,
      28.04,
      28.22,
      28.4,
      27.86,
      28.04,
      28.22,
      28.4,
      40.74,
      41.,
      41.26,
      41.52,
      25.44,
      25.6,
      25.76,
      25.92,
      47.44,
      47.7333333333,
      48.0266666667,
      48.32,
      34.88,
      35.0933333333,
      35.3066666667,
      35.52,
      34.88,
      35.0933333333,
      35.3066666667,
      35.52,
      30.05,
      30.2333333333,
      30.4166666667,
      30.6,
      54.6766666667,
      55.0066666667,
      55.3366666667,
      55.6666666667,
      54.6766666667,
      55.0066666667,
      55.3366666667,
      55.6666666667,
      79.89,
      80.3666666667,
      80.8433333333,
      81.32,
      49.84,
      50.1333333333,
      50.4266666667,
      50.72,
      92.84,
      93.3777777778,
      93.9155555556,
      94.4533333333,
      68.2133333333,
      68.6044444444,
      68.9955555556,
      69.3866666667,
      68.2133333333,
      68.6044444444,
      68.9955555556,
      69.3866666667,
      22.8,
      22.9333333333,
      23.0666666667,
      23.2,
      41.4666666667,
      41.7066666667,
      41.9466666667,
      42.1866666667,
      41.4666666667,
      41.7066666667,
      41.9466666667,
      42.1866666667,
      60.56,
      60.9066666667,
      61.2533333333,
      61.6,
      37.76,
      37.9733333333,
      38.1866666667,
      38.4,
      70.2933333333,
      70.6844444444,
      71.0755555556,
      71.4666666667,
      51.6266666667,
      51.9111111111,
      52.1955555556,
      52.48,
      51.6266666667,
      51.9111111111,
      52.1955555556,
      52.48,
      22.8,
      22.9333333333,
      23.0666666667,
      23.2,
      41.4666666667,
      41.7066666667,
      41.9466666667,
      42.1866666667,
      41.4666666667,
      41.7066666667,
      41.9466666667,
      42.1866666667,
      60.56,
      60.9066666667,
      61.2533333333,
      61.6,
      37.76,
      37.9733333333,
      38.1866666667,
      38.4,
      70.2933333333,
      70.6844444444,
      71.0755555556,
      71.4666666667,
      51.6266666667,
      51.9111111111,
      52.1955555556,
      52.48,
      51.6266666667,
      51.9111111111,
      52.1955555556,
      52.48,
  };
  const std::array<int, 4> in_shape = {{3, 8, 8, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID3x8x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.04, 0.08, 0.12, 0.16, 0.04, 0.08, 0.12, 0.16, 0.24, 0.32, 0.4,  0.48,
      0.24, 0.32, 0.4,  0.48, 0.24, 0.32, 0.4,  0.48, 0.2,  0.24, 0.28, 0.32,
      0.2,  0.24, 0.28, 0.32, 0.,   0.,   0.,   0.,   0.04, 0.08, 0.12, 0.16,
      0.04, 0.08, 0.12, 0.16, 0.24, 0.32, 0.4,  0.48, 0.24, 0.32, 0.4,  0.48,
      0.24, 0.32, 0.4,  0.48, 0.2,  0.24, 0.28, 0.32, 0.2,  0.24, 0.28, 0.32,
      0.,   0.,   0.,   0.,   0.4,  0.48, 0.56, 0.64, 0.4,  0.48, 0.56, 0.64,
      1.12, 1.28, 1.44, 1.6,  1.12, 1.28, 1.44, 1.6,  1.12, 1.28, 1.44, 1.6,
      0.72, 0.8,  0.88, 0.96, 0.72, 0.8,  0.88, 0.96, 0.,   0.,   0.,   0.,
      0.4,  0.48, 0.56, 0.64, 0.4,  0.48, 0.56, 0.64, 1.12, 1.28, 1.44, 1.6,
      1.12, 1.28, 1.44, 1.6,  1.12, 1.28, 1.44, 1.6,  0.72, 0.8,  0.88, 0.96,
      0.72, 0.8,  0.88, 0.96, 0.,   0.,   0.,   0.,   0.4,  0.48, 0.56, 0.64,
      0.4,  0.48, 0.56, 0.64, 1.12, 1.28, 1.44, 1.6,  1.12, 1.28, 1.44, 1.6,
      1.12, 1.28, 1.44, 1.6,  0.72, 0.8,  0.88, 0.96, 0.72, 0.8,  0.88, 0.96,
      0.,   0.,   0.,   0.,   0.36, 0.4,  0.44, 0.48, 0.36, 0.4,  0.44, 0.48,
      0.88, 0.96, 1.04, 1.12, 0.88, 0.96, 1.04, 1.12, 0.88, 0.96, 1.04, 1.12,
      0.52, 0.56, 0.6,  0.64, 0.52, 0.56, 0.6,  0.64, 0.,   0.,   0.,   0.,
      0.36, 0.4,  0.44, 0.48, 0.36, 0.4,  0.44, 0.48, 0.88, 0.96, 1.04, 1.12,
      0.88, 0.96, 1.04, 1.12, 0.88, 0.96, 1.04, 1.12, 0.52, 0.56, 0.6,  0.64,
      0.52, 0.56, 0.6,  0.64, 0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.68, 0.72, 0.76, 0.8,  0.68, 0.72, 0.76, 0.8,
      1.52, 1.6,  1.68, 1.76, 1.52, 1.6,  1.68, 1.76, 1.52, 1.6,  1.68, 1.76,
      0.84, 0.88, 0.92, 0.96, 0.84, 0.88, 0.92, 0.96, 0.,   0.,   0.,   0.,
      0.68, 0.72, 0.76, 0.8,  0.68, 0.72, 0.76, 0.8,  1.52, 1.6,  1.68, 1.76,
      1.52, 1.6,  1.68, 1.76, 1.52, 1.6,  1.68, 1.76, 0.84, 0.88, 0.92, 0.96,
      0.84, 0.88, 0.92, 0.96, 0.,   0.,   0.,   0.,   1.68, 1.76, 1.84, 1.92,
      1.68, 1.76, 1.84, 1.92, 3.68, 3.84, 4.,   4.16, 3.68, 3.84, 4.,   4.16,
      3.68, 3.84, 4.,   4.16, 2.,   2.08, 2.16, 2.24, 2.,   2.08, 2.16, 2.24,
      0.,   0.,   0.,   0.,   1.68, 1.76, 1.84, 1.92, 1.68, 1.76, 1.84, 1.92,
      3.68, 3.84, 4.,   4.16, 3.68, 3.84, 4.,   4.16, 3.68, 3.84, 4.,   4.16,
      2.,   2.08, 2.16, 2.24, 2.,   2.08, 2.16, 2.24, 0.,   0.,   0.,   0.,
      1.68, 1.76, 1.84, 1.92, 1.68, 1.76, 1.84, 1.92, 3.68, 3.84, 4.,   4.16,
      3.68, 3.84, 4.,   4.16, 3.68, 3.84, 4.,   4.16, 2.,   2.08, 2.16, 2.24,
      2.,   2.08, 2.16, 2.24, 0.,   0.,   0.,   0.,   1.,   1.04, 1.08, 1.12,
      1.,   1.04, 1.08, 1.12, 2.16, 2.24, 2.32, 2.4,  2.16, 2.24, 2.32, 2.4,
      2.16, 2.24, 2.32, 2.4,  1.16, 1.2,  1.24, 1.28, 1.16, 1.2,  1.24, 1.28,
      0.,   0.,   0.,   0.,   1.,   1.04, 1.08, 1.12, 1.,   1.04, 1.08, 1.12,
      2.16, 2.24, 2.32, 2.4,  2.16, 2.24, 2.32, 2.4,  2.16, 2.24, 2.32, 2.4,
      1.16, 1.2,  1.24, 1.28, 1.16, 1.2,  1.24, 1.28, 0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   1.32, 1.36, 1.4,  1.44,
      1.32, 1.36, 1.4,  1.44, 2.8,  2.88, 2.96, 3.04, 2.8,  2.88, 2.96, 3.04,
      2.8,  2.88, 2.96, 3.04, 1.48, 1.52, 1.56, 1.6,  1.48, 1.52, 1.56, 1.6,
      0.,   0.,   0.,   0.,   1.32, 1.36, 1.4,  1.44, 1.32, 1.36, 1.4,  1.44,
      2.8,  2.88, 2.96, 3.04, 2.8,  2.88, 2.96, 3.04, 2.8,  2.88, 2.96, 3.04,
      1.48, 1.52, 1.56, 1.6,  1.48, 1.52, 1.56, 1.6,  0.,   0.,   0.,   0.,
      2.96, 3.04, 3.12, 3.2,  2.96, 3.04, 3.12, 3.2,  6.24, 6.4,  6.56, 6.72,
      6.24, 6.4,  6.56, 6.72, 6.24, 6.4,  6.56, 6.72, 3.28, 3.36, 3.44, 3.52,
      3.28, 3.36, 3.44, 3.52, 0.,   0.,   0.,   0.,   2.96, 3.04, 3.12, 3.2,
      2.96, 3.04, 3.12, 3.2,  6.24, 6.4,  6.56, 6.72, 6.24, 6.4,  6.56, 6.72,
      6.24, 6.4,  6.56, 6.72, 3.28, 3.36, 3.44, 3.52, 3.28, 3.36, 3.44, 3.52,
      0.,   0.,   0.,   0.,   2.96, 3.04, 3.12, 3.2,  2.96, 3.04, 3.12, 3.2,
      6.24, 6.4,  6.56, 6.72, 6.24, 6.4,  6.56, 6.72, 6.24, 6.4,  6.56, 6.72,
      3.28, 3.36, 3.44, 3.52, 3.28, 3.36, 3.44, 3.52, 0.,   0.,   0.,   0.,
      1.64, 1.68, 1.72, 1.76, 1.64, 1.68, 1.72, 1.76, 3.44, 3.52, 3.6,  3.68,
      3.44, 3.52, 3.6,  3.68, 3.44, 3.52, 3.6,  3.68, 1.8,  1.84, 1.88, 1.92,
      1.8,  1.84, 1.88, 1.92, 0.,   0.,   0.,   0.,   1.64, 1.68, 1.72, 1.76,
      1.64, 1.68, 1.72, 1.76, 3.44, 3.52, 3.6,  3.68, 3.44, 3.52, 3.6,  3.68,
      3.44, 3.52, 3.6,  3.68, 1.8,  1.84, 1.88, 1.92, 1.8,  1.84, 1.88, 1.92,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
  };
  const std::array<int, 4> in_shape = {{3, 8, 8, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME3x8x10x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.0625,       0.1625,        0.1625,        0.3125,        0.25,
      0.45,         0.35,          0.7666666667,  0.6166666667,  0.6166666667,
      0.3625,       0.7425,        0.7425,        1.2125,        0.85,
      1.41,         1.03,          2.1133333333,  1.6433333333,  1.6433333333,
      0.3625,       0.7425,        0.7425,        1.2125,        0.85,
      1.41,         1.03,          2.1133333333,  1.6433333333,  1.6433333333,
      0.9125,       1.7725,        1.7725,        2.7625,        1.85,
      2.97,         2.11,          4.1933333333,  3.2033333333,  3.2033333333,
      0.85,         1.61,          1.61,          2.45,          1.6,
      2.52,         1.76,          3.4266666667,  2.5866666667,  2.5866666667,
      2.1833333333, 4.0766666667,  4.0766666667,  6.1166666667,  3.9333333333,
      6.12,         4.2266666667,  8.1155555556,  6.0755555556,  6.0755555556,
      1.8833333333, 3.4966666667,  3.4966666667,  5.2166666667,  3.3333333333,
      5.16,         3.5466666667,  6.7688888889,  5.0488888889,  5.0488888889,
      1.8833333333, 3.4966666667,  3.4966666667,  5.2166666667,  3.3333333333,
      5.16,         3.5466666667,  6.7688888889,  5.0488888889,  5.0488888889,
      1.3125,       2.4125,        2.4125,        3.5625,        2.25,
      3.45,         2.35,          4.4333333333,  3.2833333333,  3.2833333333,
      2.6125,       4.7925,        4.7925,        7.0625,        4.45,
      6.81,         4.63,          8.7133333333,  6.4433333333,  6.4433333333,
      2.6125,       4.7925,        4.7925,        7.0625,        4.45,
      6.81,         4.63,          8.7133333333,  6.4433333333,  6.4433333333,
      4.1625,       7.6225,        7.6225,        11.2125,       7.05,
      10.77,        7.31,          13.7266666667, 10.1366666667, 10.1366666667,
      2.85,         5.21,          5.21,          7.65,          4.8,
      7.32,         4.96,          9.2933333333,  6.8533333333,  6.8533333333,
      5.85,         10.6766666667, 10.6766666667, 15.65,         9.8,
      14.92,        10.0933333333, 18.8711111111, 13.8977777778, 13.8977777778,
      4.55,         8.2966666667,  8.2966666667,  12.15,         7.6,
      11.56,        7.8133333333,  14.5911111111, 10.7377777778, 10.7377777778,
      4.55,         8.2966666667,  8.2966666667,  12.15,         7.6,
      11.56,        7.8133333333,  14.5911111111, 10.7377777778, 10.7377777778,
      2.5625,       4.6625,        4.6625,        6.8125,        4.25,
      6.45,         4.35,          8.1,           5.95,          5.95,
      4.8625,       8.8425,        8.8425,        12.9125,       8.05,
      12.21,        8.23,          15.3133333333, 11.2433333333, 11.2433333333,
      4.8625,       8.8425,        8.8425,        12.9125,       8.05,
      12.21,        8.23,          15.3133333333, 11.2433333333, 11.2433333333,
      7.4125,       13.4725,       13.4725,       19.6625,       12.25,
      18.57,        12.51,         23.26,         17.07,         17.07,
      4.85,         8.81,          8.81,          12.85,         8.,
      12.12,        8.16,          15.16,         11.12,         11.12,
      9.5166666667, 17.2766666667, 17.2766666667, 25.1833333333, 15.6666666667,
      23.72,        15.96,         29.6266666667, 21.72,         21.72,
      7.2166666667, 13.0966666667, 13.0966666667, 19.0833333333, 11.8666666667,
      17.96,        12.08,         22.4133333333, 16.4266666667, 16.4266666667,
      7.2166666667, 13.0966666667, 13.0966666667, 19.0833333333, 11.8666666667,
      17.96,        12.08,         22.4133333333, 16.4266666667, 16.4266666667};
  const std::array<int, 4> in_shape = {{3, 8, 10, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID3x8x10x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.04, 0.04, 0.12, 0.12, 0.24, 0.2,  0.2,  0.12, 0.12, 0.,   0.04, 0.04,
      0.12, 0.12, 0.24, 0.2,  0.2,  0.12, 0.12, 0.,   0.2,  0.2,  0.48, 0.48,
      0.84, 0.64, 0.64, 0.36, 0.36, 0.,   0.2,  0.2,  0.48, 0.48, 0.84, 0.64,
      0.64, 0.36, 0.36, 0.,   0.2,  0.2,  0.48, 0.48, 0.84, 0.64, 0.64, 0.36,
      0.36, 0.,   0.16, 0.16, 0.36, 0.36, 0.6,  0.44, 0.44, 0.24, 0.24, 0.,
      0.16, 0.16, 0.36, 0.36, 0.6,  0.44, 0.44, 0.24, 0.24, 0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.28, 0.28, 0.6,  0.6,
      0.96, 0.68, 0.68, 0.36, 0.36, 0.,   0.28, 0.28, 0.6,  0.6,  0.96, 0.68,
      0.68, 0.36, 0.36, 0.,   0.68, 0.68, 1.44, 1.44, 2.28, 1.6,  1.6,  0.84,
      0.84, 0.,   0.68, 0.68, 1.44, 1.44, 2.28, 1.6,  1.6,  0.84, 0.84, 0.,
      0.68, 0.68, 1.44, 1.44, 2.28, 1.6,  1.6,  0.84, 0.84, 0.,   0.4,  0.4,
      0.84, 0.84, 1.32, 0.92, 0.92, 0.48, 0.48, 0.,   0.4,  0.4,  0.84, 0.84,
      1.32, 0.92, 0.92, 0.48, 0.48, 0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.52, 0.52, 1.08, 1.08, 1.68, 1.16, 1.16, 0.6,
      0.6,  0.,   0.52, 0.52, 1.08, 1.08, 1.68, 1.16, 1.16, 0.6,  0.6,  0.,
      1.16, 1.16, 2.4,  2.4,  3.72, 2.56, 2.56, 1.32, 1.32, 0.,   1.16, 1.16,
      2.4,  2.4,  3.72, 2.56, 2.56, 1.32, 1.32, 0.,   1.16, 1.16, 2.4,  2.4,
      3.72, 2.56, 2.56, 1.32, 1.32, 0.,   0.64, 0.64, 1.32, 1.32, 2.04, 1.4,
      1.4,  0.72, 0.72, 0.,   0.64, 0.64, 1.32, 1.32, 2.04, 1.4,  1.4,  0.72,
      0.72, 0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
  };
  const std::array<int, 4> in_shape = {{3, 8, 10, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME3x8x10x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.0625,        0.125,         0.2125,        0.325,
      0.2125,        0.325,         0.4625,        0.625,
      0.4,           0.5,           0.75,          0.9,
      0.6,           0.7,           1.35,          1.5333333333,
      1.1,           1.2333333333,  1.1,           1.2333333333,
      0.6125,        0.725,         1.2825,        1.485,
      1.2825,        1.485,         2.1325,        2.425,
      1.52,          1.7,           2.55,          2.82,
      1.88,          2.06,          3.8966666667,  4.2266666667,
      3.0466666667,  3.2866666667,  3.0466666667,  3.2866666667,
      0.6125,        0.725,         1.2825,        1.485,
      1.2825,        1.485,         2.1325,        2.425,
      1.52,          1.7,           2.55,          2.82,
      1.88,          2.06,          3.8966666667,  4.2266666667,
      3.0466666667,  3.2866666667,  3.0466666667,  3.2866666667,
      1.6625,        1.825,         3.2525,        3.545,
      3.2525,        3.545,         5.1025,        5.525,
      3.44,          3.7,           5.55,          5.94,
      3.96,          4.22,          7.91,          8.3866666667,
      6.06,          6.4066666667,  6.06,          6.4066666667,
      1.6,           1.7,           3.04,          3.22,
      3.04,          3.22,          4.64,          4.9,
      3.04,          3.2,           4.8,           5.04,
      3.36,          3.52,          6.56,          6.8533333333,
      4.96,          5.1733333333,  4.96,          5.1733333333,
      4.1833333333,  4.3666666667,  7.8233333333,  8.1533333333,
      7.8233333333,  8.1533333333,  11.7566666667, 12.2333333333,
      7.5733333333,  7.8666666667,  11.8,          12.24,
      8.16,          8.4533333333,  15.6933333333, 16.2311111111,
      11.76,         12.1511111111, 11.76,         12.1511111111,
      3.6333333333,  3.7666666667,  6.7533333333,  6.9933333333,
      6.7533333333,  6.9933333333,  10.0866666667, 10.4333333333,
      6.4533333333,  6.6666666667,  10.,           10.32,
      6.88,          7.0933333333,  13.1466666667, 13.5377777778,
      9.8133333333,  10.0977777778, 9.8133333333,  10.0977777778,
      3.6333333333,  3.7666666667,  6.7533333333,  6.9933333333,
      6.7533333333,  6.9933333333,  10.0866666667, 10.4333333333,
      6.4533333333,  6.6666666667,  10.,           10.32,
      6.88,          7.0933333333,  13.1466666667, 13.5377777778,
      9.8133333333,  10.0977777778, 9.8133333333,  10.0977777778,
      2.5625,        2.625,         4.7125,        4.825,
      4.7125,        4.825,         6.9625,        7.125,
      4.4,           4.5,           6.75,          6.9,
      4.6,           4.7,           8.6833333333,  8.8666666667,
      6.4333333333,  6.5666666667,  6.4333333333,  6.5666666667,
      5.1125,        5.225,         9.3825,        9.585,
      9.3825,        9.585,         13.8325,       14.125,
      8.72,          8.9,           13.35,         13.62,
      9.08,          9.26,          17.0966666667, 17.4266666667,
      12.6466666667, 12.8866666667, 12.6466666667, 12.8866666667,
      5.1125,        5.225,         9.3825,        9.585,
      9.3825,        9.585,         13.8325,       14.125,
      8.72,          8.9,           13.35,         13.62,
      9.08,          9.26,          17.0966666667, 17.4266666667,
      12.6466666667, 12.8866666667, 12.6466666667, 12.8866666667,
      8.1625,        8.325,         14.9525,       15.245,
      14.9525,       15.245,        22.0025,       22.425,
      13.84,         14.1,          21.15,         21.54,
      14.36,         14.62,         26.9766666667, 27.4533333333,
      19.9266666667, 20.2733333333, 19.9266666667, 20.2733333333,
      5.6,           5.7,           10.24,         10.42,
      10.24,         10.42,         15.04,         15.3,
      9.44,          9.6,           14.4,          14.64,
      9.76,          9.92,          18.2933333333, 18.5866666667,
      13.4933333333, 13.7066666667, 13.4933333333, 13.7066666667,
      11.5166666667, 11.7,          21.0233333333, 21.3533333333,
      21.0233333333, 21.3533333333, 30.8233333333, 31.3,
      19.3066666667, 19.6,          29.4,          29.84,
      19.8933333333, 20.1866666667, 37.2044444444, 37.7422222222,
      27.4044444444, 27.7955555556, 27.4044444444, 27.7955555556,
      8.9666666667,  9.1,           16.3533333333, 16.5933333333,
      16.3533333333, 16.5933333333, 23.9533333333, 24.3,
      14.9866666667, 15.2,          22.8,          23.12,
      15.4133333333, 15.6266666667, 28.7911111111, 29.1822222222,
      21.1911111111, 21.4755555556, 21.1911111111, 21.4755555556,
      8.9666666667,  9.1,           16.3533333333, 16.5933333333,
      16.3533333333, 16.5933333333, 23.9533333333, 24.3,
      14.9866666667, 15.2,          22.8,          23.12,
      15.4133333333, 15.6266666667, 28.7911111111, 29.1822222222,
      21.1911111111, 21.4755555556, 21.1911111111, 21.4755555556,
      5.0625,        5.125,         9.2125,        9.325,
      9.2125,        9.325,         13.4625,       13.625,
      8.4,           8.5,           12.75,         12.9,
      8.6,           8.7,           16.0166666667, 16.2,
      11.7666666667, 11.9,          11.7666666667, 11.9,
      9.6125,        9.725,         17.4825,       17.685,
      17.4825,       17.685,        25.5325,       25.825,
      15.92,         16.1,          24.15,         24.42,
      16.28,         16.46,         30.2966666667, 30.6266666667,
      22.2466666667, 22.4866666667, 22.2466666667, 22.4866666667,
      9.6125,        9.725,         17.4825,       17.685,
      17.4825,       17.685,        25.5325,       25.825,
      15.92,         16.1,          24.15,         24.42,
      16.28,         16.46,         30.2966666667, 30.6266666667,
      22.2466666667, 22.4866666667, 22.2466666667, 22.4866666667,
      14.6625,       14.825,        26.6525,       26.945,
      26.6525,       26.945,        38.9025,       39.325,
      24.24,         24.5,          36.75,         37.14,
      24.76,         25.02,         46.0433333333, 46.52,
      33.7933333333, 34.14,         33.7933333333, 34.14,
      9.6,           9.7,           17.44,         17.62,
      17.44,         17.62,         25.44,         25.7,
      15.84,         16.,           24.,           24.24,
      16.16,         16.32,         30.0266666667, 30.32,
      22.0266666667, 22.24,         22.0266666667, 22.24,
      18.85,         19.0333333333, 34.2233333333, 34.5533333333,
      34.2233333333, 34.5533333333, 49.89,         50.3666666667,
      31.04,         31.3333333333, 47.,           47.44,
      31.6266666667, 31.92,         58.7155555556, 59.2533333333,
      43.0488888889, 43.44,         43.0488888889, 43.44,
      14.3,          14.4333333333, 25.9533333333, 26.1933333333,
      25.9533333333, 26.1933333333, 37.82,         38.1666666667,
      23.52,         23.7333333333, 35.6,          35.92,
      23.9466666667, 24.16,         44.4355555556, 44.8266666667,
      32.5688888889, 32.8533333333, 32.5688888889, 32.8533333333,
      14.3,          14.4333333333, 25.9533333333, 26.1933333333,
      25.9533333333, 26.1933333333, 37.82,         38.1666666667,
      23.52,         23.7333333333, 35.6,          35.92,
      23.9466666667, 24.16,         44.4355555556, 44.8266666667,
      32.5688888889, 32.8533333333, 32.5688888889, 32.8533333333};
  const std::array<int, 4> in_shape = {{3, 8, 10, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID3x8x10x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.04, 0.08, 0.04, 0.08, 0.16, 0.24, 0.16, 0.24, 0.36, 0.48, 0.32, 0.4,
      0.32, 0.4,  0.2,  0.24, 0.2,  0.24, 0.,   0.,   0.04, 0.08, 0.04, 0.08,
      0.16, 0.24, 0.16, 0.24, 0.36, 0.48, 0.32, 0.4,  0.32, 0.4,  0.2,  0.24,
      0.2,  0.24, 0.,   0.,   0.32, 0.4,  0.32, 0.4,  0.8,  0.96, 0.8,  0.96,
      1.44, 1.68, 1.12, 1.28, 1.12, 1.28, 0.64, 0.72, 0.64, 0.72, 0.,   0.,
      0.32, 0.4,  0.32, 0.4,  0.8,  0.96, 0.8,  0.96, 1.44, 1.68, 1.12, 1.28,
      1.12, 1.28, 0.64, 0.72, 0.64, 0.72, 0.,   0.,   0.32, 0.4,  0.32, 0.4,
      0.8,  0.96, 0.8,  0.96, 1.44, 1.68, 1.12, 1.28, 1.12, 1.28, 0.64, 0.72,
      0.64, 0.72, 0.,   0.,   0.28, 0.32, 0.28, 0.32, 0.64, 0.72, 0.64, 0.72,
      1.08, 1.2,  0.8,  0.88, 0.8,  0.88, 0.44, 0.48, 0.44, 0.48, 0.,   0.,
      0.28, 0.32, 0.28, 0.32, 0.64, 0.72, 0.64, 0.72, 1.08, 1.2,  0.8,  0.88,
      0.8,  0.88, 0.44, 0.48, 0.44, 0.48, 0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.52, 0.56, 0.52, 0.56, 1.12, 1.2,  1.12, 1.2,
      1.8,  1.92, 1.28, 1.36, 1.28, 1.36, 0.68, 0.72, 0.68, 0.72, 0.,   0.,
      0.52, 0.56, 0.52, 0.56, 1.12, 1.2,  1.12, 1.2,  1.8,  1.92, 1.28, 1.36,
      1.28, 1.36, 0.68, 0.72, 0.68, 0.72, 0.,   0.,   1.28, 1.36, 1.28, 1.36,
      2.72, 2.88, 2.72, 2.88, 4.32, 4.56, 3.04, 3.2,  3.04, 3.2,  1.6,  1.68,
      1.6,  1.68, 0.,   0.,   1.28, 1.36, 1.28, 1.36, 2.72, 2.88, 2.72, 2.88,
      4.32, 4.56, 3.04, 3.2,  3.04, 3.2,  1.6,  1.68, 1.6,  1.68, 0.,   0.,
      1.28, 1.36, 1.28, 1.36, 2.72, 2.88, 2.72, 2.88, 4.32, 4.56, 3.04, 3.2,
      3.04, 3.2,  1.6,  1.68, 1.6,  1.68, 0.,   0.,   0.76, 0.8,  0.76, 0.8,
      1.6,  1.68, 1.6,  1.68, 2.52, 2.64, 1.76, 1.84, 1.76, 1.84, 0.92, 0.96,
      0.92, 0.96, 0.,   0.,   0.76, 0.8,  0.76, 0.8,  1.6,  1.68, 1.6,  1.68,
      2.52, 2.64, 1.76, 1.84, 1.76, 1.84, 0.92, 0.96, 0.92, 0.96, 0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   1.,   1.04, 1.,   1.04,
      2.08, 2.16, 2.08, 2.16, 3.24, 3.36, 2.24, 2.32, 2.24, 2.32, 1.16, 1.2,
      1.16, 1.2,  0.,   0.,   1.,   1.04, 1.,   1.04, 2.08, 2.16, 2.08, 2.16,
      3.24, 3.36, 2.24, 2.32, 2.24, 2.32, 1.16, 1.2,  1.16, 1.2,  0.,   0.,
      2.24, 2.32, 2.24, 2.32, 4.64, 4.8,  4.64, 4.8,  7.2,  7.44, 4.96, 5.12,
      4.96, 5.12, 2.56, 2.64, 2.56, 2.64, 0.,   0.,   2.24, 2.32, 2.24, 2.32,
      4.64, 4.8,  4.64, 4.8,  7.2,  7.44, 4.96, 5.12, 4.96, 5.12, 2.56, 2.64,
      2.56, 2.64, 0.,   0.,   2.24, 2.32, 2.24, 2.32, 4.64, 4.8,  4.64, 4.8,
      7.2,  7.44, 4.96, 5.12, 4.96, 5.12, 2.56, 2.64, 2.56, 2.64, 0.,   0.,
      1.24, 1.28, 1.24, 1.28, 2.56, 2.64, 2.56, 2.64, 3.96, 4.08, 2.72, 2.8,
      2.72, 2.8,  1.4,  1.44, 1.4,  1.44, 0.,   0.,   1.24, 1.28, 1.24, 1.28,
      2.56, 2.64, 2.56, 2.64, 3.96, 4.08, 2.72, 2.8,  2.72, 2.8,  1.4,  1.44,
      1.4,  1.44, 0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
  };
  const std::array<int, 4> in_shape = {{3, 8, 10, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME3x8x10x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.0625,
                                         0.125,
                                         0.1875,
                                         0.25,
                                         0.3125,
                                         0.425,
                                         0.5375,
                                         0.65,
                                         0.3125,
                                         0.425,
                                         0.5375,
                                         0.65,
                                         0.7625,
                                         0.925,
                                         1.0875,
                                         1.25,
                                         0.7,
                                         0.8,
                                         0.9,
                                         1.,
                                         1.35,
                                         1.5,
                                         1.65,
                                         1.8,
                                         1.1,
                                         1.2,
                                         1.3,
                                         1.4,
                                         2.5166666667,
                                         2.7,
                                         2.8833333333,
                                         3.0666666667,
                                         2.0666666667,
                                         2.2,
                                         2.3333333333,
                                         2.4666666667,
                                         2.0666666667,
                                         2.2,
                                         2.3333333333,
                                         2.4666666667,
                                         1.1125,
                                         1.225,
                                         1.3375,
                                         1.45,
                                         2.3625,
                                         2.565,
                                         2.7675,
                                         2.97,
                                         2.3625,
                                         2.565,
                                         2.7675,
                                         2.97,
                                         3.9725,
                                         4.265,
                                         4.5575,
                                         4.85,
                                         2.86,
                                         3.04,
                                         3.22,
                                         3.4,
                                         4.83,
                                         5.1,
                                         5.37,
                                         5.64,
                                         3.58,
                                         3.76,
                                         3.94,
                                         4.12,
                                         7.4633333333,
                                         7.7933333333,
                                         8.1233333333,
                                         8.4533333333,
                                         5.8533333333,
                                         6.0933333333,
                                         6.3333333333,
                                         6.5733333333,
                                         5.8533333333,
                                         6.0933333333,
                                         6.3333333333,
                                         6.5733333333,
                                         1.1125,
                                         1.225,
                                         1.3375,
                                         1.45,
                                         2.3625,
                                         2.565,
                                         2.7675,
                                         2.97,
                                         2.3625,
                                         2.565,
                                         2.7675,
                                         2.97,
                                         3.9725,
                                         4.265,
                                         4.5575,
                                         4.85,
                                         2.86,
                                         3.04,
                                         3.22,
                                         3.4,
                                         4.83,
                                         5.1,
                                         5.37,
                                         5.64,
                                         3.58,
                                         3.76,
                                         3.94,
                                         4.12,
                                         7.4633333333,
                                         7.7933333333,
                                         8.1233333333,
                                         8.4533333333,
                                         5.8533333333,
                                         6.0933333333,
                                         6.3333333333,
                                         6.5733333333,
                                         5.8533333333,
                                         6.0933333333,
                                         6.3333333333,
                                         6.5733333333,
                                         3.1625,
                                         3.325,
                                         3.4875,
                                         3.65,
                                         6.2125,
                                         6.505,
                                         6.7975,
                                         7.09,
                                         6.2125,
                                         6.505,
                                         6.7975,
                                         7.09,
                                         9.7825,
                                         10.205,
                                         10.6275,
                                         11.05,
                                         6.62,
                                         6.88,
                                         7.14,
                                         7.4,
                                         10.71,
                                         11.1,
                                         11.49,
                                         11.88,
                                         7.66,
                                         7.92,
                                         8.18,
                                         8.44,
                                         15.3433333333,
                                         15.82,
                                         16.2966666667,
                                         16.7733333333,
                                         11.7733333333,
                                         12.12,
                                         12.4666666667,
                                         12.8133333333,
                                         11.7733333333,
                                         12.12,
                                         12.4666666667,
                                         12.8133333333,
                                         3.1,
                                         3.2,
                                         3.3,
                                         3.4,
                                         5.9,
                                         6.08,
                                         6.26,
                                         6.44,
                                         5.9,
                                         6.08,
                                         6.26,
                                         6.44,
                                         9.02,
                                         9.28,
                                         9.54,
                                         9.8,
                                         5.92,
                                         6.08,
                                         6.24,
                                         6.4,
                                         9.36,
                                         9.6,
                                         9.84,
                                         10.08,
                                         6.56,
                                         6.72,
                                         6.88,
                                         7.04,
                                         12.8266666667,
                                         13.12,
                                         13.4133333333,
                                         13.7066666667,
                                         9.7066666667,
                                         9.92,
                                         10.1333333333,
                                         10.3466666667,
                                         9.7066666667,
                                         9.92,
                                         10.1333333333,
                                         10.3466666667,
                                         8.1833333333,
                                         8.3666666667,
                                         8.55,
                                         8.7333333333,
                                         15.3166666667,
                                         15.6466666667,
                                         15.9766666667,
                                         16.3066666667,
                                         15.3166666667,
                                         15.6466666667,
                                         15.9766666667,
                                         16.3066666667,
                                         23.0366666667,
                                         23.5133333333,
                                         23.99,
                                         24.4666666667,
                                         14.8533333333,
                                         15.1466666667,
                                         15.44,
                                         15.7333333333,
                                         23.16,
                                         23.6,
                                         24.04,
                                         24.48,
                                         16.0266666667,
                                         16.32,
                                         16.6133333333,
                                         16.9066666667,
                                         30.8488888889,
                                         31.3866666667,
                                         31.9244444444,
                                         32.4622222222,
                                         23.1288888889,
                                         23.52,
                                         23.9111111111,
                                         24.3022222222,
                                         23.1288888889,
                                         23.52,
                                         23.9111111111,
                                         24.3022222222,
                                         7.1333333333,
                                         7.2666666667,
                                         7.4,
                                         7.5333333333,
                                         13.2666666667,
                                         13.5066666667,
                                         13.7466666667,
                                         13.9866666667,
                                         13.2666666667,
                                         13.5066666667,
                                         13.7466666667,
                                         13.9866666667,
                                         19.8266666667,
                                         20.1733333333,
                                         20.52,
                                         20.8666666667,
                                         12.6933333333,
                                         12.9066666667,
                                         13.12,
                                         13.3333333333,
                                         19.68,
                                         20.,
                                         20.32,
                                         20.64,
                                         13.5466666667,
                                         13.76,
                                         13.9733333333,
                                         14.1866666667,
                                         25.9022222222,
                                         26.2933333333,
                                         26.6844444444,
                                         27.0755555556,
                                         19.3422222222,
                                         19.6266666667,
                                         19.9111111111,
                                         20.1955555556,
                                         19.3422222222,
                                         19.6266666667,
                                         19.9111111111,
                                         20.1955555556,
                                         7.1333333333,
                                         7.2666666667,
                                         7.4,
                                         7.5333333333,
                                         13.2666666667,
                                         13.5066666667,
                                         13.7466666667,
                                         13.9866666667,
                                         13.2666666667,
                                         13.5066666667,
                                         13.7466666667,
                                         13.9866666667,
                                         19.8266666667,
                                         20.1733333333,
                                         20.52,
                                         20.8666666667,
                                         12.6933333333,
                                         12.9066666667,
                                         13.12,
                                         13.3333333333,
                                         19.68,
                                         20.,
                                         20.32,
                                         20.64,
                                         13.5466666667,
                                         13.76,
                                         13.9733333333,
                                         14.1866666667,
                                         25.9022222222,
                                         26.2933333333,
                                         26.6844444444,
                                         27.0755555556,
                                         19.3422222222,
                                         19.6266666667,
                                         19.9111111111,
                                         20.1955555556,
                                         19.3422222222,
                                         19.6266666667,
                                         19.9111111111,
                                         20.1955555556,
                                         5.0625,
                                         5.125,
                                         5.1875,
                                         5.25,
                                         9.3125,
                                         9.425,
                                         9.5375,
                                         9.65,
                                         9.3125,
                                         9.425,
                                         9.5375,
                                         9.65,
                                         13.7625,
                                         13.925,
                                         14.0875,
                                         14.25,
                                         8.7,
                                         8.8,
                                         8.9,
                                         9.,
                                         13.35,
                                         13.5,
                                         13.65,
                                         13.8,
                                         9.1,
                                         9.2,
                                         9.3,
                                         9.4,
                                         17.1833333333,
                                         17.3666666667,
                                         17.55,
                                         17.7333333333,
                                         12.7333333333,
                                         12.8666666667,
                                         13.,
                                         13.1333333333,
                                         12.7333333333,
                                         12.8666666667,
                                         13.,
                                         13.1333333333,
                                         10.1125,
                                         10.225,
                                         10.3375,
                                         10.45,
                                         18.5625,
                                         18.765,
                                         18.9675,
                                         19.17,
                                         18.5625,
                                         18.765,
                                         18.9675,
                                         19.17,
                                         27.3725,
                                         27.665,
                                         27.9575,
                                         28.25,
                                         17.26,
                                         17.44,
                                         17.62,
                                         17.8,
                                         26.43,
                                         26.7,
                                         26.97,
                                         27.24,
                                         17.98,
                                         18.16,
                                         18.34,
                                         18.52,
                                         33.8633333333,
                                         34.1933333333,
                                         34.5233333333,
                                         34.8533333333,
                                         25.0533333333,
                                         25.2933333333,
                                         25.5333333333,
                                         25.7733333333,
                                         25.0533333333,
                                         25.2933333333,
                                         25.5333333333,
                                         25.7733333333,
                                         10.1125,
                                         10.225,
                                         10.3375,
                                         10.45,
                                         18.5625,
                                         18.765,
                                         18.9675,
                                         19.17,
                                         18.5625,
                                         18.765,
                                         18.9675,
                                         19.17,
                                         27.3725,
                                         27.665,
                                         27.9575,
                                         28.25,
                                         17.26,
                                         17.44,
                                         17.62,
                                         17.8,
                                         26.43,
                                         26.7,
                                         26.97,
                                         27.24,
                                         17.98,
                                         18.16,
                                         18.34,
                                         18.52,
                                         33.8633333333,
                                         34.1933333333,
                                         34.5233333333,
                                         34.8533333333,
                                         25.0533333333,
                                         25.2933333333,
                                         25.5333333333,
                                         25.7733333333,
                                         25.0533333333,
                                         25.2933333333,
                                         25.5333333333,
                                         25.7733333333,
                                         16.1625,
                                         16.325,
                                         16.4875,
                                         16.65,
                                         29.6125,
                                         29.905,
                                         30.1975,
                                         30.49,
                                         29.6125,
                                         29.905,
                                         30.1975,
                                         30.49,
                                         43.5825,
                                         44.005,
                                         44.4275,
                                         44.85,
                                         27.42,
                                         27.68,
                                         27.94,
                                         28.2,
                                         41.91,
                                         42.3,
                                         42.69,
                                         43.08,
                                         28.46,
                                         28.72,
                                         28.98,
                                         29.24,
                                         53.4766666667,
                                         53.9533333333,
                                         54.43,
                                         54.9066666667,
                                         39.5066666667,
                                         39.8533333333,
                                         40.2,
                                         40.5466666667,
                                         39.5066666667,
                                         39.8533333333,
                                         40.2,
                                         40.5466666667,
                                         11.1,
                                         11.2,
                                         11.3,
                                         11.4,
                                         20.3,
                                         20.48,
                                         20.66,
                                         20.84,
                                         20.3,
                                         20.48,
                                         20.66,
                                         20.84,
                                         29.82,
                                         30.08,
                                         30.34,
                                         30.6,
                                         18.72,
                                         18.88,
                                         19.04,
                                         19.2,
                                         28.56,
                                         28.8,
                                         29.04,
                                         29.28,
                                         19.36,
                                         19.52,
                                         19.68,
                                         19.84,
                                         36.2933333333,
                                         36.5866666667,
                                         36.88,
                                         37.1733333333,
                                         26.7733333333,
                                         26.9866666667,
                                         27.2,
                                         27.4133333333,
                                         26.7733333333,
                                         26.9866666667,
                                         27.2,
                                         27.4133333333,
                                         22.85,
                                         23.0333333333,
                                         23.2166666667,
                                         23.4,
                                         41.7166666667,
                                         42.0466666667,
                                         42.3766666667,
                                         42.7066666667,
                                         41.7166666667,
                                         42.0466666667,
                                         42.3766666667,
                                         42.7066666667,
                                         61.17,
                                         61.6466666667,
                                         62.1233333333,
                                         62.6,
                                         38.32,
                                         38.6133333333,
                                         38.9066666667,
                                         39.2,
                                         58.36,
                                         58.8,
                                         59.24,
                                         59.68,
                                         39.4933333333,
                                         39.7866666667,
                                         40.08,
                                         40.3733333333,
                                         73.8711111111,
                                         74.4088888889,
                                         74.9466666667,
                                         75.4844444444,
                                         54.4177777778,
                                         54.8088888889,
                                         55.2,
                                         55.5911111111,
                                         54.4177777778,
                                         54.8088888889,
                                         55.2,
                                         55.5911111111,
                                         17.8,
                                         17.9333333333,
                                         18.0666666667,
                                         18.2,
                                         32.4666666667,
                                         32.7066666667,
                                         32.9466666667,
                                         33.1866666667,
                                         32.4666666667,
                                         32.7066666667,
                                         32.9466666667,
                                         33.1866666667,
                                         47.56,
                                         47.9066666667,
                                         48.2533333333,
                                         48.6,
                                         29.76,
                                         29.9733333333,
                                         30.1866666667,
                                         30.4,
                                         45.28,
                                         45.6,
                                         45.92,
                                         46.24,
                                         30.6133333333,
                                         30.8266666667,
                                         31.04,
                                         31.2533333333,
                                         57.1911111111,
                                         57.5822222222,
                                         57.9733333333,
                                         58.3644444444,
                                         42.0977777778,
                                         42.3822222222,
                                         42.6666666667,
                                         42.9511111111,
                                         42.0977777778,
                                         42.3822222222,
                                         42.6666666667,
                                         42.9511111111,
                                         17.8,
                                         17.9333333333,
                                         18.0666666667,
                                         18.2,
                                         32.4666666667,
                                         32.7066666667,
                                         32.9466666667,
                                         33.1866666667,
                                         32.4666666667,
                                         32.7066666667,
                                         32.9466666667,
                                         33.1866666667,
                                         47.56,
                                         47.9066666667,
                                         48.2533333333,
                                         48.6,
                                         29.76,
                                         29.9733333333,
                                         30.1866666667,
                                         30.4,
                                         45.28,
                                         45.6,
                                         45.92,
                                         46.24,
                                         30.6133333333,
                                         30.8266666667,
                                         31.04,
                                         31.2533333333,
                                         57.1911111111,
                                         57.5822222222,
                                         57.9733333333,
                                         58.3644444444,
                                         42.0977777778,
                                         42.3822222222,
                                         42.6666666667,
                                         42.9511111111,
                                         42.0977777778,
                                         42.3822222222,
                                         42.6666666667,
                                         42.9511111111,
                                         10.0625,
                                         10.125,
                                         10.1875,
                                         10.25,
                                         18.3125,
                                         18.425,
                                         18.5375,
                                         18.65,
                                         18.3125,
                                         18.425,
                                         18.5375,
                                         18.65,
                                         26.7625,
                                         26.925,
                                         27.0875,
                                         27.25,
                                         16.7,
                                         16.8,
                                         16.9,
                                         17.,
                                         25.35,
                                         25.5,
                                         25.65,
                                         25.8,
                                         17.1,
                                         17.2,
                                         17.3,
                                         17.4,
                                         31.85,
                                         32.0333333333,
                                         32.2166666667,
                                         32.4,
                                         23.4,
                                         23.5333333333,
                                         23.6666666667,
                                         23.8,
                                         23.4,
                                         23.5333333333,
                                         23.6666666667,
                                         23.8,
                                         19.1125,
                                         19.225,
                                         19.3375,
                                         19.45,
                                         34.7625,
                                         34.965,
                                         35.1675,
                                         35.37,
                                         34.7625,
                                         34.965,
                                         35.1675,
                                         35.37,
                                         50.7725,
                                         51.065,
                                         51.3575,
                                         51.65,
                                         31.66,
                                         31.84,
                                         32.02,
                                         32.2,
                                         48.03,
                                         48.3,
                                         48.57,
                                         48.84,
                                         32.38,
                                         32.56,
                                         32.74,
                                         32.92,
                                         60.2633333333,
                                         60.5933333333,
                                         60.9233333333,
                                         61.2533333333,
                                         44.2533333333,
                                         44.4933333333,
                                         44.7333333333,
                                         44.9733333333,
                                         44.2533333333,
                                         44.4933333333,
                                         44.7333333333,
                                         44.9733333333,
                                         19.1125,
                                         19.225,
                                         19.3375,
                                         19.45,
                                         34.7625,
                                         34.965,
                                         35.1675,
                                         35.37,
                                         34.7625,
                                         34.965,
                                         35.1675,
                                         35.37,
                                         50.7725,
                                         51.065,
                                         51.3575,
                                         51.65,
                                         31.66,
                                         31.84,
                                         32.02,
                                         32.2,
                                         48.03,
                                         48.3,
                                         48.57,
                                         48.84,
                                         32.38,
                                         32.56,
                                         32.74,
                                         32.92,
                                         60.2633333333,
                                         60.5933333333,
                                         60.9233333333,
                                         61.2533333333,
                                         44.2533333333,
                                         44.4933333333,
                                         44.7333333333,
                                         44.9733333333,
                                         44.2533333333,
                                         44.4933333333,
                                         44.7333333333,
                                         44.9733333333,
                                         29.1625,
                                         29.325,
                                         29.4875,
                                         29.65,
                                         53.0125,
                                         53.305,
                                         53.5975,
                                         53.89,
                                         53.0125,
                                         53.305,
                                         53.5975,
                                         53.89,
                                         77.3825,
                                         77.805,
                                         78.2275,
                                         78.65,
                                         48.22,
                                         48.48,
                                         48.74,
                                         49.,
                                         73.11,
                                         73.5,
                                         73.89,
                                         74.28,
                                         49.26,
                                         49.52,
                                         49.78,
                                         50.04,
                                         91.61,
                                         92.0866666667,
                                         92.5633333333,
                                         93.04,
                                         67.24,
                                         67.5866666667,
                                         67.9333333333,
                                         68.28,
                                         67.24,
                                         67.5866666667,
                                         67.9333333333,
                                         68.28,
                                         19.1,
                                         19.2,
                                         19.3,
                                         19.4,
                                         34.7,
                                         34.88,
                                         35.06,
                                         35.24,
                                         34.7,
                                         34.88,
                                         35.06,
                                         35.24,
                                         50.62,
                                         50.88,
                                         51.14,
                                         51.4,
                                         31.52,
                                         31.68,
                                         31.84,
                                         32.,
                                         47.76,
                                         48.,
                                         48.24,
                                         48.48,
                                         32.16,
                                         32.32,
                                         32.48,
                                         32.64,
                                         59.76,
                                         60.0533333333,
                                         60.3466666667,
                                         60.64,
                                         43.84,
                                         44.0533333333,
                                         44.2666666667,
                                         44.48,
                                         43.84,
                                         44.0533333333,
                                         44.2666666667,
                                         44.48,
                                         37.5166666667,
                                         37.7,
                                         37.8833333333,
                                         38.0666666667,
                                         68.1166666667,
                                         68.4466666667,
                                         68.7766666667,
                                         69.1066666667,
                                         68.1166666667,
                                         68.4466666667,
                                         68.7766666667,
                                         69.1066666667,
                                         99.3033333333,
                                         99.78,
                                         100.2566666667,
                                         100.7333333333,
                                         61.7866666667,
                                         62.08,
                                         62.3733333333,
                                         62.6666666667,
                                         93.56,
                                         94.,
                                         94.44,
                                         94.88,
                                         62.96,
                                         63.2533333333,
                                         63.5466666667,
                                         63.84,
                                         116.8933333333,
                                         117.4311111111,
                                         117.9688888889,
                                         118.5066666667,
                                         85.7066666667,
                                         86.0977777778,
                                         86.4888888889,
                                         86.88,
                                         85.7066666667,
                                         86.0977777778,
                                         86.4888888889,
                                         86.88,
                                         28.4666666667,
                                         28.6,
                                         28.7333333333,
                                         28.8666666667,
                                         51.6666666667,
                                         51.9066666667,
                                         52.1466666667,
                                         52.3866666667,
                                         51.6666666667,
                                         51.9066666667,
                                         52.1466666667,
                                         52.3866666667,
                                         75.2933333333,
                                         75.64,
                                         75.9866666667,
                                         76.3333333333,
                                         46.8266666667,
                                         47.04,
                                         47.2533333333,
                                         47.4666666667,
                                         70.88,
                                         71.2,
                                         71.52,
                                         71.84,
                                         47.68,
                                         47.8933333333,
                                         48.1066666667,
                                         48.32,
                                         88.48,
                                         88.8711111111,
                                         89.2622222222,
                                         89.6533333333,
                                         64.8533333333,
                                         65.1377777778,
                                         65.4222222222,
                                         65.7066666667,
                                         64.8533333333,
                                         65.1377777778,
                                         65.4222222222,
                                         65.7066666667,
                                         28.4666666667,
                                         28.6,
                                         28.7333333333,
                                         28.8666666667,
                                         51.6666666667,
                                         51.9066666667,
                                         52.1466666667,
                                         52.3866666667,
                                         51.6666666667,
                                         51.9066666667,
                                         52.1466666667,
                                         52.3866666667,
                                         75.2933333333,
                                         75.64,
                                         75.9866666667,
                                         76.3333333333,
                                         46.8266666667,
                                         47.04,
                                         47.2533333333,
                                         47.4666666667,
                                         70.88,
                                         71.2,
                                         71.52,
                                         71.84,
                                         47.68,
                                         47.8933333333,
                                         48.1066666667,
                                         48.32,
                                         88.48,
                                         88.8711111111,
                                         89.2622222222,
                                         89.6533333333,
                                         64.8533333333,
                                         65.1377777778,
                                         65.4222222222,
                                         65.7066666667,
                                         64.8533333333,
                                         65.1377777778,
                                         65.4222222222,
                                         65.7066666667};
  const std::array<int, 4> in_shape = {{3, 8, 10, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID3x8x10x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.04, 0.08,  0.12,  0.16, 0.04,  0.08,  0.12,  0.16, 0.24,  0.32,  0.4,
      0.48, 0.24,  0.32,  0.4,  0.48,  0.6,   0.72,  0.84, 0.96,  0.56,  0.64,
      0.72, 0.8,   0.56,  0.64, 0.72,  0.8,   0.36,  0.4,  0.44,  0.48,  0.36,
      0.4,  0.44,  0.48,  0.,   0.,    0.,    0.,    0.04, 0.08,  0.12,  0.16,
      0.04, 0.08,  0.12,  0.16, 0.24,  0.32,  0.4,   0.48, 0.24,  0.32,  0.4,
      0.48, 0.6,   0.72,  0.84, 0.96,  0.56,  0.64,  0.72, 0.8,   0.56,  0.64,
      0.72, 0.8,   0.36,  0.4,  0.44,  0.48,  0.36,  0.4,  0.44,  0.48,  0.,
      0.,   0.,    0.,    0.56, 0.64,  0.72,  0.8,   0.56, 0.64,  0.72,  0.8,
      1.44, 1.6,   1.76,  1.92, 1.44,  1.6,   1.76,  1.92, 2.64,  2.88,  3.12,
      3.36, 2.08,  2.24,  2.4,  2.56,  2.08,  2.24,  2.4,  2.56,  1.2,   1.28,
      1.36, 1.44,  1.2,   1.28, 1.36,  1.44,  0.,    0.,   0.,    0.,    0.56,
      0.64, 0.72,  0.8,   0.56, 0.64,  0.72,  0.8,   1.44, 1.6,   1.76,  1.92,
      1.44, 1.6,   1.76,  1.92, 2.64,  2.88,  3.12,  3.36, 2.08,  2.24,  2.4,
      2.56, 2.08,  2.24,  2.4,  2.56,  1.2,   1.28,  1.36, 1.44,  1.2,   1.28,
      1.36, 1.44,  0.,    0.,   0.,    0.,    0.56,  0.64, 0.72,  0.8,   0.56,
      0.64, 0.72,  0.8,   1.44, 1.6,   1.76,  1.92,  1.44, 1.6,   1.76,  1.92,
      2.64, 2.88,  3.12,  3.36, 2.08,  2.24,  2.4,   2.56, 2.08,  2.24,  2.4,
      2.56, 1.2,   1.28,  1.36, 1.44,  1.2,   1.28,  1.36, 1.44,  0.,    0.,
      0.,   0.,    0.52,  0.56, 0.6,   0.64,  0.52,  0.56, 0.6,   0.64,  1.2,
      1.28, 1.36,  1.44,  1.2,  1.28,  1.36,  1.44,  2.04, 2.16,  2.28,  2.4,
      1.52, 1.6,   1.68,  1.76, 1.52,  1.6,   1.68,  1.76, 0.84,  0.88,  0.92,
      0.96, 0.84,  0.88,  0.92, 0.96,  0.,    0.,    0.,   0.,    0.52,  0.56,
      0.6,  0.64,  0.52,  0.56, 0.6,   0.64,  1.2,   1.28, 1.36,  1.44,  1.2,
      1.28, 1.36,  1.44,  2.04, 2.16,  2.28,  2.4,   1.52, 1.6,   1.68,  1.76,
      1.52, 1.6,   1.68,  1.76, 0.84,  0.88,  0.92,  0.96, 0.84,  0.88,  0.92,
      0.96, 0.,    0.,    0.,   0.,    0.,    0.,    0.,   0.,    0.,    0.,
      0.,   0.,    0.,    0.,   0.,    0.,    0.,    0.,   0.,    0.,    0.,
      0.,   0.,    0.,    0.,   0.,    0.,    0.,    0.,   0.,    0.,    0.,
      0.,   0.,    0.,    0.,   0.,    0.,    0.,    0.,   0.,    0.,    0.,
      0.,   1.,    1.04,  1.08, 1.12,  1.,    1.04,  1.08, 1.12,  2.16,  2.24,
      2.32, 2.4,   2.16,  2.24, 2.32,  2.4,   3.48,  3.6,  3.72,  3.84,  2.48,
      2.56, 2.64,  2.72,  2.48, 2.56,  2.64,  2.72,  1.32, 1.36,  1.4,   1.44,
      1.32, 1.36,  1.4,   1.44, 0.,    0.,    0.,    0.,   1.,    1.04,  1.08,
      1.12, 1.,    1.04,  1.08, 1.12,  2.16,  2.24,  2.32, 2.4,   2.16,  2.24,
      2.32, 2.4,   3.48,  3.6,  3.72,  3.84,  2.48,  2.56, 2.64,  2.72,  2.48,
      2.56, 2.64,  2.72,  1.32, 1.36,  1.4,   1.44,  1.32, 1.36,  1.4,   1.44,
      0.,   0.,    0.,    0.,   2.48,  2.56,  2.64,  2.72, 2.48,  2.56,  2.64,
      2.72, 5.28,  5.44,  5.6,  5.76,  5.28,  5.44,  5.6,  5.76,  8.4,   8.64,
      8.88, 9.12,  5.92,  6.08, 6.24,  6.4,   5.92,  6.08, 6.24,  6.4,   3.12,
      3.2,  3.28,  3.36,  3.12, 3.2,   3.28,  3.36,  0.,   0.,    0.,    0.,
      2.48, 2.56,  2.64,  2.72, 2.48,  2.56,  2.64,  2.72, 5.28,  5.44,  5.6,
      5.76, 5.28,  5.44,  5.6,  5.76,  8.4,   8.64,  8.88, 9.12,  5.92,  6.08,
      6.24, 6.4,   5.92,  6.08, 6.24,  6.4,   3.12,  3.2,  3.28,  3.36,  3.12,
      3.2,  3.28,  3.36,  0.,   0.,    0.,    0.,    2.48, 2.56,  2.64,  2.72,
      2.48, 2.56,  2.64,  2.72, 5.28,  5.44,  5.6,   5.76, 5.28,  5.44,  5.6,
      5.76, 8.4,   8.64,  8.88, 9.12,  5.92,  6.08,  6.24, 6.4,   5.92,  6.08,
      6.24, 6.4,   3.12,  3.2,  3.28,  3.36,  3.12,  3.2,  3.28,  3.36,  0.,
      0.,   0.,    0.,    1.48, 1.52,  1.56,  1.6,   1.48, 1.52,  1.56,  1.6,
      3.12, 3.2,   3.28,  3.36, 3.12,  3.2,   3.28,  3.36, 4.92,  5.04,  5.16,
      5.28, 3.44,  3.52,  3.6,  3.68,  3.44,  3.52,  3.6,  3.68,  1.8,   1.84,
      1.88, 1.92,  1.8,   1.84, 1.88,  1.92,  0.,    0.,   0.,    0.,    1.48,
      1.52, 1.56,  1.6,   1.48, 1.52,  1.56,  1.6,   3.12, 3.2,   3.28,  3.36,
      3.12, 3.2,   3.28,  3.36, 4.92,  5.04,  5.16,  5.28, 3.44,  3.52,  3.6,
      3.68, 3.44,  3.52,  3.6,  3.68,  1.8,   1.84,  1.88, 1.92,  1.8,   1.84,
      1.88, 1.92,  0.,    0.,   0.,    0.,    0.,    0.,   0.,    0.,    0.,
      0.,   0.,    0.,    0.,   0.,    0.,    0.,    0.,   0.,    0.,    0.,
      0.,   0.,    0.,    0.,   0.,    0.,    0.,    0.,   0.,    0.,    0.,
      0.,   0.,    0.,    0.,   0.,    0.,    0.,    0.,   0.,    0.,    0.,
      0.,   0.,    1.96,  2.,   2.04,  2.08,  1.96,  2.,   2.04,  2.08,  4.08,
      4.16, 4.24,  4.32,  4.08, 4.16,  4.24,  4.32,  6.36, 6.48,  6.6,   6.72,
      4.4,  4.48,  4.56,  4.64, 4.4,   4.48,  4.56,  4.64, 2.28,  2.32,  2.36,
      2.4,  2.28,  2.32,  2.36, 2.4,   0.,    0.,    0.,   0.,    1.96,  2.,
      2.04, 2.08,  1.96,  2.,   2.04,  2.08,  4.08,  4.16, 4.24,  4.32,  4.08,
      4.16, 4.24,  4.32,  6.36, 6.48,  6.6,   6.72,  4.4,  4.48,  4.56,  4.64,
      4.4,  4.48,  4.56,  4.64, 2.28,  2.32,  2.36,  2.4,  2.28,  2.32,  2.36,
      2.4,  0.,    0.,    0.,   0.,    4.4,   4.48,  4.56, 4.64,  4.4,   4.48,
      4.56, 4.64,  9.12,  9.28, 9.44,  9.6,   9.12,  9.28, 9.44,  9.6,   14.16,
      14.4, 14.64, 14.88, 9.76, 9.92,  10.08, 10.24, 9.76, 9.92,  10.08, 10.24,
      5.04, 5.12,  5.2,   5.28, 5.04,  5.12,  5.2,   5.28, 0.,    0.,    0.,
      0.,   4.4,   4.48,  4.56, 4.64,  4.4,   4.48,  4.56, 4.64,  9.12,  9.28,
      9.44, 9.6,   9.12,  9.28, 9.44,  9.6,   14.16, 14.4, 14.64, 14.88, 9.76,
      9.92, 10.08, 10.24, 9.76, 9.92,  10.08, 10.24, 5.04, 5.12,  5.2,   5.28,
      5.04, 5.12,  5.2,   5.28, 0.,    0.,    0.,    0.,   4.4,   4.48,  4.56,
      4.64, 4.4,   4.48,  4.56, 4.64,  9.12,  9.28,  9.44, 9.6,   9.12,  9.28,
      9.44, 9.6,   14.16, 14.4, 14.64, 14.88, 9.76,  9.92, 10.08, 10.24, 9.76,
      9.92, 10.08, 10.24, 5.04, 5.12,  5.2,   5.28,  5.04, 5.12,  5.2,   5.28,
      0.,   0.,    0.,    0.,   2.44,  2.48,  2.52,  2.56, 2.44,  2.48,  2.52,
      2.56, 5.04,  5.12,  5.2,  5.28,  5.04,  5.12,  5.2,  5.28,  7.8,   7.92,
      8.04, 8.16,  5.36,  5.44, 5.52,  5.6,   5.36,  5.44, 5.52,  5.6,   2.76,
      2.8,  2.84,  2.88,  2.76, 2.8,   2.84,  2.88,  0.,   0.,    0.,    0.,
      2.44, 2.48,  2.52,  2.56, 2.44,  2.48,  2.52,  2.56, 5.04,  5.12,  5.2,
      5.28, 5.04,  5.12,  5.2,  5.28,  7.8,   7.92,  8.04, 8.16,  5.36,  5.44,
      5.52, 5.6,   5.36,  5.44, 5.52,  5.6,   2.76,  2.8,  2.84,  2.88,  2.76,
      2.8,  2.84,  2.88,  0.,   0.,    0.,    0.,    0.,   0.,    0.,    0.,
      0.,   0.,    0.,    0.,   0.,    0.,    0.,    0.,   0.,    0.,    0.,
      0.,   0.,    0.,    0.,   0.,    0.,    0.,    0.,   0.,    0.,    0.,
      0.,   0.,    0.,    0.,   0.,    0.,    0.,    0.,   0.,    0.,    0.,
      0.,   0.,    0.,
  };
  const std::array<int, 4> in_shape = {{3, 8, 10, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME3x10x7x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.1833333333,
                                         0.1833333333,
                                         0.3333333333,
                                         0.25,
                                         0.5833333333,
                                         0.4833333333,
                                         0.4833333333,
                                         0.7566666667,
                                         0.7566666667,
                                         1.1866666667,
                                         0.77,
                                         1.6366666667,
                                         1.2966666667,
                                         1.2966666667,
                                         0.7566666667,
                                         0.7566666667,
                                         1.1866666667,
                                         0.77,
                                         1.6366666667,
                                         1.2966666667,
                                         1.2966666667,
                                         1.7566666667,
                                         1.7566666667,
                                         2.6266666667,
                                         1.61,
                                         3.2766666667,
                                         2.5366666667,
                                         2.5366666667,
                                         1.5733333333,
                                         1.5733333333,
                                         2.2933333333,
                                         1.36,
                                         2.6933333333,
                                         2.0533333333,
                                         2.0533333333,
                                         3.,
                                         3.,
                                         4.32,
                                         2.52,
                                         4.92,
                                         3.72,
                                         3.72,
                                         2.4266666667,
                                         2.4266666667,
                                         3.4666666667,
                                         2.,
                                         3.8666666667,
                                         2.9066666667,
                                         2.9066666667,
                                         5.5155555556,
                                         5.5155555556,
                                         7.8222222222,
                                         4.4666666667,
                                         8.5555555556,
                                         6.3955555556,
                                         6.3955555556,
                                         4.5155555556,
                                         4.5155555556,
                                         6.3822222222,
                                         3.6266666667,
                                         6.9155555556,
                                         5.1555555556,
                                         5.1555555556,
                                         4.5155555556,
                                         4.5155555556,
                                         6.3822222222,
                                         3.6266666667,
                                         6.9155555556,
                                         5.1555555556,
                                         5.1555555556,
                                         2.85,
                                         2.85,
                                         4.,
                                         2.25,
                                         4.25,
                                         3.15,
                                         3.15,
                                         5.5566666667,
                                         5.5566666667,
                                         7.7866666667,
                                         4.37,
                                         8.2366666667,
                                         6.0966666667,
                                         6.0966666667,
                                         5.5566666667,
                                         5.5566666667,
                                         7.7866666667,
                                         4.37,
                                         8.2366666667,
                                         6.0966666667,
                                         6.0966666667,
                                         8.69,
                                         8.69,
                                         12.16,
                                         6.81,
                                         12.81,
                                         9.47,
                                         9.47,
                                         5.84,
                                         5.84,
                                         8.16,
                                         4.56,
                                         8.56,
                                         6.32,
                                         6.32,
                                         9.4,
                                         9.4,
                                         13.12,
                                         7.32,
                                         13.72,
                                         10.12,
                                         10.12,
                                         6.6933333333,
                                         6.6933333333,
                                         9.3333333333,
                                         5.2,
                                         9.7333333333,
                                         7.1733333333,
                                         7.1733333333,
                                         13.3377777778,
                                         13.3377777778,
                                         18.5777777778,
                                         10.3333333333,
                                         19.3111111111,
                                         14.2177777778,
                                         14.2177777778,
                                         10.2044444444,
                                         10.2044444444,
                                         14.2044444444,
                                         7.8933333333,
                                         14.7377777778,
                                         10.8444444444,
                                         10.8444444444,
                                         10.2044444444,
                                         10.2044444444,
                                         14.2044444444,
                                         7.8933333333,
                                         14.7377777778,
                                         10.8444444444,
                                         10.8444444444,
                                         5.5166666667,
                                         5.5166666667,
                                         7.6666666667,
                                         4.25,
                                         7.9166666667,
                                         5.8166666667,
                                         5.8166666667,
                                         10.3566666667,
                                         10.3566666667,
                                         14.3866666667,
                                         7.97,
                                         14.8366666667,
                                         10.8966666667,
                                         10.8966666667,
                                         10.3566666667,
                                         10.3566666667,
                                         14.3866666667,
                                         7.97,
                                         14.8366666667,
                                         10.8966666667,
                                         10.8966666667,
                                         15.6233333333,
                                         15.6233333333,
                                         21.6933333333,
                                         12.01,
                                         22.3433333333,
                                         16.4033333333,
                                         16.4033333333,
                                         10.1066666667,
                                         10.1066666667,
                                         14.0266666667,
                                         7.76,
                                         14.4266666667,
                                         10.5866666667,
                                         10.5866666667,
                                         15.8,
                                         15.8,
                                         21.92,
                                         12.12,
                                         22.52,
                                         16.52,
                                         16.52,
                                         10.96,
                                         10.96,
                                         15.2,
                                         8.4,
                                         15.6,
                                         11.44,
                                         11.44,
                                         21.16,
                                         21.16,
                                         29.3333333333,
                                         16.2,
                                         30.0666666667,
                                         22.04,
                                         22.04,
                                         15.8933333333,
                                         15.8933333333,
                                         22.0266666667,
                                         12.16,
                                         22.56,
                                         16.5333333333,
                                         16.5333333333,
                                         15.8933333333,
                                         15.8933333333,
                                         22.0266666667,
                                         12.16,
                                         22.56,
                                         16.5333333333,
                                         16.5333333333};
  const std::array<int, 4> in_shape = {{3, 10, 7, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID3x10x7x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.04, 0.04, 0.12, 0.12, 0.12, 0.08, 0.08, 0.04, 0.04, 0.12, 0.12, 0.12,
      0.08, 0.08, 0.16, 0.16, 0.4,  0.4,  0.4,  0.24, 0.24, 0.16, 0.16, 0.4,
      0.4,  0.4,  0.24, 0.24, 0.36, 0.36, 0.84, 0.84, 0.84, 0.48, 0.48, 0.32,
      0.32, 0.72, 0.72, 0.72, 0.4,  0.4,  0.32, 0.32, 0.72, 0.72, 0.72, 0.4,
      0.4,  0.2,  0.2,  0.44, 0.44, 0.44, 0.24, 0.24, 0.2,  0.2,  0.44, 0.44,
      0.44, 0.24, 0.24, 0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.28, 0.28,
      0.6,  0.6,  0.6,  0.32, 0.32, 0.28, 0.28, 0.6,  0.6,  0.6,  0.32, 0.32,
      0.64, 0.64, 1.36, 1.36, 1.36, 0.72, 0.72, 0.64, 0.64, 1.36, 1.36, 1.36,
      0.72, 0.72, 1.08, 1.08, 2.28, 2.28, 2.28, 1.2,  1.2,  0.8,  0.8,  1.68,
      1.68, 1.68, 0.88, 0.88, 0.8,  0.8,  1.68, 1.68, 1.68, 0.88, 0.88, 0.44,
      0.44, 0.92, 0.92, 0.92, 0.48, 0.48, 0.44, 0.44, 0.92, 0.92, 0.92, 0.48,
      0.48, 0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.52, 0.52, 1.08, 1.08,
      1.08, 0.56, 0.56, 0.52, 0.52, 1.08, 1.08, 1.08, 0.56, 0.56, 1.12, 1.12,
      2.32, 2.32, 2.32, 1.2,  1.2,  1.12, 1.12, 2.32, 2.32, 2.32, 1.2,  1.2,
      1.8,  1.8,  3.72, 3.72, 3.72, 1.92, 1.92, 1.28, 1.28, 2.64, 2.64, 2.64,
      1.36, 1.36, 1.28, 1.28, 2.64, 2.64, 2.64, 1.36, 1.36, 0.68, 0.68, 1.4,
      1.4,  1.4,  0.72, 0.72, 0.68, 0.68, 1.4,  1.4,  1.4,  0.72, 0.72, 0.,
      0.,   0.,   0.,   0.,   0.,   0.,
  };
  const std::array<int, 4> in_shape = {{3, 10, 7, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME3x10x7x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.2333333333,  0.3666666667,
                                         0.2333333333,  0.3666666667,
                                         0.4833333333,  0.6666666667,
                                         0.4,           0.5,
                                         0.9833333333,  1.1666666667,
                                         0.8333333333,  0.9666666667,
                                         0.8333333333,  0.9666666667,
                                         1.2733333333,  1.5133333333,
                                         1.2733333333,  1.5133333333,
                                         2.0433333333,  2.3733333333,
                                         1.36,          1.54,
                                         2.9433333333,  3.2733333333,
                                         2.3533333333,  2.5933333333,
                                         2.3533333333,  2.5933333333,
                                         1.2733333333,  1.5133333333,
                                         1.2733333333,  1.5133333333,
                                         2.0433333333,  2.3733333333,
                                         1.36,          1.54,
                                         2.9433333333,  3.2733333333,
                                         2.3533333333,  2.5933333333,
                                         2.3533333333,  2.5933333333,
                                         3.1666666667,  3.5133333333,
                                         3.1666666667,  3.5133333333,
                                         4.7766666667,  5.2533333333,
                                         2.96,          3.22,
                                         6.0766666667,  6.5533333333,
                                         4.7266666667,  5.0733333333,
                                         4.7266666667,  5.0733333333,
                                         2.9333333333,  3.1466666667,
                                         2.9333333333,  3.1466666667,
                                         4.2933333333,  4.5866666667,
                                         2.56,          2.72,
                                         5.0933333333,  5.3866666667,
                                         3.8933333333,  4.1066666667,
                                         3.8933333333,  4.1066666667,
                                         5.68,          6.,
                                         5.68,          6.,
                                         8.2,           8.64,
                                         4.8,           5.04,
                                         9.4,           9.84,
                                         7.12,          7.44,
                                         7.12,          7.44,
                                         4.64,          4.8533333333,
                                         4.64,          4.8533333333,
                                         6.64,          6.9333333333,
                                         3.84,          4.,
                                         7.44,          7.7333333333,
                                         5.6,           5.8133333333,
                                         5.6,           5.8133333333,
                                         10.64,         11.0311111111,
                                         10.64,         11.0311111111,
                                         15.1066666667, 15.6444444444,
                                         8.64,          8.9333333333,
                                         16.5733333333, 17.1111111111,
                                         12.4,          12.7911111111,
                                         12.4,          12.7911111111,
                                         8.7466666667,  9.0311111111,
                                         8.7466666667,  9.0311111111,
                                         12.3733333333, 12.7644444444,
                                         7.04,          7.2533333333,
                                         13.44,         13.8311111111,
                                         10.0266666667, 10.3111111111,
                                         10.0266666667, 10.3111111111,
                                         8.7466666667,  9.0311111111,
                                         8.7466666667,  9.0311111111,
                                         12.3733333333, 12.7644444444,
                                         7.04,          7.2533333333,
                                         13.44,         13.8311111111,
                                         10.0266666667, 10.3111111111,
                                         10.0266666667, 10.3111111111,
                                         5.5666666667,  5.7,
                                         5.5666666667,  5.7,
                                         7.8166666667,  8.,
                                         4.4,           4.5,
                                         8.3166666667,  8.5,
                                         6.1666666667,  6.3,
                                         6.1666666667,  6.3,
                                         10.8733333333, 11.1133333333,
                                         10.8733333333, 11.1133333333,
                                         15.2433333333, 15.5733333333,
                                         8.56,          8.74,
                                         16.1433333333, 16.4733333333,
                                         11.9533333333, 12.1933333333,
                                         11.9533333333, 12.1933333333,
                                         10.8733333333, 11.1133333333,
                                         10.8733333333, 11.1133333333,
                                         15.2433333333, 15.5733333333,
                                         8.56,          8.74,
                                         16.1433333333, 16.4733333333,
                                         11.9533333333, 12.1933333333,
                                         11.9533333333, 12.1933333333,
                                         17.0333333333, 17.38,
                                         17.0333333333, 17.38,
                                         23.8433333333, 24.32,
                                         13.36,         13.62,
                                         25.1433333333, 25.62,
                                         18.5933333333, 18.94,
                                         18.5933333333, 18.94,
                                         11.4666666667, 11.68,
                                         11.4666666667, 11.68,
                                         16.0266666667, 16.32,
                                         8.96,          9.12,
                                         16.8266666667, 17.12,
                                         12.4266666667, 12.64,
                                         12.4266666667, 12.64,
                                         18.48,         18.8,
                                         18.48,         18.8,
                                         25.8,          26.24,
                                         14.4,          14.64,
                                         27.,           27.44,
                                         19.92,         20.24,
                                         19.92,         20.24,
                                         13.1733333333, 13.3866666667,
                                         13.1733333333, 13.3866666667,
                                         18.3733333333, 18.6666666667,
                                         10.24,         10.4,
                                         19.1733333333, 19.4666666667,
                                         14.1333333333, 14.3466666667,
                                         14.1333333333, 14.3466666667,
                                         26.2844444444, 26.6755555556,
                                         26.2844444444, 26.6755555556,
                                         36.6177777778, 37.1555555556,
                                         20.3733333333, 20.6666666667,
                                         38.0844444444, 38.6222222222,
                                         28.0444444444, 28.4355555556,
                                         28.0444444444, 28.4355555556,
                                         20.1244444444, 20.4088888889,
                                         20.1244444444, 20.4088888889,
                                         28.0177777778, 28.4088888889,
                                         15.5733333333, 15.7866666667,
                                         29.0844444444, 29.4755555556,
                                         21.4044444444, 21.6888888889,
                                         21.4044444444, 21.6888888889,
                                         20.1244444444, 20.4088888889,
                                         20.1244444444, 20.4088888889,
                                         28.0177777778, 28.4088888889,
                                         15.5733333333, 15.7866666667,
                                         29.0844444444, 29.4755555556,
                                         21.4044444444, 21.6888888889,
                                         21.4044444444, 21.6888888889,
                                         10.9,          11.0333333333,
                                         10.9,          11.0333333333,
                                         15.15,         15.3333333333,
                                         8.4,           8.5,
                                         15.65,         15.8333333333,
                                         11.5,          11.6333333333,
                                         11.5,          11.6333333333,
                                         20.4733333333, 20.7133333333,
                                         20.4733333333, 20.7133333333,
                                         28.4433333333, 28.7733333333,
                                         15.76,         15.94,
                                         29.3433333333, 29.6733333333,
                                         21.5533333333, 21.7933333333,
                                         21.5533333333, 21.7933333333,
                                         20.4733333333, 20.7133333333,
                                         20.4733333333, 20.7133333333,
                                         28.4433333333, 28.7733333333,
                                         15.76,         15.94,
                                         29.3433333333, 29.6733333333,
                                         21.5533333333, 21.7933333333,
                                         21.5533333333, 21.7933333333,
                                         30.9,          31.2466666667,
                                         30.9,          31.2466666667,
                                         42.91,         43.3866666667,
                                         23.76,         24.02,
                                         44.21,         44.6866666667,
                                         32.46,         32.8066666667,
                                         32.46,         32.8066666667,
                                         20.,           20.2133333333,
                                         20.,           20.2133333333,
                                         27.76,         28.0533333333,
                                         15.36,         15.52,
                                         28.56,         28.8533333333,
                                         20.96,         21.1733333333,
                                         20.96,         21.1733333333,
                                         31.28,         31.6,
                                         31.28,         31.6,
                                         43.4,          43.84,
                                         24.,           24.24,
                                         44.6,          45.04,
                                         32.72,         33.04,
                                         32.72,         33.04,
                                         21.7066666667, 21.92,
                                         21.7066666667, 21.92,
                                         30.1066666667, 30.4,
                                         16.64,         16.8,
                                         30.9066666667, 31.2,
                                         22.6666666667, 22.88,
                                         22.6666666667, 22.88,
                                         41.9288888889, 42.32,
                                         41.9288888889, 42.32,
                                         58.1288888889, 58.6666666667,
                                         32.1066666667, 32.4,
                                         59.5955555556, 60.1333333333,
                                         43.6888888889, 44.08,
                                         43.6888888889, 44.08,
                                         31.5022222222, 31.7866666667,
                                         31.5022222222, 31.7866666667,
                                         43.6622222222, 44.0533333333,
                                         24.1066666667, 24.32,
                                         44.7288888889, 45.12,
                                         32.7822222222, 33.0666666667,
                                         32.7822222222, 33.0666666667,
                                         31.5022222222, 31.7866666667,
                                         31.5022222222, 31.7866666667,
                                         43.6622222222, 44.0533333333,
                                         24.1066666667, 24.32,
                                         44.7288888889, 45.12,
                                         32.7822222222, 33.0666666667,
                                         32.7822222222, 33.0666666667};
  const std::array<int, 4> in_shape = {{3, 10, 7, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID3x10x7x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.04, 0.08, 0.04, 0.08, 0.16, 0.24, 0.16, 0.24, 0.16, 0.24, 0.12, 0.16,
      0.12, 0.16, 0.04, 0.08, 0.04, 0.08, 0.16, 0.24, 0.16, 0.24, 0.16, 0.24,
      0.12, 0.16, 0.12, 0.16, 0.24, 0.32, 0.24, 0.32, 0.64, 0.8,  0.64, 0.8,
      0.64, 0.8,  0.4,  0.48, 0.4,  0.48, 0.24, 0.32, 0.24, 0.32, 0.64, 0.8,
      0.64, 0.8,  0.64, 0.8,  0.4,  0.48, 0.4,  0.48, 0.6,  0.72, 0.6,  0.72,
      1.44, 1.68, 1.44, 1.68, 1.44, 1.68, 0.84, 0.96, 0.84, 0.96, 0.56, 0.64,
      0.56, 0.64, 1.28, 1.44, 1.28, 1.44, 1.28, 1.44, 0.72, 0.8,  0.72, 0.8,
      0.56, 0.64, 0.56, 0.64, 1.28, 1.44, 1.28, 1.44, 1.28, 1.44, 0.72, 0.8,
      0.72, 0.8,  0.36, 0.4,  0.36, 0.4,  0.8,  0.88, 0.8,  0.88, 0.8,  0.88,
      0.44, 0.48, 0.44, 0.48, 0.36, 0.4,  0.36, 0.4,  0.8,  0.88, 0.8,  0.88,
      0.8,  0.88, 0.44, 0.48, 0.44, 0.48, 0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.52, 0.56, 0.52, 0.56,
      1.12, 1.2,  1.12, 1.2,  1.12, 1.2,  0.6,  0.64, 0.6,  0.64, 0.52, 0.56,
      0.52, 0.56, 1.12, 1.2,  1.12, 1.2,  1.12, 1.2,  0.6,  0.64, 0.6,  0.64,
      1.2,  1.28, 1.2,  1.28, 2.56, 2.72, 2.56, 2.72, 2.56, 2.72, 1.36, 1.44,
      1.36, 1.44, 1.2,  1.28, 1.2,  1.28, 2.56, 2.72, 2.56, 2.72, 2.56, 2.72,
      1.36, 1.44, 1.36, 1.44, 2.04, 2.16, 2.04, 2.16, 4.32, 4.56, 4.32, 4.56,
      4.32, 4.56, 2.28, 2.4,  2.28, 2.4,  1.52, 1.6,  1.52, 1.6,  3.2,  3.36,
      3.2,  3.36, 3.2,  3.36, 1.68, 1.76, 1.68, 1.76, 1.52, 1.6,  1.52, 1.6,
      3.2,  3.36, 3.2,  3.36, 3.2,  3.36, 1.68, 1.76, 1.68, 1.76, 0.84, 0.88,
      0.84, 0.88, 1.76, 1.84, 1.76, 1.84, 1.76, 1.84, 0.92, 0.96, 0.92, 0.96,
      0.84, 0.88, 0.84, 0.88, 1.76, 1.84, 1.76, 1.84, 1.76, 1.84, 0.92, 0.96,
      0.92, 0.96, 0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   1.,   1.04, 1.,   1.04, 2.08, 2.16, 2.08, 2.16,
      2.08, 2.16, 1.08, 1.12, 1.08, 1.12, 1.,   1.04, 1.,   1.04, 2.08, 2.16,
      2.08, 2.16, 2.08, 2.16, 1.08, 1.12, 1.08, 1.12, 2.16, 2.24, 2.16, 2.24,
      4.48, 4.64, 4.48, 4.64, 4.48, 4.64, 2.32, 2.4,  2.32, 2.4,  2.16, 2.24,
      2.16, 2.24, 4.48, 4.64, 4.48, 4.64, 4.48, 4.64, 2.32, 2.4,  2.32, 2.4,
      3.48, 3.6,  3.48, 3.6,  7.2,  7.44, 7.2,  7.44, 7.2,  7.44, 3.72, 3.84,
      3.72, 3.84, 2.48, 2.56, 2.48, 2.56, 5.12, 5.28, 5.12, 5.28, 5.12, 5.28,
      2.64, 2.72, 2.64, 2.72, 2.48, 2.56, 2.48, 2.56, 5.12, 5.28, 5.12, 5.28,
      5.12, 5.28, 2.64, 2.72, 2.64, 2.72, 1.32, 1.36, 1.32, 1.36, 2.72, 2.8,
      2.72, 2.8,  2.72, 2.8,  1.4,  1.44, 1.4,  1.44, 1.32, 1.36, 1.32, 1.36,
      2.72, 2.8,  2.72, 2.8,  2.72, 2.8,  1.4,  1.44, 1.4,  1.44, 0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
  };
  const std::array<int, 4> in_shape = {{3, 10, 7, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME3x10x7x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.3333333333,
                                         0.4666666667,
                                         0.6,
                                         0.7333333333,
                                         0.3333333333,
                                         0.4666666667,
                                         0.6,
                                         0.7333333333,
                                         0.7833333333,
                                         0.9666666667,
                                         1.15,
                                         1.3333333333,
                                         0.7,
                                         0.8,
                                         0.9,
                                         1.,
                                         1.7833333333,
                                         1.9666666667,
                                         2.15,
                                         2.3333333333,
                                         1.5333333333,
                                         1.6666666667,
                                         1.8,
                                         1.9333333333,
                                         1.5333333333,
                                         1.6666666667,
                                         1.8,
                                         1.9333333333,
                                         2.3066666667,
                                         2.5466666667,
                                         2.7866666667,
                                         3.0266666667,
                                         2.3066666667,
                                         2.5466666667,
                                         2.7866666667,
                                         3.0266666667,
                                         3.7566666667,
                                         4.0866666667,
                                         4.4166666667,
                                         4.7466666667,
                                         2.54,
                                         2.72,
                                         2.9,
                                         3.08,
                                         5.5566666667,
                                         5.8866666667,
                                         6.2166666667,
                                         6.5466666667,
                                         4.4666666667,
                                         4.7066666667,
                                         4.9466666667,
                                         5.1866666667,
                                         4.4666666667,
                                         4.7066666667,
                                         4.9466666667,
                                         5.1866666667,
                                         2.3066666667,
                                         2.5466666667,
                                         2.7866666667,
                                         3.0266666667,
                                         2.3066666667,
                                         2.5466666667,
                                         2.7866666667,
                                         3.0266666667,
                                         3.7566666667,
                                         4.0866666667,
                                         4.4166666667,
                                         4.7466666667,
                                         2.54,
                                         2.72,
                                         2.9,
                                         3.08,
                                         5.5566666667,
                                         5.8866666667,
                                         6.2166666667,
                                         6.5466666667,
                                         4.4666666667,
                                         4.7066666667,
                                         4.9466666667,
                                         5.1866666667,
                                         4.4666666667,
                                         4.7066666667,
                                         4.9466666667,
                                         5.1866666667,
                                         5.9866666667,
                                         6.3333333333,
                                         6.68,
                                         7.0266666667,
                                         5.9866666667,
                                         6.3333333333,
                                         6.68,
                                         7.0266666667,
                                         9.0766666667,
                                         9.5533333333,
                                         10.03,
                                         10.5066666667,
                                         5.66,
                                         5.92,
                                         6.18,
                                         6.44,
                                         11.6766666667,
                                         12.1533333333,
                                         12.63,
                                         13.1066666667,
                                         9.1066666667,
                                         9.4533333333,
                                         9.8,
                                         10.1466666667,
                                         9.1066666667,
                                         9.4533333333,
                                         9.8,
                                         10.1466666667,
                                         5.6533333333,
                                         5.8666666667,
                                         6.08,
                                         6.2933333333,
                                         5.6533333333,
                                         5.8666666667,
                                         6.08,
                                         6.2933333333,
                                         8.2933333333,
                                         8.5866666667,
                                         8.88,
                                         9.1733333333,
                                         4.96,
                                         5.12,
                                         5.28,
                                         5.44,
                                         9.8933333333,
                                         10.1866666667,
                                         10.48,
                                         10.7733333333,
                                         7.5733333333,
                                         7.7866666667,
                                         8.,
                                         8.2133333333,
                                         7.5733333333,
                                         7.7866666667,
                                         8.,
                                         8.2133333333,
                                         11.04,
                                         11.36,
                                         11.68,
                                         12.,
                                         11.04,
                                         11.36,
                                         11.68,
                                         12.,
                                         15.96,
                                         16.4,
                                         16.84,
                                         17.28,
                                         9.36,
                                         9.6,
                                         9.84,
                                         10.08,
                                         18.36,
                                         18.8,
                                         19.24,
                                         19.68,
                                         13.92,
                                         14.24,
                                         14.56,
                                         14.88,
                                         13.92,
                                         14.24,
                                         14.56,
                                         14.88,
                                         9.0666666667,
                                         9.28,
                                         9.4933333333,
                                         9.7066666667,
                                         9.0666666667,
                                         9.28,
                                         9.4933333333,
                                         9.7066666667,
                                         12.9866666667,
                                         13.28,
                                         13.5733333333,
                                         13.8666666667,
                                         7.52,
                                         7.68,
                                         7.84,
                                         8.,
                                         14.5866666667,
                                         14.88,
                                         15.1733333333,
                                         15.4666666667,
                                         10.9866666667,
                                         11.2,
                                         11.4133333333,
                                         11.6266666667,
                                         10.9866666667,
                                         11.2,
                                         11.4133333333,
                                         11.6266666667,
                                         20.8888888889,
                                         21.28,
                                         21.6711111111,
                                         22.0622222222,
                                         20.8888888889,
                                         21.28,
                                         21.6711111111,
                                         22.0622222222,
                                         29.6755555556,
                                         30.2133333333,
                                         30.7511111111,
                                         31.2888888889,
                                         16.9866666667,
                                         17.28,
                                         17.5733333333,
                                         17.8666666667,
                                         32.6088888889,
                                         33.1466666667,
                                         33.6844444444,
                                         34.2222222222,
                                         24.4088888889,
                                         24.8,
                                         25.1911111111,
                                         25.5822222222,
                                         24.4088888889,
                                         24.8,
                                         25.1911111111,
                                         25.5822222222,
                                         17.2088888889,
                                         17.4933333333,
                                         17.7777777778,
                                         18.0622222222,
                                         17.2088888889,
                                         17.4933333333,
                                         17.7777777778,
                                         18.0622222222,
                                         24.3555555556,
                                         24.7466666667,
                                         25.1377777778,
                                         25.5288888889,
                                         13.8666666667,
                                         14.08,
                                         14.2933333333,
                                         14.5066666667,
                                         26.4888888889,
                                         26.88,
                                         27.2711111111,
                                         27.6622222222,
                                         19.7688888889,
                                         20.0533333333,
                                         20.3377777778,
                                         20.6222222222,
                                         19.7688888889,
                                         20.0533333333,
                                         20.3377777778,
                                         20.6222222222,
                                         17.2088888889,
                                         17.4933333333,
                                         17.7777777778,
                                         18.0622222222,
                                         17.2088888889,
                                         17.4933333333,
                                         17.7777777778,
                                         18.0622222222,
                                         24.3555555556,
                                         24.7466666667,
                                         25.1377777778,
                                         25.5288888889,
                                         13.8666666667,
                                         14.08,
                                         14.2933333333,
                                         14.5066666667,
                                         26.4888888889,
                                         26.88,
                                         27.2711111111,
                                         27.6622222222,
                                         19.7688888889,
                                         20.0533333333,
                                         20.3377777778,
                                         20.6222222222,
                                         19.7688888889,
                                         20.0533333333,
                                         20.3377777778,
                                         20.6222222222,
                                         11.,
                                         11.1333333333,
                                         11.2666666667,
                                         11.4,
                                         11.,
                                         11.1333333333,
                                         11.2666666667,
                                         11.4,
                                         15.45,
                                         15.6333333333,
                                         15.8166666667,
                                         16.,
                                         8.7,
                                         8.8,
                                         8.9,
                                         9.,
                                         16.45,
                                         16.6333333333,
                                         16.8166666667,
                                         17.,
                                         12.2,
                                         12.3333333333,
                                         12.4666666667,
                                         12.6,
                                         12.2,
                                         12.3333333333,
                                         12.4666666667,
                                         12.6,
                                         21.5066666667,
                                         21.7466666667,
                                         21.9866666667,
                                         22.2266666667,
                                         21.5066666667,
                                         21.7466666667,
                                         21.9866666667,
                                         22.2266666667,
                                         30.1566666667,
                                         30.4866666667,
                                         30.8166666667,
                                         31.1466666667,
                                         16.94,
                                         17.12,
                                         17.3,
                                         17.48,
                                         31.9566666667,
                                         32.2866666667,
                                         32.6166666667,
                                         32.9466666667,
                                         23.6666666667,
                                         23.9066666667,
                                         24.1466666667,
                                         24.3866666667,
                                         23.6666666667,
                                         23.9066666667,
                                         24.1466666667,
                                         24.3866666667,
                                         21.5066666667,
                                         21.7466666667,
                                         21.9866666667,
                                         22.2266666667,
                                         21.5066666667,
                                         21.7466666667,
                                         21.9866666667,
                                         22.2266666667,
                                         30.1566666667,
                                         30.4866666667,
                                         30.8166666667,
                                         31.1466666667,
                                         16.94,
                                         17.12,
                                         17.3,
                                         17.48,
                                         31.9566666667,
                                         32.2866666667,
                                         32.6166666667,
                                         32.9466666667,
                                         23.6666666667,
                                         23.9066666667,
                                         24.1466666667,
                                         24.3866666667,
                                         23.6666666667,
                                         23.9066666667,
                                         24.1466666667,
                                         24.3866666667,
                                         33.72,
                                         34.0666666667,
                                         34.4133333333,
                                         34.76,
                                         33.72,
                                         34.0666666667,
                                         34.4133333333,
                                         34.76,
                                         47.21,
                                         47.6866666667,
                                         48.1633333333,
                                         48.64,
                                         26.46,
                                         26.72,
                                         26.98,
                                         27.24,
                                         49.81,
                                         50.2866666667,
                                         50.7633333333,
                                         51.24,
                                         36.84,
                                         37.1866666667,
                                         37.5333333333,
                                         37.88,
                                         36.84,
                                         37.1866666667,
                                         37.5333333333,
                                         37.88,
                                         22.72,
                                         22.9333333333,
                                         23.1466666667,
                                         23.36,
                                         22.72,
                                         22.9333333333,
                                         23.1466666667,
                                         23.36,
                                         31.76,
                                         32.0533333333,
                                         32.3466666667,
                                         32.64,
                                         17.76,
                                         17.92,
                                         18.08,
                                         18.24,
                                         33.36,
                                         33.6533333333,
                                         33.9466666667,
                                         34.24,
                                         24.64,
                                         24.8533333333,
                                         25.0666666667,
                                         25.28,
                                         24.64,
                                         24.8533333333,
                                         25.0666666667,
                                         25.28,
                                         36.64,
                                         36.96,
                                         37.28,
                                         37.6,
                                         36.64,
                                         36.96,
                                         37.28,
                                         37.6,
                                         51.16,
                                         51.6,
                                         52.04,
                                         52.48,
                                         28.56,
                                         28.8,
                                         29.04,
                                         29.28,
                                         53.56,
                                         54.,
                                         54.44,
                                         54.88,
                                         39.52,
                                         39.84,
                                         40.16,
                                         40.48,
                                         39.52,
                                         39.84,
                                         40.16,
                                         40.48,
                                         26.1333333333,
                                         26.3466666667,
                                         26.56,
                                         26.7733333333,
                                         26.1333333333,
                                         26.3466666667,
                                         26.56,
                                         26.7733333333,
                                         36.4533333333,
                                         36.7466666667,
                                         37.04,
                                         37.3333333333,
                                         20.32,
                                         20.48,
                                         20.64,
                                         20.8,
                                         38.0533333333,
                                         38.3466666667,
                                         38.64,
                                         38.9333333333,
                                         28.0533333333,
                                         28.2666666667,
                                         28.48,
                                         28.6933333333,
                                         28.0533333333,
                                         28.2666666667,
                                         28.48,
                                         28.6933333333,
                                         52.1777777778,
                                         52.5688888889,
                                         52.96,
                                         53.3511111111,
                                         52.1777777778,
                                         52.5688888889,
                                         52.96,
                                         53.3511111111,
                                         72.6977777778,
                                         73.2355555556,
                                         73.7733333333,
                                         74.3111111111,
                                         40.4533333333,
                                         40.7466666667,
                                         41.04,
                                         41.3333333333,
                                         75.6311111111,
                                         76.1688888889,
                                         76.7066666667,
                                         77.2444444444,
                                         55.6977777778,
                                         56.0888888889,
                                         56.48,
                                         56.8711111111,
                                         55.6977777778,
                                         56.0888888889,
                                         56.48,
                                         56.8711111111,
                                         39.9644444444,
                                         40.2488888889,
                                         40.5333333333,
                                         40.8177777778,
                                         39.9644444444,
                                         40.2488888889,
                                         40.5333333333,
                                         40.8177777778,
                                         55.6444444444,
                                         56.0355555556,
                                         56.4266666667,
                                         56.8177777778,
                                         30.9333333333,
                                         31.1466666667,
                                         31.36,
                                         31.5733333333,
                                         57.7777777778,
                                         58.1688888889,
                                         58.56,
                                         58.9511111111,
                                         42.5244444444,
                                         42.8088888889,
                                         43.0933333333,
                                         43.3777777778,
                                         42.5244444444,
                                         42.8088888889,
                                         43.0933333333,
                                         43.3777777778,
                                         39.9644444444,
                                         40.2488888889,
                                         40.5333333333,
                                         40.8177777778,
                                         39.9644444444,
                                         40.2488888889,
                                         40.5333333333,
                                         40.8177777778,
                                         55.6444444444,
                                         56.0355555556,
                                         56.4266666667,
                                         56.8177777778,
                                         30.9333333333,
                                         31.1466666667,
                                         31.36,
                                         31.5733333333,
                                         57.7777777778,
                                         58.1688888889,
                                         58.56,
                                         58.9511111111,
                                         42.5244444444,
                                         42.8088888889,
                                         43.0933333333,
                                         43.3777777778,
                                         42.5244444444,
                                         42.8088888889,
                                         43.0933333333,
                                         43.3777777778,
                                         21.6666666667,
                                         21.8,
                                         21.9333333333,
                                         22.0666666667,
                                         21.6666666667,
                                         21.8,
                                         21.9333333333,
                                         22.0666666667,
                                         30.1166666667,
                                         30.3,
                                         30.4833333333,
                                         30.6666666667,
                                         16.7,
                                         16.8,
                                         16.9,
                                         17.,
                                         31.1166666667,
                                         31.3,
                                         31.4833333333,
                                         31.6666666667,
                                         22.8666666667,
                                         23.,
                                         23.1333333333,
                                         23.2666666667,
                                         22.8666666667,
                                         23.,
                                         23.1333333333,
                                         23.2666666667,
                                         40.7066666667,
                                         40.9466666667,
                                         41.1866666667,
                                         41.4266666667,
                                         40.7066666667,
                                         40.9466666667,
                                         41.1866666667,
                                         41.4266666667,
                                         56.5566666667,
                                         56.8866666667,
                                         57.2166666667,
                                         57.5466666667,
                                         31.34,
                                         31.52,
                                         31.7,
                                         31.88,
                                         58.3566666667,
                                         58.6866666667,
                                         59.0166666667,
                                         59.3466666667,
                                         42.8666666667,
                                         43.1066666667,
                                         43.3466666667,
                                         43.5866666667,
                                         42.8666666667,
                                         43.1066666667,
                                         43.3466666667,
                                         43.5866666667,
                                         40.7066666667,
                                         40.9466666667,
                                         41.1866666667,
                                         41.4266666667,
                                         40.7066666667,
                                         40.9466666667,
                                         41.1866666667,
                                         41.4266666667,
                                         56.5566666667,
                                         56.8866666667,
                                         57.2166666667,
                                         57.5466666667,
                                         31.34,
                                         31.52,
                                         31.7,
                                         31.88,
                                         58.3566666667,
                                         58.6866666667,
                                         59.0166666667,
                                         59.3466666667,
                                         42.8666666667,
                                         43.1066666667,
                                         43.3466666667,
                                         43.5866666667,
                                         42.8666666667,
                                         43.1066666667,
                                         43.3466666667,
                                         43.5866666667,
                                         61.4533333333,
                                         61.8,
                                         62.1466666667,
                                         62.4933333333,
                                         61.4533333333,
                                         61.8,
                                         62.1466666667,
                                         62.4933333333,
                                         85.3433333333,
                                         85.82,
                                         86.2966666667,
                                         86.7733333333,
                                         47.26,
                                         47.52,
                                         47.78,
                                         48.04,
                                         87.9433333333,
                                         88.42,
                                         88.8966666667,
                                         89.3733333333,
                                         64.5733333333,
                                         64.92,
                                         65.2666666667,
                                         65.6133333333,
                                         64.5733333333,
                                         64.92,
                                         65.2666666667,
                                         65.6133333333,
                                         39.7866666667,
                                         40.,
                                         40.2133333333,
                                         40.4266666667,
                                         39.7866666667,
                                         40.,
                                         40.2133333333,
                                         40.4266666667,
                                         55.2266666667,
                                         55.52,
                                         55.8133333333,
                                         56.1066666667,
                                         30.56,
                                         30.72,
                                         30.88,
                                         31.04,
                                         56.8266666667,
                                         57.12,
                                         57.4133333333,
                                         57.7066666667,
                                         41.7066666667,
                                         41.92,
                                         42.1333333333,
                                         42.3466666667,
                                         41.7066666667,
                                         41.92,
                                         42.1333333333,
                                         42.3466666667,
                                         62.24,
                                         62.56,
                                         62.88,
                                         63.2,
                                         62.24,
                                         62.56,
                                         62.88,
                                         63.2,
                                         86.36,
                                         86.8,
                                         87.24,
                                         87.68,
                                         47.76,
                                         48.,
                                         48.24,
                                         48.48,
                                         88.76,
                                         89.2,
                                         89.64,
                                         90.08,
                                         65.12,
                                         65.44,
                                         65.76,
                                         66.08,
                                         65.12,
                                         65.44,
                                         65.76,
                                         66.08,
                                         43.2,
                                         43.4133333333,
                                         43.6266666667,
                                         43.84,
                                         43.2,
                                         43.4133333333,
                                         43.6266666667,
                                         43.84,
                                         59.92,
                                         60.2133333333,
                                         60.5066666667,
                                         60.8,
                                         33.12,
                                         33.28,
                                         33.44,
                                         33.6,
                                         61.52,
                                         61.8133333333,
                                         62.1066666667,
                                         62.4,
                                         45.12,
                                         45.3333333333,
                                         45.5466666667,
                                         45.76,
                                         45.12,
                                         45.3333333333,
                                         45.5466666667,
                                         45.76,
                                         83.4666666667,
                                         83.8577777778,
                                         84.2488888889,
                                         84.64,
                                         83.4666666667,
                                         83.8577777778,
                                         84.2488888889,
                                         84.64,
                                         115.72,
                                         116.2577777778,
                                         116.7955555556,
                                         117.3333333333,
                                         63.92,
                                         64.2133333333,
                                         64.5066666667,
                                         64.8,
                                         118.6533333333,
                                         119.1911111111,
                                         119.7288888889,
                                         120.2666666667,
                                         86.9866666667,
                                         87.3777777778,
                                         87.7688888889,
                                         88.16,
                                         86.9866666667,
                                         87.3777777778,
                                         87.7688888889,
                                         88.16,
                                         62.72,
                                         63.0044444444,
                                         63.2888888889,
                                         63.5733333333,
                                         62.72,
                                         63.0044444444,
                                         63.2888888889,
                                         63.5733333333,
                                         86.9333333333,
                                         87.3244444444,
                                         87.7155555556,
                                         88.1066666667,
                                         48.,
                                         48.2133333333,
                                         48.4266666667,
                                         48.64,
                                         89.0666666667,
                                         89.4577777778,
                                         89.8488888889,
                                         90.24,
                                         65.28,
                                         65.5644444444,
                                         65.8488888889,
                                         66.1333333333,
                                         65.28,
                                         65.5644444444,
                                         65.8488888889,
                                         66.1333333333,
                                         62.72,
                                         63.0044444444,
                                         63.2888888889,
                                         63.5733333333,
                                         62.72,
                                         63.0044444444,
                                         63.2888888889,
                                         63.5733333333,
                                         86.9333333333,
                                         87.3244444444,
                                         87.7155555556,
                                         88.1066666667,
                                         48.,
                                         48.2133333333,
                                         48.4266666667,
                                         48.64,
                                         89.0666666667,
                                         89.4577777778,
                                         89.8488888889,
                                         90.24,
                                         65.28,
                                         65.5644444444,
                                         65.8488888889,
                                         66.1333333333,
                                         65.28,
                                         65.5644444444,
                                         65.8488888889,
                                         66.1333333333};
  const std::array<int, 4> in_shape = {{3, 10, 7, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID3x10x7x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.04,  0.08,  0.12,  0.16,  0.04,  0.08,  0.12,  0.16,  0.24,  0.32,
      0.4,   0.48,  0.24,  0.32,  0.4,   0.48,  0.24,  0.32,  0.4,   0.48,
      0.2,   0.24,  0.28,  0.32,  0.2,   0.24,  0.28,  0.32,  0.04,  0.08,
      0.12,  0.16,  0.04,  0.08,  0.12,  0.16,  0.24,  0.32,  0.4,   0.48,
      0.24,  0.32,  0.4,   0.48,  0.24,  0.32,  0.4,   0.48,  0.2,   0.24,
      0.28,  0.32,  0.2,   0.24,  0.28,  0.32,  0.4,   0.48,  0.56,  0.64,
      0.4,   0.48,  0.56,  0.64,  1.12,  1.28,  1.44,  1.6,   1.12,  1.28,
      1.44,  1.6,   1.12,  1.28,  1.44,  1.6,   0.72,  0.8,   0.88,  0.96,
      0.72,  0.8,   0.88,  0.96,  0.4,   0.48,  0.56,  0.64,  0.4,   0.48,
      0.56,  0.64,  1.12,  1.28,  1.44,  1.6,   1.12,  1.28,  1.44,  1.6,
      1.12,  1.28,  1.44,  1.6,   0.72,  0.8,   0.88,  0.96,  0.72,  0.8,
      0.88,  0.96,  1.08,  1.2,   1.32,  1.44,  1.08,  1.2,   1.32,  1.44,
      2.64,  2.88,  3.12,  3.36,  2.64,  2.88,  3.12,  3.36,  2.64,  2.88,
      3.12,  3.36,  1.56,  1.68,  1.8,   1.92,  1.56,  1.68,  1.8,   1.92,
      1.04,  1.12,  1.2,   1.28,  1.04,  1.12,  1.2,   1.28,  2.4,   2.56,
      2.72,  2.88,  2.4,   2.56,  2.72,  2.88,  2.4,   2.56,  2.72,  2.88,
      1.36,  1.44,  1.52,  1.6,   1.36,  1.44,  1.52,  1.6,   1.04,  1.12,
      1.2,   1.28,  1.04,  1.12,  1.2,   1.28,  2.4,   2.56,  2.72,  2.88,
      2.4,   2.56,  2.72,  2.88,  2.4,   2.56,  2.72,  2.88,  1.36,  1.44,
      1.52,  1.6,   1.36,  1.44,  1.52,  1.6,   0.68,  0.72,  0.76,  0.8,
      0.68,  0.72,  0.76,  0.8,   1.52,  1.6,   1.68,  1.76,  1.52,  1.6,
      1.68,  1.76,  1.52,  1.6,   1.68,  1.76,  0.84,  0.88,  0.92,  0.96,
      0.84,  0.88,  0.92,  0.96,  0.68,  0.72,  0.76,  0.8,   0.68,  0.72,
      0.76,  0.8,   1.52,  1.6,   1.68,  1.76,  1.52,  1.6,   1.68,  1.76,
      1.52,  1.6,   1.68,  1.76,  0.84,  0.88,  0.92,  0.96,  0.84,  0.88,
      0.92,  0.96,  0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      1.,    1.04,  1.08,  1.12,  1.,    1.04,  1.08,  1.12,  2.16,  2.24,
      2.32,  2.4,   2.16,  2.24,  2.32,  2.4,   2.16,  2.24,  2.32,  2.4,
      1.16,  1.2,   1.24,  1.28,  1.16,  1.2,   1.24,  1.28,  1.,    1.04,
      1.08,  1.12,  1.,    1.04,  1.08,  1.12,  2.16,  2.24,  2.32,  2.4,
      2.16,  2.24,  2.32,  2.4,   2.16,  2.24,  2.32,  2.4,   1.16,  1.2,
      1.24,  1.28,  1.16,  1.2,   1.24,  1.28,  2.32,  2.4,   2.48,  2.56,
      2.32,  2.4,   2.48,  2.56,  4.96,  5.12,  5.28,  5.44,  4.96,  5.12,
      5.28,  5.44,  4.96,  5.12,  5.28,  5.44,  2.64,  2.72,  2.8,   2.88,
      2.64,  2.72,  2.8,   2.88,  2.32,  2.4,   2.48,  2.56,  2.32,  2.4,
      2.48,  2.56,  4.96,  5.12,  5.28,  5.44,  4.96,  5.12,  5.28,  5.44,
      4.96,  5.12,  5.28,  5.44,  2.64,  2.72,  2.8,   2.88,  2.64,  2.72,
      2.8,   2.88,  3.96,  4.08,  4.2,   4.32,  3.96,  4.08,  4.2,   4.32,
      8.4,   8.64,  8.88,  9.12,  8.4,   8.64,  8.88,  9.12,  8.4,   8.64,
      8.88,  9.12,  4.44,  4.56,  4.68,  4.8,   4.44,  4.56,  4.68,  4.8,
      2.96,  3.04,  3.12,  3.2,   2.96,  3.04,  3.12,  3.2,   6.24,  6.4,
      6.56,  6.72,  6.24,  6.4,   6.56,  6.72,  6.24,  6.4,   6.56,  6.72,
      3.28,  3.36,  3.44,  3.52,  3.28,  3.36,  3.44,  3.52,  2.96,  3.04,
      3.12,  3.2,   2.96,  3.04,  3.12,  3.2,   6.24,  6.4,   6.56,  6.72,
      6.24,  6.4,   6.56,  6.72,  6.24,  6.4,   6.56,  6.72,  3.28,  3.36,
      3.44,  3.52,  3.28,  3.36,  3.44,  3.52,  1.64,  1.68,  1.72,  1.76,
      1.64,  1.68,  1.72,  1.76,  3.44,  3.52,  3.6,   3.68,  3.44,  3.52,
      3.6,   3.68,  3.44,  3.52,  3.6,   3.68,  1.8,   1.84,  1.88,  1.92,
      1.8,   1.84,  1.88,  1.92,  1.64,  1.68,  1.72,  1.76,  1.64,  1.68,
      1.72,  1.76,  3.44,  3.52,  3.6,   3.68,  3.44,  3.52,  3.6,   3.68,
      3.44,  3.52,  3.6,   3.68,  1.8,   1.84,  1.88,  1.92,  1.8,   1.84,
      1.88,  1.92,  0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      1.96,  2.,    2.04,  2.08,  1.96,  2.,    2.04,  2.08,  4.08,  4.16,
      4.24,  4.32,  4.08,  4.16,  4.24,  4.32,  4.08,  4.16,  4.24,  4.32,
      2.12,  2.16,  2.2,   2.24,  2.12,  2.16,  2.2,   2.24,  1.96,  2.,
      2.04,  2.08,  1.96,  2.,    2.04,  2.08,  4.08,  4.16,  4.24,  4.32,
      4.08,  4.16,  4.24,  4.32,  4.08,  4.16,  4.24,  4.32,  2.12,  2.16,
      2.2,   2.24,  2.12,  2.16,  2.2,   2.24,  4.24,  4.32,  4.4,   4.48,
      4.24,  4.32,  4.4,   4.48,  8.8,   8.96,  9.12,  9.28,  8.8,   8.96,
      9.12,  9.28,  8.8,   8.96,  9.12,  9.28,  4.56,  4.64,  4.72,  4.8,
      4.56,  4.64,  4.72,  4.8,   4.24,  4.32,  4.4,   4.48,  4.24,  4.32,
      4.4,   4.48,  8.8,   8.96,  9.12,  9.28,  8.8,   8.96,  9.12,  9.28,
      8.8,   8.96,  9.12,  9.28,  4.56,  4.64,  4.72,  4.8,   4.56,  4.64,
      4.72,  4.8,   6.84,  6.96,  7.08,  7.2,   6.84,  6.96,  7.08,  7.2,
      14.16, 14.4,  14.64, 14.88, 14.16, 14.4,  14.64, 14.88, 14.16, 14.4,
      14.64, 14.88, 7.32,  7.44,  7.56,  7.68,  7.32,  7.44,  7.56,  7.68,
      4.88,  4.96,  5.04,  5.12,  4.88,  4.96,  5.04,  5.12,  10.08, 10.24,
      10.4,  10.56, 10.08, 10.24, 10.4,  10.56, 10.08, 10.24, 10.4,  10.56,
      5.2,   5.28,  5.36,  5.44,  5.2,   5.28,  5.36,  5.44,  4.88,  4.96,
      5.04,  5.12,  4.88,  4.96,  5.04,  5.12,  10.08, 10.24, 10.4,  10.56,
      10.08, 10.24, 10.4,  10.56, 10.08, 10.24, 10.4,  10.56, 5.2,   5.28,
      5.36,  5.44,  5.2,   5.28,  5.36,  5.44,  2.6,   2.64,  2.68,  2.72,
      2.6,   2.64,  2.68,  2.72,  5.36,  5.44,  5.52,  5.6,   5.36,  5.44,
      5.52,  5.6,   5.36,  5.44,  5.52,  5.6,   2.76,  2.8,   2.84,  2.88,
      2.76,  2.8,   2.84,  2.88,  2.6,   2.64,  2.68,  2.72,  2.6,   2.64,
      2.68,  2.72,  5.36,  5.44,  5.52,  5.6,   5.36,  5.44,  5.52,  5.6,
      5.36,  5.44,  5.52,  5.6,   2.76,  2.8,   2.84,  2.88,  2.76,  2.8,
      2.84,  2.88,  0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
  };
  const std::array<int, 4> in_shape = {{3, 10, 7, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME3x10x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.0625,
                                         0.1625,
                                         0.1625,
                                         0.3125,
                                         0.25,
                                         0.5833333333,
                                         0.4833333333,
                                         0.4833333333,
                                         0.3125,
                                         0.6525,
                                         0.6525,
                                         1.0825,
                                         0.77,
                                         1.6366666667,
                                         1.2966666667,
                                         1.2966666667,
                                         0.3125,
                                         0.6525,
                                         0.6525,
                                         1.0825,
                                         0.77,
                                         1.6366666667,
                                         1.2966666667,
                                         1.2966666667,
                                         0.7625,
                                         1.5025,
                                         1.5025,
                                         2.3725,
                                         1.61,
                                         3.2766666667,
                                         2.5366666667,
                                         2.5366666667,
                                         0.7,
                                         1.34,
                                         1.34,
                                         2.06,
                                         1.36,
                                         2.6933333333,
                                         2.0533333333,
                                         2.0533333333,
                                         1.35,
                                         2.55,
                                         2.55,
                                         3.87,
                                         2.52,
                                         4.92,
                                         3.72,
                                         3.72,
                                         1.1,
                                         2.06,
                                         2.06,
                                         3.1,
                                         2.,
                                         3.8666666667,
                                         2.9066666667,
                                         2.9066666667,
                                         2.5166666667,
                                         4.6766666667,
                                         4.6766666667,
                                         6.9833333333,
                                         4.4666666667,
                                         8.5555555556,
                                         6.3955555556,
                                         6.3955555556,
                                         2.0666666667,
                                         3.8266666667,
                                         3.8266666667,
                                         5.6933333333,
                                         3.6266666667,
                                         6.9155555556,
                                         5.1555555556,
                                         5.1555555556,
                                         2.0666666667,
                                         3.8266666667,
                                         3.8266666667,
                                         5.6933333333,
                                         3.6266666667,
                                         6.9155555556,
                                         5.1555555556,
                                         5.1555555556,
                                         1.3125,
                                         2.4125,
                                         2.4125,
                                         3.5625,
                                         2.25,
                                         4.25,
                                         3.15,
                                         3.15,
                                         2.5625,
                                         4.7025,
                                         4.7025,
                                         6.9325,
                                         4.37,
                                         8.2366666667,
                                         6.0966666667,
                                         6.0966666667,
                                         2.5625,
                                         4.7025,
                                         4.7025,
                                         6.9325,
                                         4.37,
                                         8.2366666667,
                                         6.0966666667,
                                         6.0966666667,
                                         4.0125,
                                         7.3525,
                                         7.3525,
                                         10.8225,
                                         6.81,
                                         12.81,
                                         9.47,
                                         9.47,
                                         2.7,
                                         4.94,
                                         4.94,
                                         7.26,
                                         4.56,
                                         8.56,
                                         6.32,
                                         6.32,
                                         4.35,
                                         7.95,
                                         7.95,
                                         11.67,
                                         7.32,
                                         13.72,
                                         10.12,
                                         10.12,
                                         3.1,
                                         5.66,
                                         5.66,
                                         8.3,
                                         5.2,
                                         9.7333333333,
                                         7.1733333333,
                                         7.1733333333,
                                         6.1833333333,
                                         11.2766666667,
                                         11.2766666667,
                                         16.5166666667,
                                         10.3333333333,
                                         19.3111111111,
                                         14.2177777778,
                                         14.2177777778,
                                         4.7333333333,
                                         8.6266666667,
                                         8.6266666667,
                                         12.6266666667,
                                         7.8933333333,
                                         14.7377777778,
                                         10.8444444444,
                                         10.8444444444,
                                         4.7333333333,
                                         8.6266666667,
                                         8.6266666667,
                                         12.6266666667,
                                         7.8933333333,
                                         14.7377777778,
                                         10.8444444444,
                                         10.8444444444,
                                         2.5625,
                                         4.6625,
                                         4.6625,
                                         6.8125,
                                         4.25,
                                         7.9166666667,
                                         5.8166666667,
                                         5.8166666667,
                                         4.8125,
                                         8.7525,
                                         8.7525,
                                         12.7825,
                                         7.97,
                                         14.8366666667,
                                         10.8966666667,
                                         10.8966666667,
                                         4.8125,
                                         8.7525,
                                         8.7525,
                                         12.7825,
                                         7.97,
                                         14.8366666667,
                                         10.8966666667,
                                         10.8966666667,
                                         7.2625,
                                         13.2025,
                                         13.2025,
                                         19.2725,
                                         12.01,
                                         22.3433333333,
                                         16.4033333333,
                                         16.4033333333,
                                         4.7,
                                         8.54,
                                         8.54,
                                         12.46,
                                         7.76,
                                         14.4266666667,
                                         10.5866666667,
                                         10.5866666667,
                                         7.35,
                                         13.35,
                                         13.35,
                                         19.47,
                                         12.12,
                                         22.52,
                                         16.52,
                                         16.52,
                                         5.1,
                                         9.26,
                                         9.26,
                                         13.5,
                                         8.4,
                                         15.6,
                                         11.44,
                                         11.44,
                                         9.85,
                                         17.8766666667,
                                         17.8766666667,
                                         26.05,
                                         16.2,
                                         30.0666666667,
                                         22.04,
                                         22.04,
                                         7.4,
                                         13.4266666667,
                                         13.4266666667,
                                         19.56,
                                         12.16,
                                         22.56,
                                         16.5333333333,
                                         16.5333333333,
                                         7.4,
                                         13.4266666667,
                                         13.4266666667,
                                         19.56,
                                         12.16,
                                         22.56,
                                         16.5333333333,
                                         16.5333333333};
  const std::array<int, 4> in_shape = {{3, 10, 8, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID3x10x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.04, 0.04, 0.12, 0.12, 0.12, 0.08, 0.08, 0.,   0.04, 0.04, 0.12, 0.12,
      0.12, 0.08, 0.08, 0.,   0.16, 0.16, 0.4,  0.4,  0.4,  0.24, 0.24, 0.,
      0.16, 0.16, 0.4,  0.4,  0.4,  0.24, 0.24, 0.,   0.36, 0.36, 0.84, 0.84,
      0.84, 0.48, 0.48, 0.,   0.32, 0.32, 0.72, 0.72, 0.72, 0.4,  0.4,  0.,
      0.32, 0.32, 0.72, 0.72, 0.72, 0.4,  0.4,  0.,   0.2,  0.2,  0.44, 0.44,
      0.44, 0.24, 0.24, 0.,   0.2,  0.2,  0.44, 0.44, 0.44, 0.24, 0.24, 0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.28, 0.28, 0.6,  0.6,
      0.6,  0.32, 0.32, 0.,   0.28, 0.28, 0.6,  0.6,  0.6,  0.32, 0.32, 0.,
      0.64, 0.64, 1.36, 1.36, 1.36, 0.72, 0.72, 0.,   0.64, 0.64, 1.36, 1.36,
      1.36, 0.72, 0.72, 0.,   1.08, 1.08, 2.28, 2.28, 2.28, 1.2,  1.2,  0.,
      0.8,  0.8,  1.68, 1.68, 1.68, 0.88, 0.88, 0.,   0.8,  0.8,  1.68, 1.68,
      1.68, 0.88, 0.88, 0.,   0.44, 0.44, 0.92, 0.92, 0.92, 0.48, 0.48, 0.,
      0.44, 0.44, 0.92, 0.92, 0.92, 0.48, 0.48, 0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.52, 0.52, 1.08, 1.08, 1.08, 0.56, 0.56, 0.,
      0.52, 0.52, 1.08, 1.08, 1.08, 0.56, 0.56, 0.,   1.12, 1.12, 2.32, 2.32,
      2.32, 1.2,  1.2,  0.,   1.12, 1.12, 2.32, 2.32, 2.32, 1.2,  1.2,  0.,
      1.8,  1.8,  3.72, 3.72, 3.72, 1.92, 1.92, 0.,   1.28, 1.28, 2.64, 2.64,
      2.64, 1.36, 1.36, 0.,   1.28, 1.28, 2.64, 2.64, 2.64, 1.36, 1.36, 0.,
      0.68, 0.68, 1.4,  1.4,  1.4,  0.72, 0.72, 0.,   0.68, 0.68, 1.4,  1.4,
      1.4,  0.72, 0.72, 0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
  };
  const std::array<int, 4> in_shape = {{3, 10, 8, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME3x10x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.0625,
                                         0.125,
                                         0.2125,
                                         0.325,
                                         0.2125,
                                         0.325,
                                         0.4625,
                                         0.625,
                                         0.4,
                                         0.5,
                                         0.9833333333,
                                         1.1666666667,
                                         0.8333333333,
                                         0.9666666667,
                                         0.8333333333,
                                         0.9666666667,
                                         0.5125,
                                         0.625,
                                         1.1025,
                                         1.305,
                                         1.1025,
                                         1.305,
                                         1.8725,
                                         2.165,
                                         1.36,
                                         1.54,
                                         2.9433333333,
                                         3.2733333333,
                                         2.3533333333,
                                         2.5933333333,
                                         2.3533333333,
                                         2.5933333333,
                                         0.5125,
                                         0.625,
                                         1.1025,
                                         1.305,
                                         1.1025,
                                         1.305,
                                         1.8725,
                                         2.165,
                                         1.36,
                                         1.54,
                                         2.9433333333,
                                         3.2733333333,
                                         2.3533333333,
                                         2.5933333333,
                                         2.3533333333,
                                         2.5933333333,
                                         1.3625,
                                         1.525,
                                         2.7125,
                                         3.005,
                                         2.7125,
                                         3.005,
                                         4.3225,
                                         4.745,
                                         2.96,
                                         3.22,
                                         6.0766666667,
                                         6.5533333333,
                                         4.7266666667,
                                         5.0733333333,
                                         4.7266666667,
                                         5.0733333333,
                                         1.3,
                                         1.4,
                                         2.5,
                                         2.68,
                                         2.5,
                                         2.68,
                                         3.86,
                                         4.12,
                                         2.56,
                                         2.72,
                                         5.0933333333,
                                         5.3866666667,
                                         3.8933333333,
                                         4.1066666667,
                                         3.8933333333,
                                         4.1066666667,
                                         2.55,
                                         2.7,
                                         4.83,
                                         5.1,
                                         4.83,
                                         5.1,
                                         7.35,
                                         7.74,
                                         4.8,
                                         5.04,
                                         9.4,
                                         9.84,
                                         7.12,
                                         7.44,
                                         7.12,
                                         7.44,
                                         2.1,
                                         2.2,
                                         3.94,
                                         4.12,
                                         3.94,
                                         4.12,
                                         5.94,
                                         6.2,
                                         3.84,
                                         4.,
                                         7.44,
                                         7.7333333333,
                                         5.6,
                                         5.8133333333,
                                         5.6,
                                         5.8133333333,
                                         4.85,
                                         5.0333333333,
                                         9.0233333333,
                                         9.3533333333,
                                         9.0233333333,
                                         9.3533333333,
                                         13.49,
                                         13.9666666667,
                                         8.64,
                                         8.9333333333,
                                         16.5733333333,
                                         17.1111111111,
                                         12.4,
                                         12.7911111111,
                                         12.4,
                                         12.7911111111,
                                         4.,
                                         4.1333333333,
                                         7.4133333333,
                                         7.6533333333,
                                         7.4133333333,
                                         7.6533333333,
                                         11.04,
                                         11.3866666667,
                                         7.04,
                                         7.2533333333,
                                         13.44,
                                         13.8311111111,
                                         10.0266666667,
                                         10.3111111111,
                                         10.0266666667,
                                         10.3111111111,
                                         4.,
                                         4.1333333333,
                                         7.4133333333,
                                         7.6533333333,
                                         7.4133333333,
                                         7.6533333333,
                                         11.04,
                                         11.3866666667,
                                         7.04,
                                         7.2533333333,
                                         13.44,
                                         13.8311111111,
                                         10.0266666667,
                                         10.3111111111,
                                         10.0266666667,
                                         10.3111111111,
                                         2.5625,
                                         2.625,
                                         4.7125,
                                         4.825,
                                         4.7125,
                                         4.825,
                                         6.9625,
                                         7.125,
                                         4.4,
                                         4.5,
                                         8.3166666667,
                                         8.5,
                                         6.1666666667,
                                         6.3,
                                         6.1666666667,
                                         6.3,
                                         5.0125,
                                         5.125,
                                         9.2025,
                                         9.405,
                                         9.2025,
                                         9.405,
                                         13.5725,
                                         13.865,
                                         8.56,
                                         8.74,
                                         16.1433333333,
                                         16.4733333333,
                                         11.9533333333,
                                         12.1933333333,
                                         11.9533333333,
                                         12.1933333333,
                                         5.0125,
                                         5.125,
                                         9.2025,
                                         9.405,
                                         9.2025,
                                         9.405,
                                         13.5725,
                                         13.865,
                                         8.56,
                                         8.74,
                                         16.1433333333,
                                         16.4733333333,
                                         11.9533333333,
                                         12.1933333333,
                                         11.9533333333,
                                         12.1933333333,
                                         7.8625,
                                         8.025,
                                         14.4125,
                                         14.705,
                                         14.4125,
                                         14.705,
                                         21.2225,
                                         21.645,
                                         13.36,
                                         13.62,
                                         25.1433333333,
                                         25.62,
                                         18.5933333333,
                                         18.94,
                                         18.5933333333,
                                         18.94,
                                         5.3,
                                         5.4,
                                         9.7,
                                         9.88,
                                         9.7,
                                         9.88,
                                         14.26,
                                         14.52,
                                         8.96,
                                         9.12,
                                         16.8266666667,
                                         17.12,
                                         12.4266666667,
                                         12.64,
                                         12.4266666667,
                                         12.64,
                                         8.55,
                                         8.7,
                                         15.63,
                                         15.9,
                                         15.63,
                                         15.9,
                                         22.95,
                                         23.34,
                                         14.4,
                                         14.64,
                                         27.,
                                         27.44,
                                         19.92,
                                         20.24,
                                         19.92,
                                         20.24,
                                         6.1,
                                         6.2,
                                         11.14,
                                         11.32,
                                         11.14,
                                         11.32,
                                         16.34,
                                         16.6,
                                         10.24,
                                         10.4,
                                         19.1733333333,
                                         19.4666666667,
                                         14.1333333333,
                                         14.3466666667,
                                         14.1333333333,
                                         14.3466666667,
                                         12.1833333333,
                                         12.3666666667,
                                         22.2233333333,
                                         22.5533333333,
                                         22.2233333333,
                                         22.5533333333,
                                         32.5566666667,
                                         33.0333333333,
                                         20.3733333333,
                                         20.6666666667,
                                         38.0844444444,
                                         38.6222222222,
                                         28.0444444444,
                                         28.4355555556,
                                         28.0444444444,
                                         28.4355555556,
                                         9.3333333333,
                                         9.4666666667,
                                         17.0133333333,
                                         17.2533333333,
                                         17.0133333333,
                                         17.2533333333,
                                         24.9066666667,
                                         25.2533333333,
                                         15.5733333333,
                                         15.7866666667,
                                         29.0844444444,
                                         29.4755555556,
                                         21.4044444444,
                                         21.6888888889,
                                         21.4044444444,
                                         21.6888888889,
                                         9.3333333333,
                                         9.4666666667,
                                         17.0133333333,
                                         17.2533333333,
                                         17.0133333333,
                                         17.2533333333,
                                         24.9066666667,
                                         25.2533333333,
                                         15.5733333333,
                                         15.7866666667,
                                         29.0844444444,
                                         29.4755555556,
                                         21.4044444444,
                                         21.6888888889,
                                         21.4044444444,
                                         21.6888888889,
                                         5.0625,
                                         5.125,
                                         9.2125,
                                         9.325,
                                         9.2125,
                                         9.325,
                                         13.4625,
                                         13.625,
                                         8.4,
                                         8.5,
                                         15.65,
                                         15.8333333333,
                                         11.5,
                                         11.6333333333,
                                         11.5,
                                         11.6333333333,
                                         9.5125,
                                         9.625,
                                         17.3025,
                                         17.505,
                                         17.3025,
                                         17.505,
                                         25.2725,
                                         25.565,
                                         15.76,
                                         15.94,
                                         29.3433333333,
                                         29.6733333333,
                                         21.5533333333,
                                         21.7933333333,
                                         21.5533333333,
                                         21.7933333333,
                                         9.5125,
                                         9.625,
                                         17.3025,
                                         17.505,
                                         17.3025,
                                         17.505,
                                         25.2725,
                                         25.565,
                                         15.76,
                                         15.94,
                                         29.3433333333,
                                         29.6733333333,
                                         21.5533333333,
                                         21.7933333333,
                                         21.5533333333,
                                         21.7933333333,
                                         14.3625,
                                         14.525,
                                         26.1125,
                                         26.405,
                                         26.1125,
                                         26.405,
                                         38.1225,
                                         38.545,
                                         23.76,
                                         24.02,
                                         44.21,
                                         44.6866666667,
                                         32.46,
                                         32.8066666667,
                                         32.46,
                                         32.8066666667,
                                         9.3,
                                         9.4,
                                         16.9,
                                         17.08,
                                         16.9,
                                         17.08,
                                         24.66,
                                         24.92,
                                         15.36,
                                         15.52,
                                         28.56,
                                         28.8533333333,
                                         20.96,
                                         21.1733333333,
                                         20.96,
                                         21.1733333333,
                                         14.55,
                                         14.7,
                                         26.43,
                                         26.7,
                                         26.43,
                                         26.7,
                                         38.55,
                                         38.94,
                                         24.,
                                         24.24,
                                         44.6,
                                         45.04,
                                         32.72,
                                         33.04,
                                         32.72,
                                         33.04,
                                         10.1,
                                         10.2,
                                         18.34,
                                         18.52,
                                         18.34,
                                         18.52,
                                         26.74,
                                         27.,
                                         16.64,
                                         16.8,
                                         30.9066666667,
                                         31.2,
                                         22.6666666667,
                                         22.88,
                                         22.6666666667,
                                         22.88,
                                         19.5166666667,
                                         19.7,
                                         35.4233333333,
                                         35.7533333333,
                                         35.4233333333,
                                         35.7533333333,
                                         51.6233333333,
                                         52.1,
                                         32.1066666667,
                                         32.4,
                                         59.5955555556,
                                         60.1333333333,
                                         43.6888888889,
                                         44.08,
                                         43.6888888889,
                                         44.08,
                                         14.6666666667,
                                         14.8,
                                         26.6133333333,
                                         26.8533333333,
                                         26.6133333333,
                                         26.8533333333,
                                         38.7733333333,
                                         39.12,
                                         24.1066666667,
                                         24.32,
                                         44.7288888889,
                                         45.12,
                                         32.7822222222,
                                         33.0666666667,
                                         32.7822222222,
                                         33.0666666667,
                                         14.6666666667,
                                         14.8,
                                         26.6133333333,
                                         26.8533333333,
                                         26.6133333333,
                                         26.8533333333,
                                         38.7733333333,
                                         39.12,
                                         24.1066666667,
                                         24.32,
                                         44.7288888889,
                                         45.12,
                                         32.7822222222,
                                         33.0666666667,
                                         32.7822222222,
                                         33.0666666667};
  const std::array<int, 4> in_shape = {{3, 10, 8, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID3x10x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.04, 0.08, 0.04, 0.08, 0.16, 0.24, 0.16, 0.24, 0.16, 0.24, 0.12, 0.16,
      0.12, 0.16, 0.,   0.,   0.04, 0.08, 0.04, 0.08, 0.16, 0.24, 0.16, 0.24,
      0.16, 0.24, 0.12, 0.16, 0.12, 0.16, 0.,   0.,   0.24, 0.32, 0.24, 0.32,
      0.64, 0.8,  0.64, 0.8,  0.64, 0.8,  0.4,  0.48, 0.4,  0.48, 0.,   0.,
      0.24, 0.32, 0.24, 0.32, 0.64, 0.8,  0.64, 0.8,  0.64, 0.8,  0.4,  0.48,
      0.4,  0.48, 0.,   0.,   0.6,  0.72, 0.6,  0.72, 1.44, 1.68, 1.44, 1.68,
      1.44, 1.68, 0.84, 0.96, 0.84, 0.96, 0.,   0.,   0.56, 0.64, 0.56, 0.64,
      1.28, 1.44, 1.28, 1.44, 1.28, 1.44, 0.72, 0.8,  0.72, 0.8,  0.,   0.,
      0.56, 0.64, 0.56, 0.64, 1.28, 1.44, 1.28, 1.44, 1.28, 1.44, 0.72, 0.8,
      0.72, 0.8,  0.,   0.,   0.36, 0.4,  0.36, 0.4,  0.8,  0.88, 0.8,  0.88,
      0.8,  0.88, 0.44, 0.48, 0.44, 0.48, 0.,   0.,   0.36, 0.4,  0.36, 0.4,
      0.8,  0.88, 0.8,  0.88, 0.8,  0.88, 0.44, 0.48, 0.44, 0.48, 0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.52, 0.56, 0.52, 0.56, 1.12, 1.2,  1.12, 1.2,
      1.12, 1.2,  0.6,  0.64, 0.6,  0.64, 0.,   0.,   0.52, 0.56, 0.52, 0.56,
      1.12, 1.2,  1.12, 1.2,  1.12, 1.2,  0.6,  0.64, 0.6,  0.64, 0.,   0.,
      1.2,  1.28, 1.2,  1.28, 2.56, 2.72, 2.56, 2.72, 2.56, 2.72, 1.36, 1.44,
      1.36, 1.44, 0.,   0.,   1.2,  1.28, 1.2,  1.28, 2.56, 2.72, 2.56, 2.72,
      2.56, 2.72, 1.36, 1.44, 1.36, 1.44, 0.,   0.,   2.04, 2.16, 2.04, 2.16,
      4.32, 4.56, 4.32, 4.56, 4.32, 4.56, 2.28, 2.4,  2.28, 2.4,  0.,   0.,
      1.52, 1.6,  1.52, 1.6,  3.2,  3.36, 3.2,  3.36, 3.2,  3.36, 1.68, 1.76,
      1.68, 1.76, 0.,   0.,   1.52, 1.6,  1.52, 1.6,  3.2,  3.36, 3.2,  3.36,
      3.2,  3.36, 1.68, 1.76, 1.68, 1.76, 0.,   0.,   0.84, 0.88, 0.84, 0.88,
      1.76, 1.84, 1.76, 1.84, 1.76, 1.84, 0.92, 0.96, 0.92, 0.96, 0.,   0.,
      0.84, 0.88, 0.84, 0.88, 1.76, 1.84, 1.76, 1.84, 1.76, 1.84, 0.92, 0.96,
      0.92, 0.96, 0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   1.,   1.04, 1.,   1.04,
      2.08, 2.16, 2.08, 2.16, 2.08, 2.16, 1.08, 1.12, 1.08, 1.12, 0.,   0.,
      1.,   1.04, 1.,   1.04, 2.08, 2.16, 2.08, 2.16, 2.08, 2.16, 1.08, 1.12,
      1.08, 1.12, 0.,   0.,   2.16, 2.24, 2.16, 2.24, 4.48, 4.64, 4.48, 4.64,
      4.48, 4.64, 2.32, 2.4,  2.32, 2.4,  0.,   0.,   2.16, 2.24, 2.16, 2.24,
      4.48, 4.64, 4.48, 4.64, 4.48, 4.64, 2.32, 2.4,  2.32, 2.4,  0.,   0.,
      3.48, 3.6,  3.48, 3.6,  7.2,  7.44, 7.2,  7.44, 7.2,  7.44, 3.72, 3.84,
      3.72, 3.84, 0.,   0.,   2.48, 2.56, 2.48, 2.56, 5.12, 5.28, 5.12, 5.28,
      5.12, 5.28, 2.64, 2.72, 2.64, 2.72, 0.,   0.,   2.48, 2.56, 2.48, 2.56,
      5.12, 5.28, 5.12, 5.28, 5.12, 5.28, 2.64, 2.72, 2.64, 2.72, 0.,   0.,
      1.32, 1.36, 1.32, 1.36, 2.72, 2.8,  2.72, 2.8,  2.72, 2.8,  1.4,  1.44,
      1.4,  1.44, 0.,   0.,   1.32, 1.36, 1.32, 1.36, 2.72, 2.8,  2.72, 2.8,
      2.72, 2.8,  1.4,  1.44, 1.4,  1.44, 0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
  };
  const std::array<int, 4> in_shape = {{3, 10, 8, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME3x10x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.0625,
                                         0.125,
                                         0.1875,
                                         0.25,
                                         0.3125,
                                         0.425,
                                         0.5375,
                                         0.65,
                                         0.3125,
                                         0.425,
                                         0.5375,
                                         0.65,
                                         0.7625,
                                         0.925,
                                         1.0875,
                                         1.25,
                                         0.7,
                                         0.8,
                                         0.9,
                                         1.,
                                         1.7833333333,
                                         1.9666666667,
                                         2.15,
                                         2.3333333333,
                                         1.5333333333,
                                         1.6666666667,
                                         1.8,
                                         1.9333333333,
                                         1.5333333333,
                                         1.6666666667,
                                         1.8,
                                         1.9333333333,
                                         0.9125,
                                         1.025,
                                         1.1375,
                                         1.25,
                                         2.0025,
                                         2.205,
                                         2.4075,
                                         2.61,
                                         2.0025,
                                         2.205,
                                         2.4075,
                                         2.61,
                                         3.4525,
                                         3.745,
                                         4.0375,
                                         4.33,
                                         2.54,
                                         2.72,
                                         2.9,
                                         3.08,
                                         5.5566666667,
                                         5.8866666667,
                                         6.2166666667,
                                         6.5466666667,
                                         4.4666666667,
                                         4.7066666667,
                                         4.9466666667,
                                         5.1866666667,
                                         4.4666666667,
                                         4.7066666667,
                                         4.9466666667,
                                         5.1866666667,
                                         0.9125,
                                         1.025,
                                         1.1375,
                                         1.25,
                                         2.0025,
                                         2.205,
                                         2.4075,
                                         2.61,
                                         2.0025,
                                         2.205,
                                         2.4075,
                                         2.61,
                                         3.4525,
                                         3.745,
                                         4.0375,
                                         4.33,
                                         2.54,
                                         2.72,
                                         2.9,
                                         3.08,
                                         5.5566666667,
                                         5.8866666667,
                                         6.2166666667,
                                         6.5466666667,
                                         4.4666666667,
                                         4.7066666667,
                                         4.9466666667,
                                         5.1866666667,
                                         4.4666666667,
                                         4.7066666667,
                                         4.9466666667,
                                         5.1866666667,
                                         2.5625,
                                         2.725,
                                         2.8875,
                                         3.05,
                                         5.1325,
                                         5.425,
                                         5.7175,
                                         6.01,
                                         5.1325,
                                         5.425,
                                         5.7175,
                                         6.01,
                                         8.2225,
                                         8.645,
                                         9.0675,
                                         9.49,
                                         5.66,
                                         5.92,
                                         6.18,
                                         6.44,
                                         11.6766666667,
                                         12.1533333333,
                                         12.63,
                                         13.1066666667,
                                         9.1066666667,
                                         9.4533333333,
                                         9.8,
                                         10.1466666667,
                                         9.1066666667,
                                         9.4533333333,
                                         9.8,
                                         10.1466666667,
                                         2.5,
                                         2.6,
                                         2.7,
                                         2.8,
                                         4.82,
                                         5.,
                                         5.18,
                                         5.36,
                                         4.82,
                                         5.,
                                         5.18,
                                         5.36,
                                         7.46,
                                         7.72,
                                         7.98,
                                         8.24,
                                         4.96,
                                         5.12,
                                         5.28,
                                         5.44,
                                         9.8933333333,
                                         10.1866666667,
                                         10.48,
                                         10.7733333333,
                                         7.5733333333,
                                         7.7866666667,
                                         8.,
                                         8.2133333333,
                                         7.5733333333,
                                         7.7866666667,
                                         8.,
                                         8.2133333333,
                                         4.95,
                                         5.1,
                                         5.25,
                                         5.4,
                                         9.39,
                                         9.66,
                                         9.93,
                                         10.2,
                                         9.39,
                                         9.66,
                                         9.93,
                                         10.2,
                                         14.31,
                                         14.7,
                                         15.09,
                                         15.48,
                                         9.36,
                                         9.6,
                                         9.84,
                                         10.08,
                                         18.36,
                                         18.8,
                                         19.24,
                                         19.68,
                                         13.92,
                                         14.24,
                                         14.56,
                                         14.88,
                                         13.92,
                                         14.24,
                                         14.56,
                                         14.88,
                                         4.1,
                                         4.2,
                                         4.3,
                                         4.4,
                                         7.7,
                                         7.88,
                                         8.06,
                                         8.24,
                                         7.7,
                                         7.88,
                                         8.06,
                                         8.24,
                                         11.62,
                                         11.88,
                                         12.14,
                                         12.4,
                                         7.52,
                                         7.68,
                                         7.84,
                                         8.,
                                         14.5866666667,
                                         14.88,
                                         15.1733333333,
                                         15.4666666667,
                                         10.9866666667,
                                         11.2,
                                         11.4133333333,
                                         11.6266666667,
                                         10.9866666667,
                                         11.2,
                                         11.4133333333,
                                         11.6266666667,
                                         9.5166666667,
                                         9.7,
                                         9.8833333333,
                                         10.0666666667,
                                         17.7166666667,
                                         18.0466666667,
                                         18.3766666667,
                                         18.7066666667,
                                         17.7166666667,
                                         18.0466666667,
                                         18.3766666667,
                                         18.7066666667,
                                         26.5033333333,
                                         26.98,
                                         27.4566666667,
                                         27.9333333333,
                                         16.9866666667,
                                         17.28,
                                         17.5733333333,
                                         17.8666666667,
                                         32.6088888889,
                                         33.1466666667,
                                         33.6844444444,
                                         34.2222222222,
                                         24.4088888889,
                                         24.8,
                                         25.1911111111,
                                         25.5822222222,
                                         24.4088888889,
                                         24.8,
                                         25.1911111111,
                                         25.5822222222,
                                         7.8666666667,
                                         8.,
                                         8.1333333333,
                                         8.2666666667,
                                         14.5866666667,
                                         14.8266666667,
                                         15.0666666667,
                                         15.3066666667,
                                         14.5866666667,
                                         14.8266666667,
                                         15.0666666667,
                                         15.3066666667,
                                         21.7333333333,
                                         22.08,
                                         22.4266666667,
                                         22.7733333333,
                                         13.8666666667,
                                         14.08,
                                         14.2933333333,
                                         14.5066666667,
                                         26.4888888889,
                                         26.88,
                                         27.2711111111,
                                         27.6622222222,
                                         19.7688888889,
                                         20.0533333333,
                                         20.3377777778,
                                         20.6222222222,
                                         19.7688888889,
                                         20.0533333333,
                                         20.3377777778,
                                         20.6222222222,
                                         7.8666666667,
                                         8.,
                                         8.1333333333,
                                         8.2666666667,
                                         14.5866666667,
                                         14.8266666667,
                                         15.0666666667,
                                         15.3066666667,
                                         14.5866666667,
                                         14.8266666667,
                                         15.0666666667,
                                         15.3066666667,
                                         21.7333333333,
                                         22.08,
                                         22.4266666667,
                                         22.7733333333,
                                         13.8666666667,
                                         14.08,
                                         14.2933333333,
                                         14.5066666667,
                                         26.4888888889,
                                         26.88,
                                         27.2711111111,
                                         27.6622222222,
                                         19.7688888889,
                                         20.0533333333,
                                         20.3377777778,
                                         20.6222222222,
                                         19.7688888889,
                                         20.0533333333,
                                         20.3377777778,
                                         20.6222222222,
                                         5.0625,
                                         5.125,
                                         5.1875,
                                         5.25,
                                         9.3125,
                                         9.425,
                                         9.5375,
                                         9.65,
                                         9.3125,
                                         9.425,
                                         9.5375,
                                         9.65,
                                         13.7625,
                                         13.925,
                                         14.0875,
                                         14.25,
                                         8.7,
                                         8.8,
                                         8.9,
                                         9.,
                                         16.45,
                                         16.6333333333,
                                         16.8166666667,
                                         17.,
                                         12.2,
                                         12.3333333333,
                                         12.4666666667,
                                         12.6,
                                         12.2,
                                         12.3333333333,
                                         12.4666666667,
                                         12.6,
                                         9.9125,
                                         10.025,
                                         10.1375,
                                         10.25,
                                         18.2025,
                                         18.405,
                                         18.6075,
                                         18.81,
                                         18.2025,
                                         18.405,
                                         18.6075,
                                         18.81,
                                         26.8525,
                                         27.145,
                                         27.4375,
                                         27.73,
                                         16.94,
                                         17.12,
                                         17.3,
                                         17.48,
                                         31.9566666667,
                                         32.2866666667,
                                         32.6166666667,
                                         32.9466666667,
                                         23.6666666667,
                                         23.9066666667,
                                         24.1466666667,
                                         24.3866666667,
                                         23.6666666667,
                                         23.9066666667,
                                         24.1466666667,
                                         24.3866666667,
                                         9.9125,
                                         10.025,
                                         10.1375,
                                         10.25,
                                         18.2025,
                                         18.405,
                                         18.6075,
                                         18.81,
                                         18.2025,
                                         18.405,
                                         18.6075,
                                         18.81,
                                         26.8525,
                                         27.145,
                                         27.4375,
                                         27.73,
                                         16.94,
                                         17.12,
                                         17.3,
                                         17.48,
                                         31.9566666667,
                                         32.2866666667,
                                         32.6166666667,
                                         32.9466666667,
                                         23.6666666667,
                                         23.9066666667,
                                         24.1466666667,
                                         24.3866666667,
                                         23.6666666667,
                                         23.9066666667,
                                         24.1466666667,
                                         24.3866666667,
                                         15.5625,
                                         15.725,
                                         15.8875,
                                         16.05,
                                         28.5325,
                                         28.825,
                                         29.1175,
                                         29.41,
                                         28.5325,
                                         28.825,
                                         29.1175,
                                         29.41,
                                         42.0225,
                                         42.445,
                                         42.8675,
                                         43.29,
                                         26.46,
                                         26.72,
                                         26.98,
                                         27.24,
                                         49.81,
                                         50.2866666667,
                                         50.7633333333,
                                         51.24,
                                         36.84,
                                         37.1866666667,
                                         37.5333333333,
                                         37.88,
                                         36.84,
                                         37.1866666667,
                                         37.5333333333,
                                         37.88,
                                         10.5,
                                         10.6,
                                         10.7,
                                         10.8,
                                         19.22,
                                         19.4,
                                         19.58,
                                         19.76,
                                         19.22,
                                         19.4,
                                         19.58,
                                         19.76,
                                         28.26,
                                         28.52,
                                         28.78,
                                         29.04,
                                         17.76,
                                         17.92,
                                         18.08,
                                         18.24,
                                         33.36,
                                         33.6533333333,
                                         33.9466666667,
                                         34.24,
                                         24.64,
                                         24.8533333333,
                                         25.0666666667,
                                         25.28,
                                         24.64,
                                         24.8533333333,
                                         25.0666666667,
                                         25.28,
                                         16.95,
                                         17.1,
                                         17.25,
                                         17.4,
                                         30.99,
                                         31.26,
                                         31.53,
                                         31.8,
                                         30.99,
                                         31.26,
                                         31.53,
                                         31.8,
                                         45.51,
                                         45.9,
                                         46.29,
                                         46.68,
                                         28.56,
                                         28.8,
                                         29.04,
                                         29.28,
                                         53.56,
                                         54.,
                                         54.44,
                                         54.88,
                                         39.52,
                                         39.84,
                                         40.16,
                                         40.48,
                                         39.52,
                                         39.84,
                                         40.16,
                                         40.48,
                                         12.1,
                                         12.2,
                                         12.3,
                                         12.4,
                                         22.1,
                                         22.28,
                                         22.46,
                                         22.64,
                                         22.1,
                                         22.28,
                                         22.46,
                                         22.64,
                                         32.42,
                                         32.68,
                                         32.94,
                                         33.2,
                                         20.32,
                                         20.48,
                                         20.64,
                                         20.8,
                                         38.0533333333,
                                         38.3466666667,
                                         38.64,
                                         38.9333333333,
                                         28.0533333333,
                                         28.2666666667,
                                         28.48,
                                         28.6933333333,
                                         28.0533333333,
                                         28.2666666667,
                                         28.48,
                                         28.6933333333,
                                         24.1833333333,
                                         24.3666666667,
                                         24.55,
                                         24.7333333333,
                                         44.1166666667,
                                         44.4466666667,
                                         44.7766666667,
                                         45.1066666667,
                                         44.1166666667,
                                         44.4466666667,
                                         44.7766666667,
                                         45.1066666667,
                                         64.6366666667,
                                         65.1133333333,
                                         65.59,
                                         66.0666666667,
                                         40.4533333333,
                                         40.7466666667,
                                         41.04,
                                         41.3333333333,
                                         75.6311111111,
                                         76.1688888889,
                                         76.7066666667,
                                         77.2444444444,
                                         55.6977777778,
                                         56.0888888889,
                                         56.48,
                                         56.8711111111,
                                         55.6977777778,
                                         56.0888888889,
                                         56.48,
                                         56.8711111111,
                                         18.5333333333,
                                         18.6666666667,
                                         18.8,
                                         18.9333333333,
                                         33.7866666667,
                                         34.0266666667,
                                         34.2666666667,
                                         34.5066666667,
                                         33.7866666667,
                                         34.0266666667,
                                         34.2666666667,
                                         34.5066666667,
                                         49.4666666667,
                                         49.8133333333,
                                         50.16,
                                         50.5066666667,
                                         30.9333333333,
                                         31.1466666667,
                                         31.36,
                                         31.5733333333,
                                         57.7777777778,
                                         58.1688888889,
                                         58.56,
                                         58.9511111111,
                                         42.5244444444,
                                         42.8088888889,
                                         43.0933333333,
                                         43.3777777778,
                                         42.5244444444,
                                         42.8088888889,
                                         43.0933333333,
                                         43.3777777778,
                                         18.5333333333,
                                         18.6666666667,
                                         18.8,
                                         18.9333333333,
                                         33.7866666667,
                                         34.0266666667,
                                         34.2666666667,
                                         34.5066666667,
                                         33.7866666667,
                                         34.0266666667,
                                         34.2666666667,
                                         34.5066666667,
                                         49.4666666667,
                                         49.8133333333,
                                         50.16,
                                         50.5066666667,
                                         30.9333333333,
                                         31.1466666667,
                                         31.36,
                                         31.5733333333,
                                         57.7777777778,
                                         58.1688888889,
                                         58.56,
                                         58.9511111111,
                                         42.5244444444,
                                         42.8088888889,
                                         43.0933333333,
                                         43.3777777778,
                                         42.5244444444,
                                         42.8088888889,
                                         43.0933333333,
                                         43.3777777778,
                                         10.0625,
                                         10.125,
                                         10.1875,
                                         10.25,
                                         18.3125,
                                         18.425,
                                         18.5375,
                                         18.65,
                                         18.3125,
                                         18.425,
                                         18.5375,
                                         18.65,
                                         26.7625,
                                         26.925,
                                         27.0875,
                                         27.25,
                                         16.7,
                                         16.8,
                                         16.9,
                                         17.,
                                         31.1166666667,
                                         31.3,
                                         31.4833333333,
                                         31.6666666667,
                                         22.8666666667,
                                         23.,
                                         23.1333333333,
                                         23.2666666667,
                                         22.8666666667,
                                         23.,
                                         23.1333333333,
                                         23.2666666667,
                                         18.9125,
                                         19.025,
                                         19.1375,
                                         19.25,
                                         34.4025,
                                         34.605,
                                         34.8075,
                                         35.01,
                                         34.4025,
                                         34.605,
                                         34.8075,
                                         35.01,
                                         50.2525,
                                         50.545,
                                         50.8375,
                                         51.13,
                                         31.34,
                                         31.52,
                                         31.7,
                                         31.88,
                                         58.3566666667,
                                         58.6866666667,
                                         59.0166666667,
                                         59.3466666667,
                                         42.8666666667,
                                         43.1066666667,
                                         43.3466666667,
                                         43.5866666667,
                                         42.8666666667,
                                         43.1066666667,
                                         43.3466666667,
                                         43.5866666667,
                                         18.9125,
                                         19.025,
                                         19.1375,
                                         19.25,
                                         34.4025,
                                         34.605,
                                         34.8075,
                                         35.01,
                                         34.4025,
                                         34.605,
                                         34.8075,
                                         35.01,
                                         50.2525,
                                         50.545,
                                         50.8375,
                                         51.13,
                                         31.34,
                                         31.52,
                                         31.7,
                                         31.88,
                                         58.3566666667,
                                         58.6866666667,
                                         59.0166666667,
                                         59.3466666667,
                                         42.8666666667,
                                         43.1066666667,
                                         43.3466666667,
                                         43.5866666667,
                                         42.8666666667,
                                         43.1066666667,
                                         43.3466666667,
                                         43.5866666667,
                                         28.5625,
                                         28.725,
                                         28.8875,
                                         29.05,
                                         51.9325,
                                         52.225,
                                         52.5175,
                                         52.81,
                                         51.9325,
                                         52.225,
                                         52.5175,
                                         52.81,
                                         75.8225,
                                         76.245,
                                         76.6675,
                                         77.09,
                                         47.26,
                                         47.52,
                                         47.78,
                                         48.04,
                                         87.9433333333,
                                         88.42,
                                         88.8966666667,
                                         89.3733333333,
                                         64.5733333333,
                                         64.92,
                                         65.2666666667,
                                         65.6133333333,
                                         64.5733333333,
                                         64.92,
                                         65.2666666667,
                                         65.6133333333,
                                         18.5,
                                         18.6,
                                         18.7,
                                         18.8,
                                         33.62,
                                         33.8,
                                         33.98,
                                         34.16,
                                         33.62,
                                         33.8,
                                         33.98,
                                         34.16,
                                         49.06,
                                         49.32,
                                         49.58,
                                         49.84,
                                         30.56,
                                         30.72,
                                         30.88,
                                         31.04,
                                         56.8266666667,
                                         57.12,
                                         57.4133333333,
                                         57.7066666667,
                                         41.7066666667,
                                         41.92,
                                         42.1333333333,
                                         42.3466666667,
                                         41.7066666667,
                                         41.92,
                                         42.1333333333,
                                         42.3466666667,
                                         28.95,
                                         29.1,
                                         29.25,
                                         29.4,
                                         52.59,
                                         52.86,
                                         53.13,
                                         53.4,
                                         52.59,
                                         52.86,
                                         53.13,
                                         53.4,
                                         76.71,
                                         77.1,
                                         77.49,
                                         77.88,
                                         47.76,
                                         48.,
                                         48.24,
                                         48.48,
                                         88.76,
                                         89.2,
                                         89.64,
                                         90.08,
                                         65.12,
                                         65.44,
                                         65.76,
                                         66.08,
                                         65.12,
                                         65.44,
                                         65.76,
                                         66.08,
                                         20.1,
                                         20.2,
                                         20.3,
                                         20.4,
                                         36.5,
                                         36.68,
                                         36.86,
                                         37.04,
                                         36.5,
                                         36.68,
                                         36.86,
                                         37.04,
                                         53.22,
                                         53.48,
                                         53.74,
                                         54.,
                                         33.12,
                                         33.28,
                                         33.44,
                                         33.6,
                                         61.52,
                                         61.8133333333,
                                         62.1066666667,
                                         62.4,
                                         45.12,
                                         45.3333333333,
                                         45.5466666667,
                                         45.76,
                                         45.12,
                                         45.3333333333,
                                         45.5466666667,
                                         45.76,
                                         38.85,
                                         39.0333333333,
                                         39.2166666667,
                                         39.4,
                                         70.5166666667,
                                         70.8466666667,
                                         71.1766666667,
                                         71.5066666667,
                                         70.5166666667,
                                         70.8466666667,
                                         71.1766666667,
                                         71.5066666667,
                                         102.77,
                                         103.2466666667,
                                         103.7233333333,
                                         104.2,
                                         63.92,
                                         64.2133333333,
                                         64.5066666667,
                                         64.8,
                                         118.6533333333,
                                         119.1911111111,
                                         119.7288888889,
                                         120.2666666667,
                                         86.9866666667,
                                         87.3777777778,
                                         87.7688888889,
                                         88.16,
                                         86.9866666667,
                                         87.3777777778,
                                         87.7688888889,
                                         88.16,
                                         29.2,
                                         29.3333333333,
                                         29.4666666667,
                                         29.6,
                                         52.9866666667,
                                         53.2266666667,
                                         53.4666666667,
                                         53.7066666667,
                                         52.9866666667,
                                         53.2266666667,
                                         53.4666666667,
                                         53.7066666667,
                                         77.2,
                                         77.5466666667,
                                         77.8933333333,
                                         78.24,
                                         48.,
                                         48.2133333333,
                                         48.4266666667,
                                         48.64,
                                         89.0666666667,
                                         89.4577777778,
                                         89.8488888889,
                                         90.24,
                                         65.28,
                                         65.5644444444,
                                         65.8488888889,
                                         66.1333333333,
                                         65.28,
                                         65.5644444444,
                                         65.8488888889,
                                         66.1333333333,
                                         29.2,
                                         29.3333333333,
                                         29.4666666667,
                                         29.6,
                                         52.9866666667,
                                         53.2266666667,
                                         53.4666666667,
                                         53.7066666667,
                                         52.9866666667,
                                         53.2266666667,
                                         53.4666666667,
                                         53.7066666667,
                                         77.2,
                                         77.5466666667,
                                         77.8933333333,
                                         78.24,
                                         48.,
                                         48.2133333333,
                                         48.4266666667,
                                         48.64,
                                         89.0666666667,
                                         89.4577777778,
                                         89.8488888889,
                                         90.24,
                                         65.28,
                                         65.5644444444,
                                         65.8488888889,
                                         66.1333333333,
                                         65.28,
                                         65.5644444444,
                                         65.8488888889,
                                         66.1333333333};
  const std::array<int, 4> in_shape = {{3, 10, 8, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID3x10x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.04,  0.08,  0.12,  0.16,  0.04,  0.08,  0.12,  0.16,  0.24,  0.32,
      0.4,   0.48,  0.24,  0.32,  0.4,   0.48,  0.24,  0.32,  0.4,   0.48,
      0.2,   0.24,  0.28,  0.32,  0.2,   0.24,  0.28,  0.32,  0.,    0.,
      0.,    0.,    0.04,  0.08,  0.12,  0.16,  0.04,  0.08,  0.12,  0.16,
      0.24,  0.32,  0.4,   0.48,  0.24,  0.32,  0.4,   0.48,  0.24,  0.32,
      0.4,   0.48,  0.2,   0.24,  0.28,  0.32,  0.2,   0.24,  0.28,  0.32,
      0.,    0.,    0.,    0.,    0.4,   0.48,  0.56,  0.64,  0.4,   0.48,
      0.56,  0.64,  1.12,  1.28,  1.44,  1.6,   1.12,  1.28,  1.44,  1.6,
      1.12,  1.28,  1.44,  1.6,   0.72,  0.8,   0.88,  0.96,  0.72,  0.8,
      0.88,  0.96,  0.,    0.,    0.,    0.,    0.4,   0.48,  0.56,  0.64,
      0.4,   0.48,  0.56,  0.64,  1.12,  1.28,  1.44,  1.6,   1.12,  1.28,
      1.44,  1.6,   1.12,  1.28,  1.44,  1.6,   0.72,  0.8,   0.88,  0.96,
      0.72,  0.8,   0.88,  0.96,  0.,    0.,    0.,    0.,    1.08,  1.2,
      1.32,  1.44,  1.08,  1.2,   1.32,  1.44,  2.64,  2.88,  3.12,  3.36,
      2.64,  2.88,  3.12,  3.36,  2.64,  2.88,  3.12,  3.36,  1.56,  1.68,
      1.8,   1.92,  1.56,  1.68,  1.8,   1.92,  0.,    0.,    0.,    0.,
      1.04,  1.12,  1.2,   1.28,  1.04,  1.12,  1.2,   1.28,  2.4,   2.56,
      2.72,  2.88,  2.4,   2.56,  2.72,  2.88,  2.4,   2.56,  2.72,  2.88,
      1.36,  1.44,  1.52,  1.6,   1.36,  1.44,  1.52,  1.6,   0.,    0.,
      0.,    0.,    1.04,  1.12,  1.2,   1.28,  1.04,  1.12,  1.2,   1.28,
      2.4,   2.56,  2.72,  2.88,  2.4,   2.56,  2.72,  2.88,  2.4,   2.56,
      2.72,  2.88,  1.36,  1.44,  1.52,  1.6,   1.36,  1.44,  1.52,  1.6,
      0.,    0.,    0.,    0.,    0.68,  0.72,  0.76,  0.8,   0.68,  0.72,
      0.76,  0.8,   1.52,  1.6,   1.68,  1.76,  1.52,  1.6,   1.68,  1.76,
      1.52,  1.6,   1.68,  1.76,  0.84,  0.88,  0.92,  0.96,  0.84,  0.88,
      0.92,  0.96,  0.,    0.,    0.,    0.,    0.68,  0.72,  0.76,  0.8,
      0.68,  0.72,  0.76,  0.8,   1.52,  1.6,   1.68,  1.76,  1.52,  1.6,
      1.68,  1.76,  1.52,  1.6,   1.68,  1.76,  0.84,  0.88,  0.92,  0.96,
      0.84,  0.88,  0.92,  0.96,  0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      1.,    1.04,  1.08,  1.12,  1.,    1.04,  1.08,  1.12,  2.16,  2.24,
      2.32,  2.4,   2.16,  2.24,  2.32,  2.4,   2.16,  2.24,  2.32,  2.4,
      1.16,  1.2,   1.24,  1.28,  1.16,  1.2,   1.24,  1.28,  0.,    0.,
      0.,    0.,    1.,    1.04,  1.08,  1.12,  1.,    1.04,  1.08,  1.12,
      2.16,  2.24,  2.32,  2.4,   2.16,  2.24,  2.32,  2.4,   2.16,  2.24,
      2.32,  2.4,   1.16,  1.2,   1.24,  1.28,  1.16,  1.2,   1.24,  1.28,
      0.,    0.,    0.,    0.,    2.32,  2.4,   2.48,  2.56,  2.32,  2.4,
      2.48,  2.56,  4.96,  5.12,  5.28,  5.44,  4.96,  5.12,  5.28,  5.44,
      4.96,  5.12,  5.28,  5.44,  2.64,  2.72,  2.8,   2.88,  2.64,  2.72,
      2.8,   2.88,  0.,    0.,    0.,    0.,    2.32,  2.4,   2.48,  2.56,
      2.32,  2.4,   2.48,  2.56,  4.96,  5.12,  5.28,  5.44,  4.96,  5.12,
      5.28,  5.44,  4.96,  5.12,  5.28,  5.44,  2.64,  2.72,  2.8,   2.88,
      2.64,  2.72,  2.8,   2.88,  0.,    0.,    0.,    0.,    3.96,  4.08,
      4.2,   4.32,  3.96,  4.08,  4.2,   4.32,  8.4,   8.64,  8.88,  9.12,
      8.4,   8.64,  8.88,  9.12,  8.4,   8.64,  8.88,  9.12,  4.44,  4.56,
      4.68,  4.8,   4.44,  4.56,  4.68,  4.8,   0.,    0.,    0.,    0.,
      2.96,  3.04,  3.12,  3.2,   2.96,  3.04,  3.12,  3.2,   6.24,  6.4,
      6.56,  6.72,  6.24,  6.4,   6.56,  6.72,  6.24,  6.4,   6.56,  6.72,
      3.28,  3.36,  3.44,  3.52,  3.28,  3.36,  3.44,  3.52,  0.,    0.,
      0.,    0.,    2.96,  3.04,  3.12,  3.2,   2.96,  3.04,  3.12,  3.2,
      6.24,  6.4,   6.56,  6.72,  6.24,  6.4,   6.56,  6.72,  6.24,  6.4,
      6.56,  6.72,  3.28,  3.36,  3.44,  3.52,  3.28,  3.36,  3.44,  3.52,
      0.,    0.,    0.,    0.,    1.64,  1.68,  1.72,  1.76,  1.64,  1.68,
      1.72,  1.76,  3.44,  3.52,  3.6,   3.68,  3.44,  3.52,  3.6,   3.68,
      3.44,  3.52,  3.6,   3.68,  1.8,   1.84,  1.88,  1.92,  1.8,   1.84,
      1.88,  1.92,  0.,    0.,    0.,    0.,    1.64,  1.68,  1.72,  1.76,
      1.64,  1.68,  1.72,  1.76,  3.44,  3.52,  3.6,   3.68,  3.44,  3.52,
      3.6,   3.68,  3.44,  3.52,  3.6,   3.68,  1.8,   1.84,  1.88,  1.92,
      1.8,   1.84,  1.88,  1.92,  0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      1.96,  2.,    2.04,  2.08,  1.96,  2.,    2.04,  2.08,  4.08,  4.16,
      4.24,  4.32,  4.08,  4.16,  4.24,  4.32,  4.08,  4.16,  4.24,  4.32,
      2.12,  2.16,  2.2,   2.24,  2.12,  2.16,  2.2,   2.24,  0.,    0.,
      0.,    0.,    1.96,  2.,    2.04,  2.08,  1.96,  2.,    2.04,  2.08,
      4.08,  4.16,  4.24,  4.32,  4.08,  4.16,  4.24,  4.32,  4.08,  4.16,
      4.24,  4.32,  2.12,  2.16,  2.2,   2.24,  2.12,  2.16,  2.2,   2.24,
      0.,    0.,    0.,    0.,    4.24,  4.32,  4.4,   4.48,  4.24,  4.32,
      4.4,   4.48,  8.8,   8.96,  9.12,  9.28,  8.8,   8.96,  9.12,  9.28,
      8.8,   8.96,  9.12,  9.28,  4.56,  4.64,  4.72,  4.8,   4.56,  4.64,
      4.72,  4.8,   0.,    0.,    0.,    0.,    4.24,  4.32,  4.4,   4.48,
      4.24,  4.32,  4.4,   4.48,  8.8,   8.96,  9.12,  9.28,  8.8,   8.96,
      9.12,  9.28,  8.8,   8.96,  9.12,  9.28,  4.56,  4.64,  4.72,  4.8,
      4.56,  4.64,  4.72,  4.8,   0.,    0.,    0.,    0.,    6.84,  6.96,
      7.08,  7.2,   6.84,  6.96,  7.08,  7.2,   14.16, 14.4,  14.64, 14.88,
      14.16, 14.4,  14.64, 14.88, 14.16, 14.4,  14.64, 14.88, 7.32,  7.44,
      7.56,  7.68,  7.32,  7.44,  7.56,  7.68,  0.,    0.,    0.,    0.,
      4.88,  4.96,  5.04,  5.12,  4.88,  4.96,  5.04,  5.12,  10.08, 10.24,
      10.4,  10.56, 10.08, 10.24, 10.4,  10.56, 10.08, 10.24, 10.4,  10.56,
      5.2,   5.28,  5.36,  5.44,  5.2,   5.28,  5.36,  5.44,  0.,    0.,
      0.,    0.,    4.88,  4.96,  5.04,  5.12,  4.88,  4.96,  5.04,  5.12,
      10.08, 10.24, 10.4,  10.56, 10.08, 10.24, 10.4,  10.56, 10.08, 10.24,
      10.4,  10.56, 5.2,   5.28,  5.36,  5.44,  5.2,   5.28,  5.36,  5.44,
      0.,    0.,    0.,    0.,    2.6,   2.64,  2.68,  2.72,  2.6,   2.64,
      2.68,  2.72,  5.36,  5.44,  5.52,  5.6,   5.36,  5.44,  5.52,  5.6,
      5.36,  5.44,  5.52,  5.6,   2.76,  2.8,   2.84,  2.88,  2.76,  2.8,
      2.84,  2.88,  0.,    0.,    0.,    0.,    2.6,   2.64,  2.68,  2.72,
      2.6,   2.64,  2.68,  2.72,  5.36,  5.44,  5.52,  5.6,   5.36,  5.44,
      5.52,  5.6,   5.36,  5.44,  5.52,  5.6,   2.76,  2.8,   2.84,  2.88,
      2.76,  2.8,   2.84,  2.88,  0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
  };
  const std::array<int, 4> in_shape = {{3, 10, 8, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME3x10x10x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.0625,
                                         0.1625,
                                         0.1625,
                                         0.3125,
                                         0.25,
                                         0.45,
                                         0.35,
                                         0.7666666667,
                                         0.6166666667,
                                         0.6166666667,
                                         0.3625,
                                         0.7425,
                                         0.7425,
                                         1.2125,
                                         0.85,
                                         1.41,
                                         1.03,
                                         2.1133333333,
                                         1.6433333333,
                                         1.6433333333,
                                         0.3625,
                                         0.7425,
                                         0.7425,
                                         1.2125,
                                         0.85,
                                         1.41,
                                         1.03,
                                         2.1133333333,
                                         1.6433333333,
                                         1.6433333333,
                                         0.9125,
                                         1.7725,
                                         1.7725,
                                         2.7625,
                                         1.85,
                                         2.97,
                                         2.11,
                                         4.1933333333,
                                         3.2033333333,
                                         3.2033333333,
                                         0.85,
                                         1.61,
                                         1.61,
                                         2.45,
                                         1.6,
                                         2.52,
                                         1.76,
                                         3.4266666667,
                                         2.5866666667,
                                         2.5866666667,
                                         1.65,
                                         3.09,
                                         3.09,
                                         4.65,
                                         3.,
                                         4.68,
                                         3.24,
                                         6.24,
                                         4.68,
                                         4.68,
                                         1.35,
                                         2.51,
                                         2.51,
                                         3.75,
                                         2.4,
                                         3.72,
                                         2.56,
                                         4.8933333333,
                                         3.6533333333,
                                         3.6533333333,
                                         3.1,
                                         5.7266666667,
                                         5.7266666667,
                                         8.5,
                                         5.4,
                                         8.32,
                                         5.6933333333,
                                         10.8044444444,
                                         8.0311111111,
                                         8.0311111111,
                                         2.55,
                                         4.6966666667,
                                         4.6966666667,
                                         6.95,
                                         4.4,
                                         6.76,
                                         4.6133333333,
                                         8.7244444444,
                                         6.4711111111,
                                         6.4711111111,
                                         2.55,
                                         4.6966666667,
                                         4.6966666667,
                                         6.95,
                                         4.4,
                                         6.76,
                                         4.6133333333,
                                         8.7244444444,
                                         6.4711111111,
                                         6.4711111111,
                                         1.625,
                                         2.975,
                                         2.975,
                                         4.375,
                                         2.75,
                                         4.2,
                                         2.85,
                                         5.35,
                                         3.95,
                                         3.95,
                                         3.175,
                                         5.805,
                                         5.805,
                                         8.525,
                                         5.35,
                                         8.16,
                                         5.53,
                                         10.3633333333,
                                         7.6433333333,
                                         7.6433333333,
                                         3.175,
                                         5.805,
                                         5.805,
                                         8.525,
                                         5.35,
                                         8.16,
                                         5.53,
                                         10.3633333333,
                                         7.6433333333,
                                         7.6433333333,
                                         4.975,
                                         9.085,
                                         9.085,
                                         13.325,
                                         8.35,
                                         12.72,
                                         8.61,
                                         16.11,
                                         11.87,
                                         11.87,
                                         3.35,
                                         6.11,
                                         6.11,
                                         8.95,
                                         5.6,
                                         8.52,
                                         5.76,
                                         10.76,
                                         7.92,
                                         7.92,
                                         5.4,
                                         9.84,
                                         9.84,
                                         14.4,
                                         9.,
                                         13.68,
                                         9.24,
                                         17.24,
                                         12.68,
                                         12.68,
                                         3.85,
                                         7.01,
                                         7.01,
                                         10.25,
                                         6.4,
                                         9.72,
                                         6.56,
                                         12.2266666667,
                                         8.9866666667,
                                         8.9866666667,
                                         7.6833333333,
                                         13.9766666667,
                                         13.9766666667,
                                         20.4166666667,
                                         12.7333333333,
                                         19.32,
                                         13.0266666667,
                                         24.2488888889,
                                         17.8088888889,
                                         17.8088888889,
                                         5.8833333333,
                                         10.6966666667,
                                         10.6966666667,
                                         15.6166666667,
                                         9.7333333333,
                                         14.76,
                                         9.9466666667,
                                         18.5022222222,
                                         13.5822222222,
                                         13.5822222222,
                                         5.8833333333,
                                         10.6966666667,
                                         10.6966666667,
                                         15.6166666667,
                                         9.7333333333,
                                         14.76,
                                         9.9466666667,
                                         18.5022222222,
                                         13.5822222222,
                                         13.5822222222,
                                         3.1875,
                                         5.7875,
                                         5.7875,
                                         8.4375,
                                         5.25,
                                         7.95,
                                         5.35,
                                         9.9333333333,
                                         7.2833333333,
                                         7.2833333333,
                                         5.9875,
                                         10.8675,
                                         10.8675,
                                         15.8375,
                                         9.85,
                                         14.91,
                                         10.03,
                                         18.6133333333,
                                         13.6433333333,
                                         13.6433333333,
                                         5.9875,
                                         10.8675,
                                         10.8675,
                                         15.8375,
                                         9.85,
                                         14.91,
                                         10.03,
                                         18.6133333333,
                                         13.6433333333,
                                         13.6433333333,
                                         9.0375,
                                         16.3975,
                                         16.3975,
                                         23.8875,
                                         14.85,
                                         22.47,
                                         15.11,
                                         28.0266666667,
                                         20.5366666667,
                                         20.5366666667,
                                         5.85,
                                         10.61,
                                         10.61,
                                         15.45,
                                         9.6,
                                         14.52,
                                         9.76,
                                         18.0933333333,
                                         13.2533333333,
                                         13.2533333333,
                                         9.15,
                                         16.59,
                                         16.59,
                                         24.15,
                                         15.,
                                         22.68,
                                         15.24,
                                         28.24,
                                         20.68,
                                         20.68,
                                         6.35,
                                         11.51,
                                         11.51,
                                         16.75,
                                         10.4,
                                         15.72,
                                         10.56,
                                         19.56,
                                         14.32,
                                         14.32,
                                         12.2666666667,
                                         22.2266666667,
                                         22.2266666667,
                                         32.3333333333,
                                         20.0666666667,
                                         30.32,
                                         20.36,
                                         37.6933333333,
                                         27.5866666667,
                                         27.5866666667,
                                         9.2166666667,
                                         16.6966666667,
                                         16.6966666667,
                                         24.2833333333,
                                         15.0666666667,
                                         22.76,
                                         15.28,
                                         28.28,
                                         20.6933333333,
                                         20.6933333333,
                                         9.2166666667,
                                         16.6966666667,
                                         16.6966666667,
                                         24.2833333333,
                                         15.0666666667,
                                         22.76,
                                         15.28,
                                         28.28,
                                         20.6933333333,
                                         20.6933333333};
  const std::array<int, 4> in_shape = {{3, 10, 10, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID3x10x10x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.04, 0.04, 0.12, 0.12, 0.24, 0.2,  0.2,  0.12, 0.12, 0.,   0.04, 0.04,
      0.12, 0.12, 0.24, 0.2,  0.2,  0.12, 0.12, 0.,   0.2,  0.2,  0.48, 0.48,
      0.84, 0.64, 0.64, 0.36, 0.36, 0.,   0.2,  0.2,  0.48, 0.48, 0.84, 0.64,
      0.64, 0.36, 0.36, 0.,   0.48, 0.48, 1.08, 1.08, 1.8,  1.32, 1.32, 0.72,
      0.72, 0.,   0.44, 0.44, 0.96, 0.96, 1.56, 1.12, 1.12, 0.6,  0.6,  0.,
      0.44, 0.44, 0.96, 0.96, 1.56, 1.12, 1.12, 0.6,  0.6,  0.,   0.28, 0.28,
      0.6,  0.6,  0.96, 0.68, 0.68, 0.36, 0.36, 0.,   0.28, 0.28, 0.6,  0.6,
      0.96, 0.68, 0.68, 0.36, 0.36, 0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.4,  0.4,  0.84, 0.84, 1.32, 0.92, 0.92, 0.48,
      0.48, 0.,   0.4,  0.4,  0.84, 0.84, 1.32, 0.92, 0.92, 0.48, 0.48, 0.,
      0.92, 0.92, 1.92, 1.92, 3.,   2.08, 2.08, 1.08, 1.08, 0.,   0.92, 0.92,
      1.92, 1.92, 3.,   2.08, 2.08, 1.08, 1.08, 0.,   1.56, 1.56, 3.24, 3.24,
      5.04, 3.48, 3.48, 1.8,  1.8,  0.,   1.16, 1.16, 2.4,  2.4,  3.72, 2.56,
      2.56, 1.32, 1.32, 0.,   1.16, 1.16, 2.4,  2.4,  3.72, 2.56, 2.56, 1.32,
      1.32, 0.,   0.64, 0.64, 1.32, 1.32, 2.04, 1.4,  1.4,  0.72, 0.72, 0.,
      0.64, 0.64, 1.32, 1.32, 2.04, 1.4,  1.4,  0.72, 0.72, 0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.76, 0.76, 1.56, 1.56,
      2.4,  1.64, 1.64, 0.84, 0.84, 0.,   0.76, 0.76, 1.56, 1.56, 2.4,  1.64,
      1.64, 0.84, 0.84, 0.,   1.64, 1.64, 3.36, 3.36, 5.16, 3.52, 3.52, 1.8,
      1.8,  0.,   1.64, 1.64, 3.36, 3.36, 5.16, 3.52, 3.52, 1.8,  1.8,  0.,
      2.64, 2.64, 5.4,  5.4,  8.28, 5.64, 5.64, 2.88, 2.88, 0.,   1.88, 1.88,
      3.84, 3.84, 5.88, 4.,   4.,   2.04, 2.04, 0.,   1.88, 1.88, 3.84, 3.84,
      5.88, 4.,   4.,   2.04, 2.04, 0.,   1.,   1.,   2.04, 2.04, 3.12, 2.12,
      2.12, 1.08, 1.08, 0.,   1.,   1.,   2.04, 2.04, 3.12, 2.12, 2.12, 1.08,
      1.08, 0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
  };
  const std::array<int, 4> in_shape = {{3, 10, 10, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME3x10x10x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.0625,
                                         0.125,
                                         0.2125,
                                         0.325,
                                         0.2125,
                                         0.325,
                                         0.4625,
                                         0.625,
                                         0.4,
                                         0.5,
                                         0.75,
                                         0.9,
                                         0.6,
                                         0.7,
                                         1.35,
                                         1.5333333333,
                                         1.1,
                                         1.2333333333,
                                         1.1,
                                         1.2333333333,
                                         0.6125,
                                         0.725,
                                         1.2825,
                                         1.485,
                                         1.2825,
                                         1.485,
                                         2.1325,
                                         2.425,
                                         1.52,
                                         1.7,
                                         2.55,
                                         2.82,
                                         1.88,
                                         2.06,
                                         3.8966666667,
                                         4.2266666667,
                                         3.0466666667,
                                         3.2866666667,
                                         3.0466666667,
                                         3.2866666667,
                                         0.6125,
                                         0.725,
                                         1.2825,
                                         1.485,
                                         1.2825,
                                         1.485,
                                         2.1325,
                                         2.425,
                                         1.52,
                                         1.7,
                                         2.55,
                                         2.82,
                                         1.88,
                                         2.06,
                                         3.8966666667,
                                         4.2266666667,
                                         3.0466666667,
                                         3.2866666667,
                                         3.0466666667,
                                         3.2866666667,
                                         1.6625,
                                         1.825,
                                         3.2525,
                                         3.545,
                                         3.2525,
                                         3.545,
                                         5.1025,
                                         5.525,
                                         3.44,
                                         3.7,
                                         5.55,
                                         5.94,
                                         3.96,
                                         4.22,
                                         7.91,
                                         8.3866666667,
                                         6.06,
                                         6.4066666667,
                                         6.06,
                                         6.4066666667,
                                         1.6,
                                         1.7,
                                         3.04,
                                         3.22,
                                         3.04,
                                         3.22,
                                         4.64,
                                         4.9,
                                         3.04,
                                         3.2,
                                         4.8,
                                         5.04,
                                         3.36,
                                         3.52,
                                         6.56,
                                         6.8533333333,
                                         4.96,
                                         5.1733333333,
                                         4.96,
                                         5.1733333333,
                                         3.15,
                                         3.3,
                                         5.91,
                                         6.18,
                                         5.91,
                                         6.18,
                                         8.91,
                                         9.3,
                                         5.76,
                                         6.,
                                         9.,
                                         9.36,
                                         6.24,
                                         6.48,
                                         12.04,
                                         12.48,
                                         9.04,
                                         9.36,
                                         9.04,
                                         9.36,
                                         2.6,
                                         2.7,
                                         4.84,
                                         5.02,
                                         4.84,
                                         5.02,
                                         7.24,
                                         7.5,
                                         4.64,
                                         4.8,
                                         7.2,
                                         7.44,
                                         4.96,
                                         5.12,
                                         9.4933333333,
                                         9.7866666667,
                                         7.0933333333,
                                         7.3066666667,
                                         7.0933333333,
                                         7.3066666667,
                                         6.0166666667,
                                         6.2,
                                         11.1233333333,
                                         11.4533333333,
                                         11.1233333333,
                                         11.4533333333,
                                         16.5233333333,
                                         17.,
                                         10.5066666667,
                                         10.8,
                                         16.2,
                                         16.64,
                                         11.0933333333,
                                         11.3866666667,
                                         21.0711111111,
                                         21.6088888889,
                                         15.6711111111,
                                         16.0622222222,
                                         15.6711111111,
                                         16.0622222222,
                                         4.9666666667,
                                         5.1,
                                         9.1533333333,
                                         9.3933333333,
                                         9.1533333333,
                                         9.3933333333,
                                         13.5533333333,
                                         13.9,
                                         8.5866666667,
                                         8.8,
                                         13.2,
                                         13.52,
                                         9.0133333333,
                                         9.2266666667,
                                         17.0577777778,
                                         17.4488888889,
                                         12.6577777778,
                                         12.9422222222,
                                         12.6577777778,
                                         12.9422222222,
                                         4.9666666667,
                                         5.1,
                                         9.1533333333,
                                         9.3933333333,
                                         9.1533333333,
                                         9.3933333333,
                                         13.5533333333,
                                         13.9,
                                         8.5866666667,
                                         8.8,
                                         13.2,
                                         13.52,
                                         9.0133333333,
                                         9.2266666667,
                                         17.0577777778,
                                         17.4488888889,
                                         12.6577777778,
                                         12.9422222222,
                                         12.6577777778,
                                         12.9422222222,
                                         3.1875,
                                         3.25,
                                         5.8375,
                                         5.95,
                                         5.8375,
                                         5.95,
                                         8.5875,
                                         8.75,
                                         5.4,
                                         5.5,
                                         8.25,
                                         8.4,
                                         5.6,
                                         5.7,
                                         10.5166666667,
                                         10.7,
                                         7.7666666667,
                                         7.9,
                                         7.7666666667,
                                         7.9,
                                         6.2375,
                                         6.35,
                                         11.4075,
                                         11.61,
                                         11.4075,
                                         11.61,
                                         16.7575,
                                         17.05,
                                         10.52,
                                         10.7,
                                         16.05,
                                         16.32,
                                         10.88,
                                         11.06,
                                         20.3966666667,
                                         20.7266666667,
                                         15.0466666667,
                                         15.2866666667,
                                         15.0466666667,
                                         15.2866666667,
                                         6.2375,
                                         6.35,
                                         11.4075,
                                         11.61,
                                         11.4075,
                                         11.61,
                                         16.7575,
                                         17.05,
                                         10.52,
                                         10.7,
                                         16.05,
                                         16.32,
                                         10.88,
                                         11.06,
                                         20.3966666667,
                                         20.7266666667,
                                         15.0466666667,
                                         15.2866666667,
                                         15.0466666667,
                                         15.2866666667,
                                         9.7875,
                                         9.95,
                                         17.8775,
                                         18.17,
                                         17.8775,
                                         18.17,
                                         26.2275,
                                         26.65,
                                         16.44,
                                         16.7,
                                         25.05,
                                         25.44,
                                         16.96,
                                         17.22,
                                         31.7433333333,
                                         32.22,
                                         23.3933333333,
                                         23.74,
                                         23.3933333333,
                                         23.74,
                                         6.6,
                                         6.7,
                                         12.04,
                                         12.22,
                                         12.04,
                                         12.22,
                                         17.64,
                                         17.9,
                                         11.04,
                                         11.2,
                                         16.8,
                                         17.04,
                                         11.36,
                                         11.52,
                                         21.2266666667,
                                         21.52,
                                         15.6266666667,
                                         15.84,
                                         15.6266666667,
                                         15.84,
                                         10.65,
                                         10.8,
                                         19.41,
                                         19.68,
                                         19.41,
                                         19.68,
                                         28.41,
                                         28.8,
                                         17.76,
                                         18.,
                                         27.,
                                         27.36,
                                         18.24,
                                         18.48,
                                         34.04,
                                         34.48,
                                         25.04,
                                         25.36,
                                         25.04,
                                         25.36,
                                         7.6,
                                         7.7,
                                         13.84,
                                         14.02,
                                         13.84,
                                         14.02,
                                         20.24,
                                         20.5,
                                         12.64,
                                         12.8,
                                         19.2,
                                         19.44,
                                         12.96,
                                         13.12,
                                         24.16,
                                         24.4533333333,
                                         17.76,
                                         17.9733333333,
                                         17.76,
                                         17.9733333333,
                                         15.1833333333,
                                         15.3666666667,
                                         27.6233333333,
                                         27.9533333333,
                                         27.6233333333,
                                         27.9533333333,
                                         40.3566666667,
                                         40.8333333333,
                                         25.1733333333,
                                         25.4666666667,
                                         38.2,
                                         38.64,
                                         25.76,
                                         26.0533333333,
                                         47.96,
                                         48.4977777778,
                                         35.2266666667,
                                         35.6177777778,
                                         35.2266666667,
                                         35.6177777778,
                                         11.6333333333,
                                         11.7666666667,
                                         21.1533333333,
                                         21.3933333333,
                                         21.1533333333,
                                         21.3933333333,
                                         30.8866666667,
                                         31.2333333333,
                                         19.2533333333,
                                         19.4666666667,
                                         29.2,
                                         29.52,
                                         19.68,
                                         19.8933333333,
                                         36.6133333333,
                                         37.0044444444,
                                         26.88,
                                         27.1644444444,
                                         26.88,
                                         27.1644444444,
                                         11.6333333333,
                                         11.7666666667,
                                         21.1533333333,
                                         21.3933333333,
                                         21.1533333333,
                                         21.3933333333,
                                         30.8866666667,
                                         31.2333333333,
                                         19.2533333333,
                                         19.4666666667,
                                         29.2,
                                         29.52,
                                         19.68,
                                         19.8933333333,
                                         36.6133333333,
                                         37.0044444444,
                                         26.88,
                                         27.1644444444,
                                         26.88,
                                         27.1644444444,
                                         6.3125,
                                         6.375,
                                         11.4625,
                                         11.575,
                                         11.4625,
                                         11.575,
                                         16.7125,
                                         16.875,
                                         10.4,
                                         10.5,
                                         15.75,
                                         15.9,
                                         10.6,
                                         10.7,
                                         19.6833333333,
                                         19.8666666667,
                                         14.4333333333,
                                         14.5666666667,
                                         14.4333333333,
                                         14.5666666667,
                                         11.8625,
                                         11.975,
                                         21.5325,
                                         21.735,
                                         21.5325,
                                         21.735,
                                         31.3825,
                                         31.675,
                                         19.52,
                                         19.7,
                                         29.55,
                                         29.82,
                                         19.88,
                                         20.06,
                                         36.8966666667,
                                         37.2266666667,
                                         27.0466666667,
                                         27.2866666667,
                                         27.0466666667,
                                         27.2866666667,
                                         11.8625,
                                         11.975,
                                         21.5325,
                                         21.735,
                                         21.5325,
                                         21.735,
                                         31.3825,
                                         31.675,
                                         19.52,
                                         19.7,
                                         29.55,
                                         29.82,
                                         19.88,
                                         20.06,
                                         36.8966666667,
                                         37.2266666667,
                                         27.0466666667,
                                         27.2866666667,
                                         27.0466666667,
                                         27.2866666667,
                                         17.9125,
                                         18.075,
                                         32.5025,
                                         32.795,
                                         32.5025,
                                         32.795,
                                         47.3525,
                                         47.775,
                                         29.44,
                                         29.7,
                                         44.55,
                                         44.94,
                                         29.96,
                                         30.22,
                                         55.5766666667,
                                         56.0533333333,
                                         40.7266666667,
                                         41.0733333333,
                                         40.7266666667,
                                         41.0733333333,
                                         11.6,
                                         11.7,
                                         21.04,
                                         21.22,
                                         21.04,
                                         21.22,
                                         30.64,
                                         30.9,
                                         19.04,
                                         19.2,
                                         28.8,
                                         29.04,
                                         19.36,
                                         19.52,
                                         35.8933333333,
                                         36.1866666667,
                                         26.2933333333,
                                         26.5066666667,
                                         26.2933333333,
                                         26.5066666667,
                                         18.15,
                                         18.3,
                                         32.91,
                                         33.18,
                                         32.91,
                                         33.18,
                                         47.91,
                                         48.3,
                                         29.76,
                                         30.,
                                         45.,
                                         45.36,
                                         30.24,
                                         30.48,
                                         56.04,
                                         56.48,
                                         41.04,
                                         41.36,
                                         41.04,
                                         41.36,
                                         12.6,
                                         12.7,
                                         22.84,
                                         23.02,
                                         22.84,
                                         23.02,
                                         33.24,
                                         33.5,
                                         20.64,
                                         20.8,
                                         31.2,
                                         31.44,
                                         20.96,
                                         21.12,
                                         38.8266666667,
                                         39.12,
                                         28.4266666667,
                                         28.64,
                                         28.4266666667,
                                         28.64,
                                         24.35,
                                         24.5333333333,
                                         44.1233333333,
                                         44.4533333333,
                                         44.1233333333,
                                         44.4533333333,
                                         64.19,
                                         64.6666666667,
                                         39.84,
                                         40.1333333333,
                                         60.2,
                                         60.64,
                                         40.4266666667,
                                         40.72,
                                         74.8488888889,
                                         75.3866666667,
                                         54.7822222222,
                                         55.1733333333,
                                         54.7822222222,
                                         55.1733333333,
                                         18.3,
                                         18.4333333333,
                                         33.1533333333,
                                         33.3933333333,
                                         33.1533333333,
                                         33.3933333333,
                                         48.22,
                                         48.5666666667,
                                         29.92,
                                         30.1333333333,
                                         45.2,
                                         45.52,
                                         30.3466666667,
                                         30.56,
                                         56.1688888889,
                                         56.56,
                                         41.1022222222,
                                         41.3866666667,
                                         41.1022222222,
                                         41.3866666667,
                                         18.3,
                                         18.4333333333,
                                         33.1533333333,
                                         33.3933333333,
                                         33.1533333333,
                                         33.3933333333,
                                         48.22,
                                         48.5666666667,
                                         29.92,
                                         30.1333333333,
                                         45.2,
                                         45.52,
                                         30.3466666667,
                                         30.56,
                                         56.1688888889,
                                         56.56,
                                         41.1022222222,
                                         41.3866666667,
                                         41.1022222222,
                                         41.3866666667};
  const std::array<int, 4> in_shape = {{3, 10, 10, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID3x10x10x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.04,  0.08,  0.04,  0.08,  0.16, 0.24,  0.16,  0.24,  0.36,  0.48,  0.32,
      0.4,   0.32,  0.4,   0.2,   0.24, 0.2,   0.24,  0.,    0.,    0.04,  0.08,
      0.04,  0.08,  0.16,  0.24,  0.16, 0.24,  0.36,  0.48,  0.32,  0.4,   0.32,
      0.4,   0.2,   0.24,  0.2,   0.24, 0.,    0.,    0.32,  0.4,   0.32,  0.4,
      0.8,   0.96,  0.8,   0.96,  1.44, 1.68,  1.12,  1.28,  1.12,  1.28,  0.64,
      0.72,  0.64,  0.72,  0.,    0.,   0.32,  0.4,   0.32,  0.4,   0.8,   0.96,
      0.8,   0.96,  1.44,  1.68,  1.12, 1.28,  1.12,  1.28,  0.64,  0.72,  0.64,
      0.72,  0.,    0.,    0.84,  0.96, 0.84,  0.96,  1.92,  2.16,  1.92,  2.16,
      3.24,  3.6,   2.4,   2.64,  2.4,  2.64,  1.32,  1.44,  1.32,  1.44,  0.,
      0.,    0.8,   0.88,  0.8,   0.88, 1.76,  1.92,  1.76,  1.92,  2.88,  3.12,
      2.08,  2.24,  2.08,  2.24,  1.12, 1.2,   1.12,  1.2,   0.,    0.,    0.8,
      0.88,  0.8,   0.88,  1.76,  1.92, 1.76,  1.92,  2.88,  3.12,  2.08,  2.24,
      2.08,  2.24,  1.12,  1.2,   1.12, 1.2,   0.,    0.,    0.52,  0.56,  0.52,
      0.56,  1.12,  1.2,   1.12,  1.2,  1.8,   1.92,  1.28,  1.36,  1.28,  1.36,
      0.68,  0.72,  0.68,  0.72,  0.,   0.,    0.52,  0.56,  0.52,  0.56,  1.12,
      1.2,   1.12,  1.2,   1.8,   1.92, 1.28,  1.36,  1.28,  1.36,  0.68,  0.72,
      0.68,  0.72,  0.,    0.,    0.,   0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,   0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.76,  0.8,   0.76, 0.8,   1.6,   1.68,  1.6,   1.68,  2.52,
      2.64,  1.76,  1.84,  1.76,  1.84, 0.92,  0.96,  0.92,  0.96,  0.,    0.,
      0.76,  0.8,   0.76,  0.8,   1.6,  1.68,  1.6,   1.68,  2.52,  2.64,  1.76,
      1.84,  1.76,  1.84,  0.92,  0.96, 0.92,  0.96,  0.,    0.,    1.76,  1.84,
      1.76,  1.84,  3.68,  3.84,  3.68, 3.84,  5.76,  6.,    4.,    4.16,  4.,
      4.16,  2.08,  2.16,  2.08,  2.16, 0.,    0.,    1.76,  1.84,  1.76,  1.84,
      3.68,  3.84,  3.68,  3.84,  5.76, 6.,    4.,    4.16,  4.,    4.16,  2.08,
      2.16,  2.08,  2.16,  0.,    0.,   3.,    3.12,  3.,    3.12,  6.24,  6.48,
      6.24,  6.48,  9.72,  10.08, 6.72, 6.96,  6.72,  6.96,  3.48,  3.6,   3.48,
      3.6,   0.,    0.,    2.24,  2.32, 2.24,  2.32,  4.64,  4.8,   4.64,  4.8,
      7.2,   7.44,  4.96,  5.12,  4.96, 5.12,  2.56,  2.64,  2.56,  2.64,  0.,
      0.,    2.24,  2.32,  2.24,  2.32, 4.64,  4.8,   4.64,  4.8,   7.2,   7.44,
      4.96,  5.12,  4.96,  5.12,  2.56, 2.64,  2.56,  2.64,  0.,    0.,    1.24,
      1.28,  1.24,  1.28,  2.56,  2.64, 2.56,  2.64,  3.96,  4.08,  2.72,  2.8,
      2.72,  2.8,   1.4,   1.44,  1.4,  1.44,  0.,    0.,    1.24,  1.28,  1.24,
      1.28,  2.56,  2.64,  2.56,  2.64, 3.96,  4.08,  2.72,  2.8,   2.72,  2.8,
      1.4,   1.44,  1.4,   1.44,  0.,   0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,   0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    1.48, 1.52,  1.48,  1.52,  3.04,  3.12,  3.04,
      3.12,  4.68,  4.8,   3.2,   3.28, 3.2,   3.28,  1.64,  1.68,  1.64,  1.68,
      0.,    0.,    1.48,  1.52,  1.48, 1.52,  3.04,  3.12,  3.04,  3.12,  4.68,
      4.8,   3.2,   3.28,  3.2,   3.28, 1.64,  1.68,  1.64,  1.68,  0.,    0.,
      3.2,   3.28,  3.2,   3.28,  6.56, 6.72,  6.56,  6.72,  10.08, 10.32, 6.88,
      7.04,  6.88,  7.04,  3.52,  3.6,  3.52,  3.6,   0.,    0.,    3.2,   3.28,
      3.2,   3.28,  6.56,  6.72,  6.56, 6.72,  10.08, 10.32, 6.88,  7.04,  6.88,
      7.04,  3.52,  3.6,   3.52,  3.6,  0.,    0.,    5.16,  5.28,  5.16,  5.28,
      10.56, 10.8,  10.56, 10.8,  16.2, 16.56, 11.04, 11.28, 11.04, 11.28, 5.64,
      5.76,  5.64,  5.76,  0.,    0.,   3.68,  3.76,  3.68,  3.76,  7.52,  7.68,
      7.52,  7.68,  11.52, 11.76, 7.84, 8.,    7.84,  8.,    4.,    4.08,  4.,
      4.08,  0.,    0.,    3.68,  3.76, 3.68,  3.76,  7.52,  7.68,  7.52,  7.68,
      11.52, 11.76, 7.84,  8.,    7.84, 8.,    4.,    4.08,  4.,    4.08,  0.,
      0.,    1.96,  2.,    1.96,  2.,   4.,    4.08,  4.,    4.08,  6.12,  6.24,
      4.16,  4.24,  4.16,  4.24,  2.12, 2.16,  2.12,  2.16,  0.,    0.,    1.96,
      2.,    1.96,  2.,    4.,    4.08, 4.,    4.08,  6.12,  6.24,  4.16,  4.24,
      4.16,  4.24,  2.12,  2.16,  2.12, 2.16,  0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,   0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,   0.,
  };
  const std::array<int, 4> in_shape = {{3, 10, 10, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME3x10x10x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.0625,
                                         0.125,
                                         0.1875,
                                         0.25,
                                         0.3125,
                                         0.425,
                                         0.5375,
                                         0.65,
                                         0.3125,
                                         0.425,
                                         0.5375,
                                         0.65,
                                         0.7625,
                                         0.925,
                                         1.0875,
                                         1.25,
                                         0.7,
                                         0.8,
                                         0.9,
                                         1.,
                                         1.35,
                                         1.5,
                                         1.65,
                                         1.8,
                                         1.1,
                                         1.2,
                                         1.3,
                                         1.4,
                                         2.5166666667,
                                         2.7,
                                         2.8833333333,
                                         3.0666666667,
                                         2.0666666667,
                                         2.2,
                                         2.3333333333,
                                         2.4666666667,
                                         2.0666666667,
                                         2.2,
                                         2.3333333333,
                                         2.4666666667,
                                         1.1125,
                                         1.225,
                                         1.3375,
                                         1.45,
                                         2.3625,
                                         2.565,
                                         2.7675,
                                         2.97,
                                         2.3625,
                                         2.565,
                                         2.7675,
                                         2.97,
                                         3.9725,
                                         4.265,
                                         4.5575,
                                         4.85,
                                         2.86,
                                         3.04,
                                         3.22,
                                         3.4,
                                         4.83,
                                         5.1,
                                         5.37,
                                         5.64,
                                         3.58,
                                         3.76,
                                         3.94,
                                         4.12,
                                         7.4633333333,
                                         7.7933333333,
                                         8.1233333333,
                                         8.4533333333,
                                         5.8533333333,
                                         6.0933333333,
                                         6.3333333333,
                                         6.5733333333,
                                         5.8533333333,
                                         6.0933333333,
                                         6.3333333333,
                                         6.5733333333,
                                         1.1125,
                                         1.225,
                                         1.3375,
                                         1.45,
                                         2.3625,
                                         2.565,
                                         2.7675,
                                         2.97,
                                         2.3625,
                                         2.565,
                                         2.7675,
                                         2.97,
                                         3.9725,
                                         4.265,
                                         4.5575,
                                         4.85,
                                         2.86,
                                         3.04,
                                         3.22,
                                         3.4,
                                         4.83,
                                         5.1,
                                         5.37,
                                         5.64,
                                         3.58,
                                         3.76,
                                         3.94,
                                         4.12,
                                         7.4633333333,
                                         7.7933333333,
                                         8.1233333333,
                                         8.4533333333,
                                         5.8533333333,
                                         6.0933333333,
                                         6.3333333333,
                                         6.5733333333,
                                         5.8533333333,
                                         6.0933333333,
                                         6.3333333333,
                                         6.5733333333,
                                         3.1625,
                                         3.325,
                                         3.4875,
                                         3.65,
                                         6.2125,
                                         6.505,
                                         6.7975,
                                         7.09,
                                         6.2125,
                                         6.505,
                                         6.7975,
                                         7.09,
                                         9.7825,
                                         10.205,
                                         10.6275,
                                         11.05,
                                         6.62,
                                         6.88,
                                         7.14,
                                         7.4,
                                         10.71,
                                         11.1,
                                         11.49,
                                         11.88,
                                         7.66,
                                         7.92,
                                         8.18,
                                         8.44,
                                         15.3433333333,
                                         15.82,
                                         16.2966666667,
                                         16.7733333333,
                                         11.7733333333,
                                         12.12,
                                         12.4666666667,
                                         12.8133333333,
                                         11.7733333333,
                                         12.12,
                                         12.4666666667,
                                         12.8133333333,
                                         3.1,
                                         3.2,
                                         3.3,
                                         3.4,
                                         5.9,
                                         6.08,
                                         6.26,
                                         6.44,
                                         5.9,
                                         6.08,
                                         6.26,
                                         6.44,
                                         9.02,
                                         9.28,
                                         9.54,
                                         9.8,
                                         5.92,
                                         6.08,
                                         6.24,
                                         6.4,
                                         9.36,
                                         9.6,
                                         9.84,
                                         10.08,
                                         6.56,
                                         6.72,
                                         6.88,
                                         7.04,
                                         12.8266666667,
                                         13.12,
                                         13.4133333333,
                                         13.7066666667,
                                         9.7066666667,
                                         9.92,
                                         10.1333333333,
                                         10.3466666667,
                                         9.7066666667,
                                         9.92,
                                         10.1333333333,
                                         10.3466666667,
                                         6.15,
                                         6.3,
                                         6.45,
                                         6.6,
                                         11.55,
                                         11.82,
                                         12.09,
                                         12.36,
                                         11.55,
                                         11.82,
                                         12.09,
                                         12.36,
                                         17.43,
                                         17.82,
                                         18.21,
                                         18.6,
                                         11.28,
                                         11.52,
                                         11.76,
                                         12.,
                                         17.64,
                                         18.,
                                         18.36,
                                         18.72,
                                         12.24,
                                         12.48,
                                         12.72,
                                         12.96,
                                         23.64,
                                         24.08,
                                         24.52,
                                         24.96,
                                         17.76,
                                         18.08,
                                         18.4,
                                         18.72,
                                         17.76,
                                         18.08,
                                         18.4,
                                         18.72,
                                         5.1,
                                         5.2,
                                         5.3,
                                         5.4,
                                         9.5,
                                         9.68,
                                         9.86,
                                         10.04,
                                         9.5,
                                         9.68,
                                         9.86,
                                         10.04,
                                         14.22,
                                         14.48,
                                         14.74,
                                         15.,
                                         9.12,
                                         9.28,
                                         9.44,
                                         9.6,
                                         14.16,
                                         14.4,
                                         14.64,
                                         14.88,
                                         9.76,
                                         9.92,
                                         10.08,
                                         10.24,
                                         18.6933333333,
                                         18.9866666667,
                                         19.28,
                                         19.5733333333,
                                         13.9733333333,
                                         14.1866666667,
                                         14.4,
                                         14.6133333333,
                                         13.9733333333,
                                         14.1866666667,
                                         14.4,
                                         14.6133333333,
                                         11.85,
                                         12.0333333333,
                                         12.2166666667,
                                         12.4,
                                         21.9166666667,
                                         22.2466666667,
                                         22.5766666667,
                                         22.9066666667,
                                         21.9166666667,
                                         22.2466666667,
                                         22.5766666667,
                                         22.9066666667,
                                         32.57,
                                         33.0466666667,
                                         33.5233333333,
                                         34.,
                                         20.72,
                                         21.0133333333,
                                         21.3066666667,
                                         21.6,
                                         31.96,
                                         32.4,
                                         32.84,
                                         33.28,
                                         21.8933333333,
                                         22.1866666667,
                                         22.48,
                                         22.7733333333,
                                         41.6044444444,
                                         42.1422222222,
                                         42.68,
                                         43.2177777778,
                                         30.9511111111,
                                         31.3422222222,
                                         31.7333333333,
                                         32.1244444444,
                                         30.9511111111,
                                         31.3422222222,
                                         31.7333333333,
                                         32.1244444444,
                                         9.8,
                                         9.9333333333,
                                         10.0666666667,
                                         10.2,
                                         18.0666666667,
                                         18.3066666667,
                                         18.5466666667,
                                         18.7866666667,
                                         18.0666666667,
                                         18.3066666667,
                                         18.5466666667,
                                         18.7866666667,
                                         26.76,
                                         27.1066666667,
                                         27.4533333333,
                                         27.8,
                                         16.96,
                                         17.1733333333,
                                         17.3866666667,
                                         17.6,
                                         26.08,
                                         26.4,
                                         26.72,
                                         27.04,
                                         17.8133333333,
                                         18.0266666667,
                                         18.24,
                                         18.4533333333,
                                         33.7244444444,
                                         34.1155555556,
                                         34.5066666667,
                                         34.8977777778,
                                         25.0311111111,
                                         25.3155555556,
                                         25.6,
                                         25.8844444444,
                                         25.0311111111,
                                         25.3155555556,
                                         25.6,
                                         25.8844444444,
                                         9.8,
                                         9.9333333333,
                                         10.0666666667,
                                         10.2,
                                         18.0666666667,
                                         18.3066666667,
                                         18.5466666667,
                                         18.7866666667,
                                         18.0666666667,
                                         18.3066666667,
                                         18.5466666667,
                                         18.7866666667,
                                         26.76,
                                         27.1066666667,
                                         27.4533333333,
                                         27.8,
                                         16.96,
                                         17.1733333333,
                                         17.3866666667,
                                         17.6,
                                         26.08,
                                         26.4,
                                         26.72,
                                         27.04,
                                         17.8133333333,
                                         18.0266666667,
                                         18.24,
                                         18.4533333333,
                                         33.7244444444,
                                         34.1155555556,
                                         34.5066666667,
                                         34.8977777778,
                                         25.0311111111,
                                         25.3155555556,
                                         25.6,
                                         25.8844444444,
                                         25.0311111111,
                                         25.3155555556,
                                         25.6,
                                         25.8844444444,
                                         6.3125,
                                         6.375,
                                         6.4375,
                                         6.5,
                                         11.5625,
                                         11.675,
                                         11.7875,
                                         11.9,
                                         11.5625,
                                         11.675,
                                         11.7875,
                                         11.9,
                                         17.0125,
                                         17.175,
                                         17.3375,
                                         17.5,
                                         10.7,
                                         10.8,
                                         10.9,
                                         11.,
                                         16.35,
                                         16.5,
                                         16.65,
                                         16.8,
                                         11.1,
                                         11.2,
                                         11.3,
                                         11.4,
                                         20.85,
                                         21.0333333333,
                                         21.2166666667,
                                         21.4,
                                         15.4,
                                         15.5333333333,
                                         15.6666666667,
                                         15.8,
                                         15.4,
                                         15.5333333333,
                                         15.6666666667,
                                         15.8,
                                         12.3625,
                                         12.475,
                                         12.5875,
                                         12.7,
                                         22.6125,
                                         22.815,
                                         23.0175,
                                         23.22,
                                         22.6125,
                                         22.815,
                                         23.0175,
                                         23.22,
                                         33.2225,
                                         33.515,
                                         33.8075,
                                         34.1,
                                         20.86,
                                         21.04,
                                         21.22,
                                         21.4,
                                         31.83,
                                         32.1,
                                         32.37,
                                         32.64,
                                         21.58,
                                         21.76,
                                         21.94,
                                         22.12,
                                         40.4633333333,
                                         40.7933333333,
                                         41.1233333333,
                                         41.4533333333,
                                         29.8533333333,
                                         30.0933333333,
                                         30.3333333333,
                                         30.5733333333,
                                         29.8533333333,
                                         30.0933333333,
                                         30.3333333333,
                                         30.5733333333,
                                         12.3625,
                                         12.475,
                                         12.5875,
                                         12.7,
                                         22.6125,
                                         22.815,
                                         23.0175,
                                         23.22,
                                         22.6125,
                                         22.815,
                                         23.0175,
                                         23.22,
                                         33.2225,
                                         33.515,
                                         33.8075,
                                         34.1,
                                         20.86,
                                         21.04,
                                         21.22,
                                         21.4,
                                         31.83,
                                         32.1,
                                         32.37,
                                         32.64,
                                         21.58,
                                         21.76,
                                         21.94,
                                         22.12,
                                         40.4633333333,
                                         40.7933333333,
                                         41.1233333333,
                                         41.4533333333,
                                         29.8533333333,
                                         30.0933333333,
                                         30.3333333333,
                                         30.5733333333,
                                         29.8533333333,
                                         30.0933333333,
                                         30.3333333333,
                                         30.5733333333,
                                         19.4125,
                                         19.575,
                                         19.7375,
                                         19.9,
                                         35.4625,
                                         35.755,
                                         36.0475,
                                         36.34,
                                         35.4625,
                                         35.755,
                                         36.0475,
                                         36.34,
                                         52.0325,
                                         52.455,
                                         52.8775,
                                         53.3,
                                         32.62,
                                         32.88,
                                         33.14,
                                         33.4,
                                         49.71,
                                         50.1,
                                         50.49,
                                         50.88,
                                         33.66,
                                         33.92,
                                         34.18,
                                         34.44,
                                         63.01,
                                         63.4866666667,
                                         63.9633333333,
                                         64.44,
                                         46.44,
                                         46.7866666667,
                                         47.1333333333,
                                         47.48,
                                         46.44,
                                         46.7866666667,
                                         47.1333333333,
                                         47.48,
                                         13.1,
                                         13.2,
                                         13.3,
                                         13.4,
                                         23.9,
                                         24.08,
                                         24.26,
                                         24.44,
                                         23.9,
                                         24.08,
                                         24.26,
                                         24.44,
                                         35.02,
                                         35.28,
                                         35.54,
                                         35.8,
                                         21.92,
                                         22.08,
                                         22.24,
                                         22.4,
                                         33.36,
                                         33.6,
                                         33.84,
                                         34.08,
                                         22.56,
                                         22.72,
                                         22.88,
                                         23.04,
                                         42.16,
                                         42.4533333333,
                                         42.7466666667,
                                         43.04,
                                         31.04,
                                         31.2533333333,
                                         31.4666666667,
                                         31.68,
                                         31.04,
                                         31.2533333333,
                                         31.4666666667,
                                         31.68,
                                         21.15,
                                         21.3,
                                         21.45,
                                         21.6,
                                         38.55,
                                         38.82,
                                         39.09,
                                         39.36,
                                         38.55,
                                         38.82,
                                         39.09,
                                         39.36,
                                         56.43,
                                         56.82,
                                         57.21,
                                         57.6,
                                         35.28,
                                         35.52,
                                         35.76,
                                         36.,
                                         53.64,
                                         54.,
                                         54.36,
                                         54.72,
                                         36.24,
                                         36.48,
                                         36.72,
                                         36.96,
                                         67.64,
                                         68.08,
                                         68.52,
                                         68.96,
                                         49.76,
                                         50.08,
                                         50.4,
                                         50.72,
                                         49.76,
                                         50.08,
                                         50.4,
                                         50.72,
                                         15.1,
                                         15.2,
                                         15.3,
                                         15.4,
                                         27.5,
                                         27.68,
                                         27.86,
                                         28.04,
                                         27.5,
                                         27.68,
                                         27.86,
                                         28.04,
                                         40.22,
                                         40.48,
                                         40.74,
                                         41.,
                                         25.12,
                                         25.28,
                                         25.44,
                                         25.6,
                                         38.16,
                                         38.4,
                                         38.64,
                                         38.88,
                                         25.76,
                                         25.92,
                                         26.08,
                                         26.24,
                                         48.0266666667,
                                         48.32,
                                         48.6133333333,
                                         48.9066666667,
                                         35.3066666667,
                                         35.52,
                                         35.7333333333,
                                         35.9466666667,
                                         35.3066666667,
                                         35.52,
                                         35.7333333333,
                                         35.9466666667,
                                         30.1833333333,
                                         30.3666666667,
                                         30.55,
                                         30.7333333333,
                                         54.9166666667,
                                         55.2466666667,
                                         55.5766666667,
                                         55.9066666667,
                                         54.9166666667,
                                         55.2466666667,
                                         55.5766666667,
                                         55.9066666667,
                                         80.2366666667,
                                         80.7133333333,
                                         81.19,
                                         81.6666666667,
                                         50.0533333333,
                                         50.3466666667,
                                         50.64,
                                         50.9333333333,
                                         75.96,
                                         76.4,
                                         76.84,
                                         77.28,
                                         51.2266666667,
                                         51.52,
                                         51.8133333333,
                                         52.1066666667,
                                         95.3822222222,
                                         95.92,
                                         96.4577777778,
                                         96.9955555556,
                                         70.0622222222,
                                         70.4533333333,
                                         70.8444444444,
                                         71.2355555556,
                                         70.0622222222,
                                         70.4533333333,
                                         70.8444444444,
                                         71.2355555556,
                                         23.1333333333,
                                         23.2666666667,
                                         23.4,
                                         23.5333333333,
                                         42.0666666667,
                                         42.3066666667,
                                         42.5466666667,
                                         42.7866666667,
                                         42.0666666667,
                                         42.3066666667,
                                         42.5466666667,
                                         42.7866666667,
                                         61.4266666667,
                                         61.7733333333,
                                         62.12,
                                         62.4666666667,
                                         38.2933333333,
                                         38.5066666667,
                                         38.72,
                                         38.9333333333,
                                         58.08,
                                         58.4,
                                         58.72,
                                         59.04,
                                         39.1466666667,
                                         39.36,
                                         39.5733333333,
                                         39.7866666667,
                                         72.8355555556,
                                         73.2266666667,
                                         73.6177777778,
                                         74.0088888889,
                                         53.4755555556,
                                         53.76,
                                         54.0444444444,
                                         54.3288888889,
                                         53.4755555556,
                                         53.76,
                                         54.0444444444,
                                         54.3288888889,
                                         23.1333333333,
                                         23.2666666667,
                                         23.4,
                                         23.5333333333,
                                         42.0666666667,
                                         42.3066666667,
                                         42.5466666667,
                                         42.7866666667,
                                         42.0666666667,
                                         42.3066666667,
                                         42.5466666667,
                                         42.7866666667,
                                         61.4266666667,
                                         61.7733333333,
                                         62.12,
                                         62.4666666667,
                                         38.2933333333,
                                         38.5066666667,
                                         38.72,
                                         38.9333333333,
                                         58.08,
                                         58.4,
                                         58.72,
                                         59.04,
                                         39.1466666667,
                                         39.36,
                                         39.5733333333,
                                         39.7866666667,
                                         72.8355555556,
                                         73.2266666667,
                                         73.6177777778,
                                         74.0088888889,
                                         53.4755555556,
                                         53.76,
                                         54.0444444444,
                                         54.3288888889,
                                         53.4755555556,
                                         53.76,
                                         54.0444444444,
                                         54.3288888889,
                                         12.5625,
                                         12.625,
                                         12.6875,
                                         12.75,
                                         22.8125,
                                         22.925,
                                         23.0375,
                                         23.15,
                                         22.8125,
                                         22.925,
                                         23.0375,
                                         23.15,
                                         33.2625,
                                         33.425,
                                         33.5875,
                                         33.75,
                                         20.7,
                                         20.8,
                                         20.9,
                                         21.,
                                         31.35,
                                         31.5,
                                         31.65,
                                         31.8,
                                         21.1,
                                         21.2,
                                         21.3,
                                         21.4,
                                         39.1833333333,
                                         39.3666666667,
                                         39.55,
                                         39.7333333333,
                                         28.7333333333,
                                         28.8666666667,
                                         29.,
                                         29.1333333333,
                                         28.7333333333,
                                         28.8666666667,
                                         29.,
                                         29.1333333333,
                                         23.6125,
                                         23.725,
                                         23.8375,
                                         23.95,
                                         42.8625,
                                         43.065,
                                         43.2675,
                                         43.47,
                                         42.8625,
                                         43.065,
                                         43.2675,
                                         43.47,
                                         62.4725,
                                         62.765,
                                         63.0575,
                                         63.35,
                                         38.86,
                                         39.04,
                                         39.22,
                                         39.4,
                                         58.83,
                                         59.1,
                                         59.37,
                                         59.64,
                                         39.58,
                                         39.76,
                                         39.94,
                                         40.12,
                                         73.4633333333,
                                         73.7933333333,
                                         74.1233333333,
                                         74.4533333333,
                                         53.8533333333,
                                         54.0933333333,
                                         54.3333333333,
                                         54.5733333333,
                                         53.8533333333,
                                         54.0933333333,
                                         54.3333333333,
                                         54.5733333333,
                                         23.6125,
                                         23.725,
                                         23.8375,
                                         23.95,
                                         42.8625,
                                         43.065,
                                         43.2675,
                                         43.47,
                                         42.8625,
                                         43.065,
                                         43.2675,
                                         43.47,
                                         62.4725,
                                         62.765,
                                         63.0575,
                                         63.35,
                                         38.86,
                                         39.04,
                                         39.22,
                                         39.4,
                                         58.83,
                                         59.1,
                                         59.37,
                                         59.64,
                                         39.58,
                                         39.76,
                                         39.94,
                                         40.12,
                                         73.4633333333,
                                         73.7933333333,
                                         74.1233333333,
                                         74.4533333333,
                                         53.8533333333,
                                         54.0933333333,
                                         54.3333333333,
                                         54.5733333333,
                                         53.8533333333,
                                         54.0933333333,
                                         54.3333333333,
                                         54.5733333333,
                                         35.6625,
                                         35.825,
                                         35.9875,
                                         36.15,
                                         64.7125,
                                         65.005,
                                         65.2975,
                                         65.59,
                                         64.7125,
                                         65.005,
                                         65.2975,
                                         65.59,
                                         94.2825,
                                         94.705,
                                         95.1275,
                                         95.55,
                                         58.62,
                                         58.88,
                                         59.14,
                                         59.4,
                                         88.71,
                                         89.1,
                                         89.49,
                                         89.88,
                                         59.66,
                                         59.92,
                                         60.18,
                                         60.44,
                                         110.6766666667,
                                         111.1533333333,
                                         111.63,
                                         112.1066666667,
                                         81.1066666667,
                                         81.4533333333,
                                         81.8,
                                         82.1466666667,
                                         81.1066666667,
                                         81.4533333333,
                                         81.8,
                                         82.1466666667,
                                         23.1,
                                         23.2,
                                         23.3,
                                         23.4,
                                         41.9,
                                         42.08,
                                         42.26,
                                         42.44,
                                         41.9,
                                         42.08,
                                         42.26,
                                         42.44,
                                         61.02,
                                         61.28,
                                         61.54,
                                         61.8,
                                         37.92,
                                         38.08,
                                         38.24,
                                         38.4,
                                         57.36,
                                         57.6,
                                         57.84,
                                         58.08,
                                         38.56,
                                         38.72,
                                         38.88,
                                         39.04,
                                         71.4933333333,
                                         71.7866666667,
                                         72.08,
                                         72.3733333333,
                                         52.3733333333,
                                         52.5866666667,
                                         52.8,
                                         53.0133333333,
                                         52.3733333333,
                                         52.5866666667,
                                         52.8,
                                         53.0133333333,
                                         36.15,
                                         36.3,
                                         36.45,
                                         36.6,
                                         65.55,
                                         65.82,
                                         66.09,
                                         66.36,
                                         65.55,
                                         65.82,
                                         66.09,
                                         66.36,
                                         95.43,
                                         95.82,
                                         96.21,
                                         96.6,
                                         59.28,
                                         59.52,
                                         59.76,
                                         60.,
                                         89.64,
                                         90.,
                                         90.36,
                                         90.72,
                                         60.24,
                                         60.48,
                                         60.72,
                                         60.96,
                                         111.64,
                                         112.08,
                                         112.52,
                                         112.96,
                                         81.76,
                                         82.08,
                                         82.4,
                                         82.72,
                                         81.76,
                                         82.08,
                                         82.4,
                                         82.72,
                                         25.1,
                                         25.2,
                                         25.3,
                                         25.4,
                                         45.5,
                                         45.68,
                                         45.86,
                                         46.04,
                                         45.5,
                                         45.68,
                                         45.86,
                                         46.04,
                                         66.22,
                                         66.48,
                                         66.74,
                                         67.,
                                         41.12,
                                         41.28,
                                         41.44,
                                         41.6,
                                         62.16,
                                         62.4,
                                         62.64,
                                         62.88,
                                         41.76,
                                         41.92,
                                         42.08,
                                         42.24,
                                         77.36,
                                         77.6533333333,
                                         77.9466666667,
                                         78.24,
                                         56.64,
                                         56.8533333333,
                                         57.0666666667,
                                         57.28,
                                         56.64,
                                         56.8533333333,
                                         57.0666666667,
                                         57.28,
                                         48.5166666667,
                                         48.7,
                                         48.8833333333,
                                         49.0666666667,
                                         87.9166666667,
                                         88.2466666667,
                                         88.5766666667,
                                         88.9066666667,
                                         87.9166666667,
                                         88.2466666667,
                                         88.5766666667,
                                         88.9066666667,
                                         127.9033333333,
                                         128.38,
                                         128.8566666667,
                                         129.3333333333,
                                         79.3866666667,
                                         79.68,
                                         79.9733333333,
                                         80.2666666667,
                                         119.96,
                                         120.4,
                                         120.84,
                                         121.28,
                                         80.56,
                                         80.8533333333,
                                         81.1466666667,
                                         81.44,
                                         149.16,
                                         149.6977777778,
                                         150.2355555556,
                                         150.7733333333,
                                         109.1733333333,
                                         109.5644444444,
                                         109.9555555556,
                                         110.3466666667,
                                         109.1733333333,
                                         109.5644444444,
                                         109.9555555556,
                                         110.3466666667,
                                         36.4666666667,
                                         36.6,
                                         36.7333333333,
                                         36.8666666667,
                                         66.0666666667,
                                         66.3066666667,
                                         66.5466666667,
                                         66.7866666667,
                                         66.0666666667,
                                         66.3066666667,
                                         66.5466666667,
                                         66.7866666667,
                                         96.0933333333,
                                         96.44,
                                         96.7866666667,
                                         97.1333333333,
                                         59.6266666667,
                                         59.84,
                                         60.0533333333,
                                         60.2666666667,
                                         90.08,
                                         90.4,
                                         90.72,
                                         91.04,
                                         60.48,
                                         60.6933333333,
                                         60.9066666667,
                                         61.12,
                                         111.9466666667,
                                         112.3377777778,
                                         112.7288888889,
                                         113.12,
                                         81.92,
                                         82.2044444444,
                                         82.4888888889,
                                         82.7733333333,
                                         81.92,
                                         82.2044444444,
                                         82.4888888889,
                                         82.7733333333,
                                         36.4666666667,
                                         36.6,
                                         36.7333333333,
                                         36.8666666667,
                                         66.0666666667,
                                         66.3066666667,
                                         66.5466666667,
                                         66.7866666667,
                                         66.0666666667,
                                         66.3066666667,
                                         66.5466666667,
                                         66.7866666667,
                                         96.0933333333,
                                         96.44,
                                         96.7866666667,
                                         97.1333333333,
                                         59.6266666667,
                                         59.84,
                                         60.0533333333,
                                         60.2666666667,
                                         90.08,
                                         90.4,
                                         90.72,
                                         91.04,
                                         60.48,
                                         60.6933333333,
                                         60.9066666667,
                                         61.12,
                                         111.9466666667,
                                         112.3377777778,
                                         112.7288888889,
                                         113.12,
                                         81.92,
                                         82.2044444444,
                                         82.4888888889,
                                         82.7733333333,
                                         81.92,
                                         82.2044444444,
                                         82.4888888889,
                                         82.7733333333};
  const std::array<int, 4> in_shape = {{3, 10, 10, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID3x10x10x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.04,  0.08,  0.12,  0.16,  0.04,  0.08,  0.12,  0.16,  0.24,  0.32,
      0.4,   0.48,  0.24,  0.32,  0.4,   0.48,  0.6,   0.72,  0.84,  0.96,
      0.56,  0.64,  0.72,  0.8,   0.56,  0.64,  0.72,  0.8,   0.36,  0.4,
      0.44,  0.48,  0.36,  0.4,   0.44,  0.48,  0.,    0.,    0.,    0.,
      0.04,  0.08,  0.12,  0.16,  0.04,  0.08,  0.12,  0.16,  0.24,  0.32,
      0.4,   0.48,  0.24,  0.32,  0.4,   0.48,  0.6,   0.72,  0.84,  0.96,
      0.56,  0.64,  0.72,  0.8,   0.56,  0.64,  0.72,  0.8,   0.36,  0.4,
      0.44,  0.48,  0.36,  0.4,   0.44,  0.48,  0.,    0.,    0.,    0.,
      0.56,  0.64,  0.72,  0.8,   0.56,  0.64,  0.72,  0.8,   1.44,  1.6,
      1.76,  1.92,  1.44,  1.6,   1.76,  1.92,  2.64,  2.88,  3.12,  3.36,
      2.08,  2.24,  2.4,   2.56,  2.08,  2.24,  2.4,   2.56,  1.2,   1.28,
      1.36,  1.44,  1.2,   1.28,  1.36,  1.44,  0.,    0.,    0.,    0.,
      0.56,  0.64,  0.72,  0.8,   0.56,  0.64,  0.72,  0.8,   1.44,  1.6,
      1.76,  1.92,  1.44,  1.6,   1.76,  1.92,  2.64,  2.88,  3.12,  3.36,
      2.08,  2.24,  2.4,   2.56,  2.08,  2.24,  2.4,   2.56,  1.2,   1.28,
      1.36,  1.44,  1.2,   1.28,  1.36,  1.44,  0.,    0.,    0.,    0.,
      1.56,  1.68,  1.8,   1.92,  1.56,  1.68,  1.8,   1.92,  3.6,   3.84,
      4.08,  4.32,  3.6,   3.84,  4.08,  4.32,  6.12,  6.48,  6.84,  7.2,
      4.56,  4.8,   5.04,  5.28,  4.56,  4.8,   5.04,  5.28,  2.52,  2.64,
      2.76,  2.88,  2.52,  2.64,  2.76,  2.88,  0.,    0.,    0.,    0.,
      1.52,  1.6,   1.68,  1.76,  1.52,  1.6,   1.68,  1.76,  3.36,  3.52,
      3.68,  3.84,  3.36,  3.52,  3.68,  3.84,  5.52,  5.76,  6.,    6.24,
      4.,    4.16,  4.32,  4.48,  4.,    4.16,  4.32,  4.48,  2.16,  2.24,
      2.32,  2.4,   2.16,  2.24,  2.32,  2.4,   0.,    0.,    0.,    0.,
      1.52,  1.6,   1.68,  1.76,  1.52,  1.6,   1.68,  1.76,  3.36,  3.52,
      3.68,  3.84,  3.36,  3.52,  3.68,  3.84,  5.52,  5.76,  6.,    6.24,
      4.,    4.16,  4.32,  4.48,  4.,    4.16,  4.32,  4.48,  2.16,  2.24,
      2.32,  2.4,   2.16,  2.24,  2.32,  2.4,   0.,    0.,    0.,    0.,
      1.,    1.04,  1.08,  1.12,  1.,    1.04,  1.08,  1.12,  2.16,  2.24,
      2.32,  2.4,   2.16,  2.24,  2.32,  2.4,   3.48,  3.6,   3.72,  3.84,
      2.48,  2.56,  2.64,  2.72,  2.48,  2.56,  2.64,  2.72,  1.32,  1.36,
      1.4,   1.44,  1.32,  1.36,  1.4,   1.44,  0.,    0.,    0.,    0.,
      1.,    1.04,  1.08,  1.12,  1.,    1.04,  1.08,  1.12,  2.16,  2.24,
      2.32,  2.4,   2.16,  2.24,  2.32,  2.4,   3.48,  3.6,   3.72,  3.84,
      2.48,  2.56,  2.64,  2.72,  2.48,  2.56,  2.64,  2.72,  1.32,  1.36,
      1.4,   1.44,  1.32,  1.36,  1.4,   1.44,  0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      1.48,  1.52,  1.56,  1.6,   1.48,  1.52,  1.56,  1.6,   3.12,  3.2,
      3.28,  3.36,  3.12,  3.2,   3.28,  3.36,  4.92,  5.04,  5.16,  5.28,
      3.44,  3.52,  3.6,   3.68,  3.44,  3.52,  3.6,   3.68,  1.8,   1.84,
      1.88,  1.92,  1.8,   1.84,  1.88,  1.92,  0.,    0.,    0.,    0.,
      1.48,  1.52,  1.56,  1.6,   1.48,  1.52,  1.56,  1.6,   3.12,  3.2,
      3.28,  3.36,  3.12,  3.2,   3.28,  3.36,  4.92,  5.04,  5.16,  5.28,
      3.44,  3.52,  3.6,   3.68,  3.44,  3.52,  3.6,   3.68,  1.8,   1.84,
      1.88,  1.92,  1.8,   1.84,  1.88,  1.92,  0.,    0.,    0.,    0.,
      3.44,  3.52,  3.6,   3.68,  3.44,  3.52,  3.6,   3.68,  7.2,   7.36,
      7.52,  7.68,  7.2,   7.36,  7.52,  7.68,  11.28, 11.52, 11.76, 12.,
      7.84,  8.,    8.16,  8.32,  7.84,  8.,    8.16,  8.32,  4.08,  4.16,
      4.24,  4.32,  4.08,  4.16,  4.24,  4.32,  0.,    0.,    0.,    0.,
      3.44,  3.52,  3.6,   3.68,  3.44,  3.52,  3.6,   3.68,  7.2,   7.36,
      7.52,  7.68,  7.2,   7.36,  7.52,  7.68,  11.28, 11.52, 11.76, 12.,
      7.84,  8.,    8.16,  8.32,  7.84,  8.,    8.16,  8.32,  4.08,  4.16,
      4.24,  4.32,  4.08,  4.16,  4.24,  4.32,  0.,    0.,    0.,    0.,
      5.88,  6.,    6.12,  6.24,  5.88,  6.,    6.12,  6.24,  12.24, 12.48,
      12.72, 12.96, 12.24, 12.48, 12.72, 12.96, 19.08, 19.44, 19.8,  20.16,
      13.2,  13.44, 13.68, 13.92, 13.2,  13.44, 13.68, 13.92, 6.84,  6.96,
      7.08,  7.2,   6.84,  6.96,  7.08,  7.2,   0.,    0.,    0.,    0.,
      4.4,   4.48,  4.56,  4.64,  4.4,   4.48,  4.56,  4.64,  9.12,  9.28,
      9.44,  9.6,   9.12,  9.28,  9.44,  9.6,   14.16, 14.4,  14.64, 14.88,
      9.76,  9.92,  10.08, 10.24, 9.76,  9.92,  10.08, 10.24, 5.04,  5.12,
      5.2,   5.28,  5.04,  5.12,  5.2,   5.28,  0.,    0.,    0.,    0.,
      4.4,   4.48,  4.56,  4.64,  4.4,   4.48,  4.56,  4.64,  9.12,  9.28,
      9.44,  9.6,   9.12,  9.28,  9.44,  9.6,   14.16, 14.4,  14.64, 14.88,
      9.76,  9.92,  10.08, 10.24, 9.76,  9.92,  10.08, 10.24, 5.04,  5.12,
      5.2,   5.28,  5.04,  5.12,  5.2,   5.28,  0.,    0.,    0.,    0.,
      2.44,  2.48,  2.52,  2.56,  2.44,  2.48,  2.52,  2.56,  5.04,  5.12,
      5.2,   5.28,  5.04,  5.12,  5.2,   5.28,  7.8,   7.92,  8.04,  8.16,
      5.36,  5.44,  5.52,  5.6,   5.36,  5.44,  5.52,  5.6,   2.76,  2.8,
      2.84,  2.88,  2.76,  2.8,   2.84,  2.88,  0.,    0.,    0.,    0.,
      2.44,  2.48,  2.52,  2.56,  2.44,  2.48,  2.52,  2.56,  5.04,  5.12,
      5.2,   5.28,  5.04,  5.12,  5.2,   5.28,  7.8,   7.92,  8.04,  8.16,
      5.36,  5.44,  5.52,  5.6,   5.36,  5.44,  5.52,  5.6,   2.76,  2.8,
      2.84,  2.88,  2.76,  2.8,   2.84,  2.88,  0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      2.92,  2.96,  3.,    3.04,  2.92,  2.96,  3.,    3.04,  6.,    6.08,
      6.16,  6.24,  6.,    6.08,  6.16,  6.24,  9.24,  9.36,  9.48,  9.6,
      6.32,  6.4,   6.48,  6.56,  6.32,  6.4,   6.48,  6.56,  3.24,  3.28,
      3.32,  3.36,  3.24,  3.28,  3.32,  3.36,  0.,    0.,    0.,    0.,
      2.92,  2.96,  3.,    3.04,  2.92,  2.96,  3.,    3.04,  6.,    6.08,
      6.16,  6.24,  6.,    6.08,  6.16,  6.24,  9.24,  9.36,  9.48,  9.6,
      6.32,  6.4,   6.48,  6.56,  6.32,  6.4,   6.48,  6.56,  3.24,  3.28,
      3.32,  3.36,  3.24,  3.28,  3.32,  3.36,  0.,    0.,    0.,    0.,
      6.32,  6.4,   6.48,  6.56,  6.32,  6.4,   6.48,  6.56,  12.96, 13.12,
      13.28, 13.44, 12.96, 13.12, 13.28, 13.44, 19.92, 20.16, 20.4,  20.64,
      13.6,  13.76, 13.92, 14.08, 13.6,  13.76, 13.92, 14.08, 6.96,  7.04,
      7.12,  7.2,   6.96,  7.04,  7.12,  7.2,   0.,    0.,    0.,    0.,
      6.32,  6.4,   6.48,  6.56,  6.32,  6.4,   6.48,  6.56,  12.96, 13.12,
      13.28, 13.44, 12.96, 13.12, 13.28, 13.44, 19.92, 20.16, 20.4,  20.64,
      13.6,  13.76, 13.92, 14.08, 13.6,  13.76, 13.92, 14.08, 6.96,  7.04,
      7.12,  7.2,   6.96,  7.04,  7.12,  7.2,   0.,    0.,    0.,    0.,
      10.2,  10.32, 10.44, 10.56, 10.2,  10.32, 10.44, 10.56, 20.88, 21.12,
      21.36, 21.6,  20.88, 21.12, 21.36, 21.6,  32.04, 32.4,  32.76, 33.12,
      21.84, 22.08, 22.32, 22.56, 21.84, 22.08, 22.32, 22.56, 11.16, 11.28,
      11.4,  11.52, 11.16, 11.28, 11.4,  11.52, 0.,    0.,    0.,    0.,
      7.28,  7.36,  7.44,  7.52,  7.28,  7.36,  7.44,  7.52,  14.88, 15.04,
      15.2,  15.36, 14.88, 15.04, 15.2,  15.36, 22.8,  23.04, 23.28, 23.52,
      15.52, 15.68, 15.84, 16.,   15.52, 15.68, 15.84, 16.,   7.92,  8.,
      8.08,  8.16,  7.92,  8.,    8.08,  8.16,  0.,    0.,    0.,    0.,
      7.28,  7.36,  7.44,  7.52,  7.28,  7.36,  7.44,  7.52,  14.88, 15.04,
      15.2,  15.36, 14.88, 15.04, 15.2,  15.36, 22.8,  23.04, 23.28, 23.52,
      15.52, 15.68, 15.84, 16.,   15.52, 15.68, 15.84, 16.,   7.92,  8.,
      8.08,  8.16,  7.92,  8.,    8.08,  8.16,  0.,    0.,    0.,    0.,
      3.88,  3.92,  3.96,  4.,    3.88,  3.92,  3.96,  4.,    7.92,  8.,
      8.08,  8.16,  7.92,  8.,    8.08,  8.16,  12.12, 12.24, 12.36, 12.48,
      8.24,  8.32,  8.4,   8.48,  8.24,  8.32,  8.4,   8.48,  4.2,   4.24,
      4.28,  4.32,  4.2,   4.24,  4.28,  4.32,  0.,    0.,    0.,    0.,
      3.88,  3.92,  3.96,  4.,    3.88,  3.92,  3.96,  4.,    7.92,  8.,
      8.08,  8.16,  7.92,  8.,    8.08,  8.16,  12.12, 12.24, 12.36, 12.48,
      8.24,  8.32,  8.4,   8.48,  8.24,  8.32,  8.4,   8.48,  4.2,   4.24,
      4.28,  4.32,  4.2,   4.24,  4.28,  4.32,  0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
  };
  const std::array<int, 4> in_shape = {{3, 10, 10, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
