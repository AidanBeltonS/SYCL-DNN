/*
 * Copyright Codeplay Software Ltd.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use these files except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

// DO NOT MODIFY BY HAND
// This file was automatically generated by generate_batchnorm_tests.py.
// Results calculated using Tensorflow v2.8.0.

#include <gtest/gtest.h>

#include "sycldnn/data_format.h"

#include "sycldnn/batchnorm/direction.h"
#include "sycldnn/batchnorm/params.h"

#include "test/batchnorm/batchnorm_fixture.h"
#include "test/types/cartesian_product.h"
#include "test/types/kernel_data_types.h"
#include "test/types/test_backend_types.h"
#include "test/types/to_gtest_types.h"

#include <vector>

using DataTypeList = sycldnn::types::KernelDataTypes;
using Backends = sycldnn::types::AllBackendTypes;

using TypeBackendPairs =
    sycldnn::types::CartesianProduct<DataTypeList, Backends>::type;

using GTestTypePairs = sycldnn::types::ToGTestTypes<TypeBackendPairs>::type;

using namespace sycldnn;  // NOLINT(google-build-using-namespace)
template <typename Pair>
using BatchnormGradientFrozen =
    BatchNormFixture<Pair, batchnorm::Gradient, batchnorm::Frozen>;
TYPED_TEST_CASE(BatchnormGradientFrozen, GTestTypePairs);
TYPED_TEST(BatchnormGradientFrozen, 1x1x1x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {31.622776601683796};
  const std::vector<DataType> mean = {1.};
  const std::vector<DataType> variance = {0.};
  const std::vector<DataType> grad_scale = {-31.622776601683796};
  const std::vector<DataType> grad_offset = {1.};
  const std::array<int, 4> in_shape = {{1, 1, 1, 1}};
  const auto params = getBatchNormParams(in_shape, DataFormat::NHWC);
  const DataType max_input_val = 0.0;
  this->test_batchnorm(exp_grad, mean, variance, grad_scale, grad_offset,
                       params, max_input_val);
}
TYPED_TEST(BatchnormGradientFrozen, 1x1x1x5) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {31.622776601683796, 63.24555320336759,
                                          31.622776601683796, 63.24555320336759,
                                          31.622776601683796};
  const std::vector<DataType> mean = {1., 2., 1., 2., 1.};
  const std::vector<DataType> variance = {0., 0., 0., 0., 0.};
  const std::vector<DataType> grad_scale = {
      -31.622776601683796, -126.49110640673518, -31.622776601683796,
      -126.49110640673518, -31.622776601683796};
  const std::vector<DataType> grad_offset = {1., 2., 1., 2., 1.};
  const std::array<int, 4> in_shape = {{1, 1, 1, 5}};
  const auto params = getBatchNormParams(in_shape, DataFormat::NHWC);
  const DataType max_input_val = 2.0;
  this->test_batchnorm(exp_grad, mean, variance, grad_scale, grad_offset,
                       params, max_input_val);
}
TYPED_TEST(BatchnormGradientFrozen, 1x1x1x8) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518};
  const std::vector<DataType> mean = {1., 2., 3., 4., 1., 2., 3., 4.};
  const std::vector<DataType> variance = {0., 0., 0., 0., 0., 0., 0., 0.};
  const std::vector<DataType> grad_scale = {
      -31.622776601683796, -126.49110640673518, -284.60498941515414,
      -505.96442562694074, -31.622776601683796, -126.49110640673518,
      -284.60498941515414, -505.96442562694074};
  const std::vector<DataType> grad_offset = {1., 2., 3., 4., 1., 2., 3., 4.};
  const std::array<int, 4> in_shape = {{1, 1, 1, 8}};
  const auto params = getBatchNormParams(in_shape, DataFormat::NHWC);
  const DataType max_input_val = 4.0;
  this->test_batchnorm(exp_grad, mean, variance, grad_scale, grad_offset,
                       params, max_input_val);
}
TYPED_TEST(BatchnormGradientFrozen, 1x1x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343};
  const std::vector<DataType> mean = {2.5};
  const std::vector<DataType> variance = {1.25};
  const std::vector<DataType> grad_scale = {-36.7098766162444};
  const std::vector<DataType> grad_offset = {20.};
  const std::array<int, 4> in_shape = {{1, 1, 8, 1}};
  const auto params = getBatchNormParams(in_shape, DataFormat::NHWC);
  const DataType max_input_val = 4.0;
  this->test_batchnorm(exp_grad, mean, variance, grad_scale, grad_offset,
                       params, max_input_val);
}
TYPED_TEST(BatchnormGradientFrozen, 1x1x8x5) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343};
  const std::vector<DataType> mean = {2.5, 2.5, 2.5, 2.5, 2.5};
  const std::vector<DataType> variance = {1.25, 1.25, 1.25, 1.25, 1.25};
  const std::vector<DataType> grad_scale = {
      -36.70987661624441, -36.70987661624441, -36.70987661624441,
      -36.70987661624441, -36.70987661624441};
  const std::vector<DataType> grad_offset = {20., 20., 20., 20., 20.};
  const std::array<int, 4> in_shape = {{1, 1, 8, 5}};
  const auto params = getBatchNormParams(in_shape, DataFormat::NHWC);
  const DataType max_input_val = 4.0;
  this->test_batchnorm(exp_grad, mean, variance, grad_scale, grad_offset,
                       params, max_input_val);
}
TYPED_TEST(BatchnormGradientFrozen, 1x1x8x8) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518};
  const std::vector<DataType> mean = {1., 2., 3., 4., 1., 2., 3., 4.};
  const std::vector<DataType> variance = {0., 0., 0., 0., 0., 0., 0., 0.};
  const std::vector<DataType> grad_scale = {
      -252.98221281347037, -1011.9288512538815, -2276.8399153212335,
      -4047.715405015526,  -252.98221281347037, -1011.9288512538815,
      -2276.8399153212335, -4047.715405015526};
  const std::vector<DataType> grad_offset = {8., 16., 24., 32.,
                                             8., 16., 24., 32.};
  const std::array<int, 4> in_shape = {{1, 1, 8, 8}};
  const auto params = getBatchNormParams(in_shape, DataFormat::NHWC);
  const DataType max_input_val = 4.0;
  this->test_batchnorm(exp_grad, mean, variance, grad_scale, grad_offset,
                       params, max_input_val);
}
TYPED_TEST(BatchnormGradientFrozen, 1x1x9x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.8657008268211548, 1.7314016536423096, 2.597102480463464,
      3.462803307284619,  0.8657008268211548, 1.7314016536423096,
      2.597102480463464,  3.462803307284619,  0.8657008268211548};
  const std::vector<DataType> mean = {2.3333333333333335};
  const std::vector<DataType> variance = {1.3333333333333333};
  const std::vector<DataType> grad_scale = {-33.42608545553062};
  const std::vector<DataType> grad_offset = {21.};
  const std::array<int, 4> in_shape = {{1, 1, 9, 1}};
  const auto params = getBatchNormParams(in_shape, DataFormat::NHWC);
  const DataType max_input_val = 4.0;
  this->test_batchnorm(exp_grad, mean, variance, grad_scale, grad_offset,
                       params, max_input_val);
}
TYPED_TEST(BatchnormGradientFrozen, 1x1x9x5) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.8657008268211546, 1.8758041465830082, 2.813706219874512,
      3.462803307284619,  0.8657008268211546, 1.7314016536423091,
      2.813706219874512,  3.7516082931660164, 0.8657008268211548,
      1.7314016536423091, 2.5971024804634637, 3.7516082931660164,
      0.9379020732915041, 1.7314016536423096, 2.5971024804634637,
      3.4628033072846183, 0.9379020732915041, 1.8758041465830082,
      2.597102480463464,  3.4628033072846183, 0.8657008268211546,
      1.8758041465830082, 2.813706219874512,  3.462803307284619,
      0.8657008268211546, 1.7314016536423091, 2.813706219874512,
      3.7516082931660164, 0.8657008268211548, 1.7314016536423091,
      2.5971024804634637, 3.7516082931660164, 0.9379020732915041,
      1.7314016536423096, 2.5971024804634637, 3.4628033072846183,
      0.9379020732915041, 1.8758041465830082, 2.597102480463464,
      3.4628033072846183, 0.8657008268211546, 1.8758041465830082,
      2.813706219874512,  3.462803307284619,  0.8657008268211546};
  const std::vector<DataType> mean = {2.3333333333333335, 2.4444444444444446,
                                      2.5555555555555554, 2.6666666666666665,
                                      2.3333333333333335};
  const std::vector<DataType> variance = {
      1.3333333333333335, 1.1358024691358024, 1.1358024691358024,
      1.3333333333333333, 1.3333333333333335};
  const std::vector<DataType> grad_scale = {
      -33.42608545553061, -41.446206217479315, -46.13571658393682,
      -46.41159785784794, -33.42608545553061};
  const std::vector<DataType> grad_offset = {21., 22., 23., 24., 21.};
  const std::array<int, 4> in_shape = {{1, 1, 9, 5}};
  const auto params = getBatchNormParams(in_shape, DataFormat::NHWC);
  const DataType max_input_val = 4.0;
  this->test_batchnorm(exp_grad, mean, variance, grad_scale, grad_offset,
                       params, max_input_val);
}
TYPED_TEST(BatchnormGradientFrozen, 1x1x9x8) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518};
  const std::vector<DataType> mean = {1., 2., 3., 4., 1., 2., 3., 4.};
  const std::vector<DataType> variance = {0., 0., 0., 0., 0., 0., 0., 0.};
  const std::vector<DataType> grad_scale = {
      -284.60498941515414, -1138.4199576606165, -2561.444904736388,
      -4553.679830642466,  -284.60498941515414, -1138.4199576606165,
      -2561.444904736388,  -4553.679830642466};
  const std::vector<DataType> grad_offset = {9., 18., 27., 36.,
                                             9., 18., 27., 36.};
  const std::array<int, 4> in_shape = {{1, 1, 9, 8}};
  const auto params = getBatchNormParams(in_shape, DataFormat::NHWC);
  const DataType max_input_val = 4.0;
  this->test_batchnorm(exp_grad, mean, variance, grad_scale, grad_offset,
                       params, max_input_val);
}
TYPED_TEST(BatchnormGradientFrozen, 1x8x1x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343};
  const std::vector<DataType> mean = {2.5};
  const std::vector<DataType> variance = {1.25};
  const std::vector<DataType> grad_scale = {-36.7098766162444};
  const std::vector<DataType> grad_offset = {20.};
  const std::array<int, 4> in_shape = {{1, 8, 1, 1}};
  const auto params = getBatchNormParams(in_shape, DataFormat::NHWC);
  const DataType max_input_val = 4.0;
  this->test_batchnorm(exp_grad, mean, variance, grad_scale, grad_offset,
                       params, max_input_val);
}
TYPED_TEST(BatchnormGradientFrozen, 1x8x1x5) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343};
  const std::vector<DataType> mean = {2.5, 2.5, 2.5, 2.5, 2.5};
  const std::vector<DataType> variance = {1.25, 1.25, 1.25, 1.25, 1.25};
  const std::vector<DataType> grad_scale = {
      -36.70987661624441, -36.70987661624441, -36.70987661624441,
      -36.70987661624441, -36.70987661624441};
  const std::vector<DataType> grad_offset = {20., 20., 20., 20., 20.};
  const std::array<int, 4> in_shape = {{1, 8, 1, 5}};
  const auto params = getBatchNormParams(in_shape, DataFormat::NHWC);
  const DataType max_input_val = 4.0;
  this->test_batchnorm(exp_grad, mean, variance, grad_scale, grad_offset,
                       params, max_input_val);
}
TYPED_TEST(BatchnormGradientFrozen, 1x8x1x8) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518};
  const std::vector<DataType> mean = {1., 2., 3., 4., 1., 2., 3., 4.};
  const std::vector<DataType> variance = {0., 0., 0., 0., 0., 0., 0., 0.};
  const std::vector<DataType> grad_scale = {
      -252.98221281347037, -1011.9288512538815, -2276.8399153212335,
      -4047.715405015526,  -252.98221281347037, -1011.9288512538815,
      -2276.8399153212335, -4047.715405015526};
  const std::vector<DataType> grad_offset = {8., 16., 24., 32.,
                                             8., 16., 24., 32.};
  const std::array<int, 4> in_shape = {{1, 8, 1, 8}};
  const auto params = getBatchNormParams(in_shape, DataFormat::NHWC);
  const DataType max_input_val = 4.0;
  this->test_batchnorm(exp_grad, mean, variance, grad_scale, grad_offset,
                       params, max_input_val);
}
TYPED_TEST(BatchnormGradientFrozen, 1x8x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343};
  const std::vector<DataType> mean = {2.5};
  const std::vector<DataType> variance = {1.25};
  const std::vector<DataType> grad_scale = {-293.6790129299553};
  const std::vector<DataType> grad_offset = {160.};
  const std::array<int, 4> in_shape = {{1, 8, 8, 1}};
  const auto params = getBatchNormParams(in_shape, DataFormat::NHWC);
  const DataType max_input_val = 4.0;
  this->test_batchnorm(exp_grad, mean, variance, grad_scale, grad_offset,
                       params, max_input_val);
}
TYPED_TEST(BatchnormGradientFrozen, 1x8x8x5) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343};
  const std::vector<DataType> mean = {2.5, 2.5, 2.5, 2.5, 2.5};
  const std::vector<DataType> variance = {1.25, 1.25, 1.25, 1.25, 1.25};
  const std::vector<DataType> grad_scale = {
      -293.67901292995504, -293.67901292995504, -293.67901292995504,
      -293.67901292995504, -293.67901292995504};
  const std::vector<DataType> grad_offset = {160., 160., 160., 160., 160.};
  const std::array<int, 4> in_shape = {{1, 8, 8, 5}};
  const auto params = getBatchNormParams(in_shape, DataFormat::NHWC);
  const DataType max_input_val = 4.0;
  this->test_batchnorm(exp_grad, mean, variance, grad_scale, grad_offset,
                       params, max_input_val);
}
TYPED_TEST(BatchnormGradientFrozen, 1x8x8x8) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518};
  const std::vector<DataType> mean = {1., 2., 3., 4., 1., 2., 3., 4.};
  const std::vector<DataType> variance = {0., 0., 0., 0., 0., 0., 0., 0.};
  const std::vector<DataType> grad_scale = {
      -2023.857702507765, -8095.43081003106,  -18214.71932256988,
      -32381.72324012424, -2023.857702507765, -8095.43081003106,
      -18214.71932256988, -32381.72324012424};
  const std::vector<DataType> grad_offset = {64., 128., 192., 256.,
                                             64., 128., 192., 256.};
  const std::array<int, 4> in_shape = {{1, 8, 8, 8}};
  const auto params = getBatchNormParams(in_shape, DataFormat::NHWC);
  const DataType max_input_val = 4.0;
  this->test_batchnorm(exp_grad, mean, variance, grad_scale, grad_offset,
                       params, max_input_val);
}
TYPED_TEST(BatchnormGradientFrozen, 1x8x9x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343};
  const std::vector<DataType> mean = {2.5};
  const std::vector<DataType> variance = {1.25};
  const std::vector<DataType> grad_scale = {-330.38888954619966};
  const std::vector<DataType> grad_offset = {180.};
  const std::array<int, 4> in_shape = {{1, 8, 9, 1}};
  const auto params = getBatchNormParams(in_shape, DataFormat::NHWC);
  const DataType max_input_val = 4.0;
  this->test_batchnorm(exp_grad, mean, variance, grad_scale, grad_offset,
                       params, max_input_val);
}
TYPED_TEST(BatchnormGradientFrozen, 1x8x9x5) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343};
  const std::vector<DataType> mean = {2.5, 2.5, 2.5, 2.5, 2.5};
  const std::vector<DataType> variance = {1.25, 1.25, 1.25, 1.25, 1.25};
  const std::vector<DataType> grad_scale = {
      -330.38888954619944, -330.38888954619944, -330.38888954619944,
      -330.38888954619944, -330.38888954619944};
  const std::vector<DataType> grad_offset = {180., 180., 180., 180., 180.};
  const std::array<int, 4> in_shape = {{1, 8, 9, 5}};
  const auto params = getBatchNormParams(in_shape, DataFormat::NHWC);
  const DataType max_input_val = 4.0;
  this->test_batchnorm(exp_grad, mean, variance, grad_scale, grad_offset,
                       params, max_input_val);
}
TYPED_TEST(BatchnormGradientFrozen, 1x8x9x8) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518};
  const std::vector<DataType> mean = {1., 2., 3., 4., 1., 2., 3., 4.};
  const std::vector<DataType> variance = {0., 0., 0., 0., 0., 0., 0., 0.};
  const std::vector<DataType> grad_scale = {
      -2276.8399153212345, -9107.359661284938,  -20491.559237891117,
      -36429.43864513975,  -2276.8399153212345, -9107.359661284938,
      -20491.559237891117, -36429.43864513975};
  const std::vector<DataType> grad_offset = {72., 144., 216., 288.,
                                             72., 144., 216., 288.};
  const std::array<int, 4> in_shape = {{1, 8, 9, 8}};
  const auto params = getBatchNormParams(in_shape, DataFormat::NHWC);
  const DataType max_input_val = 4.0;
  this->test_batchnorm(exp_grad, mean, variance, grad_scale, grad_offset,
                       params, max_input_val);
}
TYPED_TEST(BatchnormGradientFrozen, 1x9x1x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.8657008268211548, 1.7314016536423096, 2.597102480463464,
      3.462803307284619,  0.8657008268211548, 1.7314016536423096,
      2.597102480463464,  3.462803307284619,  0.8657008268211548};
  const std::vector<DataType> mean = {2.3333333333333335};
  const std::vector<DataType> variance = {1.3333333333333333};
  const std::vector<DataType> grad_scale = {-33.42608545553062};
  const std::vector<DataType> grad_offset = {21.};
  const std::array<int, 4> in_shape = {{1, 9, 1, 1}};
  const auto params = getBatchNormParams(in_shape, DataFormat::NHWC);
  const DataType max_input_val = 4.0;
  this->test_batchnorm(exp_grad, mean, variance, grad_scale, grad_offset,
                       params, max_input_val);
}
TYPED_TEST(BatchnormGradientFrozen, 1x9x1x5) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.8657008268211546, 1.8758041465830082, 2.813706219874512,
      3.462803307284619,  0.8657008268211546, 1.7314016536423091,
      2.813706219874512,  3.7516082931660164, 0.8657008268211548,
      1.7314016536423091, 2.5971024804634637, 3.7516082931660164,
      0.9379020732915041, 1.7314016536423096, 2.5971024804634637,
      3.4628033072846183, 0.9379020732915041, 1.8758041465830082,
      2.597102480463464,  3.4628033072846183, 0.8657008268211546,
      1.8758041465830082, 2.813706219874512,  3.462803307284619,
      0.8657008268211546, 1.7314016536423091, 2.813706219874512,
      3.7516082931660164, 0.8657008268211548, 1.7314016536423091,
      2.5971024804634637, 3.7516082931660164, 0.9379020732915041,
      1.7314016536423096, 2.5971024804634637, 3.4628033072846183,
      0.9379020732915041, 1.8758041465830082, 2.597102480463464,
      3.4628033072846183, 0.8657008268211546, 1.8758041465830082,
      2.813706219874512,  3.462803307284619,  0.8657008268211546};
  const std::vector<DataType> mean = {2.3333333333333335, 2.4444444444444446,
                                      2.5555555555555554, 2.6666666666666665,
                                      2.3333333333333335};
  const std::vector<DataType> variance = {
      1.3333333333333335, 1.1358024691358024, 1.1358024691358024,
      1.3333333333333333, 1.3333333333333335};
  const std::vector<DataType> grad_scale = {
      -33.42608545553061, -41.446206217479315, -46.13571658393682,
      -46.41159785784794, -33.42608545553061};
  const std::vector<DataType> grad_offset = {21., 22., 23., 24., 21.};
  const std::array<int, 4> in_shape = {{1, 9, 1, 5}};
  const auto params = getBatchNormParams(in_shape, DataFormat::NHWC);
  const DataType max_input_val = 4.0;
  this->test_batchnorm(exp_grad, mean, variance, grad_scale, grad_offset,
                       params, max_input_val);
}
TYPED_TEST(BatchnormGradientFrozen, 1x9x1x8) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518};
  const std::vector<DataType> mean = {1., 2., 3., 4., 1., 2., 3., 4.};
  const std::vector<DataType> variance = {0., 0., 0., 0., 0., 0., 0., 0.};
  const std::vector<DataType> grad_scale = {
      -284.60498941515414, -1138.4199576606165, -2561.444904736388,
      -4553.679830642466,  -284.60498941515414, -1138.4199576606165,
      -2561.444904736388,  -4553.679830642466};
  const std::vector<DataType> grad_offset = {9., 18., 27., 36.,
                                             9., 18., 27., 36.};
  const std::array<int, 4> in_shape = {{1, 9, 1, 8}};
  const auto params = getBatchNormParams(in_shape, DataFormat::NHWC);
  const DataType max_input_val = 4.0;
  this->test_batchnorm(exp_grad, mean, variance, grad_scale, grad_offset,
                       params, max_input_val);
}
TYPED_TEST(BatchnormGradientFrozen, 1x9x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343};
  const std::vector<DataType> mean = {2.5};
  const std::vector<DataType> variance = {1.25};
  const std::vector<DataType> grad_scale = {-330.38888954619966};
  const std::vector<DataType> grad_offset = {180.};
  const std::array<int, 4> in_shape = {{1, 9, 8, 1}};
  const auto params = getBatchNormParams(in_shape, DataFormat::NHWC);
  const DataType max_input_val = 4.0;
  this->test_batchnorm(exp_grad, mean, variance, grad_scale, grad_offset,
                       params, max_input_val);
}
TYPED_TEST(BatchnormGradientFrozen, 1x9x8x5) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343};
  const std::vector<DataType> mean = {2.5, 2.5, 2.5, 2.5, 2.5};
  const std::vector<DataType> variance = {1.25, 1.25, 1.25, 1.25, 1.25};
  const std::vector<DataType> grad_scale = {
      -330.38888954619944, -330.38888954619944, -330.38888954619944,
      -330.38888954619944, -330.38888954619944};
  const std::vector<DataType> grad_offset = {180., 180., 180., 180., 180.};
  const std::array<int, 4> in_shape = {{1, 9, 8, 5}};
  const auto params = getBatchNormParams(in_shape, DataFormat::NHWC);
  const DataType max_input_val = 4.0;
  this->test_batchnorm(exp_grad, mean, variance, grad_scale, grad_offset,
                       params, max_input_val);
}
TYPED_TEST(BatchnormGradientFrozen, 1x9x8x8) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518};
  const std::vector<DataType> mean = {1., 2., 3., 4., 1., 2., 3., 4.};
  const std::vector<DataType> variance = {0., 0., 0., 0., 0., 0., 0., 0.};
  const std::vector<DataType> grad_scale = {
      -2276.8399153212345, -9107.359661284938,  -20491.559237891117,
      -36429.43864513975,  -2276.8399153212345, -9107.359661284938,
      -20491.559237891117, -36429.43864513975};
  const std::vector<DataType> grad_offset = {72., 144., 216., 288.,
                                             72., 144., 216., 288.};
  const std::array<int, 4> in_shape = {{1, 9, 8, 8}};
  const auto params = getBatchNormParams(in_shape, DataFormat::NHWC);
  const DataType max_input_val = 4.0;
  this->test_batchnorm(exp_grad, mean, variance, grad_scale, grad_offset,
                       params, max_input_val);
}
TYPED_TEST(BatchnormGradientFrozen, 1x9x9x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.889811169577287, 1.779622339154574, 2.669433508731861,
      3.559244678309148, 0.889811169577287, 1.779622339154574,
      2.669433508731861, 3.559244678309148, 0.889811169577287,
      1.779622339154574, 2.669433508731861, 3.559244678309148,
      0.889811169577287, 1.779622339154574, 2.669433508731861,
      3.559244678309148, 0.889811169577287, 1.779622339154574,
      2.669433508731861, 3.559244678309148, 0.889811169577287,
      1.779622339154574, 2.669433508731861, 3.559244678309148,
      0.889811169577287, 1.779622339154574, 2.669433508731861,
      3.559244678309148, 0.889811169577287, 1.779622339154574,
      2.669433508731861, 3.559244678309148, 0.889811169577287,
      1.779622339154574, 2.669433508731861, 3.559244678309148,
      0.889811169577287, 1.779622339154574, 2.669433508731861,
      3.559244678309148, 0.889811169577287, 1.779622339154574,
      2.669433508731861, 3.559244678309148, 0.889811169577287,
      1.779622339154574, 2.669433508731861, 3.559244678309148,
      0.889811169577287, 1.779622339154574, 2.669433508731861,
      3.559244678309148, 0.889811169577287, 1.779622339154574,
      2.669433508731861, 3.559244678309148, 0.889811169577287,
      1.779622339154574, 2.669433508731861, 3.559244678309148,
      0.889811169577287, 1.779622339154574, 2.669433508731861,
      3.559244678309148, 0.889811169577287, 1.779622339154574,
      2.669433508731861, 3.559244678309148, 0.889811169577287,
      1.779622339154574, 2.669433508731861, 3.559244678309148,
      0.889811169577287, 1.779622339154574, 2.669433508731861,
      3.559244678309148, 0.889811169577287, 1.779622339154574,
      2.669433508731861, 3.559244678309148, 0.889811169577287};
  const std::vector<DataType> mean = {2.4814814814814814};
  const std::vector<DataType> variance = {1.262002743484225};
  const std::vector<DataType> grad_scale = {-362.8821706809224};
  const std::vector<DataType> grad_offset = {201.};
  const std::array<int, 4> in_shape = {{1, 9, 9, 1}};
  const auto params = getBatchNormParams(in_shape, DataFormat::NHWC);
  const DataType max_input_val = 4.0;
  this->test_batchnorm(exp_grad, mean, variance, grad_scale, grad_offset,
                       params, max_input_val);
}
TYPED_TEST(BatchnormGradientFrozen, 1x9x9x5) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.889811169577287,  1.7970560160947926, 2.695584024142189,
      3.559244678309147,  0.8898111695772865, 1.779622339154574,
      2.695584024142189,  3.594112032189585,  0.8898111695772868,
      1.779622339154573,  2.669433508731861,  3.594112032189585,
      0.8985280080473963, 1.7796223391545736, 2.6694335087318595,
      3.559244678309148,  0.8985280080473963, 1.7970560160947926,
      2.6694335087318604, 3.559244678309146,  0.889811169577287,
      1.7970560160947926, 2.695584024142189,  3.559244678309147,
      0.8898111695772865, 1.779622339154574,  2.695584024142189,
      3.594112032189585,  0.8898111695772868, 1.779622339154573,
      2.669433508731861,  3.594112032189585,  0.8985280080473963,
      1.7796223391545736, 2.6694335087318595, 3.559244678309148,
      0.8985280080473963, 1.7970560160947926, 2.6694335087318604,
      3.559244678309146,  0.889811169577287,  1.7970560160947926,
      2.695584024142189,  3.559244678309147,  0.8898111695772865,
      1.779622339154574,  2.695584024142189,  3.594112032189585,
      0.8898111695772868, 1.779622339154573,  2.669433508731861,
      3.594112032189585,  0.8985280080473963, 1.7796223391545736,
      2.6694335087318595, 3.559244678309148,  0.8985280080473963,
      1.7970560160947926, 2.6694335087318604, 3.559244678309146,
      0.889811169577287,  1.7970560160947926, 2.695584024142189,
      3.559244678309147,  0.8898111695772865, 1.779622339154574,
      2.695584024142189,  3.594112032189585,  0.8898111695772868,
      1.779622339154573,  2.669433508731861,  3.594112032189585,
      0.8985280080473963, 1.7796223391545736, 2.6694335087318595,
      3.559244678309148,  0.8985280080473963, 1.7970560160947926,
      2.6694335087318604, 3.559244678309146,  0.889811169577287,
      1.7970560160947926, 2.695584024142189,  3.559244678309147,
      0.8898111695772865, 1.779622339154574,  2.695584024142189,
      3.594112032189585,  0.8898111695772868, 1.779622339154573,
      2.669433508731861,  3.594112032189585,  0.8985280080473963,
      1.7796223391545736, 2.6694335087318595, 3.559244678309148,
      0.8985280080473963, 1.7970560160947926, 2.6694335087318604,
      3.559244678309146,  0.889811169577287,  1.7970560160947926,
      2.695584024142189,  3.559244678309147,  0.8898111695772865,
      1.779622339154574,  2.695584024142189,  3.594112032189585,
      0.8898111695772868, 1.779622339154573,  2.669433508731861,
      3.594112032189585,  0.8985280080473963, 1.7796223391545736,
      2.6694335087318595, 3.559244678309148,  0.8985280080473963,
      1.7970560160947926, 2.6694335087318604, 3.559244678309146,
      0.889811169577287,  1.7970560160947926, 2.695584024142189,
      3.559244678309147,  0.8898111695772865, 1.779622339154574,
      2.695584024142189,  3.594112032189585,  0.8898111695772868,
      1.779622339154573,  2.669433508731861,  3.594112032189585,
      0.8985280080473963, 1.7796223391545736, 2.6694335087318595,
      3.559244678309148,  0.8985280080473963, 1.7970560160947926,
      2.6694335087318604, 3.559244678309146,  0.889811169577287,
      1.7970560160947926, 2.695584024142189,  3.559244678309147,
      0.8898111695772865, 1.779622339154574,  2.695584024142189,
      3.594112032189585,  0.8898111695772868, 1.779622339154573,
      2.669433508731861,  3.594112032189585,  0.8985280080473963,
      1.7796223391545736, 2.6694335087318595, 3.559244678309148,
      0.8985280080473963, 1.7970560160947926, 2.6694335087318604,
      3.559244678309146,  0.889811169577287,  1.7970560160947926,
      2.695584024142189,  3.559244678309147,  0.8898111695772865,
      1.779622339154574,  2.695584024142189,  3.594112032189585,
      0.8898111695772868, 1.779622339154573,  2.669433508731861,
      3.594112032189585,  0.8985280080473963, 1.7796223391545736,
      2.6694335087318595, 3.559244678309148,  0.8985280080473963,
      1.7970560160947926, 2.6694335087318604, 3.559244678309146,
      0.889811169577287,  1.7970560160947926, 2.695584024142189,
      3.559244678309147,  0.8898111695772865, 1.779622339154574,
      2.695584024142189,  3.594112032189585,  0.8898111695772868,
      1.779622339154573,  2.669433508731861,  3.594112032189585,
      0.8985280080473963, 1.7796223391545736, 2.6694335087318595,
      3.559244678309148,  0.8985280080473963, 1.7970560160947926,
      2.6694335087318604, 3.559244678309146,  0.889811169577287,
      1.7970560160947926, 2.695584024142189,  3.559244678309147,
      0.8898111695772865, 1.779622339154574,  2.695584024142189,
      3.594112032189585,  0.8898111695772868, 1.779622339154573,
      2.669433508731861,  3.594112032189585,  0.8985280080473963,
      1.7796223391545736, 2.6694335087318595, 3.559244678309148,
      0.8985280080473963, 1.7970560160947926, 2.6694335087318604,
      3.559244678309146,  0.889811169577287,  1.7970560160947926,
      2.695584024142189,  3.559244678309147,  0.8898111695772865,
      1.779622339154574,  2.695584024142189,  3.594112032189585,
      0.8898111695772868, 1.779622339154573,  2.669433508731861,
      3.594112032189585,  0.8985280080473963, 1.7796223391545736,
      2.6694335087318595, 3.559244678309148,  0.8985280080473963,
      1.7970560160947926, 2.6694335087318604, 3.559244678309146,
      0.889811169577287,  1.7970560160947926, 2.695584024142189,
      3.559244678309147,  0.8898111695772865, 1.779622339154574,
      2.695584024142189,  3.594112032189585,  0.8898111695772868,
      1.779622339154573,  2.669433508731861,  3.594112032189585,
      0.8985280080473963, 1.7796223391545736, 2.6694335087318595,
      3.559244678309148,  0.8985280080473963, 1.7970560160947926,
      2.6694335087318604, 3.559244678309146,  0.889811169577287,
      1.7970560160947926, 2.695584024142189,  3.559244678309147,
      0.8898111695772865, 1.779622339154574,  2.695584024142189,
      3.594112032189585,  0.8898111695772868, 1.779622339154573,
      2.669433508731861,  3.594112032189585,  0.8985280080473963,
      1.7796223391545736, 2.6694335087318595, 3.559244678309148,
      0.8985280080473963, 1.7970560160947926, 2.6694335087318604,
      3.559244678309146,  0.889811169577287,  1.7970560160947926,
      2.695584024142189,  3.559244678309147,  0.8898111695772865,
      1.779622339154574,  2.695584024142189,  3.594112032189585,
      0.8898111695772868, 1.779622339154573,  2.669433508731861,
      3.594112032189585,  0.8985280080473963, 1.7796223391545736,
      2.6694335087318595, 3.559244678309148,  0.8985280080473963,
      1.7970560160947926, 2.6694335087318604, 3.559244678309146,
      0.889811169577287,  1.7970560160947926, 2.695584024142189,
      3.559244678309147,  0.8898111695772865, 1.779622339154574,
      2.695584024142189,  3.594112032189585,  0.8898111695772868,
      1.779622339154573,  2.669433508731861,  3.594112032189585,
      0.8985280080473963, 1.7796223391545736, 2.6694335087318595,
      3.559244678309148,  0.8985280080473963, 1.7970560160947926,
      2.6694335087318604, 3.559244678309146,  0.889811169577287,
      1.7970560160947926, 2.695584024142189,  3.559244678309147,
      0.8898111695772865, 1.779622339154574,  2.695584024142189,
      3.594112032189585,  0.8898111695772868, 1.779622339154573,
      2.669433508731861,  3.594112032189585,  0.8985280080473963,
      1.7796223391545736, 2.6694335087318595, 3.559244678309148,
      0.8985280080473963, 1.7970560160947926, 2.6694335087318604,
      3.559244678309146,  0.889811169577287,  1.7970560160947926,
      2.695584024142189,  3.559244678309147,  0.8898111695772865,
      1.779622339154574,  2.695584024142189,  3.594112032189585,
      0.8898111695772868, 1.779622339154573,  2.669433508731861,
      3.594112032189585,  0.8985280080473963, 1.7796223391545736,
      2.6694335087318595, 3.559244678309148,  0.8985280080473963,
      1.7970560160947926, 2.6694335087318604, 3.559244678309146,
      0.889811169577287,  1.7970560160947926, 2.695584024142189,
      3.559244678309147,  0.8898111695772865, 1.779622339154574,
      2.695584024142189,  3.594112032189585,  0.8898111695772868,
      1.779622339154573,  2.669433508731861,  3.594112032189585,
      0.8985280080473963, 1.7796223391545736, 2.6694335087318595,
      3.559244678309148,  0.8985280080473963, 1.7970560160947926,
      2.6694335087318604, 3.559244678309146,  0.889811169577287,
      1.7970560160947926, 2.695584024142189,  3.559244678309147,
      0.8898111695772865, 1.779622339154574,  2.695584024142189,
      3.594112032189585,  0.8898111695772868, 1.779622339154573,
      2.669433508731861,  3.594112032189585,  0.8985280080473963,
      1.7796223391545736, 2.6694335087318595, 3.559244678309148,
      0.8985280080473963, 1.7970560160947926, 2.6694335087318604,
      3.559244678309146,  0.889811169577287,  1.7970560160947926,
      2.695584024142189,  3.559244678309147,  0.8898111695772865};
  const std::vector<DataType> mean = {2.4814814814814814, 2.493827160493827,
                                      2.506172839506173, 2.5185185185185186,
                                      2.4814814814814814};
  const std::vector<DataType> variance = {1.262002743484225, 1.237616217040085,
                                          1.237616217040085, 1.2620027434842251,
                                          1.262002743484226};
  const std::vector<DataType> grad_scale = {
      -362.8821706809224, -371.70165284754916, -376.1942928877868,
      -376.22933822458197, -362.882170680922};
  const std::vector<DataType> grad_offset = {201., 202., 203., 204., 201.};
  const std::array<int, 4> in_shape = {{1, 9, 9, 5}};
  const auto params = getBatchNormParams(in_shape, DataFormat::NHWC);
  const DataType max_input_val = 4.0;
  this->test_batchnorm(exp_grad, mean, variance, grad_scale, grad_offset,
                       params, max_input_val);
}
TYPED_TEST(BatchnormGradientFrozen, 1x9x9x8) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518};
  const std::vector<DataType> mean = {1., 2., 3., 4., 1., 2., 3., 4.};
  const std::vector<DataType> variance = {0., 0., 0., 0., 0., 0., 0., 0.};
  const std::vector<DataType> grad_scale = {
      -2561.4449047363873, -10245.77961894555,  -23053.00414262751,
      -40983.1184757822,   -2561.4449047363873, -10245.77961894555,
      -23053.00414262751,  -40983.1184757822};
  const std::vector<DataType> grad_offset = {81., 162., 243., 324.,
                                             81., 162., 243., 324.};
  const std::array<int, 4> in_shape = {{1, 9, 9, 8}};
  const auto params = getBatchNormParams(in_shape, DataFormat::NHWC);
  const DataType max_input_val = 4.0;
  this->test_batchnorm(exp_grad, mean, variance, grad_scale, grad_offset,
                       params, max_input_val);
}
TYPED_TEST(BatchnormGradientFrozen, 3x1x1x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      31.622776601683796, 31.622776601683796, 31.622776601683796};
  const std::vector<DataType> mean = {1.};
  const std::vector<DataType> variance = {0.};
  const std::vector<DataType> grad_scale = {-94.86832980505139};
  const std::vector<DataType> grad_offset = {3.};
  const std::array<int, 4> in_shape = {{3, 1, 1, 1}};
  const auto params = getBatchNormParams(in_shape, DataFormat::NHWC);
  const DataType max_input_val = 1.0;
  this->test_batchnorm(exp_grad, mean, variance, grad_scale, grad_offset,
                       params, max_input_val);
}
TYPED_TEST(BatchnormGradientFrozen, 3x1x1x5) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      2.116563421391978, 4.233126842783956, 2.116563421391978,
      4.233126842783956, 2.116563421391978, 4.233126842783956,
      2.116563421391978, 4.233126842783956, 2.116563421391978,
      4.233126842783956, 2.116563421391978, 4.233126842783956,
      2.116563421391978, 4.233126842783956, 2.116563421391978};
  const std::vector<DataType> mean = {1.3333333333333333, 1.6666666666666667,
                                      1.3333333333333333, 1.6666666666666667,
                                      1.3333333333333333};
  const std::vector<DataType> variance = {
      0.2222222222222222, 0.2222222222222222, 0.2222222222222222,
      0.2222222222222222, 0.2222222222222222};
  const std::vector<DataType> grad_scale = {
      -8.301777769574203, -14.651468033750142, -8.301777769574203,
      -14.651468033750142, -8.301777769574203};
  const std::vector<DataType> grad_offset = {4., 5., 4., 5., 4.};
  const std::array<int, 4> in_shape = {{3, 1, 1, 5}};
  const auto params = getBatchNormParams(in_shape, DataFormat::NHWC);
  const DataType max_input_val = 2.0;
  this->test_batchnorm(exp_grad, mean, variance, grad_scale, grad_offset,
                       params, max_input_val);
}
TYPED_TEST(BatchnormGradientFrozen, 3x1x1x8) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518};
  const std::vector<DataType> mean = {1., 2., 3., 4., 1., 2., 3., 4.};
  const std::vector<DataType> variance = {0., 0., 0., 0., 0., 0., 0., 0.};
  const std::vector<DataType> grad_scale = {
      -94.86832980505139,  -379.47331922020555, -853.8149682454624,
      -1517.8932768808222, -94.86832980505139,  -379.47331922020555,
      -853.8149682454624,  -1517.8932768808222};
  const std::vector<DataType> grad_offset = {3., 6., 9., 12., 3., 6., 9., 12.};
  const std::array<int, 4> in_shape = {{3, 1, 1, 8}};
  const auto params = getBatchNormParams(in_shape, DataFormat::NHWC);
  const DataType max_input_val = 4.0;
  this->test_batchnorm(exp_grad, mean, variance, grad_scale, grad_offset,
                       params, max_input_val);
}
TYPED_TEST(BatchnormGradientFrozen, 3x1x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343};
  const std::vector<DataType> mean = {2.5};
  const std::vector<DataType> variance = {1.25};
  const std::vector<DataType> grad_scale = {-110.1296298487332};
  const std::vector<DataType> grad_offset = {60.};
  const std::array<int, 4> in_shape = {{3, 1, 8, 1}};
  const auto params = getBatchNormParams(in_shape, DataFormat::NHWC);
  const DataType max_input_val = 4.0;
  this->test_batchnorm(exp_grad, mean, variance, grad_scale, grad_offset,
                       params, max_input_val);
}
TYPED_TEST(BatchnormGradientFrozen, 3x1x8x5) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343};
  const std::vector<DataType> mean = {2.5, 2.5, 2.5, 2.5, 2.5};
  const std::vector<DataType> variance = {1.25, 1.25, 1.25, 1.25, 1.25};
  const std::vector<DataType> grad_scale = {
      -110.1296298487332, -110.12962984873322, -110.12962984873322,
      -110.12962984873322, -110.1296298487332};
  const std::vector<DataType> grad_offset = {60., 60., 60., 60., 60.};
  const std::array<int, 4> in_shape = {{3, 1, 8, 5}};
  const auto params = getBatchNormParams(in_shape, DataFormat::NHWC);
  const DataType max_input_val = 4.0;
  this->test_batchnorm(exp_grad, mean, variance, grad_scale, grad_offset,
                       params, max_input_val);
}
TYPED_TEST(BatchnormGradientFrozen, 3x1x8x8) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518};
  const std::vector<DataType> mean = {1., 2., 3., 4., 1., 2., 3., 4.};
  const std::vector<DataType> variance = {0., 0., 0., 0., 0., 0., 0., 0.};
  const std::vector<DataType> grad_scale = {
      -758.9466384404107,  -3035.7865537616426, -6830.5197459636975,
      -12143.14621504657,  -758.9466384404107,  -3035.7865537616426,
      -6830.5197459636975, -12143.14621504657};
  const std::vector<DataType> grad_offset = {24., 48., 72., 96.,
                                             24., 48., 72., 96.};
  const std::array<int, 4> in_shape = {{3, 1, 8, 8}};
  const auto params = getBatchNormParams(in_shape, DataFormat::NHWC);
  const DataType max_input_val = 4.0;
  this->test_batchnorm(exp_grad, mean, variance, grad_scale, grad_offset,
                       params, max_input_val);
}
TYPED_TEST(BatchnormGradientFrozen, 3x1x9x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.9087618079410872, 1.8175236158821744, 2.7262854238232617,
      3.6350472317643487, 0.9087618079410872, 1.8175236158821744,
      2.7262854238232617, 3.6350472317643487, 0.9087618079410872,
      1.8175236158821744, 2.7262854238232617, 3.6350472317643487,
      0.9087618079410872, 1.8175236158821744, 2.7262854238232617,
      3.6350472317643487, 0.9087618079410872, 1.8175236158821744,
      2.7262854238232617, 3.6350472317643487, 0.9087618079410872,
      1.8175236158821744, 2.7262854238232617, 3.6350472317643487,
      0.9087618079410872, 1.8175236158821744, 2.7262854238232617};
  const std::vector<DataType> mean = {2.4444444444444446};
  const std::vector<DataType> variance = {1.2098765432098768};
  const std::vector<DataType> grad_scale = {-119.63586957779852};
  const std::vector<DataType> grad_offset = {66.};
  const std::array<int, 4> in_shape = {{3, 1, 9, 1}};
  const auto params = getBatchNormParams(in_shape, DataFormat::NHWC);
  const DataType max_input_val = 4.0;
  this->test_batchnorm(exp_grad, mean, variance, grad_scale, grad_offset,
                       params, max_input_val);
}
TYPED_TEST(BatchnormGradientFrozen, 3x1x9x5) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.9087618079410873, 1.8175236158821744, 2.6437166216309396,
      3.5249554955079194, 0.9087618079410872, 1.8175236158821746,
      2.7262854238232617, 3.5249554955079194, 0.8812388738769799,
      1.8175236158821744, 2.7262854238232617, 3.6350472317643487,
      0.8812388738769799, 1.7624777477539597, 2.7262854238232617,
      3.635047231764349,  0.9087618079410872, 1.7624777477539597,
      2.6437166216309396, 3.6350472317643487, 0.9087618079410873,
      1.8175236158821744, 2.6437166216309396, 3.5249554955079194,
      0.9087618079410872, 1.8175236158821746, 2.7262854238232617,
      3.5249554955079194, 0.8812388738769799, 1.8175236158821744,
      2.7262854238232617, 3.6350472317643487, 0.8812388738769799,
      1.7624777477539597, 2.7262854238232617, 3.635047231764349,
      0.9087618079410872, 1.7624777477539597, 2.6437166216309396,
      3.6350472317643487, 0.9087618079410873, 1.8175236158821744,
      2.6437166216309396, 3.5249554955079194, 0.9087618079410872,
      1.8175236158821746, 2.7262854238232617, 3.5249554955079194,
      0.8812388738769799, 1.8175236158821744, 2.7262854238232617,
      3.6350472317643487, 0.8812388738769799, 1.7624777477539597,
      2.7262854238232617, 3.635047231764349,  0.9087618079410872,
      1.7624777477539597, 2.6437166216309396, 3.6350472317643487,
      0.9087618079410873, 1.8175236158821744, 2.6437166216309396,
      3.5249554955079194, 0.9087618079410872, 1.8175236158821746,
      2.7262854238232617, 3.5249554955079194, 0.8812388738769799,
      1.8175236158821744, 2.7262854238232617, 3.6350472317643487,
      0.8812388738769799, 1.7624777477539597, 2.7262854238232617,
      3.635047231764349,  0.9087618079410872, 1.7624777477539597,
      2.6437166216309396, 3.6350472317643487, 0.9087618079410873,
      1.8175236158821744, 2.6437166216309396, 3.5249554955079194,
      0.9087618079410872, 1.8175236158821746, 2.7262854238232617,
      3.5249554955079194, 0.8812388738769799, 1.8175236158821744,
      2.7262854238232617, 3.6350472317643487, 0.8812388738769799,
      1.7624777477539597, 2.7262854238232617, 3.635047231764349,
      0.9087618079410872, 1.7624777477539597, 2.6437166216309396,
      3.6350472317643487, 0.9087618079410873, 1.8175236158821744,
      2.6437166216309396, 3.5249554955079194, 0.9087618079410872,
      1.8175236158821746, 2.7262854238232617, 3.5249554955079194,
      0.8812388738769799, 1.8175236158821744, 2.7262854238232617,
      3.6350472317643487, 0.8812388738769799, 1.7624777477539597,
      2.7262854238232617, 3.635047231764349,  0.9087618079410872,
      1.7624777477539597, 2.6437166216309396, 3.6350472317643487,
      0.9087618079410873, 1.8175236158821744, 2.6437166216309396,
      3.5249554955079194, 0.9087618079410872, 1.8175236158821746,
      2.7262854238232617, 3.5249554955079194, 0.8812388738769799,
      1.8175236158821744, 2.7262854238232617, 3.6350472317643487,
      0.8812388738769799, 1.7624777477539597, 2.7262854238232617};
  const std::vector<DataType> mean = {2.4444444444444446, 2.5555555555555554,
                                      2.5185185185185186, 2.4814814814814814,
                                      2.4444444444444446};
  const std::vector<DataType> variance = {
      1.2098765432098764, 1.2098765432098768, 1.286694101508916,
      1.2866941015089164, 1.2098765432098768};
  const std::vector<DataType> grad_scale = {
      -119.63586957779859, -133.2672966969148, -123.94128448336184,
      -119.53509011397696, -119.63586957779854};
  const std::vector<DataType> grad_offset = {66., 69., 68., 67., 66.};
  const std::array<int, 4> in_shape = {{3, 1, 9, 5}};
  const auto params = getBatchNormParams(in_shape, DataFormat::NHWC);
  const DataType max_input_val = 4.0;
  this->test_batchnorm(exp_grad, mean, variance, grad_scale, grad_offset,
                       params, max_input_val);
}
TYPED_TEST(BatchnormGradientFrozen, 3x1x9x8) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518};
  const std::vector<DataType> mean = {1., 2., 3., 4., 1., 2., 3., 4.};
  const std::vector<DataType> variance = {0., 0., 0., 0., 0., 0., 0., 0.};
  const std::vector<DataType> grad_scale = {
      -853.814968245462,   -3415.259872981848, -7684.334714209159,
      -13661.039491927391, -853.814968245462,  -3415.259872981848,
      -7684.334714209159,  -13661.039491927391};
  const std::vector<DataType> grad_offset = {27., 54., 81., 108.,
                                             27., 54., 81., 108.};
  const std::array<int, 4> in_shape = {{3, 1, 9, 8}};
  const auto params = getBatchNormParams(in_shape, DataFormat::NHWC);
  const DataType max_input_val = 4.0;
  this->test_batchnorm(exp_grad, mean, variance, grad_scale, grad_offset,
                       params, max_input_val);
}
TYPED_TEST(BatchnormGradientFrozen, 3x8x1x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343};
  const std::vector<DataType> mean = {2.5};
  const std::vector<DataType> variance = {1.25};
  const std::vector<DataType> grad_scale = {-110.1296298487332};
  const std::vector<DataType> grad_offset = {60.};
  const std::array<int, 4> in_shape = {{3, 8, 1, 1}};
  const auto params = getBatchNormParams(in_shape, DataFormat::NHWC);
  const DataType max_input_val = 4.0;
  this->test_batchnorm(exp_grad, mean, variance, grad_scale, grad_offset,
                       params, max_input_val);
}
TYPED_TEST(BatchnormGradientFrozen, 3x8x1x5) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343};
  const std::vector<DataType> mean = {2.5, 2.5, 2.5, 2.5, 2.5};
  const std::vector<DataType> variance = {1.25, 1.25, 1.25, 1.25, 1.25};
  const std::vector<DataType> grad_scale = {
      -110.1296298487332, -110.12962984873322, -110.12962984873322,
      -110.12962984873322, -110.1296298487332};
  const std::vector<DataType> grad_offset = {60., 60., 60., 60., 60.};
  const std::array<int, 4> in_shape = {{3, 8, 1, 5}};
  const auto params = getBatchNormParams(in_shape, DataFormat::NHWC);
  const DataType max_input_val = 4.0;
  this->test_batchnorm(exp_grad, mean, variance, grad_scale, grad_offset,
                       params, max_input_val);
}
TYPED_TEST(BatchnormGradientFrozen, 3x8x1x8) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518};
  const std::vector<DataType> mean = {1., 2., 3., 4., 1., 2., 3., 4.};
  const std::vector<DataType> variance = {0., 0., 0., 0., 0., 0., 0., 0.};
  const std::vector<DataType> grad_scale = {
      -758.9466384404107,  -3035.7865537616426, -6830.5197459636975,
      -12143.14621504657,  -758.9466384404107,  -3035.7865537616426,
      -6830.5197459636975, -12143.14621504657};
  const std::vector<DataType> grad_offset = {24., 48., 72., 96.,
                                             24., 48., 72., 96.};
  const std::array<int, 4> in_shape = {{3, 8, 1, 8}};
  const auto params = getBatchNormParams(in_shape, DataFormat::NHWC);
  const DataType max_input_val = 4.0;
  this->test_batchnorm(exp_grad, mean, variance, grad_scale, grad_offset,
                       params, max_input_val);
}
TYPED_TEST(BatchnormGradientFrozen, 3x8x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343};
  const std::vector<DataType> mean = {2.5};
  const std::vector<DataType> variance = {1.25};
  const std::vector<DataType> grad_scale = {-881.0370387898657};
  const std::vector<DataType> grad_offset = {480.};
  const std::array<int, 4> in_shape = {{3, 8, 8, 1}};
  const auto params = getBatchNormParams(in_shape, DataFormat::NHWC);
  const DataType max_input_val = 4.0;
  this->test_batchnorm(exp_grad, mean, variance, grad_scale, grad_offset,
                       params, max_input_val);
}
TYPED_TEST(BatchnormGradientFrozen, 3x8x8x5) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343};
  const std::vector<DataType> mean = {2.5, 2.5, 2.5, 2.5, 2.5};
  const std::vector<DataType> variance = {1.25, 1.25, 1.25, 1.25, 1.25};
  const std::vector<DataType> grad_scale = {
      -881.0370387898678, -881.0370387898677, -881.0370387898678,
      -881.0370387898678, -881.0370387898678};
  const std::vector<DataType> grad_offset = {480., 480., 480., 480., 480.};
  const std::array<int, 4> in_shape = {{3, 8, 8, 5}};
  const auto params = getBatchNormParams(in_shape, DataFormat::NHWC);
  const DataType max_input_val = 4.0;
  this->test_batchnorm(exp_grad, mean, variance, grad_scale, grad_offset,
                       params, max_input_val);
}
TYPED_TEST(BatchnormGradientFrozen, 3x8x8x8) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518};
  const std::vector<DataType> mean = {1., 2., 3., 4., 1., 2., 3., 4.};
  const std::vector<DataType> variance = {0., 0., 0., 0., 0., 0., 0., 0.};
  const std::vector<DataType> grad_scale = {
      -6071.573107523273,  -24286.292430093094, -54644.157967709405,
      -97145.16972037237,  -6071.573107523273,  -24286.292430093094,
      -54644.157967709405, -97145.16972037237};
  const std::vector<DataType> grad_offset = {192., 384., 576., 768.,
                                             192., 384., 576., 768.};
  const std::array<int, 4> in_shape = {{3, 8, 8, 8}};
  const auto params = getBatchNormParams(in_shape, DataFormat::NHWC);
  const DataType max_input_val = 4.0;
  this->test_batchnorm(exp_grad, mean, variance, grad_scale, grad_offset,
                       params, max_input_val);
}
TYPED_TEST(BatchnormGradientFrozen, 3x8x9x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343};
  const std::vector<DataType> mean = {2.5};
  const std::vector<DataType> variance = {1.25};
  const std::vector<DataType> grad_scale = {-991.166668638599};
  const std::vector<DataType> grad_offset = {540.};
  const std::array<int, 4> in_shape = {{3, 8, 9, 1}};
  const auto params = getBatchNormParams(in_shape, DataFormat::NHWC);
  const DataType max_input_val = 4.0;
  this->test_batchnorm(exp_grad, mean, variance, grad_scale, grad_offset,
                       params, max_input_val);
}
TYPED_TEST(BatchnormGradientFrozen, 3x8x9x5) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343};
  const std::vector<DataType> mean = {2.5, 2.5, 2.5, 2.5, 2.5};
  const std::vector<DataType> variance = {1.25, 1.25, 1.25, 1.25, 1.25};
  const std::vector<DataType> grad_scale = {
      -991.1666686386017, -991.1666686386015, -991.1666686386017,
      -991.1666686386017, -991.1666686386017};
  const std::vector<DataType> grad_offset = {540., 540., 540., 540., 540.};
  const std::array<int, 4> in_shape = {{3, 8, 9, 5}};
  const auto params = getBatchNormParams(in_shape, DataFormat::NHWC);
  const DataType max_input_val = 4.0;
  this->test_batchnorm(exp_grad, mean, variance, grad_scale, grad_offset,
                       params, max_input_val);
}
TYPED_TEST(BatchnormGradientFrozen, 3x8x9x8) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518};
  const std::vector<DataType> mean = {1., 2., 3., 4., 1., 2., 3., 4.};
  const std::vector<DataType> variance = {0., 0., 0., 0., 0., 0., 0., 0.};
  const std::vector<DataType> grad_scale = {
      -6830.519745963681, -27322.078983854724, -61474.67771367303,
      -109288.3159354189, -6830.519745963681,  -27322.078983854724,
      -61474.67771367303, -109288.3159354189};
  const std::vector<DataType> grad_offset = {216., 432., 648., 864.,
                                             216., 432., 648., 864.};
  const std::array<int, 4> in_shape = {{3, 8, 9, 8}};
  const auto params = getBatchNormParams(in_shape, DataFormat::NHWC);
  const DataType max_input_val = 4.0;
  this->test_batchnorm(exp_grad, mean, variance, grad_scale, grad_offset,
                       params, max_input_val);
}
TYPED_TEST(BatchnormGradientFrozen, 3x9x1x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.9087618079410872, 1.8175236158821744, 2.7262854238232617,
      3.6350472317643487, 0.9087618079410872, 1.8175236158821744,
      2.7262854238232617, 3.6350472317643487, 0.9087618079410872,
      1.8175236158821744, 2.7262854238232617, 3.6350472317643487,
      0.9087618079410872, 1.8175236158821744, 2.7262854238232617,
      3.6350472317643487, 0.9087618079410872, 1.8175236158821744,
      2.7262854238232617, 3.6350472317643487, 0.9087618079410872,
      1.8175236158821744, 2.7262854238232617, 3.6350472317643487,
      0.9087618079410872, 1.8175236158821744, 2.7262854238232617};
  const std::vector<DataType> mean = {2.4444444444444446};
  const std::vector<DataType> variance = {1.2098765432098768};
  const std::vector<DataType> grad_scale = {-119.63586957779852};
  const std::vector<DataType> grad_offset = {66.};
  const std::array<int, 4> in_shape = {{3, 9, 1, 1}};
  const auto params = getBatchNormParams(in_shape, DataFormat::NHWC);
  const DataType max_input_val = 4.0;
  this->test_batchnorm(exp_grad, mean, variance, grad_scale, grad_offset,
                       params, max_input_val);
}
TYPED_TEST(BatchnormGradientFrozen, 3x9x1x5) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.9087618079410873, 1.8175236158821744, 2.6437166216309396,
      3.5249554955079194, 0.9087618079410872, 1.8175236158821746,
      2.7262854238232617, 3.5249554955079194, 0.8812388738769799,
      1.8175236158821744, 2.7262854238232617, 3.6350472317643487,
      0.8812388738769799, 1.7624777477539597, 2.7262854238232617,
      3.635047231764349,  0.9087618079410872, 1.7624777477539597,
      2.6437166216309396, 3.6350472317643487, 0.9087618079410873,
      1.8175236158821744, 2.6437166216309396, 3.5249554955079194,
      0.9087618079410872, 1.8175236158821746, 2.7262854238232617,
      3.5249554955079194, 0.8812388738769799, 1.8175236158821744,
      2.7262854238232617, 3.6350472317643487, 0.8812388738769799,
      1.7624777477539597, 2.7262854238232617, 3.635047231764349,
      0.9087618079410872, 1.7624777477539597, 2.6437166216309396,
      3.6350472317643487, 0.9087618079410873, 1.8175236158821744,
      2.6437166216309396, 3.5249554955079194, 0.9087618079410872,
      1.8175236158821746, 2.7262854238232617, 3.5249554955079194,
      0.8812388738769799, 1.8175236158821744, 2.7262854238232617,
      3.6350472317643487, 0.8812388738769799, 1.7624777477539597,
      2.7262854238232617, 3.635047231764349,  0.9087618079410872,
      1.7624777477539597, 2.6437166216309396, 3.6350472317643487,
      0.9087618079410873, 1.8175236158821744, 2.6437166216309396,
      3.5249554955079194, 0.9087618079410872, 1.8175236158821746,
      2.7262854238232617, 3.5249554955079194, 0.8812388738769799,
      1.8175236158821744, 2.7262854238232617, 3.6350472317643487,
      0.8812388738769799, 1.7624777477539597, 2.7262854238232617,
      3.635047231764349,  0.9087618079410872, 1.7624777477539597,
      2.6437166216309396, 3.6350472317643487, 0.9087618079410873,
      1.8175236158821744, 2.6437166216309396, 3.5249554955079194,
      0.9087618079410872, 1.8175236158821746, 2.7262854238232617,
      3.5249554955079194, 0.8812388738769799, 1.8175236158821744,
      2.7262854238232617, 3.6350472317643487, 0.8812388738769799,
      1.7624777477539597, 2.7262854238232617, 3.635047231764349,
      0.9087618079410872, 1.7624777477539597, 2.6437166216309396,
      3.6350472317643487, 0.9087618079410873, 1.8175236158821744,
      2.6437166216309396, 3.5249554955079194, 0.9087618079410872,
      1.8175236158821746, 2.7262854238232617, 3.5249554955079194,
      0.8812388738769799, 1.8175236158821744, 2.7262854238232617,
      3.6350472317643487, 0.8812388738769799, 1.7624777477539597,
      2.7262854238232617, 3.635047231764349,  0.9087618079410872,
      1.7624777477539597, 2.6437166216309396, 3.6350472317643487,
      0.9087618079410873, 1.8175236158821744, 2.6437166216309396,
      3.5249554955079194, 0.9087618079410872, 1.8175236158821746,
      2.7262854238232617, 3.5249554955079194, 0.8812388738769799,
      1.8175236158821744, 2.7262854238232617, 3.6350472317643487,
      0.8812388738769799, 1.7624777477539597, 2.7262854238232617};
  const std::vector<DataType> mean = {2.4444444444444446, 2.5555555555555554,
                                      2.5185185185185186, 2.4814814814814814,
                                      2.4444444444444446};
  const std::vector<DataType> variance = {
      1.2098765432098764, 1.2098765432098768, 1.286694101508916,
      1.2866941015089164, 1.2098765432098768};
  const std::vector<DataType> grad_scale = {
      -119.63586957779859, -133.2672966969148, -123.94128448336184,
      -119.53509011397696, -119.63586957779854};
  const std::vector<DataType> grad_offset = {66., 69., 68., 67., 66.};
  const std::array<int, 4> in_shape = {{3, 9, 1, 5}};
  const auto params = getBatchNormParams(in_shape, DataFormat::NHWC);
  const DataType max_input_val = 4.0;
  this->test_batchnorm(exp_grad, mean, variance, grad_scale, grad_offset,
                       params, max_input_val);
}
TYPED_TEST(BatchnormGradientFrozen, 3x9x1x8) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518};
  const std::vector<DataType> mean = {1., 2., 3., 4., 1., 2., 3., 4.};
  const std::vector<DataType> variance = {0., 0., 0., 0., 0., 0., 0., 0.};
  const std::vector<DataType> grad_scale = {
      -853.814968245462,   -3415.259872981848, -7684.334714209159,
      -13661.039491927391, -853.814968245462,  -3415.259872981848,
      -7684.334714209159,  -13661.039491927391};
  const std::vector<DataType> grad_offset = {27., 54., 81., 108.,
                                             27., 54., 81., 108.};
  const std::array<int, 4> in_shape = {{3, 9, 1, 8}};
  const auto params = getBatchNormParams(in_shape, DataFormat::NHWC);
  const DataType max_input_val = 4.0;
  this->test_batchnorm(exp_grad, mean, variance, grad_scale, grad_offset,
                       params, max_input_val);
}
TYPED_TEST(BatchnormGradientFrozen, 3x9x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343};
  const std::vector<DataType> mean = {2.5};
  const std::vector<DataType> variance = {1.25};
  const std::vector<DataType> grad_scale = {-991.166668638599};
  const std::vector<DataType> grad_offset = {540.};
  const std::array<int, 4> in_shape = {{3, 9, 8, 1}};
  const auto params = getBatchNormParams(in_shape, DataFormat::NHWC);
  const DataType max_input_val = 4.0;
  this->test_batchnorm(exp_grad, mean, variance, grad_scale, grad_offset,
                       params, max_input_val);
}
TYPED_TEST(BatchnormGradientFrozen, 3x9x8x5) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343,
      0.8940696346430336, 1.7881392692860671, 2.6822089039291006,
      3.5762785385721343, 0.8940696346430336, 1.7881392692860671,
      2.6822089039291006, 3.5762785385721343, 0.8940696346430336,
      1.7881392692860671, 2.6822089039291006, 3.5762785385721343};
  const std::vector<DataType> mean = {2.5, 2.5, 2.5, 2.5, 2.5};
  const std::vector<DataType> variance = {1.25, 1.25, 1.25, 1.25, 1.25};
  const std::vector<DataType> grad_scale = {
      -991.1666686386017, -991.1666686386015, -991.1666686386017,
      -991.1666686386017, -991.1666686386017};
  const std::vector<DataType> grad_offset = {540., 540., 540., 540., 540.};
  const std::array<int, 4> in_shape = {{3, 9, 8, 5}};
  const auto params = getBatchNormParams(in_shape, DataFormat::NHWC);
  const DataType max_input_val = 4.0;
  this->test_batchnorm(exp_grad, mean, variance, grad_scale, grad_offset,
                       params, max_input_val);
}
TYPED_TEST(BatchnormGradientFrozen, 3x9x8x8) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518};
  const std::vector<DataType> mean = {1., 2., 3., 4., 1., 2., 3., 4.};
  const std::vector<DataType> variance = {0., 0., 0., 0., 0., 0., 0., 0.};
  const std::vector<DataType> grad_scale = {
      -6830.519745963681, -27322.078983854724, -61474.67771367303,
      -109288.3159354189, -6830.519745963681,  -27322.078983854724,
      -61474.67771367303, -109288.3159354189};
  const std::vector<DataType> grad_offset = {216., 432., 648., 864.,
                                             216., 432., 648., 864.};
  const std::array<int, 4> in_shape = {{3, 9, 8, 8}};
  const auto params = getBatchNormParams(in_shape, DataFormat::NHWC);
  const DataType max_input_val = 4.0;
  this->test_batchnorm(exp_grad, mean, variance, grad_scale, grad_offset,
                       params, max_input_val);
}
TYPED_TEST(BatchnormGradientFrozen, 3x9x9x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.8955574997317551, 1.7911149994635103, 2.6866724991952653,
      3.5822299989270205, 0.8955574997317551, 1.7911149994635103,
      2.6866724991952653, 3.5822299989270205, 0.8955574997317551,
      1.7911149994635103, 2.6866724991952653, 3.5822299989270205,
      0.8955574997317551, 1.7911149994635103, 2.6866724991952653,
      3.5822299989270205, 0.8955574997317551, 1.7911149994635103,
      2.6866724991952653, 3.5822299989270205, 0.8955574997317551,
      1.7911149994635103, 2.6866724991952653, 3.5822299989270205,
      0.8955574997317551, 1.7911149994635103, 2.6866724991952653,
      3.5822299989270205, 0.8955574997317551, 1.7911149994635103,
      2.6866724991952653, 3.5822299989270205, 0.8955574997317551,
      1.7911149994635103, 2.6866724991952653, 3.5822299989270205,
      0.8955574997317551, 1.7911149994635103, 2.6866724991952653,
      3.5822299989270205, 0.8955574997317551, 1.7911149994635103,
      2.6866724991952653, 3.5822299989270205, 0.8955574997317551,
      1.7911149994635103, 2.6866724991952653, 3.5822299989270205,
      0.8955574997317551, 1.7911149994635103, 2.6866724991952653,
      3.5822299989270205, 0.8955574997317551, 1.7911149994635103,
      2.6866724991952653, 3.5822299989270205, 0.8955574997317551,
      1.7911149994635103, 2.6866724991952653, 3.5822299989270205,
      0.8955574997317551, 1.7911149994635103, 2.6866724991952653,
      3.5822299989270205, 0.8955574997317551, 1.7911149994635103,
      2.6866724991952653, 3.5822299989270205, 0.8955574997317551,
      1.7911149994635103, 2.6866724991952653, 3.5822299989270205,
      0.8955574997317551, 1.7911149994635103, 2.6866724991952653,
      3.5822299989270205, 0.8955574997317551, 1.7911149994635103,
      2.6866724991952653, 3.5822299989270205, 0.8955574997317551,
      1.7911149994635103, 2.6866724991952653, 3.5822299989270205,
      0.8955574997317551, 1.7911149994635103, 2.6866724991952653,
      3.5822299989270205, 0.8955574997317551, 1.7911149994635103,
      2.6866724991952653, 3.5822299989270205, 0.8955574997317551,
      1.7911149994635103, 2.6866724991952653, 3.5822299989270205,
      0.8955574997317551, 1.7911149994635103, 2.6866724991952653,
      3.5822299989270205, 0.8955574997317551, 1.7911149994635103,
      2.6866724991952653, 3.5822299989270205, 0.8955574997317551,
      1.7911149994635103, 2.6866724991952653, 3.5822299989270205,
      0.8955574997317551, 1.7911149994635103, 2.6866724991952653,
      3.5822299989270205, 0.8955574997317551, 1.7911149994635103,
      2.6866724991952653, 3.5822299989270205, 0.8955574997317551,
      1.7911149994635103, 2.6866724991952653, 3.5822299989270205,
      0.8955574997317551, 1.7911149994635103, 2.6866724991952653,
      3.5822299989270205, 0.8955574997317551, 1.7911149994635103,
      2.6866724991952653, 3.5822299989270205, 0.8955574997317551,
      1.7911149994635103, 2.6866724991952653, 3.5822299989270205,
      0.8955574997317551, 1.7911149994635103, 2.6866724991952653,
      3.5822299989270205, 0.8955574997317551, 1.7911149994635103,
      2.6866724991952653, 3.5822299989270205, 0.8955574997317551,
      1.7911149994635103, 2.6866724991952653, 3.5822299989270205,
      0.8955574997317551, 1.7911149994635103, 2.6866724991952653,
      3.5822299989270205, 0.8955574997317551, 1.7911149994635103,
      2.6866724991952653, 3.5822299989270205, 0.8955574997317551,
      1.7911149994635103, 2.6866724991952653, 3.5822299989270205,
      0.8955574997317551, 1.7911149994635103, 2.6866724991952653,
      3.5822299989270205, 0.8955574997317551, 1.7911149994635103,
      2.6866724991952653, 3.5822299989270205, 0.8955574997317551,
      1.7911149994635103, 2.6866724991952653, 3.5822299989270205,
      0.8955574997317551, 1.7911149994635103, 2.6866724991952653,
      3.5822299989270205, 0.8955574997317551, 1.7911149994635103,
      2.6866724991952653, 3.5822299989270205, 0.8955574997317551,
      1.7911149994635103, 2.6866724991952653, 3.5822299989270205,
      0.8955574997317551, 1.7911149994635103, 2.6866724991952653,
      3.5822299989270205, 0.8955574997317551, 1.7911149994635103,
      2.6866724991952653, 3.5822299989270205, 0.8955574997317551,
      1.7911149994635103, 2.6866724991952653, 3.5822299989270205,
      0.8955574997317551, 1.7911149994635103, 2.6866724991952653,
      3.5822299989270205, 0.8955574997317551, 1.7911149994635103,
      2.6866724991952653, 3.5822299989270205, 0.8955574997317551,
      1.7911149994635103, 2.6866724991952653, 3.5822299989270205,
      0.8955574997317551, 1.7911149994635103, 2.6866724991952653,
      3.5822299989270205, 0.8955574997317551, 1.7911149994635103,
      2.6866724991952653, 3.5822299989270205, 0.8955574997317551,
      1.7911149994635103, 2.6866724991952653, 3.5822299989270205,
      0.8955574997317551, 1.7911149994635103, 2.6866724991952653,
      3.5822299989270205, 0.8955574997317551, 1.7911149994635103,
      2.6866724991952653, 3.5822299989270205, 0.8955574997317551,
      1.7911149994635103, 2.6866724991952653, 3.5822299989270205,
      0.8955574997317551, 1.7911149994635103, 2.6866724991952653,
      3.5822299989270205, 0.8955574997317551, 1.7911149994635103,
      2.6866724991952653, 3.5822299989270205, 0.8955574997317551,
      1.7911149994635103, 2.6866724991952653, 3.5822299989270205,
      0.8955574997317551, 1.7911149994635103, 2.6866724991952653};
  const std::vector<DataType> mean = {2.493827160493827};
  const std::vector<DataType> variance = {1.2458466697149824};
  const std::vector<DataType> grad_scale = {-1110.6144553148704};
  const std::vector<DataType> grad_offset = {606.};
  const std::array<int, 4> in_shape = {{3, 9, 9, 1}};
  const auto params = getBatchNormParams(in_shape, DataFormat::NHWC);
  const DataType max_input_val = 4.0;
  this->test_batchnorm(exp_grad, mean, variance, grad_scale, grad_offset,
                       params, max_input_val);
}
TYPED_TEST(BatchnormGradientFrozen, 3x9x9x5) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      0.8955574997317548, 1.7911149994635096, 2.6778126454176077,
      3.57041686055681,   0.8955574997317549, 1.7911149994635096,
      2.6866724991952644, 3.57041686055681,   0.8926042151392025,
      1.7911149994635098, 2.6866724991952644, 3.582229998927019,
      0.8926042151392025, 1.785208430278405,  2.686672499195265,
      3.582229998927019,  0.8955574997317548, 1.785208430278405,
      2.6778126454176077, 3.5822299989270197, 0.8955574997317548,
      1.7911149994635096, 2.6778126454176077, 3.57041686055681,
      0.8955574997317549, 1.7911149994635096, 2.6866724991952644,
      3.57041686055681,   0.8926042151392025, 1.7911149994635098,
      2.6866724991952644, 3.582229998927019,  0.8926042151392025,
      1.785208430278405,  2.686672499195265,  3.582229998927019,
      0.8955574997317548, 1.785208430278405,  2.6778126454176077,
      3.5822299989270197, 0.8955574997317548, 1.7911149994635096,
      2.6778126454176077, 3.57041686055681,   0.8955574997317549,
      1.7911149994635096, 2.6866724991952644, 3.57041686055681,
      0.8926042151392025, 1.7911149994635098, 2.6866724991952644,
      3.582229998927019,  0.8926042151392025, 1.785208430278405,
      2.686672499195265,  3.582229998927019,  0.8955574997317548,
      1.785208430278405,  2.6778126454176077, 3.5822299989270197,
      0.8955574997317548, 1.7911149994635096, 2.6778126454176077,
      3.57041686055681,   0.8955574997317549, 1.7911149994635096,
      2.6866724991952644, 3.57041686055681,   0.8926042151392025,
      1.7911149994635098, 2.6866724991952644, 3.582229998927019,
      0.8926042151392025, 1.785208430278405,  2.686672499195265,
      3.582229998927019,  0.8955574997317548, 1.785208430278405,
      2.6778126454176077, 3.5822299989270197, 0.8955574997317548,
      1.7911149994635096, 2.6778126454176077, 3.57041686055681,
      0.8955574997317549, 1.7911149994635096, 2.6866724991952644,
      3.57041686055681,   0.8926042151392025, 1.7911149994635098,
      2.6866724991952644, 3.582229998927019,  0.8926042151392025,
      1.785208430278405,  2.686672499195265,  3.582229998927019,
      0.8955574997317548, 1.785208430278405,  2.6778126454176077,
      3.5822299989270197, 0.8955574997317548, 1.7911149994635096,
      2.6778126454176077, 3.57041686055681,   0.8955574997317549,
      1.7911149994635096, 2.6866724991952644, 3.57041686055681,
      0.8926042151392025, 1.7911149994635098, 2.6866724991952644,
      3.582229998927019,  0.8926042151392025, 1.785208430278405,
      2.686672499195265,  3.582229998927019,  0.8955574997317548,
      1.785208430278405,  2.6778126454176077, 3.5822299989270197,
      0.8955574997317548, 1.7911149994635096, 2.6778126454176077,
      3.57041686055681,   0.8955574997317549, 1.7911149994635096,
      2.6866724991952644, 3.57041686055681,   0.8926042151392025,
      1.7911149994635098, 2.6866724991952644, 3.582229998927019,
      0.8926042151392025, 1.785208430278405,  2.686672499195265,
      3.582229998927019,  0.8955574997317548, 1.785208430278405,
      2.6778126454176077, 3.5822299989270197, 0.8955574997317548,
      1.7911149994635096, 2.6778126454176077, 3.57041686055681,
      0.8955574997317549, 1.7911149994635096, 2.6866724991952644,
      3.57041686055681,   0.8926042151392025, 1.7911149994635098,
      2.6866724991952644, 3.582229998927019,  0.8926042151392025,
      1.785208430278405,  2.686672499195265,  3.582229998927019,
      0.8955574997317548, 1.785208430278405,  2.6778126454176077,
      3.5822299989270197, 0.8955574997317548, 1.7911149994635096,
      2.6778126454176077, 3.57041686055681,   0.8955574997317549,
      1.7911149994635096, 2.6866724991952644, 3.57041686055681,
      0.8926042151392025, 1.7911149994635098, 2.6866724991952644,
      3.582229998927019,  0.8926042151392025, 1.785208430278405,
      2.686672499195265,  3.582229998927019,  0.8955574997317548,
      1.785208430278405,  2.6778126454176077, 3.5822299989270197,
      0.8955574997317548, 1.7911149994635096, 2.6778126454176077,
      3.57041686055681,   0.8955574997317549, 1.7911149994635096,
      2.6866724991952644, 3.57041686055681,   0.8926042151392025,
      1.7911149994635098, 2.6866724991952644, 3.582229998927019,
      0.8926042151392025, 1.785208430278405,  2.686672499195265,
      3.582229998927019,  0.8955574997317548, 1.785208430278405,
      2.6778126454176077, 3.5822299989270197, 0.8955574997317548,
      1.7911149994635096, 2.6778126454176077, 3.57041686055681,
      0.8955574997317549, 1.7911149994635096, 2.6866724991952644,
      3.57041686055681,   0.8926042151392025, 1.7911149994635098,
      2.6866724991952644, 3.582229998927019,  0.8926042151392025,
      1.785208430278405,  2.686672499195265,  3.582229998927019,
      0.8955574997317548, 1.785208430278405,  2.6778126454176077,
      3.5822299989270197, 0.8955574997317548, 1.7911149994635096,
      2.6778126454176077, 3.57041686055681,   0.8955574997317549,
      1.7911149994635096, 2.6866724991952644, 3.57041686055681,
      0.8926042151392025, 1.7911149994635098, 2.6866724991952644,
      3.582229998927019,  0.8926042151392025, 1.785208430278405,
      2.686672499195265,  3.582229998927019,  0.8955574997317548,
      1.785208430278405,  2.6778126454176077, 3.5822299989270197,
      0.8955574997317548, 1.7911149994635096, 2.6778126454176077,
      3.57041686055681,   0.8955574997317549, 1.7911149994635096,
      2.6866724991952644, 3.57041686055681,   0.8926042151392025,
      1.7911149994635098, 2.6866724991952644, 3.582229998927019,
      0.8926042151392025, 1.785208430278405,  2.686672499195265,
      3.582229998927019,  0.8955574997317548, 1.785208430278405,
      2.6778126454176077, 3.5822299989270197, 0.8955574997317548,
      1.7911149994635096, 2.6778126454176077, 3.57041686055681,
      0.8955574997317549, 1.7911149994635096, 2.6866724991952644,
      3.57041686055681,   0.8926042151392025, 1.7911149994635098,
      2.6866724991952644, 3.582229998927019,  0.8926042151392025,
      1.785208430278405,  2.686672499195265,  3.582229998927019,
      0.8955574997317548, 1.785208430278405,  2.6778126454176077,
      3.5822299989270197, 0.8955574997317548, 1.7911149994635096,
      2.6778126454176077, 3.57041686055681,   0.8955574997317549,
      1.7911149994635096, 2.6866724991952644, 3.57041686055681,
      0.8926042151392025, 1.7911149994635098, 2.6866724991952644,
      3.582229998927019,  0.8926042151392025, 1.785208430278405,
      2.686672499195265,  3.582229998927019,  0.8955574997317548,
      1.785208430278405,  2.6778126454176077, 3.5822299989270197,
      0.8955574997317548, 1.7911149994635096, 2.6778126454176077,
      3.57041686055681,   0.8955574997317549, 1.7911149994635096,
      2.6866724991952644, 3.57041686055681,   0.8926042151392025,
      1.7911149994635098, 2.6866724991952644, 3.582229998927019,
      0.8926042151392025, 1.785208430278405,  2.686672499195265,
      3.582229998927019,  0.8955574997317548, 1.785208430278405,
      2.6778126454176077, 3.5822299989270197, 0.8955574997317548,
      1.7911149994635096, 2.6778126454176077, 3.57041686055681,
      0.8955574997317549, 1.7911149994635096, 2.6866724991952644,
      3.57041686055681,   0.8926042151392025, 1.7911149994635098,
      2.6866724991952644, 3.582229998927019,  0.8926042151392025,
      1.785208430278405,  2.686672499195265,  3.582229998927019,
      0.8955574997317548, 1.785208430278405,  2.6778126454176077,
      3.5822299989270197, 0.8955574997317548, 1.7911149994635096,
      2.6778126454176077, 3.57041686055681,   0.8955574997317549,
      1.7911149994635096, 2.6866724991952644, 3.57041686055681,
      0.8926042151392025, 1.7911149994635098, 2.6866724991952644,
      3.582229998927019,  0.8926042151392025, 1.785208430278405,
      2.686672499195265,  3.582229998927019,  0.8955574997317548,
      1.785208430278405,  2.6778126454176077, 3.5822299989270197,
      0.8955574997317548, 1.7911149994635096, 2.6778126454176077,
      3.57041686055681,   0.8955574997317549, 1.7911149994635096,
      2.6866724991952644, 3.57041686055681,   0.8926042151392025,
      1.7911149994635098, 2.6866724991952644, 3.582229998927019,
      0.8926042151392025, 1.785208430278405,  2.686672499195265,
      3.582229998927019,  0.8955574997317548, 1.785208430278405,
      2.6778126454176077, 3.5822299989270197, 0.8955574997317548,
      1.7911149994635096, 2.6778126454176077, 3.57041686055681,
      0.8955574997317549, 1.7911149994635096, 2.6866724991952644,
      3.57041686055681,   0.8926042151392025, 1.7911149994635098,
      2.6866724991952644, 3.582229998927019,  0.8926042151392025,
      1.785208430278405,  2.686672499195265,  3.582229998927019,
      0.8955574997317548, 1.785208430278405,  2.6778126454176077,
      3.5822299989270197, 0.8955574997317548, 1.7911149994635096,
      2.6778126454176077, 3.57041686055681,   0.8955574997317549,
      1.7911149994635096, 2.6866724991952644, 3.57041686055681,
      0.8926042151392025, 1.7911149994635098, 2.6866724991952644,
      3.582229998927019,  0.8926042151392025, 1.785208430278405,
      2.686672499195265,  3.582229998927019,  0.8955574997317548,
      1.785208430278405,  2.6778126454176077, 3.5822299989270197,
      0.8955574997317548, 1.7911149994635096, 2.6778126454176077,
      3.57041686055681,   0.8955574997317549, 1.7911149994635096,
      2.6866724991952644, 3.57041686055681,   0.8926042151392025,
      1.7911149994635098, 2.6866724991952644, 3.582229998927019,
      0.8926042151392025, 1.785208430278405,  2.686672499195265,
      3.582229998927019,  0.8955574997317548, 1.785208430278405,
      2.6778126454176077, 3.5822299989270197, 0.8955574997317548,
      1.7911149994635096, 2.6778126454176077, 3.57041686055681,
      0.8955574997317549, 1.7911149994635096, 2.6866724991952644,
      3.57041686055681,   0.8926042151392025, 1.7911149994635098,
      2.6866724991952644, 3.582229998927019,  0.8926042151392025,
      1.785208430278405,  2.686672499195265,  3.582229998927019,
      0.8955574997317548, 1.785208430278405,  2.6778126454176077,
      3.5822299989270197, 0.8955574997317548, 1.7911149994635096,
      2.6778126454176077, 3.57041686055681,   0.8955574997317549,
      1.7911149994635096, 2.6866724991952644, 3.57041686055681,
      0.8926042151392025, 1.7911149994635098, 2.6866724991952644,
      3.582229998927019,  0.8926042151392025, 1.785208430278405,
      2.686672499195265,  3.582229998927019,  0.8955574997317548,
      1.785208430278405,  2.6778126454176077, 3.5822299989270197,
      0.8955574997317548, 1.7911149994635096, 2.6778126454176077,
      3.57041686055681,   0.8955574997317549, 1.7911149994635096,
      2.6866724991952644, 3.57041686055681,   0.8926042151392025,
      1.7911149994635098, 2.6866724991952644, 3.582229998927019,
      0.8926042151392025, 1.785208430278405,  2.686672499195265,
      3.582229998927019,  0.8955574997317548, 1.785208430278405,
      2.6778126454176077, 3.5822299989270197, 0.8955574997317548,
      1.7911149994635096, 2.6778126454176077, 3.57041686055681,
      0.8955574997317549, 1.7911149994635096, 2.6866724991952644,
      3.57041686055681,   0.8926042151392025, 1.7911149994635098,
      2.6866724991952644, 3.582229998927019,  0.8926042151392025,
      1.785208430278405,  2.686672499195265,  3.582229998927019,
      0.8955574997317548, 1.785208430278405,  2.6778126454176077,
      3.5822299989270197, 0.8955574997317548, 1.7911149994635096,
      2.6778126454176077, 3.57041686055681,   0.8955574997317549,
      1.7911149994635096, 2.6866724991952644, 3.57041686055681,
      0.8926042151392025, 1.7911149994635098, 2.6866724991952644,
      3.582229998927019,  0.8926042151392025, 1.785208430278405,
      2.686672499195265,  3.582229998927019,  0.8955574997317548,
      1.785208430278405,  2.6778126454176077, 3.5822299989270197,
      0.8955574997317548, 1.7911149994635096, 2.6778126454176077,
      3.57041686055681,   0.8955574997317549, 1.7911149994635096,
      2.6866724991952644, 3.57041686055681,   0.8926042151392025,
      1.7911149994635098, 2.6866724991952644, 3.582229998927019,
      0.8926042151392025, 1.785208430278405,  2.686672499195265,
      3.582229998927019,  0.8955574997317548, 1.785208430278405,
      2.6778126454176077, 3.5822299989270197, 0.8955574997317548,
      1.7911149994635096, 2.6778126454176077, 3.57041686055681,
      0.8955574997317549, 1.7911149994635096, 2.6866724991952644,
      3.57041686055681,   0.8926042151392025, 1.7911149994635098,
      2.6866724991952644, 3.582229998927019,  0.8926042151392025,
      1.785208430278405,  2.686672499195265,  3.582229998927019,
      0.8955574997317548, 1.785208430278405,  2.6778126454176077,
      3.5822299989270197, 0.8955574997317548, 1.7911149994635096,
      2.6778126454176077, 3.57041686055681,   0.8955574997317549,
      1.7911149994635096, 2.6866724991952644, 3.57041686055681,
      0.8926042151392025, 1.7911149994635098, 2.6866724991952644,
      3.582229998927019,  0.8926042151392025, 1.785208430278405,
      2.686672499195265,  3.582229998927019,  0.8955574997317548,
      1.785208430278405,  2.6778126454176077, 3.5822299989270197,
      0.8955574997317548, 1.7911149994635096, 2.6778126454176077,
      3.57041686055681,   0.8955574997317549, 1.7911149994635096,
      2.6866724991952644, 3.57041686055681,   0.8926042151392025,
      1.7911149994635098, 2.6866724991952644, 3.582229998927019,
      0.8926042151392025, 1.785208430278405,  2.686672499195265,
      3.582229998927019,  0.8955574997317548, 1.785208430278405,
      2.6778126454176077, 3.5822299989270197, 0.8955574997317548,
      1.7911149994635096, 2.6778126454176077, 3.57041686055681,
      0.8955574997317549, 1.7911149994635096, 2.6866724991952644,
      3.57041686055681,   0.8926042151392025, 1.7911149994635098,
      2.6866724991952644, 3.582229998927019,  0.8926042151392025,
      1.785208430278405,  2.686672499195265,  3.582229998927019,
      0.8955574997317548, 1.785208430278405,  2.6778126454176077,
      3.5822299989270197, 0.8955574997317548, 1.7911149994635096,
      2.6778126454176077, 3.57041686055681,   0.8955574997317549,
      1.7911149994635096, 2.6866724991952644, 3.57041686055681,
      0.8926042151392025, 1.7911149994635098, 2.6866724991952644,
      3.582229998927019,  0.8926042151392025, 1.785208430278405,
      2.686672499195265,  3.582229998927019,  0.8955574997317548,
      1.785208430278405,  2.6778126454176077, 3.5822299989270197,
      0.8955574997317548, 1.7911149994635096, 2.6778126454176077,
      3.57041686055681,   0.8955574997317549, 1.7911149994635096,
      2.6866724991952644, 3.57041686055681,   0.8926042151392025,
      1.7911149994635098, 2.6866724991952644, 3.582229998927019,
      0.8926042151392025, 1.785208430278405,  2.686672499195265,
      3.582229998927019,  0.8955574997317548, 1.785208430278405,
      2.6778126454176077, 3.5822299989270197, 0.8955574997317548,
      1.7911149994635096, 2.6778126454176077, 3.57041686055681,
      0.8955574997317549, 1.7911149994635096, 2.6866724991952644,
      3.57041686055681,   0.8926042151392025, 1.7911149994635098,
      2.6866724991952644, 3.582229998927019,  0.8926042151392025,
      1.785208430278405,  2.686672499195265,  3.582229998927019,
      0.8955574997317548, 1.785208430278405,  2.6778126454176077,
      3.5822299989270197, 0.8955574997317548, 1.7911149994635096,
      2.6778126454176077, 3.57041686055681,   0.8955574997317549,
      1.7911149994635096, 2.6866724991952644, 3.57041686055681,
      0.8926042151392025, 1.7911149994635098, 2.6866724991952644,
      3.582229998927019,  0.8926042151392025, 1.785208430278405,
      2.686672499195265,  3.582229998927019,  0.8955574997317548,
      1.785208430278405,  2.6778126454176077, 3.5822299989270197,
      0.8955574997317548, 1.7911149994635096, 2.6778126454176077,
      3.57041686055681,   0.8955574997317549, 1.7911149994635096,
      2.6866724991952644, 3.57041686055681,   0.8926042151392025,
      1.7911149994635098, 2.6866724991952644, 3.582229998927019,
      0.8926042151392025, 1.785208430278405,  2.686672499195265,
      3.582229998927019,  0.8955574997317548, 1.785208430278405,
      2.6778126454176077, 3.5822299989270197, 0.8955574997317548,
      1.7911149994635096, 2.6778126454176077, 3.57041686055681,
      0.8955574997317549, 1.7911149994635096, 2.6866724991952644,
      3.57041686055681,   0.8926042151392025, 1.7911149994635098,
      2.6866724991952644, 3.582229998927019,  0.8926042151392025,
      1.785208430278405,  2.686672499195265,  3.582229998927019,
      0.8955574997317548, 1.785208430278405,  2.6778126454176077,
      3.5822299989270197, 0.8955574997317548, 1.7911149994635096,
      2.6778126454176077, 3.57041686055681,   0.8955574997317549,
      1.7911149994635096, 2.6866724991952644, 3.57041686055681,
      0.8926042151392025, 1.7911149994635098, 2.6866724991952644,
      3.582229998927019,  0.8926042151392025, 1.785208430278405,
      2.686672499195265,  3.582229998927019,  0.8955574997317548,
      1.785208430278405,  2.6778126454176077, 3.5822299989270197,
      0.8955574997317548, 1.7911149994635096, 2.6778126454176077,
      3.57041686055681,   0.8955574997317549, 1.7911149994635096,
      2.6866724991952644, 3.57041686055681,   0.8926042151392025,
      1.7911149994635098, 2.6866724991952644, 3.582229998927019,
      0.8926042151392025, 1.785208430278405,  2.686672499195265,
      3.582229998927019,  0.8955574997317548, 1.785208430278405,
      2.6778126454176077, 3.5822299989270197, 0.8955574997317548,
      1.7911149994635096, 2.6778126454176077, 3.57041686055681,
      0.8955574997317549, 1.7911149994635096, 2.6866724991952644,
      3.57041686055681,   0.8926042151392025, 1.7911149994635098,
      2.6866724991952644, 3.582229998927019,  0.8926042151392025,
      1.785208430278405,  2.686672499195265,  3.582229998927019,
      0.8955574997317548, 1.785208430278405,  2.6778126454176077,
      3.5822299989270197, 0.8955574997317548, 1.7911149994635096,
      2.6778126454176077, 3.57041686055681,   0.8955574997317549,
      1.7911149994635096, 2.6866724991952644, 3.57041686055681,
      0.8926042151392025, 1.7911149994635098, 2.6866724991952644,
      3.582229998927019,  0.8926042151392025, 1.785208430278405,
      2.686672499195265,  3.582229998927019,  0.8955574997317548,
      1.785208430278405,  2.6778126454176077, 3.5822299989270197,
      0.8955574997317548, 1.7911149994635096, 2.6778126454176077,
      3.57041686055681,   0.8955574997317549, 1.7911149994635096,
      2.6866724991952644, 3.57041686055681,   0.8926042151392025,
      1.7911149994635098, 2.6866724991952644, 3.582229998927019,
      0.8926042151392025, 1.785208430278405,  2.686672499195265,
      3.582229998927019,  0.8955574997317548, 1.785208430278405,
      2.6778126454176077, 3.5822299989270197, 0.8955574997317548,
      1.7911149994635096, 2.6778126454176077, 3.57041686055681,
      0.8955574997317549, 1.7911149994635096, 2.6866724991952644,
      3.57041686055681,   0.8926042151392025, 1.7911149994635098,
      2.6866724991952644, 3.582229998927019,  0.8926042151392025,
      1.785208430278405,  2.686672499195265,  3.582229998927019,
      0.8955574997317548, 1.785208430278405,  2.6778126454176077,
      3.5822299989270197, 0.8955574997317548, 1.7911149994635096,
      2.6778126454176077, 3.57041686055681,   0.8955574997317549,
      1.7911149994635096, 2.6866724991952644, 3.57041686055681,
      0.8926042151392025, 1.7911149994635098, 2.6866724991952644,
      3.582229998927019,  0.8926042151392025, 1.785208430278405,
      2.686672499195265,  3.582229998927019,  0.8955574997317548,
      1.785208430278405,  2.6778126454176077, 3.5822299989270197,
      0.8955574997317548, 1.7911149994635096, 2.6778126454176077,
      3.57041686055681,   0.8955574997317549, 1.7911149994635096,
      2.6866724991952644, 3.57041686055681,   0.8926042151392025,
      1.7911149994635098, 2.6866724991952644, 3.582229998927019,
      0.8926042151392025, 1.785208430278405,  2.686672499195265,
      3.582229998927019,  0.8955574997317548, 1.785208430278405,
      2.6778126454176077, 3.5822299989270197, 0.8955574997317548,
      1.7911149994635096, 2.6778126454176077, 3.57041686055681,
      0.8955574997317549, 1.7911149994635096, 2.6866724991952644,
      3.57041686055681,   0.8926042151392025, 1.7911149994635098,
      2.6866724991952644, 3.582229998927019,  0.8926042151392025,
      1.785208430278405,  2.686672499195265,  3.582229998927019,
      0.8955574997317548, 1.785208430278405,  2.6778126454176077,
      3.5822299989270197, 0.8955574997317548, 1.7911149994635096,
      2.6778126454176077, 3.57041686055681,   0.8955574997317549,
      1.7911149994635096, 2.6866724991952644, 3.57041686055681,
      0.8926042151392025, 1.7911149994635098, 2.6866724991952644,
      3.582229998927019,  0.8926042151392025, 1.785208430278405,
      2.686672499195265,  3.582229998927019,  0.8955574997317548,
      1.785208430278405,  2.6778126454176077, 3.5822299989270197,
      0.8955574997317548, 1.7911149994635096, 2.6778126454176077,
      3.57041686055681,   0.8955574997317549, 1.7911149994635096,
      2.6866724991952644, 3.57041686055681,   0.8926042151392025,
      1.7911149994635098, 2.6866724991952644, 3.582229998927019,
      0.8926042151392025, 1.785208430278405,  2.686672499195265,
      3.582229998927019,  0.8955574997317548, 1.785208430278405,
      2.6778126454176077, 3.5822299989270197, 0.8955574997317548,
      1.7911149994635096, 2.6778126454176077, 3.57041686055681,
      0.8955574997317549, 1.7911149994635096, 2.6866724991952644,
      3.57041686055681,   0.8926042151392025, 1.7911149994635098,
      2.6866724991952644, 3.582229998927019,  0.8926042151392025,
      1.785208430278405,  2.686672499195265,  3.582229998927019,
      0.8955574997317548, 1.785208430278405,  2.6778126454176077,
      3.5822299989270197, 0.8955574997317548, 1.7911149994635096,
      2.6778126454176077, 3.57041686055681,   0.8955574997317549,
      1.7911149994635096, 2.6866724991952644, 3.57041686055681,
      0.8926042151392025, 1.7911149994635098, 2.6866724991952644,
      3.582229998927019,  0.8926042151392025, 1.785208430278405,
      2.686672499195265,  3.582229998927019,  0.8955574997317548,
      1.785208430278405,  2.6778126454176077, 3.5822299989270197,
      0.8955574997317548, 1.7911149994635096, 2.6778126454176077,
      3.57041686055681,   0.8955574997317549, 1.7911149994635096,
      2.6866724991952644, 3.57041686055681,   0.8926042151392025,
      1.7911149994635098, 2.6866724991952644, 3.582229998927019,
      0.8926042151392025, 1.785208430278405,  2.686672499195265,
      3.582229998927019,  0.8955574997317548, 1.785208430278405,
      2.6778126454176077, 3.5822299989270197, 0.8955574997317548,
      1.7911149994635096, 2.6778126454176077, 3.57041686055681,
      0.8955574997317549, 1.7911149994635096, 2.6866724991952644,
      3.57041686055681,   0.8926042151392025, 1.7911149994635098,
      2.6866724991952644, 3.582229998927019,  0.8926042151392025,
      1.785208430278405,  2.686672499195265,  3.582229998927019,
      0.8955574997317548, 1.785208430278405,  2.6778126454176077,
      3.5822299989270197, 0.8955574997317548, 1.7911149994635096,
      2.6778126454176077, 3.57041686055681,   0.8955574997317549,
      1.7911149994635096, 2.6866724991952644, 3.57041686055681,
      0.8926042151392025, 1.7911149994635098, 2.6866724991952644,
      3.582229998927019,  0.8926042151392025, 1.785208430278405,
      2.686672499195265,  3.582229998927019,  0.8955574997317548,
      1.785208430278405,  2.6778126454176077, 3.5822299989270197,
      0.8955574997317548, 1.7911149994635096, 2.6778126454176077,
      3.57041686055681,   0.8955574997317549, 1.7911149994635096,
      2.6866724991952644, 3.57041686055681,   0.8926042151392025,
      1.7911149994635098, 2.6866724991952644, 3.582229998927019,
      0.8926042151392025, 1.785208430278405,  2.686672499195265,
      3.582229998927019,  0.8955574997317548, 1.785208430278405,
      2.6778126454176077, 3.5822299989270197, 0.8955574997317548,
      1.7911149994635096, 2.6778126454176077, 3.57041686055681,
      0.8955574997317549, 1.7911149994635096, 2.6866724991952644,
      3.57041686055681,   0.8926042151392025, 1.7911149994635098,
      2.6866724991952644, 3.582229998927019,  0.8926042151392025,
      1.785208430278405,  2.686672499195265,  3.582229998927019,
      0.8955574997317548, 1.785208430278405,  2.6778126454176077,
      3.5822299989270197, 0.8955574997317548, 1.7911149994635096,
      2.6778126454176077, 3.57041686055681,   0.8955574997317549,
      1.7911149994635096, 2.6866724991952644, 3.57041686055681,
      0.8926042151392025, 1.7911149994635098, 2.6866724991952644,
      3.582229998927019,  0.8926042151392025, 1.785208430278405,
      2.686672499195265,  3.582229998927019,  0.8955574997317548,
      1.785208430278405,  2.6778126454176077, 3.5822299989270197,
      0.8955574997317548, 1.7911149994635096, 2.6778126454176077,
      3.57041686055681,   0.8955574997317549, 1.7911149994635096,
      2.6866724991952644, 3.57041686055681,   0.8926042151392025,
      1.7911149994635098, 2.6866724991952644, 3.582229998927019,
      0.8926042151392025, 1.785208430278405,  2.686672499195265,
      3.582229998927019,  0.8955574997317548, 1.785208430278405,
      2.6778126454176077, 3.5822299989270197, 0.8955574997317548,
      1.7911149994635096, 2.6778126454176077, 3.57041686055681,
      0.8955574997317549, 1.7911149994635096, 2.6866724991952644,
      3.57041686055681,   0.8926042151392025, 1.7911149994635098,
      2.6866724991952644, 3.582229998927019,  0.8926042151392025,
      1.785208430278405,  2.686672499195265,  3.582229998927019,
      0.8955574997317548, 1.785208430278405,  2.6778126454176077,
      3.5822299989270197, 0.8955574997317548, 1.7911149994635096,
      2.6778126454176077, 3.57041686055681,   0.8955574997317549,
      1.7911149994635096, 2.6866724991952644, 3.57041686055681,
      0.8926042151392025, 1.7911149994635098, 2.6866724991952644,
      3.582229998927019,  0.8926042151392025, 1.785208430278405,
      2.686672499195265,  3.582229998927019,  0.8955574997317548,
      1.785208430278405,  2.6778126454176077, 3.5822299989270197,
      0.8955574997317548, 1.7911149994635096, 2.6778126454176077,
      3.57041686055681,   0.8955574997317549, 1.7911149994635096,
      2.6866724991952644, 3.57041686055681,   0.8926042151392025,
      1.7911149994635098, 2.6866724991952644, 3.582229998927019,
      0.8926042151392025, 1.785208430278405,  2.686672499195265};
  const std::vector<DataType> mean = {2.493827160493827, 2.506172839506173,
                                      2.5020576131687244, 2.4979423868312756,
                                      2.493827160493827};
  const std::vector<DataType> variance = {
      1.2458466697149835, 1.2458466697149835, 1.254110992565497,
      1.254110992565497, 1.2458466697149828};
  const std::vector<DataType> grad_scale = {
      -1110.6144553148736, -1124.04781781085, -1115.0686889728336,
      -1110.6056678971383, -1110.6144553148736};
  const std::vector<DataType> grad_offset = {606., 609., 608., 607., 606.};
  const std::array<int, 4> in_shape = {{3, 9, 9, 5}};
  const auto params = getBatchNormParams(in_shape, DataFormat::NHWC);
  const DataType max_input_val = 4.0;
  this->test_batchnorm(exp_grad, mean, variance, grad_scale, grad_offset,
                       params, max_input_val);
}
TYPED_TEST(BatchnormGradientFrozen, 3x9x9x8) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_grad = {
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518,
      31.622776601683796, 63.24555320336759,  94.86832980505139,
      126.49110640673518, 31.622776601683796, 63.24555320336759,
      94.86832980505139,  126.49110640673518, 31.622776601683796,
      63.24555320336759,  94.86832980505139,  126.49110640673518};
  const std::vector<DataType> mean = {1., 2., 3., 4., 1., 2., 3., 4.};
  const std::vector<DataType> variance = {0., 0., 0., 0., 0., 0., 0., 0.};
  const std::vector<DataType> grad_scale = {
      -7684.33471420914,   -30737.33885683656, -69159.01242788212,
      -122949.35542734624, -7684.33471420914,  -30737.33885683656,
      -69159.01242788212,  -122949.35542734624};
  const std::vector<DataType> grad_offset = {243., 486., 729., 972.,
                                             243., 486., 729., 972.};
  const std::array<int, 4> in_shape = {{3, 9, 9, 8}};
  const auto params = getBatchNormParams(in_shape, DataFormat::NHWC);
  const DataType max_input_val = 4.0;
  this->test_batchnorm(exp_grad, mean, variance, grad_scale, grad_offset,
                       params, max_input_val);
}
